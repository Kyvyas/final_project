(function(global,factory){if(typeof module==="object"&&typeof module.exports==="object"){module.exports=global.document?factory(global,true):function(w){if(!w.document){throw new Error("jQuery requires a window with a document")}return factory(w)}}else{factory(global)}})(typeof window!=="undefined"?window:this,function(window,noGlobal){var arr=[];var slice=arr.slice;var concat=arr.concat;var push=arr.push;var indexOf=arr.indexOf;var class2type={};var toString=class2type.toString;var hasOwn=class2type.hasOwnProperty;var support={};var document=window.document,version="2.1.4",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return num!=null?num<0?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:arr.sort,splice:arr.splice};jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[i]||{};i++}if(typeof target!=="object"&&!jQuery.isFunction(target)){target={}}if(i===length){target=this;i--}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else{clone=src&&jQuery.isPlainObject(src)?src:{}}target[name]=jQuery.extend(deep,clone,copy)}else if(copy!==undefined){target[name]=copy}}}}return target};jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:true,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray,isWindow:function(obj){return obj!=null&&obj===obj.window},isNumeric:function(obj){return!jQuery.isArray(obj)&&obj-parseFloat(obj)+1>=0},isPlainObject:function(obj){if(jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false}if(obj.constructor&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false}return true},isEmptyObject:function(obj){var name;for(name in obj){return false}return true},type:function(obj){if(obj==null){return obj+""}return typeof obj==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code);if(code){if(code.indexOf("use strict")===1){script=document.createElement("script");script.text=code;document.head.appendChild(script).parentNode.removeChild(script)}else{indirect(code)}}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray){for(;i<length;i++){value=callback.apply(obj[i],args);if(value===false){break}}}else{for(i in obj){value=callback.apply(obj[i],args);if(value===false){break}}}}else{if(isArray){for(;i<length;i++){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}else{for(i in obj){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}}return obj},trim:function(text){return text==null?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArraylike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr)}else{push.call(ret,arr)}}return ret},inArray:function(elem,arr,i){return arr==null?-1:indexOf.call(arr,elem,i)},merge:function(first,second){var len=+second.length,j=0,i=first.length;for(;j<len;j++){first[i++]=second[j]}first.length=i;return first},grep:function(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;for(;i<length;i++){callbackInverse=!callback(elems[i],i);if(callbackInverse!==callbackExpect){matches.push(elems[i])}}return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret.push(value)}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret.push(value)}}}return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp}if(!jQuery.isFunction(fn)){return undefined}args=slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy},now:Date.now,support:support});jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});function isArraylike(obj){var length="length"in obj&&obj.length,type=jQuery.type(obj);if(type==="function"||jQuery.isWindow(obj)){return false}if(obj.nodeType===1&&length){return true}return type==="array"||length===0||typeof length==="number"&&length>0&&length-1 in obj}var Sizzle=function(window){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true}return 0},MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){var i=0,len=list.length;for(;i<len;i++){if(list[i]===elem){return i}}return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|"+".*"+")\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320)},unloadHandler=function(){setDocument()};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){var j=target.length,i=0;while(target[j++]=els[i++]){}target.length=j-1}}}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context)}context=context||document;results=results||[];nodeType=context.nodeType;if(typeof selector!=="string"||!selector||nodeType!==1&&nodeType!==9&&nodeType!==11){return results}if(!seed&&documentIsHTML){if(nodeType!==11&&(match=rquickExpr.exec(selector))){if(m=match[1]){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results}}else{return results}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results}else if((m=match[3])&&support.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results}}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType!==1&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if(old=context.getAttribute("id")){nid=old.replace(rescape,"\\$&")}else{context.setAttribute("id",nid)}nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i])}newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;newSelector=groups.join(",")}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results}catch(qsaError){}finally{if(!old){context.removeAttribute("id")}}}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()]}return cache[key+" "]=value}return cache}function markFunction(fn){fn[expando]=true;return fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return false}finally{if(div.parentNode){div.parentNode.removeChild(div)}div=null}}function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler}}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff}if(cur){while(cur=cur.nextSibling){if(cur===b){return-1}}}return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[j=matchIndexes[i]]){seed[j]=!(matches[j]=seed[j])}}})})}function testContext(context){return context&&typeof context.getElementsByTagName!=="undefined"&&context}support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};setDocument=Sizzle.setDocument=function(node){var hasCompare,parent,doc=node?node.ownerDocument||node:preferredDoc;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document}document=doc;docElem=doc.documentElement;parent=doc.defaultView;if(parent&&parent!==parent.top){if(parent.addEventListener){parent.addEventListener("unload",unloadHandler,false)}else if(parent.attachEvent){parent.attachEvent("onunload",unloadHandler)}}documentIsHTML=!isXML(doc);support.attributes=assert(function(div){div.className="i";return!div.getAttribute("className")});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return!div.getElementsByTagName("*").length});support.getElementsByClassName=rnative.test(doc.getElementsByClassName);support.getById=assert(function(div){docElem.appendChild(div).id=expando;return!doc.getElementsByName||!doc.getElementsByName(expando).length});if(support.getById){Expr.find["ID"]=function(id,context){if(typeof context.getElementById!=="undefined"&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}};Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}}else{delete Expr.find["ID"];Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return node&&node.value===attrId}}}Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!=="undefined"){return context.getElementsByTagName(tag)}else if(support.qsa){return context.querySelectorAll(tag)}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while(elem=results[i++]){if(elem.nodeType===1){tmp.push(elem)}}return tmp}return results};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(documentIsHTML){return context.getElementsByClassName(className)}};rbuggyMatches=[];rbuggyQSA=[];if(support.qsa=rnative.test(doc.querySelectorAll)){assert(function(div){docElem.appendChild(div).innerHTML="<a id='"+expando+"'></a>"+"<select id='"+expando+"-\f]' msallowcapture=''>"+"<option selected=''></option></select>";if(div.querySelectorAll("[msallowcapture^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")")}if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")")}if(!div.querySelectorAll("[id~="+expando+"-]").length){rbuggyQSA.push("~=")}if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked")}if(!div.querySelectorAll("a#"+expando+"+*").length){rbuggyQSA.push(".#.+[+~]")}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("name","D");if(div.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=")}if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled")}div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:")})}if(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos)})}rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))}:function(a,b){if(b){while(b=b.parentNode){if(b===a){return true}}}return false};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0}var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare}compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||!support.sortDetached&&b.compareDocumentPosition(a)===compare){if(a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){return-1}if(b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){return 1}return sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0}return compare&4?-1:1}:function(a,b){if(a===b){hasDuplicate=true;return 0}var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0}else if(aup===bup){return siblingCheck(a,b)}cur=a;while(cur=cur.parentNode){ap.unshift(cur)}cur=b;while(cur=cur.parentNode){bp.unshift(cur)}while(ap[i]===bp[i]){i++}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0};return doc};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem)}expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret}}catch(e){}}return Sizzle(expr,document,null,[elem]).length>0};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context)}return contains(context,elem)};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem)}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while(elem=results[i++]){if(elem===results[i]){j=duplicates.push(i)}}while(j--){results.splice(duplicates[j],1)}}sortInput=null;return results};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while(node=elem[i++]){ret+=getText(node)}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else if(nodeType===3||nodeType===4){return elem.nodeValue}return ret};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" "}return match.slice(0,4)},CHILD:function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0])}match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+(match[7]+match[8]||match[3]==="odd")}else if(match[3]){Sizzle.error(match[0])}return match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null}if(match[3]){match[2]=match[4]||match[5]||""}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess)}return match.slice(0,3)}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!=="undefined"&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!="}if(!operator){return true}result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false}},CHILD:function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while(node=node[dir]){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false}}start=dir=type==="only"&&!start&&"nextSibling"}return true}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1]}else{while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff]}if(node===elem){break}}}}diff-=last;return diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument)}if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i])}}):function(elem){return fn(elem,0,args)}}return fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if(elem=unmatched[i]){seed[i]=!(matches[i]=elem)}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);input[0]=null;return!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){text=text.replace(runescape,funescape);return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang)}lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang")){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0}}while((elem=elem.parentNode)&&elem.nodeType===1);return false}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===false},disabled:function(elem){return elem.disabled===true},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName==="input"&&!!elem.checked||nodeName==="option"&&!!elem.selected},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false}}return true},parent:function(elem){return!Expr.pseudos["empty"](elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},text:function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text")},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i)}return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i)}return matchIndexes})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i)}for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i)}function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters;tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0)}soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar}groups.push(tokens=[])}matched=false;if(match=rcombinators.exec(soFar)){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length)}for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length)}}if(!matched){break}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)};function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value}return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml)}}}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true}}}}else{while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return newCache[2]=oldCache[2]}else{outerCache[dir]=newCache;if(newCache[2]=matcher(elem,context,xml)){return true}}}}}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false}}return true}:matchers[0]}function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results)}return results}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if(elem=unmatched[i]){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i)}}}}return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter)}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector)}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml)}if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if(elem=temp[i]){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if(elem=matcherOut[i]){temp.push(matcherIn[i]=elem)}}postFinder(null,matcherOut=[],temp,xml)}i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem)}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml)}else{push.apply(results,matcherOut)}}})}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,true),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));checkContext=null;return ret}];for(;i<len;i++){if(matcher=Expr.relative[tokens[i].type]){matchers=[addCombinator(elementMatcher(matchers),matcher)]}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens));
}matchers.push(matcher)}}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",outermost),dirrunsUnique=dirruns+=contextBackup==null?1:Math.random()||.1,len=elems.length;if(outermost){outermostContext=context!==document&&context}for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while(matcher=elementMatchers[j++]){if(matcher(elem,context,xml)){results.push(elem);break}}if(outermost){dirruns=dirrunsUnique}}if(bySet){if(elem=!matcher&&elem){matchedCount--}if(seed){unmatched.push(elem)}}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while(matcher=setMatchers[j++]){matcher(unmatched,setMatched,context,xml)}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results)}}}setMatched=condense(setMatched)}push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1){Sizzle.uniqueSort(results)}}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup}return unmatched};return bySet?markFunction(superMatcher):superMatcher}compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector)}i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached)}else{elementMatchers.push(cached)}}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector}return cached};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results}else if(compiled){context=context.parentNode}selector=selector.slice(tokens.shift().value.length)}i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[type=token.type]){break}if(find=Expr.find[type]){if(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context)){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results}break}}}}(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context);return results};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#"})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2)}})}if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")===""})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue}})}if(!assert(function(div){return div.getAttribute("disabled")==null})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}})}return Sizzle}(window);jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext;var rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/;var risSimple=/^.[^:#\[\.,]*$/;function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not})}if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return elem===qualifier!==not})}if(typeof qualifier==="string"){if(risSimple.test(qualifier)){return jQuery.filter(qualifier,elements,not)}qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>=0!==not})}jQuery.filter=function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")"}return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1}))};jQuery.fn.extend({find:function(selector){var i,len=this.length,ret=[],self=this;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true}}}))}for(i=0;i<len;i++){jQuery.find(selector,self[i],ret)}ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],false))},not:function(selector){return this.pushStack(winnow(this,selector||[],true))},is:function(selector){return!!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector){return this}if(typeof selector==="string"){if(selector[0]==="<"&&selector[selector.length-1]===">"&&selector.length>=3){match=[null,selector,null]}else{match=rquickExpr.exec(selector)}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(jQuery.isFunction(this[match])){this[match](context[match])}else{this.attr(match,context[match])}}}return this}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}}else if(!context||context.jquery){return(context||rootjQuery).find(selector)}else{return this.constructor(context).find(selector)}}else if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}else if(jQuery.isFunction(selector)){return typeof rootjQuery.ready!=="undefined"?rootjQuery.ready(selector):selector(jQuery)}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)};init.prototype=jQuery.fn;rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.extend({dir:function(elem,dir,until){var matched=[],truncate=until!==undefined;while((elem=elem[dir])&&elem.nodeType!==9){if(elem.nodeType===1){if(truncate&&jQuery(elem).is(until)){break}matched.push(elem)}}return matched},sibling:function(n,elem){var matched=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){matched.push(n)}}return matched}});jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){var i=0;for(;i<l;i++){if(jQuery.contains(this,targets[i])){return true}}})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}}}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){if(!elem){return this[0]&&this[0].parentNode?this.first().prevAll().length:-1}if(typeof elem==="string"){return indexOf.call(jQuery(elem),this[0])}return indexOf.call(this,elem.jquery?elem[0]:elem)},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}});function sibling(cur,dir){while((cur=cur[dir])&&cur.nodeType!==1){}return cur}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until}if(selector&&typeof selector==="string"){matched=jQuery.filter(selector,matched)}if(this.length>1){if(!guaranteedUnique[name]){jQuery.unique(matched)}if(rparentsprev.test(name)){matched.reverse()}}return this.pushStack(matched)}});var rnotwhite=/\S+/g;var optionsCache={};function createOptions(options){var object=optionsCache[options]={};jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=true});return object}jQuery.Callbacks=function(options){options=typeof options==="string"?optionsCache[options]||createOptions(options):jQuery.extend({},options);var memory,fired,firing,firingStart,firingLength,firingIndex,list=[],stack=!options.once&&[],fire=function(data){memory=options.memory&&data;fired=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;firing=true;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){memory=false;break}}firing=false;if(list){if(stack){if(stack.length){fire(stack.shift())}}else if(memory){list=[]}else{self.disable()}}},self={add:function(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);if(type==="function"){if(!options.unique||!self.has(arg)){list.push(arg)}}else if(arg&&arg.length&&type!=="string"){add(arg)}})})(arguments);if(firing){firingLength=list.length}else if(memory){firingStart=start;fire(memory)}}return this},remove:function(){if(list){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(firing){if(index<=firingLength){firingLength--}if(index<=firingIndex){firingIndex--}}}})}return this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length)},empty:function(){list=[];firingLength=0;return this},disable:function(){list=stack=memory=undefined;return this},disabled:function(){return!list},lock:function(){stack=undefined;if(!memory){self.disable()}return this},locked:function(){return!stack},fireWith:function(context,args){if(list&&(!fired||stack)){args=args||[];args=[context,args.slice?args.slice():args];if(firing){stack.push(args)}else{fire(args)}}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return!!fired}};return self};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){deferred.done(arguments).fail(arguments);return this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify)}else{newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)}})});fns=null}).promise()},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString},tuples[i^1][2].disable,tuples[2][2].lock)}deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);return this};deferred[tuple[0]+"With"]=list.fireWith});promise.promise(deferred);if(func){func.call(deferred,deferred)}return deferred},when:function(subordinate){var i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=length!==1||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?slice.call(arguments):value;if(values===progressValues){deferred.notifyWith(contexts,values)}else if(!--remaining){deferred.resolveWith(contexts,values)}}},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;i<length;i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues))}else{--remaining}}}if(!remaining){deferred.resolveWith(resolveContexts,resolveValues)}return deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){jQuery.ready.promise().done(fn);return this};jQuery.extend({isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++}else{jQuery.ready(true)}},ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return}jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return}readyList.resolveWith(document,[jQuery]);if(jQuery.fn.triggerHandler){jQuery(document).triggerHandler("ready");jQuery(document).off("ready")}}});function completed(){document.removeEventListener("DOMContentLoaded",completed,false);window.removeEventListener("load",completed,false);jQuery.ready()}jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if(document.readyState==="complete"){setTimeout(jQuery.ready)}else{document.addEventListener("DOMContentLoaded",completed,false);window.addEventListener("load",completed,false)}}return readyList.promise(obj)};jQuery.ready.promise();var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=key==null;if(jQuery.type(key)==="object"){chainable=true;for(i in key){jQuery.access(elems,fn,i,key[i],true,emptyGet,raw)}}else if(value!==undefined){chainable=true;if(!jQuery.isFunction(value)){raw=true}if(bulk){if(raw){fn.call(elems,value);fn=null}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value)}}}if(fn){for(;i<len;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)))}}}return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet};jQuery.acceptData=function(owner){return owner.nodeType===1||owner.nodeType===9||!+owner.nodeType};function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}});this.expando=jQuery.expando+Data.uid++}Data.uid=1;Data.accepts=jQuery.acceptData;Data.prototype={key:function(owner){if(!Data.accepts(owner)){return 0}var descriptor={},unlock=owner[this.expando];if(!unlock){unlock=Data.uid++;try{descriptor[this.expando]={value:unlock};Object.defineProperties(owner,descriptor)}catch(e){descriptor[this.expando]=unlock;jQuery.extend(owner,descriptor)}}if(!this.cache[unlock]){this.cache[unlock]={}}return unlock},set:function(owner,data,value){var prop,unlock=this.key(owner),cache=this.cache[unlock];if(typeof data==="string"){cache[data]=value}else{if(jQuery.isEmptyObject(cache)){jQuery.extend(this.cache[unlock],data)}else{for(prop in data){cache[prop]=data[prop]}}}return cache},get:function(owner,key){var cache=this.cache[this.key(owner)];return key===undefined?cache:cache[key]},access:function(owner,key,value){var stored;if(key===undefined||key&&typeof key==="string"&&value===undefined){stored=this.get(owner,key);return stored!==undefined?stored:this.get(owner,jQuery.camelCase(key))}this.set(owner,key,value);return value!==undefined?value:key},remove:function(owner,key){var i,name,camel,unlock=this.key(owner),cache=this.cache[unlock];if(key===undefined){this.cache[unlock]={}}else{if(jQuery.isArray(key)){name=key.concat(key.map(jQuery.camelCase))}else{camel=jQuery.camelCase(key);if(key in cache){name=[key,camel]}else{name=camel;name=name in cache?[name]:name.match(rnotwhite)||[]}}i=name.length;while(i--){delete cache[name[i]]}}},hasData:function(owner){return!jQuery.isEmptyObject(this.cache[owner[this.expando]]||{})},discard:function(owner){if(owner[this.expando]){delete this.cache[owner[this.expando]]}}};var data_priv=new Data;var data_user=new Data;var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;function dataAttr(elem,key,data){var name;if(data===undefined&&elem.nodeType===1){name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}data_user.set(elem,key,data)}else{data=undefined}}return data}jQuery.extend({hasData:function(elem){return data_user.hasData(elem)||data_priv.hasData(elem)},data:function(elem,name,data){return data_user.access(elem,name,data)},removeData:function(elem,name){data_user.remove(elem,name)},_data:function(elem,name,data){return data_priv.access(elem,name,data)},_removeData:function(elem,name){data_priv.remove(elem,name)}});jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(key===undefined){if(this.length){data=data_user.get(elem);if(elem.nodeType===1&&!data_priv.get(elem,"hasDataAttrs")){i=attrs.length;while(i--){if(attrs[i]){name=attrs[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name])}}}data_priv.set(elem,"hasDataAttrs",true)}}return data}if(typeof key==="object"){return this.each(function(){data_user.set(this,key)})}return access(this,function(value){var data,camelKey=jQuery.camelCase(key);if(elem&&value===undefined){data=data_user.get(elem,key);if(data!==undefined){return data}data=data_user.get(elem,camelKey);if(data!==undefined){return data}data=dataAttr(elem,camelKey,undefined);if(data!==undefined){return data}return}this.each(function(){var data=data_user.get(this,camelKey);data_user.set(this,camelKey,value);if(key.indexOf("-")!==-1&&data!==undefined){data_user.set(this,key,value)}})},null,value,arguments.length>1,null,true)},removeData:function(key){return this.each(function(){data_user.remove(this,key)})}});jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=data_priv.get(elem,type);if(data){if(!queue||jQuery.isArray(data)){queue=data_priv.access(elem,type,jQuery.makeArray(data))}else{queue.push(data)}}return queue||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};if(fn==="inprogress"){fn=queue.shift();startLength--}if(fn){if(type==="fx"){queue.unshift("inprogress")}delete hooks.stop;fn.call(elem,next,hooks)}if(!startLength&&hooks){hooks.empty.fire()}},_queueHooks:function(elem,type){var key=type+"queueHooks";return data_priv.get(elem,key)||data_priv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(elem,[type+"queue",key])})})}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--}if(arguments.length<setter){return jQuery.queue(this[0],type)}return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)}})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!--count){defer.resolveWith(elements,[elements])}};if(typeof type!=="string"){obj=type;type=undefined}type=type||"fx";while(i--){tmp=data_priv.get(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve)}}resolve();return defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var cssExpand=["Top","Right","Bottom","Left"];var isHidden=function(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem)};var rcheckableType=/^(?:checkbox|radio)$/i;(function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio");input.setAttribute("checked","checked");input.setAttribute("name","t");div.appendChild(input);support.checkClone=div.cloneNode(true).cloneNode(true).lastChild.checked;div.innerHTML="<textarea>x</textarea>";support.noCloneChecked=!!div.cloneNode(true).lastChild.defaultValue})();var strundefined=typeof undefined;support.focusinBubbles="onfocusin"in window;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;function returnTrue(){return true}function returnFalse(){return false}function safeActiveElement(){try{return document.activeElement}catch(err){}}jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.get(elem);if(!elemData){return}if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector}if(!handler.guid){handler.guid=jQuery.guid++}if(!(events=elemData.events)){events=elemData.events={}}if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!==strundefined&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):undefined}}types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false)}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid}}if(selector){handlers.splice(handlers.delegateCount++,0,handleObj)}else{handlers.push(handleObj)}jQuery.event.global[type]=true}},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.hasData(elem)&&data_priv.get(elem);if(!elemData||!(events=elemData.events)){return}types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true)}continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--}if(special.remove){special.remove.call(elem,handleObj)}}}if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle)}delete events[type]}}if(jQuery.isEmptyObject(events)){delete elemData.handle;data_priv.remove(elem,"events")}},trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return}if(rfocusMorph.test(type+jQuery.event.triggered)){return}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem}data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return}if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode}for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur}if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window)}}i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;handle=(data_priv.get(cur,"events")||{})[event.type]&&data_priv.get(cur,"handle");if(handle){handle.apply(cur,data)}handle=ontype&&cur[ontype];if(handle&&handle.apply&&jQuery.acceptData(cur)){event.result=handle.apply(cur,data);if(event.result===false){event.preventDefault()}}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&jQuery.acceptData(elem)){if(ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null}jQuery.event.triggered=type;elem[type]();jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp}}}}return event.result},dispatch:function(event){event=jQuery.event.fix(event);var i,j,ret,matched,handleObj,handlerQueue=[],args=slice.call(arguments),handlers=(data_priv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return}handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation()}}}}}if(special.postDispatch){special.postDispatch.call(this,event)}return event.result},handlers:function(event,handlers){var i,matches,sel,handleObj,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){for(;cur!==this;cur=cur.parentNode||this){if(cur.disabled!==true||event.type!=="click"){matches=[];for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matches[sel]===undefined){matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length}if(matches[sel]){matches.push(handleObj)}}if(matches.length){handlerQueue.push({elem:cur,handlers:matches})}}}}if(delegateCount<handlers.length){handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)})}return handlerQueue},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode}return event}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(!event.which&&button!==undefined){event.which=button&1?1:button&2?3:button&4?2:0}return event}},fix:function(event){if(event[jQuery.expando]){return event}var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];if(!fixHook){this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}}copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;while(i--){prop=copy[i];event[prop]=originalEvent[prop]}if(!event.target){event.target=document}if(event.target.nodeType===3){event.target=event.target.parentNode}return fixHook.filter?fixHook.filter(event,originalEvent):event},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){this.focus();return false}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&jQuery.nodeName(this,"input")){this.click();return false}},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){if(event.result!==undefined&&event.originalEvent){event.originalEvent.returnValue=event.result;
}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem)}else{jQuery.event.dispatch.call(elem,e)}if(e.isDefaultPrevented()){event.preventDefault()}}};jQuery.removeEvent=function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false)}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props)}if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.defaultPrevented===undefined&&src.returnValue===false?returnTrue:returnFalse}else{this.type=src}if(props){jQuery.extend(this,props)}this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true};jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(e&&e.preventDefault){e.preventDefault()}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(e&&e.stopPropagation){e.stopPropagation()}},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue;if(e&&e.stopImmediatePropagation){e.stopImmediatePropagation()}this.stopPropagation()}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||related!==target&&!jQuery.contains(target,related)){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});if(!support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix);if(!attaches){doc.addEventListener(orig,handler,true)}data_priv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix)-1;if(!attaches){doc.removeEventListener(orig,handler,true);data_priv.remove(doc,fix)}else{data_priv.access(doc,fix,attaches)}}}})}jQuery.fn.extend({on:function(types,selector,data,fn,one){var origFn,type;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined}for(type in types){this.on(type,selector,data,types[type],one)}return this}if(data==null&&fn==null){fn=selector;data=selector=undefined}else if(fn==null){if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}}if(fn===false){fn=returnFalse}else if(!fn){return this}if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this}if(typeof types==="object"){for(type in types){this.off(type,selector,types[type])}return this}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined}if(fn===false){fn=returnFalse}return this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true)}}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType!==11?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){elem.type=(elem.getAttribute("type")!==null)+"/"+elem.type;return elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);if(match){elem.type=match[1]}else{elem.removeAttribute("type")}return elem}function setGlobalEval(elems,refElements){var i=0,l=elems.length;for(;i<l;i++){data_priv.set(elems[i],"globalEval",!refElements||data_priv.get(refElements[i],"globalEval"))}}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(dest.nodeType!==1){return}if(data_priv.hasData(src)){pdataOld=data_priv.access(src);pdataCur=data_priv.set(dest,pdataOld);events=pdataOld.events;if(events){delete pdataCur.handle;pdataCur.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i])}}}}if(data_user.hasData(src)){udataOld=data_user.access(src);udataCur=jQuery.extend({},udataOld);data_user.set(dest,udataCur)}}function getAll(context,tag){var ret=context.getElementsByTagName?context.getElementsByTagName(tag||"*"):context.querySelectorAll?context.querySelectorAll(tag||"*"):[];return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();if(nodeName==="input"&&rcheckableType.test(src.type)){dest.checked=src.checked}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue}}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(true),inPage=jQuery.contains(elem.ownerDocument,elem);if(!support.noCloneChecked&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0,l=srcElements.length;i<l;i++){fixInput(srcElements[i],destElements[i])}}if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0,l=srcElements.length;i<l;i++){cloneCopyEvent(srcElements[i],destElements[i])}}else{cloneCopyEvent(elem,clone)}}destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"))}return clone},buildFragment:function(elems,context,scripts,selection){var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(jQuery.type(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem)}else if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem))}else{tmp=tmp||fragment.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild}jQuery.merge(nodes,tmp.childNodes);tmp=fragment.firstChild;tmp.textContent=""}}}fragment.textContent="";i=0;while(elem=nodes[i++]){if(selection&&jQuery.inArray(elem,selection)!==-1){continue}contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(fragment.appendChild(elem),"script");if(contains){setGlobalEval(tmp)}if(scripts){j=0;while(elem=tmp[j++]){if(rscriptType.test(elem.type||"")){scripts.push(elem)}}}}return fragment},cleanData:function(elems){var data,elem,type,key,special=jQuery.event.special,i=0;for(;(elem=elems[i])!==undefined;i++){if(jQuery.acceptData(elem)){key=elem[data_priv.expando];if(key&&(data=data_priv.cache[key])){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type)}else{jQuery.removeEvent(elem,type,data.handle)}}}if(data_priv.cache[key]){delete data_priv.cache[key]}}}delete data_user.cache[elem[data_user.expando]]}}});jQuery.fn.extend({text:function(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.textContent=value}})},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this)}})},after:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling)}})},remove:function(selector,keepData){var elem,elems=selector?jQuery.filter(selector,this):this,i=0;for(;(elem=elems[i])!=null;i++){if(!keepData&&elem.nodeType===1){jQuery.cleanData(getAll(elem))}if(elem.parentNode){if(keepData&&jQuery.contains(elem.ownerDocument,elem)){setGlobalEval(getAll(elem,"script"))}elem.parentNode.removeChild(elem)}}return this},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.textContent=""}}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined&&elem.nodeType===1){return elem.innerHTML}if(typeof value==="string"&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value}}elem=0}catch(e){}}if(elem){this.empty().append(value)}},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];this.domManip(arguments,function(elem){arg=this.parentNode;jQuery.cleanData(getAll(this));if(arg){arg.replaceChild(elem,this)}});return arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,true)},domManip:function(args,callback){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&typeof value==="string"&&!support.checkClone&&rchecked.test(value)){return this.each(function(index){var self=set.eq(index);if(isFunction){args[0]=value.call(this,index,self.html())}self.domManip(args,callback)})}if(l){fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,this);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first}if(first){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"))}}callback.call(this[i],node,i)}if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!data_priv.access(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src){if(jQuery._evalUrl){jQuery._evalUrl(node.src)}}else{jQuery.globalEval(node.textContent.replace(rcleanScript,""))}}}}}}return this}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);push.apply(ret,elems.get())}return this.pushStack(ret)}});var iframe,elemdisplay={};function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");elem.detach();return display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if(display==="none"||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);doc=iframe[0].contentDocument;doc.write();doc.close();display=actualDisplay(nodeName,doc);iframe.detach()}elemdisplay[nodeName]=display}return display}var rmargin=/^margin/;var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");var getStyles=function(elem){if(elem.ownerDocument.defaultView.opener){return elem.ownerDocument.defaultView.getComputedStyle(elem,null)}return window.getComputedStyle(elem,null)};function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;computed=computed||getStyles(elem);if(computed){ret=computed.getPropertyValue(name)||computed[name]}if(computed){if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name)}if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth}}return ret!==undefined?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){if(conditionFn()){delete this.get;return}return(this.get=hookFn).apply(this,arguments)}}}(function(){var pixelPositionVal,boxSizingReliableVal,docElem=document.documentElement,container=document.createElement("div"),div=document.createElement("div");if(!div.style){return}div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";container.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;"+"position:absolute";container.appendChild(div);function computePixelPositionAndBoxSizingReliable(){div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;"+"box-sizing:border-box;display:block;margin-top:1%;top:1%;"+"border:1px;padding:1px;width:4px;position:absolute";div.innerHTML="";docElem.appendChild(container);var divStyle=window.getComputedStyle(div,null);pixelPositionVal=divStyle.top!=="1%";boxSizingReliableVal=divStyle.width==="4px";docElem.removeChild(container)}if(window.getComputedStyle){jQuery.extend(support,{pixelPosition:function(){computePixelPositionAndBoxSizingReliable();return pixelPositionVal},boxSizingReliable:function(){if(boxSizingReliableVal==null){computePixelPositionAndBoxSizingReliable()}return boxSizingReliableVal},reliableMarginRight:function(){var ret,marginDiv=div.appendChild(document.createElement("div"));marginDiv.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;"+"box-sizing:content-box;display:block;margin:0;border:0;padding:0";marginDiv.style.marginRight=marginDiv.style.width="0";div.style.width="1px";docElem.appendChild(container);ret=!parseFloat(window.getComputedStyle(marginDiv,null).marginRight);docElem.removeChild(container);div.removeChild(marginDiv);return ret}})}})();jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name]}ret=callback.apply(elem,args||[]);for(name in options){elem.style[name]=old[name]}return ret};var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];function vendorPropName(style,name){if(name in style){return name}var capName=name[0].toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name}}return origName}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],true,styles)}if(isBorderBox){if(extra==="content"){val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles)}if(extra!=="margin"){val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}else{val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(extra!=="padding"){val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}}return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=true,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=jQuery.css(elem,"boxSizing",false,styles)==="border-box";if(val<=0||val==null){val=curCSS(elem,name,styles);if(val<0||val==null){val=elem.style[name]}if(rnumnonpx.test(val)){return val}valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]);val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue}values[index]=data_priv.get(elem,"olddisplay");display=elem.style.display;if(show){if(!values[index]&&display==="none"){elem.style.display=""}if(elem.style.display===""&&isHidden(elem)){values[index]=data_priv.access(elem,"olddisplay",defaultDisplay(elem.nodeName))}}else{hidden=isHidden(elem);if(display!=="none"||!hidden){data_priv.set(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))}}}for(index=0;index<length;index++){elem=elements[index];if(!elem.style){continue}if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none"}}return elements}jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret}}}},cssNumber:{columnCount:true,fillOpacity:true,flexGrow:true,flexShrink:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":"cssFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return}var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));type="number"}if(value==null||value!==value){return}if(type==="number"&&!jQuery.cssNumber[origName]){value+="px"}if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit"}if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined){style[name]=value}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret}return style[name]}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get"in hooks){val=hooks.get(elem,true,extra)}if(val===undefined){val=curCSS(elem,name,styles)}if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name]}if(extra===""||extra){num=parseFloat(val);return extra===true||jQuery.isNumeric(num)?num||0:val}return val}});jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){return rdisplayswap.test(jQuery.css(elem,"display"))&&elem.offsetWidth===0?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra)}},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,jQuery.css(elem,"boxSizing",false,styles)==="border-box",styles):0)}}});jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){if(computed){return jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"])}});jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0]}return expanded}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber}});jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles)}return map}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,true)},hide:function(){return showHide(this)},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide()}return this.each(function(){if(isHidden(this)){jQuery(this).show()}else{jQuery(this).hide()}})}});function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||"swing";this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration)}else{this.pos=eased=percent}this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(hooks&&hooks.set){hooks.set(this)}else{Tween.propHooks._default.set(this)}return this}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop]}result=jQuery.css(tween.elem,tween.prop,"");return!result||result==="auto"?0:result},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween)}else if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}else{tween.elem[tween.prop]=tween.now}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now}}};jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}};jQuery.fx=Tween.prototype.init;jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3];parts=parts||[];start=+target||1;do{scale=scale||".5";start=start/scale;jQuery.style(tween.elem,prop,start+unit)}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations)}if(parts){start=tween.start=+start||+target||0;tween.unit=unit;tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]}return tween}]};function createFxNow(){setTimeout(function(){fxNow=undefined});return fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type}if(includeWidth){attrs.opacity=attrs.width=type}return attrs}function createTween(value,prop,animation){var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if(tween=collection[index].call(animation,prop,value)){return tween}}}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=data_priv.get(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire()}}}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire()}})})}if(elem.nodeType===1&&("height"in props||"width"in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];display=jQuery.css(elem,"display");checkDisplay=display==="none"?data_priv.get(elem,"olddisplay")||defaultDisplay(elem.nodeName):display;if(checkDisplay==="inline"&&jQuery.css(elem,"float")==="none"){style.display="inline-block"}}if(opts.overflow){style.overflow="hidden";anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2]})}for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){if(value==="show"&&dataShow&&dataShow[prop]!==undefined){hidden=true}else{continue}}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else{display=undefined}}if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden"in dataShow){hidden=dataShow.hidden}}else{dataShow=data_priv.access(elem,"fxshow",{})}if(toggle){dataShow.hidden=!hidden}if(hidden){jQuery(elem).show()}else{anim.done(function(){jQuery(elem).hide()})}anim.done(function(){var prop;data_priv.remove(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop])}});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0}}}}else if((display==="none"?defaultDisplay(elem.nodeName):display)==="inline"){style.display=display}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0]}if(index!==name){props[name]=value;delete props[index]}hooks=jQuery.cssHooks[name];if(hooks&&"expand"in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing}}}else{specialEasing[name]=easing}}}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped){return false}var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent)}deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining}else{deferred.resolveWith(elem,[animation]);return false}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this}stopped=true;for(;index<length;index++){animation.tweens[index].run(1)}if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd])}else{deferred.rejectWith(elem,[animation,gotoEnd])}return this}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);if(result){return result}}jQuery.map(props,createTween,animation);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation)}jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"]}else{props=props.split(" ")}var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];tweeners[prop]=tweeners[prop]||[];tweeners[prop].unshift(callback)}},prefilter:function(callback,prepend){if(prepend){animationPrefilters.unshift(callback)}else{animationPrefilters.push(callback)}}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx"}opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this)}if(opt.queue){jQuery.dequeue(this,opt.queue)}};return opt};jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||data_priv.get(this,"finish")){anim.stop(true)}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){
var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd)};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}if(clearQueue&&type!==false){this.queue(type||"fx",[])}return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=data_priv.get(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index])}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index])}}}for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1)}}if(dequeue||!gotoEnd){jQuery.dequeue(this,type)}})},finish:function(type){if(type!==false){type=type||"fx"}return this.each(function(){var index,data=data_priv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true)}for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1)}}for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this)}}delete data.finish})}});jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback)}});jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.timers=[];jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1)}}if(!timers.length){jQuery.fx.stop()}fxNow=undefined};jQuery.fx.timer=function(timer){jQuery.timers.push(timer);if(timer()){jQuery.fx.start()}else{jQuery.timers.pop()}};jQuery.fx.interval=13;jQuery.fx.start=function(){if(!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval)}};jQuery.fx.stop=function(){clearInterval(timerId);timerId=null};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})};(function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox";support.checkOn=input.value!=="";support.optSelected=opt.selected;select.disabled=true;support.optDisabled=!opt.disabled;input=document.createElement("input");input.value="t";input.type="radio";support.radioValue=input.value==="t"})();var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}});jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}if(typeof elem.getAttribute===strundefined){return jQuery.prop(elem,name,value)}if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name)}else if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{elem.setAttribute(name,value+"");return value}}else if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret}else{ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&elem.nodeType===1){while(name=attrNames[i++]){propName=jQuery.propFix[name]||name;if(jQuery.expr.match.bool.test(name)){elem[propName]=false}elem.removeAttribute(name)}}},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val}return value}}}}});boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name)}else{elem.setAttribute(name,name)}return name}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle;if(!isXML){handle=attrHandle[name];attrHandle[name]=ret;ret=getter(elem,name,isXML)!=null?name.toLowerCase():null;attrHandle[name]=handle}return ret}});var rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}});jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}if(value!==undefined){return hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:elem[name]=value}else{return hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name]}},propHooks:{tabIndex:{get:function(elem){return elem.hasAttribute("tabindex")||rfocusable.test(elem.nodeName)||elem.href?elem.tabIndex:-1}}}});if(!support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent&&parent.parentNode){parent.parentNode.selectedIndex}return null}}}jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed=typeof value==="string"&&value,i=0,len=this.length;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ");if(cur){j=0;while(clazz=classes[j++]){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" "}}finalValue=jQuery.trim(cur);if(elem.className!==finalValue){elem.className=finalValue}}}}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed=arguments.length===0||typeof value==="string"&&value,i=0,len=this.length;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"");if(cur){j=0;while(clazz=classes[j++]){while(cur.indexOf(" "+clazz+" ")>=0){cur=cur.replace(" "+clazz+" "," ")}}finalValue=value?jQuery.trim(cur):"";if(elem.className!==finalValue){elem.className=finalValue}}}}return this},toggleClass:function(value,stateVal){var type=typeof value;if(typeof stateVal==="boolean"&&type==="string"){return stateVal?this.addClass(value):this.removeClass(value)}if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)})}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];while(className=classNames[i++]){if(self.hasClass(className)){self.removeClass(className)}else{self.addClass(className)}}}else if(type===strundefined||type==="boolean"){if(this.className){data_priv.set(this,"__className__",this.className)}this.className=this.className||value===false?"":data_priv.get(this,"__className__")||""}})},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){return true}}return false}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret}return}isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return}if(isFunction){val=value.call(this,i,jQuery(this).val())}else{val=value}if(val==null){val=""}else if(typeof val==="number"){val+=""}else if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""})}hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){this.value=val}})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:jQuery.trim(jQuery.text(elem))}},select:{get:function(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&(support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value}values.push(value)}}return values},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if(option.selected=jQuery.inArray(option.value,values)>=0){optionSet=true}}if(!optionSet){elem.selectedIndex=-1}return values}}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value)){return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0}}};if(!support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value}}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}});jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now();var rquery=/\?/;jQuery.parseJSON=function(data){return JSON.parse(data+"")};jQuery.parseXML=function(data){var xml,tmp;if(!data||typeof data!=="string"){return null}try{tmp=new DOMParser;xml=tmp.parseFromString(data,"text/xml")}catch(e){xml=undefined}if(!xml||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data)}return xml};var rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*"),ajaxLocation=window.location.href,ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func)){while(dataType=dataTypes[i++]){if(dataType[0]==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func)}else{(structure[dataType]=structure[dataType]||[]).push(func)}}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=structure===transports;function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false}else if(seekingTransport){return!(selected=dataTypeOrTransport)}});return selected}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:deep||(deep={}))[key]=src[key]}}if(deep){jQuery.extend(true,target,deep)}return target}function ajaxHandleResponses(s,jqXHR,responses){var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type")}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}}}if(dataTypes[0]in responses){finalDataType=dataTypes[0]}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType){firstDataType=type}}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)}return responses[finalDataType]}}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv]}}current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response}if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType)}prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev}else if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2]}else if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1])}break}}}}if(conv!==true){if(conv&&s["throws"]){response=conv(response)}else{try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}}}}}return{state:"success",data:response}}jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,parts,fireGlobals,i,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while(match=rheaders.exec(responseHeadersString)){responseHeaders[match[1].toLowerCase()]=match[2]}}match=responseHeaders[key.toLowerCase()]}return match==null?null:match},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},overrideMimeType:function(type){if(!state){s.mimeType=type}return this},statusCode:function(map){var code;if(map){if(state<2){for(code in map){statusCode[code]=[statusCode[code],map[code]]}}else{jqXHR.always(map[jqXHR.status])}}return this},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText)}done(0,finalText);return this}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""];if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?"80":"443"))!==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443"))))}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return jqXHR}fireGlobals=jQuery.event&&s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")}s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data;delete s.data}if(s.cache===false){s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++}}if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL])}if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){return jqXHR.abort()}strAbort="abort";for(i in{success:1,error:1,complete:1}){jqXHR[i](s[i])}transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport")}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])}if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout)}try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<2){done(-1,e)}else{throw e}}}function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(state===2){return}state=2;if(timeoutTimer){clearTimeout(timeoutTimer)}transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses)}response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified}modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified}}if(status===204||s.type==="HEAD"){statusText="nocontent"}else if(status===304){statusText="notmodified"}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0}}}jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])}jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error])}completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!--jQuery.active){jQuery.event.trigger("ajaxStop")}}}return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}});jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:false,global:false,"throws":true})};jQuery.fn.extend({wrapAll:function(html){var wrap;if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))})}if(this[0]){wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0])}wrap.map(function(){var elem=this;while(elem.firstElementChild){elem=elem.firstElementChild}return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))})}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html)}else{self.append(html)}})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes)}}).end()}});jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0};jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add)}})}else if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)}}else{add(prefix,obj)}}jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():value==null?"":value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional}if(jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a)){jQuery.each(a,function(){add(this.name,this.value)})}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add)}}return s.join("&").replace(r20,"+")};jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xhrId=0,xhrCallbacks={},xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();if(window.attachEvent){window.attachEvent("onunload",function(){for(var key in xhrCallbacks){xhrCallbacks[key]()}})}support.cors=!!xhrSupported&&"withCredentials"in xhrSupported;support.ajax=xhrSupported=!!xhrSupported;jQuery.ajaxTransport(function(options){var callback;if(support.cors||xhrSupported&&!options.crossDomain){return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields){for(i in options.xhrFields){xhr[i]=options.xhrFields[i]}}if(options.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType)}if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}for(i in headers){xhr.setRequestHeader(i,headers[i])}callback=function(type){return function(){if(callback){delete xhrCallbacks[id];callback=xhr.onload=xhr.onerror=null;if(type==="abort"){xhr.abort()}else if(type==="error"){complete(xhr.status,xhr.statusText)}else{complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,typeof xhr.responseText==="string"?{text:xhr.responseText}:undefined,xhr.getAllResponseHeaders())}}}};xhr.onload=callback();xhr.onerror=callback("error");callback=xhrCallbacks[id]=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback){throw e}}},abort:function(){if(callback){callback()}}}}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false}if(s.crossDomain){s.type="GET"}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({async:true,charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove();callback=null;if(evt){complete(evt.type==="error"?404:200,evt.type)}});document.head.appendChild(script[0])},abort:function(){if(callback){callback()}}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;this[callback]=true;return callback}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName)}else if(s.jsonp!==false){s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName}s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called")}return responseContainer[0]};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments};jqXHR.always(function(){window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName)}if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0])}responseContainer=overwritten=undefined});return"script"}});jQuery.parseHTML=function(data,context,keepScripts){if(!data||typeof data!=="string"){return null}if(typeof context==="boolean"){keepScripts=context;context=false}context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])]}parsed=jQuery.buildFragment([data],context,scripts);if(scripts&&scripts.length){jQuery(scripts).remove()}return jQuery.merge([],parsed.childNodes)};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments)}var selector,type,response,self=this,off=url.indexOf(" ");if(off>=0){selector=jQuery.trim(url.slice(off));url=url.slice(0,off)}if(jQuery.isFunction(params)){callback=params;params=undefined}else if(params&&typeof params==="object"){type="POST"}if(self.length>0){jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])})}return this};jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}});jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9&&elem.defaultView}jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};if(position==="static"){elem.style.position="relative"}curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=(position==="absolute"||position==="fixed")&&(curCSSTop+curCSSLeft).indexOf("auto")>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset)}if(options.top!=null){props.top=options.top-curOffset.top+curTop}if(options.left!=null){props.left=options.left-curOffset.left+curLeft}if("using"in options){options.using.call(elem,props)}else{curElem.css(props)}}};jQuery.fn.extend({offset:function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)})}var docElem,win,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;if(!doc){return}docElem=doc.documentElement;if(!jQuery.contains(docElem,elem)){return box}if(typeof elem.getBoundingClientRect!==strundefined){box=elem.getBoundingClientRect()}win=getWindow(doc);return{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft}},position:function(){if(!this[0]){return}var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect();
}else{offsetParent=this.offsetParent();offset=this.offset();if(!jQuery.nodeName(offsetParent[0],"html")){parentOffset=offsetParent.offset()}parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true)}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||docElem;while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent}return offsetParent||docElem})}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?win[prop]:elem[method]}if(win){win.scrollTo(!top?val:window.pageXOffset,top?val:window.pageYOffset)}else{elem[method]=val}},method,val,arguments.length,null)}});jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed}})});jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name]}if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])}return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})});jQuery.fn.size=function(){return this.length};jQuery.fn.andSelf=jQuery.fn.addBack;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery})}var _jQuery=window.jQuery,_$=window.$;jQuery.noConflict=function(deep){if(window.$===jQuery){window.$=_$}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery}return jQuery};if(typeof noGlobal===strundefined){window.jQuery=window.$=jQuery}return jQuery});(function(DOMParser){"use strict";var proto=DOMParser.prototype;var native_parse=proto.parseFromString;try{if((new DOMParser).parseFromString("","text/html")){return}}catch(ex){}var ua=navigator.userAgent;if(ua&&ua.match(/OS X 10_7/g)&&ua.match(/Slack_SSB/g)){return}proto.parseFromString=function(markup,type){if(/^\s*text\/html\s*(?:;|$)/i.test(type)){var doc=document.implementation.createHTMLDocument("");markup=markup||"";if(markup.toLowerCase().indexOf("<!doctype")>-1){doc.documentElement.innerHTML=markup}else{doc.body.innerHTML=markup}return doc}else{return native_parse.apply(this,arguments)}}})(DOMParser);var FlashDetect=new function(){var self=this;self.installed=false;self.raw="";self.major=-1;self.minor=-1;self.revision=-1;self.revisionStr="";var activeXDetectRules=[{name:"ShockwaveFlash.ShockwaveFlash.7",version:function(obj){return getActiveXVersion(obj)}},{name:"ShockwaveFlash.ShockwaveFlash.6",version:function(obj){var version="6,0,21";try{obj.AllowScriptAccess="always";version=getActiveXVersion(obj)}catch(err){}return version}},{name:"ShockwaveFlash.ShockwaveFlash",version:function(obj){return getActiveXVersion(obj)}}];var getActiveXVersion=function(activeXObj){var version=-1;try{version=activeXObj.GetVariable("$version")}catch(err){}return version};var getActiveXObject=function(name){var obj=-1;try{obj=new ActiveXObject(name)}catch(err){obj={activeXError:true}}return obj};var parseActiveXVersion=function(str){var versionArray=str.split(",");return{raw:str,major:parseInt(versionArray[0].split(" ")[1],10),minor:parseInt(versionArray[1],10),revision:parseInt(versionArray[2],10),revisionStr:versionArray[2]}};var parseStandardVersion=function(str){var descParts=str.split(/ +/);var majorMinor=descParts[2].split(/\./);var revisionStr=descParts[3];return{raw:str,major:parseInt(majorMinor[0],10),minor:parseInt(majorMinor[1],10),revisionStr:revisionStr,revision:parseRevisionStrToInt(revisionStr)}};var parseRevisionStrToInt=function(str){return parseInt(str.replace(/[a-zA-Z]/g,""),10)||self.revision};self.majorAtLeast=function(version){return self.major>=version};self.minorAtLeast=function(version){return self.minor>=version};self.revisionAtLeast=function(version){return self.revision>=version};self.versionAtLeast=function(major){var properties=[self.major,self.minor,self.revision];var len=Math.min(properties.length,arguments.length);for(i=0;i<len;i++){if(properties[i]>=arguments[i]){if(i+1<len&&properties[i]==arguments[i]){continue}else{return true}}else{return false}}};self.FlashDetect=function(){if(navigator.plugins&&navigator.plugins.length>0){var type="application/x-shockwave-flash";var mimeTypes=navigator.mimeTypes;if(mimeTypes&&mimeTypes[type]&&mimeTypes[type].enabledPlugin&&mimeTypes[type].enabledPlugin.description){var version=mimeTypes[type].enabledPlugin.description;var versionObj=parseStandardVersion(version);self.raw=versionObj.raw;self.major=versionObj.major;self.minor=versionObj.minor;self.revisionStr=versionObj.revisionStr;self.revision=versionObj.revision;self.installed=true}}else if(navigator.appVersion.indexOf("Mac")==-1&&window.execScript){var version=-1;for(var i=0;i<activeXDetectRules.length&&version==-1;i++){var obj=getActiveXObject(activeXDetectRules[i].name);if(!obj.activeXError){self.installed=true;version=activeXDetectRules[i].version(obj);if(version!=-1){var versionObj=parseActiveXVersion(version);self.raw=versionObj.raw;self.major=versionObj.major;self.minor=versionObj.minor;self.revision=versionObj.revision;self.revisionStr=versionObj.revisionStr}}}}}()};FlashDetect.JS_RELEASE="1.0.4";(function(window,_undefined){"use strict";if(!window||!window.document){throw new Error("SoundManager requires a browser with window and document objects.")}var soundManager=null;function SoundManager(smURL,smID){this.setupOptions={url:smURL||null,flashVersion:8,debugMode:true,debugFlash:false,useConsole:true,consoleOnly:true,waitForWindowLoad:false,bgColor:"#ffffff",useHighPerformance:false,flashPollingInterval:null,html5PollingInterval:null,flashLoadTimeout:1e3,wmode:null,allowScriptAccess:"always",useFlashBlock:false,useHTML5Audio:true,html5Test:/^(probably|maybe)$/i,preferFlash:false,noSWFCache:false,idPrefix:"sound"};this.defaultOptions={autoLoad:false,autoPlay:false,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:true,multiShotEvents:false,position:null,pan:0,stream:true,to:null,type:null,usePolicyFile:false,volume:100};this.flash9Options={isMovieStar:null,usePeakData:false,useWaveformData:false,useEQData:false,onbufferchange:null,ondataerror:null};this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null};this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:true},mp4:{related:["aac","m4a","m4b"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:false},ogg:{type:["audio/ogg; codecs=vorbis"],required:false},opus:{type:["audio/ogg; codecs=opus","audio/opus"],required:false},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:false}};this.movieID="sm2-container";this.id=smID||"sm2movie";this.debugID="soundmanager-debug";this.debugURLParam=/([#?&])debug=1/i;this.versionNumber="V2.97a.20140901";this.version=null;this.movieURL=null;this.altURL=null;this.swfLoaded=false;this.enabled=false;this.oMC=null;this.sounds={};this.soundIDs=[];this.muted=false;this.didFlashBlock=false;this.filePattern=null;this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i};this.features={buffering:false,peakData:false,waveformData:false,eqData:false,movieStar:false};this.sandbox={type:null,types:{remote:"remote (domain-based) rules",localWithFile:"local with file access (no internet access)",localWithNetwork:"local with network (internet access only, no local access)",localTrusted:"local, trusted (local+internet access)"},description:null,noRemote:null,noLocal:null};this.html5={usingFlash:null};this.flash={};this.html5Only=false;this.ignoreFlash=false;var SMSound,sm2=this,globalHTML5Audio=null,flash=null,sm="soundManager",smc=sm+": ",h5="HTML5::",id,ua=navigator.userAgent,wl=window.location.href.toString(),doc=document,doNothing,setProperties,init,fV,on_queue=[],debugOpen=true,debugTS,didAppend=false,appendSuccess=false,didInit=false,disabled=false,windowLoaded=false,_wDS,wdCount=0,initComplete,mixin,assign,extraOptions,addOnEvent,processOnEvents,initUserOnload,delayWaitForEI,waitForEI,rebootIntoHTML5,setVersionInfo,handleFocus,strings,initMovie,preInit,domContentLoaded,winOnLoad,didDCLoaded,getDocument,createMovie,catchError,setPolling,initDebug,debugLevels=["log","info","warn","error"],defaultFlashVersion=8,disableObject,failSafely,normalizeMovieURL,oRemoved=null,oRemovedHTML=null,str,flashBlockHandler,getSWFCSS,swfCSS,toggleDebug,loopFix,policyFix,complain,idCheck,waitingForEI=false,initPending=false,startTimer,stopTimer,timerExecute,h5TimerCount=0,h5IntervalTimer=null,parseURL,messages=[],canIgnoreFlash,needsFlash=null,featureCheck,html5OK,html5CanPlay,html5Ext,html5Unload,domContentLoadedIE,testHTML5,event,slice=Array.prototype.slice,useGlobalHTML5Audio=false,lastGlobalHTML5URL,hasFlash,detectFlash,badSafariFix,html5_events,showSupport,flushMessages,wrapCallback,idCounter=0,is_iDevice=ua.match(/(ipad|iphone|ipod)/i),isAndroid=ua.match(/android/i),isIE=ua.match(/msie/i),isWebkit=ua.match(/webkit/i),isSafari=ua.match(/safari/i)&&!ua.match(/chrome/i),isOpera=ua.match(/opera/i),mobileHTML5=ua.match(/(mobile|pre\/|xoom)/i)||is_iDevice||isAndroid,isBadSafari=!wl.match(/usehtml5audio/i)&&!wl.match(/sm2\-ignorebadua/i)&&isSafari&&!ua.match(/silk/i)&&ua.match(/OS X 10_6_([3-7])/i),hasConsole=window.console!==_undefined&&console.log!==_undefined,isFocused=doc.hasFocus!==_undefined?doc.hasFocus():null,tryInitOnFocus=isSafari&&(doc.hasFocus===_undefined||!doc.hasFocus()),okToDisable=!tryInitOnFocus,flashMIME=/(mp3|mp4|mpa|m4a|m4b)/i,msecScale=1e3,emptyURL="about:blank",emptyWAV="data:audio/wave;base64,/UklGRiYAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQIAAAD//w==",overHTTP=doc.location?doc.location.protocol.match(/http/i):null,http=!overHTTP?"http:/"+"/":"",netStreamMimeTypes=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|m4b|mp4v|3gp|3g2)\s*(?:$|;)/i,netStreamTypes=["mpeg4","aac","flv","mov","mp4","m4v","f4v","m4a","m4b","mp4v","3gp","3g2"],netStreamPattern=new RegExp("\\.("+netStreamTypes.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i;this.useAltURL=!overHTTP;swfCSS={swfBox:"sm2-object-box",swfDefault:"movieContainer",swfError:"swf_error",swfTimedout:"swf_timedout",swfLoaded:"swf_loaded",swfUnblocked:"swf_unblocked",sm2Debug:"sm2_debug",highPerf:"high_performance",flashDebug:"flash_debug"};this.hasHTML5=function(){try{return Audio!==_undefined&&(isOpera&&opera!==_undefined&&opera.version()<10?new Audio(null):new Audio).canPlayType!==_undefined}catch(e){return false}}();this.setup=function(options){var noURL=!sm2.url;if(options!==_undefined&&didInit&&needsFlash&&sm2.ok()&&(options.flashVersion!==_undefined||options.url!==_undefined||options.html5Test!==_undefined)){complain(str("setupLate"))}assign(options);if(options){if(noURL&&didDCLoaded&&options.url!==_undefined){sm2.beginDelayedInit()}if(!didDCLoaded&&options.url!==_undefined&&doc.readyState==="complete"){setTimeout(domContentLoaded,1)}}return sm2};this.ok=function(){return needsFlash?didInit&&!disabled:sm2.useHTML5Audio&&sm2.hasHTML5};this.supported=this.ok;this.getMovie=function(smID){return id(smID)||doc[smID]||window[smID]};this.createSound=function(oOptions,_url){var cs,cs_string,options,oSound=null;cs=sm+".createSound(): ";cs_string=cs+str(!didInit?"notReady":"notOK");if(!didInit||!sm2.ok()){complain(cs_string);return false}if(_url!==_undefined){oOptions={id:oOptions,url:_url}}options=mixin(oOptions);options.url=parseURL(options.url);if(options.id===undefined){options.id=sm2.setupOptions.idPrefix+idCounter++}if(options.id.toString().charAt(0).match(/^[0-9]$/)){sm2._wD(cs+str("badID",options.id),2)}sm2._wD(cs+options.id+(options.url?" ("+options.url+")":""),1);if(idCheck(options.id,true)){sm2._wD(cs+options.id+" exists",1);return sm2.sounds[options.id]}function make(){options=loopFix(options);sm2.sounds[options.id]=new SMSound(options);sm2.soundIDs.push(options.id);return sm2.sounds[options.id]}if(html5OK(options)){oSound=make();sm2._wD(options.id+": Using HTML5");oSound._setup_html5(options)}else{if(sm2.html5Only){sm2._wD(options.id+": No HTML5 support for this sound, and no Flash. Exiting.");return make()}if(sm2.html5.usingFlash&&options.url&&options.url.match(/data\:/i)){sm2._wD(options.id+": data: URIs not supported via Flash. Exiting.");return make()}if(fV>8){if(options.isMovieStar===null){options.isMovieStar=!!(options.serverURL||(options.type?options.type.match(netStreamMimeTypes):false)||options.url&&options.url.match(netStreamPattern))}if(options.isMovieStar){sm2._wD(cs+"using MovieStar handling");if(options.loops>1){_wDS("noNSLoop")}}}options=policyFix(options,cs);oSound=make();if(fV===8){flash._createSound(options.id,options.loops||1,options.usePolicyFile)}else{flash._createSound(options.id,options.url,options.usePeakData,options.useWaveformData,options.useEQData,options.isMovieStar,options.isMovieStar?options.bufferTime:false,options.loops||1,options.serverURL,options.duration||null,options.autoPlay,true,options.autoLoad,options.usePolicyFile);if(!options.serverURL){oSound.connected=true;if(options.onconnect){options.onconnect.apply(oSound)}}}if(!options.serverURL&&(options.autoLoad||options.autoPlay)){oSound.load(options)}}if(!options.serverURL&&options.autoPlay){oSound.play()}return oSound};this.destroySound=function(sID,_bFromSound){if(!idCheck(sID)){return false}var oS=sm2.sounds[sID],i;oS._iO={};oS.stop();oS.unload();for(i=0;i<sm2.soundIDs.length;i++){if(sm2.soundIDs[i]===sID){sm2.soundIDs.splice(i,1);break}}if(!_bFromSound){oS.destruct(true)}oS=null;delete sm2.sounds[sID];return true};this.load=function(sID,oOptions){if(!idCheck(sID)){return false}return sm2.sounds[sID].load(oOptions)};this.unload=function(sID){if(!idCheck(sID)){return false}return sm2.sounds[sID].unload()};this.onPosition=function(sID,nPosition,oMethod,oScope){if(!idCheck(sID)){return false}return sm2.sounds[sID].onposition(nPosition,oMethod,oScope)};this.onposition=this.onPosition;this.clearOnPosition=function(sID,nPosition,oMethod){if(!idCheck(sID)){return false}return sm2.sounds[sID].clearOnPosition(nPosition,oMethod)};this.play=function(sID,oOptions){var result=null,overloaded=oOptions&&!(oOptions instanceof Object);if(!didInit||!sm2.ok()){complain(sm+".play(): "+str(!didInit?"notReady":"notOK"));return false}if(!idCheck(sID,overloaded)){if(!overloaded){return false}if(overloaded){oOptions={url:oOptions}}if(oOptions&&oOptions.url){sm2._wD(sm+'.play(): Attempting to create "'+sID+'"',1);oOptions.id=sID;result=sm2.createSound(oOptions).play()}}else if(overloaded){oOptions={url:oOptions}}if(result===null){result=sm2.sounds[sID].play(oOptions)}return result};this.start=this.play;this.setPosition=function(sID,nMsecOffset){if(!idCheck(sID)){return false}return sm2.sounds[sID].setPosition(nMsecOffset)};this.stop=function(sID){if(!idCheck(sID)){return false}sm2._wD(sm+".stop("+sID+")",1);return sm2.sounds[sID].stop()};this.stopAll=function(){var oSound;sm2._wD(sm+".stopAll()",1);for(oSound in sm2.sounds){if(sm2.sounds.hasOwnProperty(oSound)){sm2.sounds[oSound].stop()}}};this.pause=function(sID){if(!idCheck(sID)){return false}return sm2.sounds[sID].pause()};this.pauseAll=function(){var i;for(i=sm2.soundIDs.length-1;i>=0;i--){sm2.sounds[sm2.soundIDs[i]].pause()}};this.resume=function(sID){if(!idCheck(sID)){return false}return sm2.sounds[sID].resume()};this.resumeAll=function(){var i;for(i=sm2.soundIDs.length-1;i>=0;i--){sm2.sounds[sm2.soundIDs[i]].resume()}};this.togglePause=function(sID){if(!idCheck(sID)){return false}return sm2.sounds[sID].togglePause()};this.setPan=function(sID,nPan){if(!idCheck(sID)){return false}return sm2.sounds[sID].setPan(nPan)};this.setVolume=function(sID,nVol){if(!idCheck(sID)){return false}return sm2.sounds[sID].setVolume(nVol)};this.mute=function(sID){var i=0;if(sID instanceof String){sID=null}if(!sID){sm2._wD(sm+".mute(): Muting all sounds");for(i=sm2.soundIDs.length-1;i>=0;i--){sm2.sounds[sm2.soundIDs[i]].mute()}sm2.muted=true}else{if(!idCheck(sID)){return false}sm2._wD(sm+'.mute(): Muting "'+sID+'"');return sm2.sounds[sID].mute()}return true};this.muteAll=function(){sm2.mute()};this.unmute=function(sID){var i;if(sID instanceof String){sID=null}if(!sID){sm2._wD(sm+".unmute(): Unmuting all sounds");for(i=sm2.soundIDs.length-1;i>=0;i--){sm2.sounds[sm2.soundIDs[i]].unmute()}sm2.muted=false}else{if(!idCheck(sID)){return false}sm2._wD(sm+'.unmute(): Unmuting "'+sID+'"');return sm2.sounds[sID].unmute()}return true};this.unmuteAll=function(){sm2.unmute()};this.toggleMute=function(sID){if(!idCheck(sID)){return false}return sm2.sounds[sID].toggleMute()};this.getMemoryUse=function(){var ram=0;if(flash&&fV!==8){ram=parseInt(flash._getMemoryUse(),10)}return ram};this.disable=function(bNoDisable){var i;if(bNoDisable===_undefined){bNoDisable=false}if(disabled){return false}disabled=true;_wDS("shutdown",1);for(i=sm2.soundIDs.length-1;i>=0;i--){disableObject(sm2.sounds[sm2.soundIDs[i]])}initComplete(bNoDisable);event.remove(window,"load",initUserOnload);return true};this.canPlayMIME=function(sMIME){var result;if(sm2.hasHTML5){result=html5CanPlay({type:sMIME})}if(!result&&needsFlash){result=sMIME&&sm2.ok()?!!((fV>8?sMIME.match(netStreamMimeTypes):null)||sMIME.match(sm2.mimePattern)):null}return result};this.canPlayURL=function(sURL){var result;if(sm2.hasHTML5){result=html5CanPlay({url:sURL})}if(!result&&needsFlash){result=sURL&&sm2.ok()?!!sURL.match(sm2.filePattern):null}return result};this.canPlayLink=function(oLink){if(oLink.type!==_undefined&&oLink.type){if(sm2.canPlayMIME(oLink.type)){return true}}return sm2.canPlayURL(oLink.href)};this.getSoundById=function(sID,_suppressDebug){if(!sID){return null}var result=sm2.sounds[sID];if(!result&&!_suppressDebug){sm2._wD(sm+'.getSoundById(): Sound "'+sID+'" not found.',2)}return result};this.onready=function(oMethod,oScope){var sType="onready",result=false;if(typeof oMethod==="function"){if(didInit){sm2._wD(str("queue",sType))}if(!oScope){oScope=window}addOnEvent(sType,oMethod,oScope);processOnEvents();result=true}else{throw str("needFunction",sType)}return result};this.ontimeout=function(oMethod,oScope){var sType="ontimeout",result=false;if(typeof oMethod==="function"){if(didInit){sm2._wD(str("queue",sType))}if(!oScope){oScope=window}addOnEvent(sType,oMethod,oScope);processOnEvents({type:sType});result=true}else{throw str("needFunction",sType)}return result};this._writeDebug=function(sText,sTypeOrObject){var sDID="soundmanager-debug",o,oItem;if(!sm2.debugMode){return false}if(hasConsole&&sm2.useConsole){if(sTypeOrObject&&typeof sTypeOrObject==="object"){console.log(sText,sTypeOrObject)}else if(debugLevels[sTypeOrObject]!==_undefined){console[debugLevels[sTypeOrObject]](sText)}else{console.log(sText)}if(sm2.consoleOnly){return true}}o=id(sDID);if(!o){return false}oItem=doc.createElement("div");if(++wdCount%2===0){oItem.className="sm2-alt"}if(sTypeOrObject===_undefined){sTypeOrObject=0}else{sTypeOrObject=parseInt(sTypeOrObject,10)}oItem.appendChild(doc.createTextNode(sText));if(sTypeOrObject){if(sTypeOrObject>=2){oItem.style.fontWeight="bold"}if(sTypeOrObject===3){oItem.style.color="#ff3333"}}o.insertBefore(oItem,o.firstChild);o=null;return true};if(wl.indexOf("sm2-debug=alert")!==-1){this._writeDebug=function(sText){window.alert(sText)}}this._wD=this._writeDebug;this._debug=function(){var i,j;_wDS("currentObj",1);for(i=0,j=sm2.soundIDs.length;i<j;i++){sm2.sounds[sm2.soundIDs[i]]._debug()}};this.reboot=function(resetEvents,excludeInit){if(sm2.soundIDs.length){sm2._wD("Destroying "+sm2.soundIDs.length+" SMSound object"+(sm2.soundIDs.length!==1?"s":"")+"...")}var i,j,k;for(i=sm2.soundIDs.length-1;i>=0;i--){sm2.sounds[sm2.soundIDs[i]].destruct()}if(flash){try{if(isIE){oRemovedHTML=flash.innerHTML}oRemoved=flash.parentNode.removeChild(flash)}catch(e){_wDS("badRemove",2)}}oRemovedHTML=oRemoved=needsFlash=flash=null;sm2.enabled=didDCLoaded=didInit=waitingForEI=initPending=didAppend=appendSuccess=disabled=useGlobalHTML5Audio=sm2.swfLoaded=false;sm2.soundIDs=[];sm2.sounds={};idCounter=0;if(!resetEvents){for(i in on_queue){if(on_queue.hasOwnProperty(i)){for(j=0,k=on_queue[i].length;j<k;j++){on_queue[i][j].fired=false}}}}else{on_queue=[]}if(!excludeInit){sm2._wD(sm+": Rebooting...")}sm2.html5={usingFlash:null};sm2.flash={};sm2.html5Only=false;sm2.ignoreFlash=false;window.setTimeout(function(){preInit();if(!excludeInit){sm2.beginDelayedInit()}},20);return sm2};this.reset=function(){_wDS("reset");return sm2.reboot(true,true)};this.getMoviePercent=function(){return flash&&"PercentLoaded"in flash?flash.PercentLoaded():null};this.beginDelayedInit=function(){windowLoaded=true;domContentLoaded();setTimeout(function(){if(initPending){return false}createMovie();initMovie();initPending=true;return true},20);delayWaitForEI()};this.destruct=function(){sm2._wD(sm+".destruct()");sm2.disable(true)};SMSound=function(oOptions){var s=this,resetProperties,add_html5_events,remove_html5_events,stop_html5_timer,start_html5_timer,attachOnPosition,onplay_called=false,onPositionItems=[],onPositionFired=0,detachOnPosition,applyFromTo,lastURL=null,lastHTML5State,urlOmitted;lastHTML5State={duration:null,time:null};this.id=oOptions.id;this.sID=this.id;this.url=oOptions.url;this.options=mixin(oOptions);this.instanceOptions=this.options;this._iO=this.instanceOptions;this.pan=this.options.pan;this.volume=this.options.volume;this.isHTML5=false;this._a=null;urlOmitted=this.url?false:true;this.id3={};this._debug=function(){sm2._wD(s.id+": Merged options:",s.options)};this.load=function(oOptions){var oSound=null,instanceOptions;if(oOptions!==_undefined){s._iO=mixin(oOptions,s.options)}else{oOptions=s.options;s._iO=oOptions;if(lastURL&&lastURL!==s.url){_wDS("manURL");s._iO.url=s.url;s.url=null}}if(!s._iO.url){s._iO.url=s.url}s._iO.url=parseURL(s._iO.url);s.instanceOptions=s._iO;instanceOptions=s._iO;sm2._wD(s.id+": load ("+instanceOptions.url+")");if(!instanceOptions.url&&!s.url){sm2._wD(s.id+": load(): url is unassigned. Exiting.",2);return s}if(!s.isHTML5&&fV===8&&!s.url&&!instanceOptions.autoPlay){sm2._wD(s.id+": Flash 8 load() limitation: Wait for onload() before calling play().",1)}if(instanceOptions.url===s.url&&s.readyState!==0&&s.readyState!==2){_wDS("onURL",1);if(s.readyState===3&&instanceOptions.onload){wrapCallback(s,function(){instanceOptions.onload.apply(s,[!!s.duration])})}return s}s.loaded=false;s.readyState=1;s.playState=0;s.id3={};if(html5OK(instanceOptions)){oSound=s._setup_html5(instanceOptions);if(!oSound._called_load){s._html5_canplay=false;if(s.url!==instanceOptions.url){sm2._wD(_wDS("manURL")+": "+instanceOptions.url);s._a.src=instanceOptions.url;s.setPosition(0)}s._a.autobuffer="auto";s._a.preload="auto";s._a._called_load=true}else{sm2._wD(s.id+": Ignoring request to load again")}}else{if(sm2.html5Only){sm2._wD(s.id+": No flash support. Exiting.");return s}if(s._iO.url&&s._iO.url.match(/data\:/i)){sm2._wD(s.id+": data: URIs not supported via Flash. Exiting.");return s}try{s.isHTML5=false;s._iO=policyFix(loopFix(instanceOptions));if(s._iO.autoPlay&&(s._iO.position||s._iO.from)){sm2._wD(s.id+": Disabling autoPlay because of non-zero offset case");s._iO.autoPlay=false}instanceOptions=s._iO;if(fV===8){flash._load(s.id,instanceOptions.url,instanceOptions.stream,instanceOptions.autoPlay,instanceOptions.usePolicyFile)}else{flash._load(s.id,instanceOptions.url,!!instanceOptions.stream,!!instanceOptions.autoPlay,instanceOptions.loops||1,!!instanceOptions.autoLoad,instanceOptions.usePolicyFile)}}catch(e){_wDS("smError",2);debugTS("onload",false);catchError({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:true})}}s.url=instanceOptions.url;return s};this.unload=function(){if(s.readyState!==0){sm2._wD(s.id+": unload()");if(!s.isHTML5){if(fV===8){flash._unload(s.id,emptyURL)}else{flash._unload(s.id)}}else{stop_html5_timer();if(s._a){s._a.pause();lastURL=html5Unload(s._a)}}resetProperties()}return s};this.destruct=function(_bFromSM){sm2._wD(s.id+": Destruct");if(!s.isHTML5){s._iO.onfailure=null;flash._destroySound(s.id)}else{stop_html5_timer();if(s._a){s._a.pause();html5Unload(s._a);if(!useGlobalHTML5Audio){remove_html5_events()}s._a._s=null;s._a=null}}if(!_bFromSM){sm2.destroySound(s.id,true)}};this.play=function(oOptions,_updatePlayState){var fN,allowMulti,a,onready,audioClone,onended,oncanplay,startOK=true,exit=null;fN=s.id+": play(): ";_updatePlayState=_updatePlayState===_undefined?true:_updatePlayState;if(!oOptions){oOptions={}}if(s.url){s._iO.url=s.url}s._iO=mixin(s._iO,s.options);s._iO=mixin(oOptions,s._iO);s._iO.url=parseURL(s._iO.url);s.instanceOptions=s._iO;if(!s.isHTML5&&s._iO.serverURL&&!s.connected){if(!s.getAutoPlay()){sm2._wD(fN+" Netstream not connected yet - setting autoPlay");s.setAutoPlay(true)}return s}if(html5OK(s._iO)){s._setup_html5(s._iO);start_html5_timer()}if(s.playState===1&&!s.paused){allowMulti=s._iO.multiShot;if(!allowMulti){sm2._wD(fN+"Already playing (one-shot)",1);if(s.isHTML5){s.setPosition(s._iO.position)}exit=s}else{sm2._wD(fN+"Already playing (multi-shot)",1)}}if(exit!==null){return exit}if(oOptions.url&&oOptions.url!==s.url){if(!s.readyState&&!s.isHTML5&&fV===8&&urlOmitted){urlOmitted=false}else{s.load(s._iO)}}if(!s.loaded){if(s.readyState===0){sm2._wD(fN+"Attempting to load");if(!s.isHTML5&&!sm2.html5Only){s._iO.autoPlay=true;s.load(s._iO)}else if(s.isHTML5){s.load(s._iO)}else{sm2._wD(fN+"Unsupported type. Exiting.");exit=s}s.instanceOptions=s._iO}else if(s.readyState===2){sm2._wD(fN+"Could not load - exiting",2);exit=s}else{sm2._wD(fN+"Loading - attempting to play...")}}else{sm2._wD(fN.substr(0,fN.lastIndexOf(":")))}if(exit!==null){return exit}if(!s.isHTML5&&fV===9&&s.position>0&&s.position===s.duration){sm2._wD(fN+"Sound at end, resetting to position:0");oOptions.position=0}if(s.paused&&s.position>=0&&(!s._iO.serverURL||s.position>0)){sm2._wD(fN+"Resuming from paused state",1);s.resume()}else{s._iO=mixin(oOptions,s._iO);if((!s.isHTML5&&s._iO.position!==null&&s._iO.position>0||s._iO.from!==null&&s._iO.from>0||s._iO.to!==null)&&s.instanceCount===0&&s.playState===0&&!s._iO.serverURL){onready=function(){s._iO=mixin(oOptions,s._iO);s.play(s._iO)};if(s.isHTML5&&!s._html5_canplay){sm2._wD(fN+"Beginning load for non-zero offset case");s.load({_oncanplay:onready});exit=false}else if(!s.isHTML5&&!s.loaded&&(!s.readyState||s.readyState!==2)){sm2._wD(fN+"Preloading for non-zero offset case");s.load({onload:onready});exit=false}if(exit!==null){return exit}s._iO=applyFromTo()}if(!s.instanceCount||s._iO.multiShotEvents||s.isHTML5&&s._iO.multiShot&&!useGlobalHTML5Audio||!s.isHTML5&&fV>8&&!s.getAutoPlay()){s.instanceCount++}if(s._iO.onposition&&s.playState===0){attachOnPosition(s)}s.playState=1;s.paused=false;s.position=s._iO.position!==_undefined&&!isNaN(s._iO.position)?s._iO.position:0;if(!s.isHTML5){s._iO=policyFix(loopFix(s._iO))}if(s._iO.onplay&&_updatePlayState){s._iO.onplay.apply(s);onplay_called=true}s.setVolume(s._iO.volume,true);s.setPan(s._iO.pan,true);if(!s.isHTML5){startOK=flash._start(s.id,s._iO.loops||1,fV===9?s.position:s.position/msecScale,s._iO.multiShot||false);if(fV===9&&!startOK){sm2._wD(fN+"No sound hardware, or 32-sound ceiling hit",2);if(s._iO.onplayerror){s._iO.onplayerror.apply(s)}}}else{if(s.instanceCount<2){start_html5_timer();a=s._setup_html5();s.setPosition(s._iO.position);a.play()}else{sm2._wD(s.id+": Cloning Audio() for instance #"+s.instanceCount+"...");audioClone=new Audio(s._iO.url);onended=function(){event.remove(audioClone,"ended",onended);s._onfinish(s);html5Unload(audioClone);audioClone=null};oncanplay=function(){event.remove(audioClone,"canplay",oncanplay);try{audioClone.currentTime=s._iO.position/msecScale}catch(err){complain(s.id+": multiShot play() failed to apply position of "+s._iO.position/msecScale)}audioClone.play()};event.add(audioClone,"ended",onended);if(s._iO.volume!==undefined){audioClone.volume=Math.max(0,Math.min(1,s._iO.volume/100))}if(s.muted){audioClone.muted=true}if(s._iO.position){event.add(audioClone,"canplay",oncanplay)}else{audioClone.play()}}}}return s};this.start=this.play;this.stop=function(bAll){var instanceOptions=s._iO,originalPosition;if(s.playState===1){sm2._wD(s.id+": stop()");s._onbufferchange(0);s._resetOnPosition(0);s.paused=false;if(!s.isHTML5){s.playState=0}detachOnPosition();if(instanceOptions.to){s.clearOnPosition(instanceOptions.to)}if(!s.isHTML5){flash._stop(s.id,bAll);if(instanceOptions.serverURL){s.unload()}}else{if(s._a){originalPosition=s.position;s.setPosition(0);s.position=originalPosition;s._a.pause();s.playState=0;s._onTimer();stop_html5_timer()}}s.instanceCount=0;s._iO={};if(instanceOptions.onstop){instanceOptions.onstop.apply(s)}}return s};this.setAutoPlay=function(autoPlay){sm2._wD(s.id+": Autoplay turned "+(autoPlay?"on":"off"));s._iO.autoPlay=autoPlay;if(!s.isHTML5){flash._setAutoPlay(s.id,autoPlay);if(autoPlay){if(!s.instanceCount&&s.readyState===1){s.instanceCount++;sm2._wD(s.id+": Incremented instance count to "+s.instanceCount)}}}};this.getAutoPlay=function(){return s._iO.autoPlay};this.setPosition=function(nMsecOffset){if(nMsecOffset===_undefined){nMsecOffset=0}var position,position1K,offset=s.isHTML5?Math.max(nMsecOffset,0):Math.min(s.duration||s._iO.duration,Math.max(nMsecOffset,0));s.position=offset;position1K=s.position/msecScale;s._resetOnPosition(s.position);s._iO.position=offset;if(!s.isHTML5){position=fV===9?s.position:position1K;if(s.readyState&&s.readyState!==2){flash._setPosition(s.id,position,s.paused||!s.playState,s._iO.multiShot)}}else if(s._a){if(s._html5_canplay){if(s._a.currentTime!==position1K){sm2._wD(s.id+": setPosition("+position1K+")");try{s._a.currentTime=position1K;if(s.playState===0||s.paused){s._a.pause()}}catch(e){sm2._wD(s.id+": setPosition("+position1K+") failed: "+e.message,2)}}}else if(position1K){sm2._wD(s.id+": setPosition("+position1K+"): Cannot seek yet, sound not ready",2);return s}if(s.paused){s._onTimer(true)}}return s};this.pause=function(_bCallFlash){if(s.paused||s.playState===0&&s.readyState!==1){return s}sm2._wD(s.id+": pause()");s.paused=true;if(!s.isHTML5){if(_bCallFlash||_bCallFlash===_undefined){flash._pause(s.id,s._iO.multiShot)}}else{s._setup_html5().pause();stop_html5_timer()}if(s._iO.onpause){s._iO.onpause.apply(s)}return s};this.resume=function(){var instanceOptions=s._iO;if(!s.paused){return s}sm2._wD(s.id+": resume()");s.paused=false;s.playState=1;if(!s.isHTML5){if(instanceOptions.isMovieStar&&!instanceOptions.serverURL){s.setPosition(s.position)}flash._pause(s.id,instanceOptions.multiShot)}else{s._setup_html5().play();start_html5_timer()}if(!onplay_called&&instanceOptions.onplay){instanceOptions.onplay.apply(s);onplay_called=true}else if(instanceOptions.onresume){instanceOptions.onresume.apply(s)}return s};this.togglePause=function(){sm2._wD(s.id+": togglePause()");if(s.playState===0){s.play({position:fV===9&&!s.isHTML5?s.position:s.position/msecScale});return s}if(s.paused){
s.resume()}else{s.pause()}return s};this.setPan=function(nPan,bInstanceOnly){if(nPan===_undefined){nPan=0}if(bInstanceOnly===_undefined){bInstanceOnly=false}if(!s.isHTML5){flash._setPan(s.id,nPan)}s._iO.pan=nPan;if(!bInstanceOnly){s.pan=nPan;s.options.pan=nPan}return s};this.setVolume=function(nVol,_bInstanceOnly){if(nVol===_undefined){nVol=100}if(_bInstanceOnly===_undefined){_bInstanceOnly=false}if(!s.isHTML5){flash._setVolume(s.id,sm2.muted&&!s.muted||s.muted?0:nVol)}else if(s._a){if(sm2.muted&&!s.muted){s.muted=true;s._a.muted=true}s._a.volume=Math.max(0,Math.min(1,nVol/100))}s._iO.volume=nVol;if(!_bInstanceOnly){s.volume=nVol;s.options.volume=nVol}return s};this.mute=function(){s.muted=true;if(!s.isHTML5){flash._setVolume(s.id,0)}else if(s._a){s._a.muted=true}return s};this.unmute=function(){s.muted=false;var hasIO=s._iO.volume!==_undefined;if(!s.isHTML5){flash._setVolume(s.id,hasIO?s._iO.volume:s.options.volume)}else if(s._a){s._a.muted=false}return s};this.toggleMute=function(){return s.muted?s.unmute():s.mute()};this.onPosition=function(nPosition,oMethod,oScope){onPositionItems.push({position:parseInt(nPosition,10),method:oMethod,scope:oScope!==_undefined?oScope:s,fired:false});return s};this.onposition=this.onPosition;this.clearOnPosition=function(nPosition,oMethod){var i;nPosition=parseInt(nPosition,10);if(isNaN(nPosition)){return false}for(i=0;i<onPositionItems.length;i++){if(nPosition===onPositionItems[i].position){if(!oMethod||oMethod===onPositionItems[i].method){if(onPositionItems[i].fired){onPositionFired--}onPositionItems.splice(i,1)}}}};this._processOnPosition=function(){var i,item,j=onPositionItems.length;if(!j||!s.playState||onPositionFired>=j){return false}for(i=j-1;i>=0;i--){item=onPositionItems[i];if(!item.fired&&s.position>=item.position){item.fired=true;onPositionFired++;item.method.apply(item.scope,[item.position]);j=onPositionItems.length}}return true};this._resetOnPosition=function(nPosition){var i,item,j=onPositionItems.length;if(!j){return false}for(i=j-1;i>=0;i--){item=onPositionItems[i];if(item.fired&&nPosition<=item.position){item.fired=false;onPositionFired--}}return true};applyFromTo=function(){var instanceOptions=s._iO,f=instanceOptions.from,t=instanceOptions.to,start,end;end=function(){sm2._wD(s.id+': "To" time of '+t+" reached.");s.clearOnPosition(t,end);s.stop()};start=function(){sm2._wD(s.id+': Playing "from" '+f);if(t!==null&&!isNaN(t)){s.onPosition(t,end)}};if(f!==null&&!isNaN(f)){instanceOptions.position=f;instanceOptions.multiShot=false;start()}return instanceOptions};attachOnPosition=function(){var item,op=s._iO.onposition;if(op){for(item in op){if(op.hasOwnProperty(item)){s.onPosition(parseInt(item,10),op[item])}}}};detachOnPosition=function(){var item,op=s._iO.onposition;if(op){for(item in op){if(op.hasOwnProperty(item)){s.clearOnPosition(parseInt(item,10))}}}};start_html5_timer=function(){if(s.isHTML5){startTimer(s)}};stop_html5_timer=function(){if(s.isHTML5){stopTimer(s)}};resetProperties=function(retainPosition){if(!retainPosition){onPositionItems=[];onPositionFired=0}onplay_called=false;s._hasTimer=null;s._a=null;s._html5_canplay=false;s.bytesLoaded=null;s.bytesTotal=null;s.duration=s._iO&&s._iO.duration?s._iO.duration:null;s.durationEstimate=null;s.buffered=[];s.eqData=[];s.eqData.left=[];s.eqData.right=[];s.failures=0;s.isBuffering=false;s.instanceOptions={};s.instanceCount=0;s.loaded=false;s.metadata={};s.readyState=0;s.muted=false;s.paused=false;s.peakData={left:0,right:0};s.waveformData={left:[],right:[]};s.playState=0;s.position=null;s.id3={}};resetProperties();this._onTimer=function(bForce){var duration,isNew=false,time,x={};if(s._hasTimer||bForce){if(s._a&&(bForce||(s.playState>0||s.readyState===1)&&!s.paused)){duration=s._get_html5_duration();if(duration!==lastHTML5State.duration){lastHTML5State.duration=duration;s.duration=duration;isNew=true}s.durationEstimate=s.duration;time=s._a.currentTime*msecScale||0;if(time!==lastHTML5State.time){lastHTML5State.time=time;isNew=true}if(isNew||bForce){s._whileplaying(time,x,x,x,x)}}return isNew}};this._get_html5_duration=function(){var instanceOptions=s._iO,d=s._a&&s._a.duration?s._a.duration*msecScale:instanceOptions&&instanceOptions.duration?instanceOptions.duration:null,result=d&&!isNaN(d)&&d!==Infinity?d:null;return result};this._apply_loop=function(a,nLoops){if(!a.loop&&nLoops>1){sm2._wD("Note: Native HTML5 looping is infinite.",1)}a.loop=nLoops>1?"loop":""};this._setup_html5=function(oOptions){var instanceOptions=mixin(s._iO,oOptions),a=useGlobalHTML5Audio?globalHTML5Audio:s._a,dURL=decodeURI(instanceOptions.url),sameURL;if(useGlobalHTML5Audio){if(dURL===decodeURI(lastGlobalHTML5URL)){sameURL=true}}else if(dURL===decodeURI(lastURL)){sameURL=true}if(a){if(a._s){if(useGlobalHTML5Audio){if(a._s&&a._s.playState&&!sameURL){a._s.stop()}}else if(!useGlobalHTML5Audio&&dURL===decodeURI(lastURL)){s._apply_loop(a,instanceOptions.loops);return a}}if(!sameURL){if(lastURL){resetProperties(false)}a.src=instanceOptions.url;s.url=instanceOptions.url;lastURL=instanceOptions.url;lastGlobalHTML5URL=instanceOptions.url;a._called_load=false}}else{if(instanceOptions.autoLoad||instanceOptions.autoPlay){s._a=new Audio(instanceOptions.url);s._a.load()}else{s._a=isOpera&&opera.version()<10?new Audio(null):new Audio}a=s._a;a._called_load=false;if(useGlobalHTML5Audio){globalHTML5Audio=a}}s.isHTML5=true;s._a=a;a._s=s;add_html5_events();s._apply_loop(a,instanceOptions.loops);if(instanceOptions.autoLoad||instanceOptions.autoPlay){s.load()}else{a.autobuffer=false;a.preload="auto"}return a};add_html5_events=function(){if(s._a._added_events){return false}var f;function add(oEvt,oFn,bCapture){return s._a?s._a.addEventListener(oEvt,oFn,bCapture||false):null}s._a._added_events=true;for(f in html5_events){if(html5_events.hasOwnProperty(f)){add(f,html5_events[f])}}return true};remove_html5_events=function(){var f;function remove(oEvt,oFn,bCapture){return s._a?s._a.removeEventListener(oEvt,oFn,bCapture||false):null}sm2._wD(s.id+": Removing event listeners");s._a._added_events=false;for(f in html5_events){if(html5_events.hasOwnProperty(f)){remove(f,html5_events[f])}}};this._onload=function(nSuccess){var fN,loadOK=!!nSuccess||!s.isHTML5&&fV===8&&s.duration;fN=s.id+": ";sm2._wD(fN+(loadOK?"onload()":"Failed to load / invalid sound?"+(!s.duration?" Zero-length duration reported.":" -")+" ("+s.url+")"),loadOK?1:2);if(!loadOK&&!s.isHTML5){if(sm2.sandbox.noRemote===true){sm2._wD(fN+str("noNet"),1)}if(sm2.sandbox.noLocal===true){sm2._wD(fN+str("noLocal"),1)}}s.loaded=loadOK;s.readyState=loadOK?3:2;s._onbufferchange(0);if(s._iO.onload){wrapCallback(s,function(){s._iO.onload.apply(s,[loadOK])})}return true};this._onbufferchange=function(nIsBuffering){if(s.playState===0){return false}if(nIsBuffering&&s.isBuffering||!nIsBuffering&&!s.isBuffering){return false}s.isBuffering=nIsBuffering===1;if(s._iO.onbufferchange){sm2._wD(s.id+": Buffer state change: "+nIsBuffering);s._iO.onbufferchange.apply(s,[nIsBuffering])}return true};this._onsuspend=function(){if(s._iO.onsuspend){sm2._wD(s.id+": Playback suspended");s._iO.onsuspend.apply(s)}return true};this._onfailure=function(msg,level,code){s.failures++;sm2._wD(s.id+": Failure ("+s.failures+"): "+msg);if(s._iO.onfailure&&s.failures===1){s._iO.onfailure(msg,level,code)}else{sm2._wD(s.id+": Ignoring failure")}};this._onwarning=function(msg,level,code){if(s._iO.onwarning){s._iO.onwarning(msg,level,code)}};this._onfinish=function(){var io_onfinish=s._iO.onfinish;s._onbufferchange(0);s._resetOnPosition(0);if(s.instanceCount){s.instanceCount--;if(!s.instanceCount){detachOnPosition();s.playState=0;s.paused=false;s.instanceCount=0;s.instanceOptions={};s._iO={};stop_html5_timer();if(s.isHTML5){s.position=0}}if(!s.instanceCount||s._iO.multiShotEvents){if(io_onfinish){sm2._wD(s.id+": onfinish()");wrapCallback(s,function(){io_onfinish.apply(s)})}}}};this._whileloading=function(nBytesLoaded,nBytesTotal,nDuration,nBufferLength){var instanceOptions=s._iO;s.bytesLoaded=nBytesLoaded;s.bytesTotal=nBytesTotal;s.duration=Math.floor(nDuration);s.bufferLength=nBufferLength;if(!s.isHTML5&&!instanceOptions.isMovieStar){if(instanceOptions.duration){s.durationEstimate=s.duration>instanceOptions.duration?s.duration:instanceOptions.duration}else{s.durationEstimate=parseInt(s.bytesTotal/s.bytesLoaded*s.duration,10)}}else{s.durationEstimate=s.duration}if(!s.isHTML5){s.buffered=[{start:0,end:s.duration}]}if((s.readyState!==3||s.isHTML5)&&instanceOptions.whileloading){instanceOptions.whileloading.apply(s)}};this._whileplaying=function(nPosition,oPeakData,oWaveformDataLeft,oWaveformDataRight,oEQData){var instanceOptions=s._iO,eqLeft;if(isNaN(nPosition)||nPosition===null){return false}s.position=Math.max(0,nPosition);s._processOnPosition();if(!s.isHTML5&&fV>8){if(instanceOptions.usePeakData&&oPeakData!==_undefined&&oPeakData){s.peakData={left:oPeakData.leftPeak,right:oPeakData.rightPeak}}if(instanceOptions.useWaveformData&&oWaveformDataLeft!==_undefined&&oWaveformDataLeft){s.waveformData={left:oWaveformDataLeft.split(","),right:oWaveformDataRight.split(",")}}if(instanceOptions.useEQData){if(oEQData!==_undefined&&oEQData&&oEQData.leftEQ){eqLeft=oEQData.leftEQ.split(",");s.eqData=eqLeft;s.eqData.left=eqLeft;if(oEQData.rightEQ!==_undefined&&oEQData.rightEQ){s.eqData.right=oEQData.rightEQ.split(",")}}}}if(s.playState===1){if(!s.isHTML5&&fV===8&&!s.position&&s.isBuffering){s._onbufferchange(0)}if(instanceOptions.whileplaying){instanceOptions.whileplaying.apply(s)}}return true};this._oncaptiondata=function(oData){sm2._wD(s.id+": Caption data received.");s.captiondata=oData;if(s._iO.oncaptiondata){s._iO.oncaptiondata.apply(s,[oData])}};this._onmetadata=function(oMDProps,oMDData){sm2._wD(s.id+": Metadata received.");var oData={},i,j;for(i=0,j=oMDProps.length;i<j;i++){oData[oMDProps[i]]=oMDData[i]}s.metadata=oData;console.log("updated metadata",s.metadata);if(s._iO.onmetadata){s._iO.onmetadata.call(s,s.metadata)}};this._onid3=function(oID3Props,oID3Data){sm2._wD(s.id+": ID3 data received.");var oData=[],i,j;for(i=0,j=oID3Props.length;i<j;i++){oData[oID3Props[i]]=oID3Data[i]}s.id3=mixin(s.id3,oData);if(s._iO.onid3){s._iO.onid3.apply(s)}};this._onconnect=function(bSuccess){bSuccess=bSuccess===1;sm2._wD(s.id+": "+(bSuccess?"Connected.":"Failed to connect? - "+s.url),bSuccess?1:2);s.connected=bSuccess;if(bSuccess){s.failures=0;if(idCheck(s.id)){if(s.getAutoPlay()){s.play(_undefined,s.getAutoPlay())}else if(s._iO.autoLoad){s.load()}}if(s._iO.onconnect){s._iO.onconnect.apply(s,[bSuccess])}}};this._ondataerror=function(sError){if(s.playState>0){sm2._wD(s.id+": Data error: "+sError);if(s._iO.ondataerror){s._iO.ondataerror.apply(s)}}};this._debug()};getDocument=function(){return doc.body||doc.getElementsByTagName("div")[0]};id=function(sID){return doc.getElementById(sID)};mixin=function(oMain,oAdd){var o1=oMain||{},o2,o;o2=oAdd===_undefined?sm2.defaultOptions:oAdd;for(o in o2){if(o2.hasOwnProperty(o)&&o1[o]===_undefined){if(typeof o2[o]!=="object"||o2[o]===null){o1[o]=o2[o]}else{o1[o]=mixin(o1[o],o2[o])}}}return o1};wrapCallback=function(oSound,callback){if(!oSound.isHTML5&&fV===8){window.setTimeout(callback,0)}else{callback()}};extraOptions={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1};assign=function(o,oParent){var i,result=true,hasParent=oParent!==_undefined,setupOptions=sm2.setupOptions,bonusOptions=extraOptions;if(o===_undefined){result=[];for(i in setupOptions){if(setupOptions.hasOwnProperty(i)){result.push(i)}}for(i in bonusOptions){if(bonusOptions.hasOwnProperty(i)){if(typeof sm2[i]==="object"){result.push(i+": {...}")}else if(sm2[i]instanceof Function){result.push(i+": function() {...}")}else{result.push(i)}}}sm2._wD(str("setup",result.join(", ")));return false}for(i in o){if(o.hasOwnProperty(i)){if(typeof o[i]!=="object"||o[i]===null||o[i]instanceof Array||o[i]instanceof RegExp){if(hasParent&&bonusOptions[oParent]!==_undefined){sm2[oParent][i]=o[i]}else if(setupOptions[i]!==_undefined){sm2.setupOptions[i]=o[i];sm2[i]=o[i]}else if(bonusOptions[i]===_undefined){complain(str(sm2[i]===_undefined?"setupUndef":"setupError",i),2);result=false}else{if(sm2[i]instanceof Function){sm2[i].apply(sm2,o[i]instanceof Array?o[i]:[o[i]])}else{sm2[i]=o[i]}}}else{if(bonusOptions[i]===_undefined){complain(str(sm2[i]===_undefined?"setupUndef":"setupError",i),2);result=false}else{return assign(o[i],i)}}}}return result};function preferFlashCheck(kind){return sm2.preferFlash&&hasFlash&&!sm2.ignoreFlash&&(sm2.flash[kind]!==_undefined&&sm2.flash[kind])}event=function(){var old=window.attachEvent,evt={add:old?"attachEvent":"addEventListener",remove:old?"detachEvent":"removeEventListener"};function getArgs(oArgs){var args=slice.call(oArgs),len=args.length;if(old){args[1]="on"+args[1];if(len>3){args.pop()}}else if(len===3){args.push(false)}return args}function apply(args,sType){var element=args.shift(),method=[evt[sType]];if(old){element[method](args[0],args[1])}else{element[method].apply(element,args)}}function add(){apply(getArgs(arguments),"add")}function remove(){apply(getArgs(arguments),"remove")}return{add:add,remove:remove}}();function html5_event(oFn){return function(e){var s=this._s,result;if(!s||!s._a){if(s&&s.id){sm2._wD(s.id+": Ignoring "+e.type)}else{sm2._wD(h5+"Ignoring "+e.type)}result=null}else{result=oFn.call(this,e)}return result}}html5_events={abort:html5_event(function(){sm2._wD(this._s.id+": abort")}),canplay:html5_event(function(){var s=this._s,position1K;if(s._html5_canplay){return true}s._html5_canplay=true;sm2._wD(s.id+": canplay");s._onbufferchange(0);position1K=s._iO.position!==_undefined&&!isNaN(s._iO.position)?s._iO.position/msecScale:null;if(this.currentTime!==position1K){sm2._wD(s.id+": canplay: Setting position to "+position1K);try{this.currentTime=position1K}catch(ee){sm2._wD(s.id+": canplay: Setting position of "+position1K+" failed: "+ee.message,2)}}if(s._iO._oncanplay){s._iO._oncanplay()}}),canplaythrough:html5_event(function(){var s=this._s;if(!s.loaded){s._onbufferchange(0);s._whileloading(s.bytesLoaded,s.bytesTotal,s._get_html5_duration());s._onload(true)}}),durationchange:html5_event(function(){var s=this._s,duration;duration=s._get_html5_duration();if(!isNaN(duration)&&duration!==s.duration){sm2._wD(this._s.id+": durationchange ("+duration+")"+(s.duration?", previously "+s.duration:""));s.durationEstimate=s.duration=duration}}),ended:html5_event(function(){var s=this._s;sm2._wD(s.id+": ended");s._onfinish()}),error:html5_event(function(){sm2._wD(this._s.id+": HTML5 error, code "+this.error.code);this._s._onload(false)}),loadeddata:html5_event(function(){var s=this._s;sm2._wD(s.id+": loadeddata");if(!s._loaded&&!isSafari){s.duration=s._get_html5_duration()}}),loadedmetadata:html5_event(function(){sm2._wD(this._s.id+": loadedmetadata")}),loadstart:html5_event(function(){sm2._wD(this._s.id+": loadstart");this._s._onbufferchange(1)}),play:html5_event(function(){this._s._onbufferchange(0)}),playing:html5_event(function(){sm2._wD(this._s.id+": playing "+String.fromCharCode(9835));this._s._onbufferchange(0)}),progress:html5_event(function(e){var s=this._s,i,j,progStr,buffered=0,isProgress=e.type==="progress",ranges=e.target.buffered,loaded=e.loaded||0,total=e.total||1;s.buffered=[];if(ranges&&ranges.length){for(i=0,j=ranges.length;i<j;i++){s.buffered.push({start:ranges.start(i)*msecScale,end:ranges.end(i)*msecScale})}buffered=(ranges.end(0)-ranges.start(0))*msecScale;loaded=Math.min(1,buffered/(e.target.duration*msecScale));if(isProgress&&ranges.length>1){progStr=[];j=ranges.length;for(i=0;i<j;i++){progStr.push(e.target.buffered.start(i)*msecScale+"-"+e.target.buffered.end(i)*msecScale)}sm2._wD(this._s.id+": progress, timeRanges: "+progStr.join(", "))}if(isProgress&&!isNaN(loaded)){sm2._wD(this._s.id+": progress, "+Math.floor(loaded*100)+"% loaded")}}if(!isNaN(loaded)){s._whileloading(loaded,total,s._get_html5_duration());if(loaded&&total&&loaded===total){html5_events.canplaythrough.call(this,e)}}}),ratechange:html5_event(function(){sm2._wD(this._s.id+": ratechange")}),suspend:html5_event(function(e){var s=this._s;sm2._wD(this._s.id+": suspend");html5_events.progress.call(this,e);s._onsuspend()}),stalled:html5_event(function(){sm2._wD(this._s.id+": stalled")}),timeupdate:html5_event(function(){this._s._onTimer()}),waiting:html5_event(function(){var s=this._s;sm2._wD(this._s.id+": waiting");s._onbufferchange(1)})};html5OK=function(iO){var result;if(!iO||!iO.type&&!iO.url&&!iO.serverURL){result=false}else if(iO.serverURL||iO.type&&preferFlashCheck(iO.type)){result=false}else{result=iO.type?html5CanPlay({type:iO.type}):html5CanPlay({url:iO.url})||sm2.html5Only||iO.url.match(/data\:/i)}return result};html5Unload=function(oAudio){var url;if(oAudio){url=isSafari?emptyURL:sm2.html5.canPlayType("audio/wav")?emptyWAV:emptyURL;oAudio.src=url;if(oAudio._called_unload!==undefined){oAudio._called_load=false}}if(useGlobalHTML5Audio){lastGlobalHTML5URL=null}return url};html5CanPlay=function(o){if(!sm2.useHTML5Audio||!sm2.hasHTML5){return false}var url=o.url||null,mime=o.type||null,aF=sm2.audioFormats,result,offset,fileExt,item;if(mime&&sm2.html5[mime]!==_undefined){return sm2.html5[mime]&&!preferFlashCheck(mime)}if(!html5Ext){html5Ext=[];for(item in aF){if(aF.hasOwnProperty(item)){html5Ext.push(item);if(aF[item].related){html5Ext=html5Ext.concat(aF[item].related)}}}html5Ext=new RegExp("\\.("+html5Ext.join("|")+")(\\?.*)?$","i")}fileExt=url?url.toLowerCase().match(html5Ext):null;if(!fileExt||!fileExt.length){if(!mime){result=false}else{offset=mime.indexOf(";");fileExt=(offset!==-1?mime.substr(0,offset):mime).substr(6)}}else{fileExt=fileExt[1]}if(fileExt&&sm2.html5[fileExt]!==_undefined){result=sm2.html5[fileExt]&&!preferFlashCheck(fileExt)}else{mime="audio/"+fileExt;result=sm2.html5.canPlayType({type:mime});sm2.html5[fileExt]=result;result=result&&sm2.html5[mime]&&!preferFlashCheck(mime)}return result};testHTML5=function(){if(!sm2.useHTML5Audio||!sm2.hasHTML5){sm2.html5.usingFlash=true;needsFlash=true;return false}var a=Audio!==_undefined?isOpera&&opera.version()<10?new Audio(null):new Audio:null,item,lookup,support={},aF,i;function cp(m){var canPlay,j,result=false,isOK=false;if(!a||typeof a.canPlayType!=="function"){return result}if(m instanceof Array){for(i=0,j=m.length;i<j;i++){if(sm2.html5[m[i]]||a.canPlayType(m[i]).match(sm2.html5Test)){isOK=true;sm2.html5[m[i]]=true;sm2.flash[m[i]]=!!m[i].match(flashMIME)}}result=isOK}else{canPlay=a&&typeof a.canPlayType==="function"?a.canPlayType(m):false;result=!!(canPlay&&canPlay.match(sm2.html5Test))}return result}aF=sm2.audioFormats;for(item in aF){if(aF.hasOwnProperty(item)){lookup="audio/"+item;support[item]=cp(aF[item].type);support[lookup]=support[item];if(item.match(flashMIME)){sm2.flash[item]=true;sm2.flash[lookup]=true}else{sm2.flash[item]=false;sm2.flash[lookup]=false}if(aF[item]&&aF[item].related){for(i=aF[item].related.length-1;i>=0;i--){support["audio/"+aF[item].related[i]]=support[item];sm2.html5[aF[item].related[i]]=support[item];sm2.flash[aF[item].related[i]]=support[item]}}}}support.canPlayType=a?cp:null;sm2.html5=mixin(sm2.html5,support);sm2.html5.usingFlash=featureCheck();needsFlash=sm2.html5.usingFlash;return true};strings={notReady:"Unavailable - wait until onready() has fired.",notOK:"Audio support is not available.",domError:sm+"exception caught while appending SWF to DOM.",spcWmode:"Removing wmode, preventing known SWF loading issue(s)",swf404:smc+"Verify that %s is a valid path.",tryDebug:"Try "+sm+".debugFlash = true for more security details (output goes to SWF.)",checkSWF:"See SWF output for more debug info.",localFail:smc+"Non-HTTP page ("+doc.location.protocol+" URL?) Review Flash player security settings for this special case:\nhttp://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html\nMay need to add/allow path, eg. c:/sm2/ or /users/me/sm2/",waitFocus:smc+"Special case: Waiting for SWF to load with window focus...",waitForever:smc+"Waiting indefinitely for Flash (will recover if unblocked)...",waitSWF:smc+"Waiting for 100% SWF load...",needFunction:smc+"Function object expected for %s",badID:'Sound ID "%s" should be a string, starting with a non-numeric character',currentObj:smc+"_debug(): Current sound objects",waitOnload:smc+"Waiting for window.onload()",docLoaded:smc+"Document already loaded",onload:smc+"initComplete(): calling soundManager.onload()",onloadOK:sm+".onload() complete",didInit:smc+"init(): Already called?",secNote:"Flash security note: Network/internet URLs will not load due to security restrictions. Access can be configured via Flash Player Global Security Settings Page: http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html",badRemove:smc+"Failed to remove Flash node.",shutdown:sm+".disable(): Shutting down",queue:smc+"Queueing %s handler",smError:"SMSound.load(): Exception: JS-Flash communication failed, or JS error.",fbTimeout:"No flash response, applying ."+swfCSS.swfTimedout+" CSS...",fbLoaded:"Flash loaded",fbHandler:smc+"flashBlockHandler()",manURL:"SMSound.load(): Using manually-assigned URL",onURL:sm+".load(): current URL already assigned.",badFV:sm+'.flashVersion must be 8 or 9. "%s" is invalid. Reverting to %s.',as2loop:"Note: Setting stream:false so looping can work (flash 8 limitation)",noNSLoop:"Note: Looping not implemented for MovieStar formats",needfl9:"Note: Switching to flash 9, required for MP4 formats.",mfTimeout:"Setting flashLoadTimeout = 0 (infinite) for off-screen, mobile flash case",needFlash:smc+"Fatal error: Flash is needed to play some required formats, but is not available.",gotFocus:smc+"Got window focus.",policy:"Enabling usePolicyFile for data access",setup:sm+".setup(): allowed parameters: %s",setupError:sm+'.setup(): "%s" cannot be assigned with this method.',setupUndef:sm+'.setup(): Could not find option "%s"',setupLate:sm+".setup(): url, flashVersion and html5Test property changes will not take effect until reboot().",noURL:smc+"Flash URL required. Call soundManager.setup({url:...}) to get started.",sm2Loaded:"SoundManager 2: Ready. "+String.fromCharCode(10003),reset:sm+".reset(): Removing event callbacks",mobileUA:"Mobile UA detected, preferring HTML5 by default.",globalHTML5:"Using singleton HTML5 Audio() pattern for this device."};str=function(){var args,i,j,o,sstr;args=slice.call(arguments);o=args.shift();sstr=strings&&strings[o]?strings[o]:"";if(sstr&&args&&args.length){for(i=0,j=args.length;i<j;i++){sstr=sstr.replace("%s",args[i])}}return sstr};loopFix=function(sOpt){if(fV===8&&sOpt.loops>1&&sOpt.stream){_wDS("as2loop");sOpt.stream=false}return sOpt};policyFix=function(sOpt,sPre){if(sOpt&&!sOpt.usePolicyFile&&(sOpt.onid3||sOpt.usePeakData||sOpt.useWaveformData||sOpt.useEQData)){sm2._wD((sPre||"")+str("policy"));sOpt.usePolicyFile=true}return sOpt};complain=function(sMsg){if(hasConsole&&console.warn!==_undefined){console.warn(sMsg)}else{sm2._wD(sMsg)}};doNothing=function(){return false};disableObject=function(o){var oProp;for(oProp in o){if(o.hasOwnProperty(oProp)&&typeof o[oProp]==="function"){o[oProp]=doNothing}}oProp=null};failSafely=function(bNoDisable){if(bNoDisable===_undefined){bNoDisable=false}if(disabled||bNoDisable){sm2.disable(bNoDisable)}};normalizeMovieURL=function(smURL){var urlParams=null,url;if(smURL){if(smURL.match(/\.swf(\?.*)?$/i)){urlParams=smURL.substr(smURL.toLowerCase().lastIndexOf(".swf?")+4);if(urlParams){return smURL}}else if(smURL.lastIndexOf("/")!==smURL.length-1){smURL+="/"}}url=(smURL&&smURL.lastIndexOf("/")!==-1?smURL.substr(0,smURL.lastIndexOf("/")+1):"./")+sm2.movieURL;if(sm2.noSWFCache){url+="?ts="+(new Date).getTime()}return url};setVersionInfo=function(){fV=parseInt(sm2.flashVersion,10);if(fV!==8&&fV!==9){sm2._wD(str("badFV",fV,defaultFlashVersion));sm2.flashVersion=fV=defaultFlashVersion}var isDebug=sm2.debugMode||sm2.debugFlash?"_debug.swf":".swf";if(sm2.useHTML5Audio&&!sm2.html5Only&&sm2.audioFormats.mp4.required&&fV<9){sm2._wD(str("needfl9"));sm2.flashVersion=fV=9}sm2.version=sm2.versionNumber+(sm2.html5Only?" (HTML5-only mode)":fV===9?" (AS3/Flash 9)":" (AS2/Flash 8)");if(fV>8){sm2.defaultOptions=mixin(sm2.defaultOptions,sm2.flash9Options);sm2.features.buffering=true;sm2.defaultOptions=mixin(sm2.defaultOptions,sm2.movieStarOptions);sm2.filePatterns.flash9=new RegExp("\\.(mp3|"+netStreamTypes.join("|")+")(\\?.*)?$","i");sm2.features.movieStar=true}else{sm2.features.movieStar=false}sm2.filePattern=sm2.filePatterns[fV!==8?"flash9":"flash8"];sm2.movieURL=(fV===8?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",isDebug);sm2.features.peakData=sm2.features.waveformData=sm2.features.eqData=fV>8};setPolling=function(bPolling,bHighPerformance){if(!flash){return false}flash._setPolling(bPolling,bHighPerformance)};initDebug=function(){if(sm2.debugURLParam.test(wl)){sm2.debugMode=true}if(id(sm2.debugID)){return false}var oD,oDebug,oTarget,oToggle,tmp;if(sm2.debugMode&&!id(sm2.debugID)&&(!hasConsole||!sm2.useConsole||!sm2.consoleOnly)){oD=doc.createElement("div");oD.id=sm2.debugID+"-toggle";oToggle={position:"fixed",bottom:"0px",right:"0px",width:"1.2em",height:"1.2em",lineHeight:"1.2em",margin:"2px",textAlign:"center",border:"1px solid #999",cursor:"pointer",background:"#fff",color:"#333",zIndex:10001};oD.appendChild(doc.createTextNode("-"));oD.onclick=toggleDebug;oD.title="Toggle SM2 debug console";if(ua.match(/msie 6/i)){oD.style.position="absolute";oD.style.cursor="hand"}for(tmp in oToggle){if(oToggle.hasOwnProperty(tmp)){oD.style[tmp]=oToggle[tmp]}}oDebug=doc.createElement("div");oDebug.id=sm2.debugID;oDebug.style.display=sm2.debugMode?"block":"none";if(sm2.debugMode&&!id(oD.id)){try{oTarget=getDocument();oTarget.appendChild(oD)}catch(e2){throw new Error(str("domError")+" \n"+e2.toString())}oTarget.appendChild(oDebug)}}oTarget=null};idCheck=this.getSoundById;_wDS=function(o,errorLevel){return!o?"":sm2._wD(str(o),errorLevel)};toggleDebug=function(){var o=id(sm2.debugID),oT=id(sm2.debugID+"-toggle");if(!o){return false}if(debugOpen){oT.innerHTML="+";o.style.display="none"}else{oT.innerHTML="-";o.style.display="block"}debugOpen=!debugOpen};debugTS=function(sEventType,bSuccess,sMessage){if(window.sm2Debugger!==_undefined){try{sm2Debugger.handleEvent(sEventType,bSuccess,sMessage)}catch(e){return false}}return true};getSWFCSS=function(){var css=[];if(sm2.debugMode){css.push(swfCSS.sm2Debug)}if(sm2.debugFlash){css.push(swfCSS.flashDebug)}if(sm2.useHighPerformance){css.push(swfCSS.highPerf)}return css.join(" ")};flashBlockHandler=function(){var name=str("fbHandler"),p=sm2.getMoviePercent(),css=swfCSS,error={type:"FLASHBLOCK"};if(sm2.html5Only){return false}if(!sm2.ok()){if(needsFlash){sm2.oMC.className=getSWFCSS()+" "+css.swfDefault+" "+(p===null?css.swfTimedout:css.swfError);sm2._wD(name+": "+str("fbTimeout")+(p?" ("+str("fbLoaded")+")":""))}sm2.didFlashBlock=true;processOnEvents({type:"ontimeout",ignoreInit:true,error:error});catchError(error)}else{if(sm2.didFlashBlock){sm2._wD(name+": Unblocked")}if(sm2.oMC){sm2.oMC.className=[getSWFCSS(),css.swfDefault,css.swfLoaded+(sm2.didFlashBlock?" "+css.swfUnblocked:"")].join(" ")}}};addOnEvent=function(sType,oMethod,oScope){if(on_queue[sType]===_undefined){on_queue[sType]=[]}on_queue[sType].push({method:oMethod,scope:oScope||null,fired:false})};processOnEvents=function(oOptions){if(!oOptions){oOptions={type:sm2.ok()?"onready":"ontimeout"}}if(!didInit&&oOptions&&!oOptions.ignoreInit){return false}if(oOptions.type==="ontimeout"&&(sm2.ok()||disabled&&!oOptions.ignoreInit)){return false}var status={success:oOptions&&oOptions.ignoreInit?sm2.ok():!disabled},srcQueue=oOptions&&oOptions.type?on_queue[oOptions.type]||[]:[],queue=[],i,j,args=[status],canRetry=needsFlash&&!sm2.ok();if(oOptions.error){args[0].error=oOptions.error}for(i=0,j=srcQueue.length;i<j;i++){if(srcQueue[i].fired!==true){queue.push(srcQueue[i])}}if(queue.length){for(i=0,j=queue.length;i<j;i++){if(queue[i].scope){queue[i].method.apply(queue[i].scope,args)}else{queue[i].method.apply(this,args)}if(!canRetry){queue[i].fired=true}}}return true};initUserOnload=function(){window.setTimeout(function(){if(sm2.useFlashBlock){flashBlockHandler()}processOnEvents();if(typeof sm2.onload==="function"){_wDS("onload",1);sm2.onload.apply(window);_wDS("onloadOK",1)}if(sm2.waitForWindowLoad){event.add(window,"load",initUserOnload)}},1)};detectFlash=function(){if(hasFlash!==_undefined){return hasFlash}var hasPlugin=false,n=navigator,nP=n.plugins,obj,type,types,AX=window.ActiveXObject;if(nP&&nP.length){type="application/x-shockwave-flash";types=n.mimeTypes;if(types&&types[type]&&types[type].enabledPlugin&&types[type].enabledPlugin.description){hasPlugin=true}}else if(AX!==_undefined&&!ua.match(/MSAppHost/i)){try{obj=new AX("ShockwaveFlash.ShockwaveFlash")}catch(e){obj=null}hasPlugin=!!obj;obj=null}hasFlash=hasPlugin;return hasPlugin};featureCheck=function(){var flashNeeded,item,formats=sm2.audioFormats,isSpecial=is_iDevice&&!!ua.match(/os (1|2|3_0|3_1)\s/i);if(isSpecial){sm2.hasHTML5=false;sm2.html5Only=true;if(sm2.oMC){sm2.oMC.style.display="none"}}else{if(sm2.useHTML5Audio){if(!sm2.html5||!sm2.html5.canPlayType){sm2._wD("SoundManager: No HTML5 Audio() support detected.");sm2.hasHTML5=false}if(isBadSafari){sm2._wD(smc+"Note: Buggy HTML5 Audio in Safari on this OS X release, see https://bugs.webkit.org/show_bug.cgi?id=32159 - "+(!hasFlash?" would use flash fallback for MP3/MP4, but none detected.":"will use flash fallback for MP3/MP4, if available"),1)}}}if(sm2.useHTML5Audio&&sm2.hasHTML5){canIgnoreFlash=true;for(item in formats){if(formats.hasOwnProperty(item)){if(formats[item].required){if(!sm2.html5.canPlayType(formats[item].type)){canIgnoreFlash=false;flashNeeded=true}else if(sm2.preferFlash&&(sm2.flash[item]||sm2.flash[formats[item].type])){flashNeeded=true}}}}}if(sm2.ignoreFlash){flashNeeded=false;canIgnoreFlash=true}sm2.html5Only=sm2.hasHTML5&&sm2.useHTML5Audio&&!flashNeeded;return!sm2.html5Only};parseURL=function(url){var i,j,urlResult=0,result;if(url instanceof Array){for(i=0,j=url.length;i<j;i++){if(url[i]instanceof Object){if(sm2.canPlayMIME(url[i].type)){urlResult=i;break}}else if(sm2.canPlayURL(url[i])){urlResult=i;break}}if(url[urlResult].url){url[urlResult]=url[urlResult].url}result=url[urlResult]}else{result=url}return result};startTimer=function(oSound){if(!oSound._hasTimer){oSound._hasTimer=true;if(!mobileHTML5&&sm2.html5PollingInterval){if(h5IntervalTimer===null&&h5TimerCount===0){h5IntervalTimer=setInterval(timerExecute,sm2.html5PollingInterval)}h5TimerCount++}}};stopTimer=function(oSound){if(oSound._hasTimer){oSound._hasTimer=false;if(!mobileHTML5&&sm2.html5PollingInterval){h5TimerCount--}}};timerExecute=function(){var i;if(h5IntervalTimer!==null&&!h5TimerCount){clearInterval(h5IntervalTimer);h5IntervalTimer=null;return false}for(i=sm2.soundIDs.length-1;i>=0;i--){if(sm2.sounds[sm2.soundIDs[i]].isHTML5&&sm2.sounds[sm2.soundIDs[i]]._hasTimer){sm2.sounds[sm2.soundIDs[i]]._onTimer()}}};catchError=function(options){options=options!==_undefined?options:{};if(typeof sm2.onerror==="function"){sm2.onerror.apply(window,[{type:options.type!==_undefined?options.type:null}])}if(options.fatal!==_undefined&&options.fatal){sm2.disable()}};badSafariFix=function(){if(!isBadSafari||!detectFlash()){return false}var aF=sm2.audioFormats,i,item;for(item in aF){if(aF.hasOwnProperty(item)){if(item==="mp3"||item==="mp4"){sm2._wD(sm+": Using flash fallback for "+item+" format");sm2.html5[item]=false;if(aF[item]&&aF[item].related){for(i=aF[item].related.length-1;i>=0;i--){sm2.html5[aF[item].related[i]]=false}}}}}};this._setSandboxType=function(sandboxType){var sb=sm2.sandbox;sb.type=sandboxType;sb.description=sb.types[sb.types[sandboxType]!==_undefined?sandboxType:"unknown"];if(sb.type==="localWithFile"){sb.noRemote=true;sb.noLocal=false;_wDS("secNote",2)}else if(sb.type==="localWithNetwork"){sb.noRemote=false;sb.noLocal=true}else if(sb.type==="localTrusted"){sb.noRemote=false;sb.noLocal=false}
};this._externalInterfaceOK=function(swfVersion){if(sm2.swfLoaded){return false}var e;debugTS("swf",true);debugTS("flashtojs",true);sm2.swfLoaded=true;tryInitOnFocus=false;if(isBadSafari){badSafariFix()}if(!swfVersion||swfVersion.replace(/\+dev/i,"")!==sm2.versionNumber.replace(/\+dev/i,"")){e=sm+': Fatal: JavaScript file build "'+sm2.versionNumber+'" does not match Flash SWF build "'+swfVersion+'" at '+sm2.url+". Ensure both are up-to-date.";setTimeout(function versionMismatch(){throw new Error(e)},0);return false}setTimeout(init,isIE?100:1)};createMovie=function(smID,smURL){if(didAppend&&appendSuccess){return false}function initMsg(){var options=[],title,msg=[],delimiter=" + ";title="SoundManager "+sm2.version+(!sm2.html5Only&&sm2.useHTML5Audio?sm2.hasHTML5?" + HTML5 audio":", no HTML5 audio support":"");if(!sm2.html5Only){if(sm2.preferFlash){options.push("preferFlash")}if(sm2.useHighPerformance){options.push("useHighPerformance")}if(sm2.flashPollingInterval){options.push("flashPollingInterval ("+sm2.flashPollingInterval+"ms)")}if(sm2.html5PollingInterval){options.push("html5PollingInterval ("+sm2.html5PollingInterval+"ms)")}if(sm2.wmode){options.push("wmode ("+sm2.wmode+")")}if(sm2.debugFlash){options.push("debugFlash")}if(sm2.useFlashBlock){options.push("flashBlock")}}else{if(sm2.html5PollingInterval){options.push("html5PollingInterval ("+sm2.html5PollingInterval+"ms)")}}if(options.length){msg=msg.concat([options.join(delimiter)])}sm2._wD(title+(msg.length?delimiter+msg.join(", "):""),1);showSupport()}if(sm2.html5Only){setVersionInfo();initMsg();sm2.oMC=id(sm2.movieID);init();didAppend=true;appendSuccess=true;return false}var remoteURL=smURL||sm2.url,localURL=sm2.altURL||remoteURL,swfTitle="JS/Flash audio component (SoundManager 2)",oTarget=getDocument(),extraClass=getSWFCSS(),isRTL=null,html=doc.getElementsByTagName("html")[0],oEmbed,oMovie,tmp,movieHTML,oEl,s,x,sClass;isRTL=html&&html.dir&&html.dir.match(/rtl/i);smID=smID===_undefined?sm2.id:smID;function param(name,value){return'<param name="'+name+'" value="'+value+'" />'}setVersionInfo();sm2.url=normalizeMovieURL(overHTTP?remoteURL:localURL);smURL=sm2.url;sm2.wmode=!sm2.wmode&&sm2.useHighPerformance?"transparent":sm2.wmode;if(sm2.wmode!==null&&(ua.match(/msie 8/i)||!isIE&&!sm2.useHighPerformance)&&navigator.platform.match(/win32|win64/i)){messages.push(strings.spcWmode);sm2.wmode=null}oEmbed={name:smID,id:smID,src:smURL,quality:"high",allowScriptAccess:sm2.allowScriptAccess,bgcolor:sm2.bgColor,pluginspage:http+"www.macromedia.com/go/getflashplayer",title:swfTitle,type:"application/x-shockwave-flash",wmode:sm2.wmode,hasPriority:"true"};if(sm2.debugFlash){oEmbed.FlashVars="debug=1"}if(!sm2.wmode){delete oEmbed.wmode}if(isIE){oMovie=doc.createElement("div");movieHTML=['<object id="'+smID+'" data="'+smURL+'" type="'+oEmbed.type+'" title="'+oEmbed.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+http+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',param("movie",smURL),param("AllowScriptAccess",sm2.allowScriptAccess),param("quality",oEmbed.quality),sm2.wmode?param("wmode",sm2.wmode):"",param("bgcolor",sm2.bgColor),param("hasPriority","true"),sm2.debugFlash?param("FlashVars",oEmbed.FlashVars):"","</object>"].join("")}else{oMovie=doc.createElement("embed");for(tmp in oEmbed){if(oEmbed.hasOwnProperty(tmp)){oMovie.setAttribute(tmp,oEmbed[tmp])}}}initDebug();extraClass=getSWFCSS();oTarget=getDocument();if(oTarget){sm2.oMC=id(sm2.movieID)||doc.createElement("div");if(!sm2.oMC.id){sm2.oMC.id=sm2.movieID;sm2.oMC.className=swfCSS.swfDefault+" "+extraClass;s=null;oEl=null;if(!sm2.useFlashBlock){if(sm2.useHighPerformance){s={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}}else{s={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"};if(isRTL){s.left=Math.abs(parseInt(s.left,10))+"px"}}}if(isWebkit){sm2.oMC.style.zIndex=1e4}if(!sm2.debugFlash){for(x in s){if(s.hasOwnProperty(x)){sm2.oMC.style[x]=s[x]}}}try{if(!isIE){sm2.oMC.appendChild(oMovie)}oTarget.appendChild(sm2.oMC);if(isIE){oEl=sm2.oMC.appendChild(doc.createElement("div"));oEl.className=swfCSS.swfBox;oEl.innerHTML=movieHTML}appendSuccess=true}catch(e){throw new Error(str("domError")+" \n"+e.toString())}}else{sClass=sm2.oMC.className;sm2.oMC.className=(sClass?sClass+" ":swfCSS.swfDefault)+(extraClass?" "+extraClass:"");sm2.oMC.appendChild(oMovie);if(isIE){oEl=sm2.oMC.appendChild(doc.createElement("div"));oEl.className=swfCSS.swfBox;oEl.innerHTML=movieHTML}appendSuccess=true}}didAppend=true;initMsg();return true};initMovie=function(){if(sm2.html5Only){createMovie();return false}if(flash){return false}if(!sm2.url){_wDS("noURL");return false}flash=sm2.getMovie(sm2.id);if(!flash){if(!oRemoved){createMovie(sm2.id,sm2.url)}else{if(!isIE){sm2.oMC.appendChild(oRemoved)}else{sm2.oMC.innerHTML=oRemovedHTML}oRemoved=null;didAppend=true}flash=sm2.getMovie(sm2.id)}if(typeof sm2.oninitmovie==="function"){setTimeout(sm2.oninitmovie,1)}flushMessages();return true};delayWaitForEI=function(){setTimeout(waitForEI,1e3)};rebootIntoHTML5=function(){window.setTimeout(function(){complain(smc+"useFlashBlock is false, 100% HTML5 mode is possible. Rebooting with preferFlash: false...");sm2.setup({preferFlash:false}).reboot();sm2.didFlashBlock=true;sm2.beginDelayedInit()},1)};waitForEI=function(){var p,loadIncomplete=false;if(!sm2.url){return false}if(waitingForEI){return false}waitingForEI=true;event.remove(window,"load",delayWaitForEI);if(hasFlash&&tryInitOnFocus&&!isFocused){_wDS("waitFocus");return false}if(!didInit){p=sm2.getMoviePercent();if(p>0&&p<100){loadIncomplete=true}}setTimeout(function(){p=sm2.getMoviePercent();if(loadIncomplete){waitingForEI=false;sm2._wD(str("waitSWF"));window.setTimeout(delayWaitForEI,1);return false}if(!didInit){sm2._wD(sm+": No Flash response within expected time. Likely causes: "+(p===0?"SWF load failed, ":"")+"Flash blocked or JS-Flash security error."+(sm2.debugFlash?" "+str("checkSWF"):""),2);if(!overHTTP&&p){_wDS("localFail",2);if(!sm2.debugFlash){_wDS("tryDebug",2)}}if(p===0){sm2._wD(str("swf404",sm2.url),1)}debugTS("flashtojs",false,": Timed out"+overHTTP?" (Check flash security or flash blockers)":" (No plugin/missing SWF?)")}if(!didInit&&okToDisable){if(p===null){if(sm2.useFlashBlock||sm2.flashLoadTimeout===0){if(sm2.useFlashBlock){flashBlockHandler()}_wDS("waitForever")}else{if(!sm2.useFlashBlock&&canIgnoreFlash){rebootIntoHTML5()}else{_wDS("waitForever");processOnEvents({type:"ontimeout",ignoreInit:true,error:{type:"INIT_FLASHBLOCK"}})}}}else{if(sm2.flashLoadTimeout===0){_wDS("waitForever")}else{if(!sm2.useFlashBlock&&canIgnoreFlash){rebootIntoHTML5()}else{failSafely(true)}}}}},sm2.flashLoadTimeout)};handleFocus=function(){function cleanup(){event.remove(window,"focus",handleFocus)}if(isFocused||!tryInitOnFocus){cleanup();return true}okToDisable=true;isFocused=true;_wDS("gotFocus");waitingForEI=false;delayWaitForEI();cleanup();return true};flushMessages=function(){if(messages.length){sm2._wD("SoundManager 2: "+messages.join(" "),1);messages=[]}};showSupport=function(){flushMessages();var item,tests=[];if(sm2.useHTML5Audio&&sm2.hasHTML5){for(item in sm2.audioFormats){if(sm2.audioFormats.hasOwnProperty(item)){tests.push(item+" = "+sm2.html5[item]+(!sm2.html5[item]&&needsFlash&&sm2.flash[item]?" (using flash)":sm2.preferFlash&&sm2.flash[item]&&needsFlash?" (preferring flash)":!sm2.html5[item]?" ("+(sm2.audioFormats[item].required?"required, ":"")+"and no flash support)":""))}}sm2._wD("SoundManager 2 HTML5 support: "+tests.join(", "),1)}};initComplete=function(bNoDisable){if(didInit){return false}if(sm2.html5Only){_wDS("sm2Loaded",1);didInit=true;initUserOnload();debugTS("onload",true);return true}var wasTimeout=sm2.useFlashBlock&&sm2.flashLoadTimeout&&!sm2.getMoviePercent(),result=true,error;if(!wasTimeout){didInit=true}error={type:!hasFlash&&needsFlash?"NO_FLASH":"INIT_TIMEOUT"};sm2._wD("SoundManager 2 "+(disabled?"failed to load":"loaded")+" ("+(disabled?"Flash security/load error":"OK")+") "+String.fromCharCode(disabled?10006:10003),disabled?2:1);if(disabled||bNoDisable){if(sm2.useFlashBlock&&sm2.oMC){sm2.oMC.className=getSWFCSS()+" "+(sm2.getMoviePercent()===null?swfCSS.swfTimedout:swfCSS.swfError)}processOnEvents({type:"ontimeout",error:error,ignoreInit:true});debugTS("onload",false);catchError(error);result=false}else{debugTS("onload",true)}if(!disabled){if(sm2.waitForWindowLoad&&!windowLoaded){_wDS("waitOnload");event.add(window,"load",initUserOnload)}else{if(sm2.waitForWindowLoad&&windowLoaded){_wDS("docLoaded")}initUserOnload()}}return result};setProperties=function(){var i,o=sm2.setupOptions;for(i in o){if(o.hasOwnProperty(i)){if(sm2[i]===_undefined){sm2[i]=o[i]}else if(sm2[i]!==o[i]){sm2.setupOptions[i]=sm2[i]}}}};init=function(){if(didInit){_wDS("didInit");return false}function cleanup(){event.remove(window,"load",sm2.beginDelayedInit)}if(sm2.html5Only){if(!didInit){cleanup();sm2.enabled=true;initComplete()}return true}initMovie();try{flash._externalInterfaceTest(false);setPolling(true,sm2.flashPollingInterval||(sm2.useHighPerformance?10:50));if(!sm2.debugMode){flash._disableDebug()}sm2.enabled=true;debugTS("jstoflash",true);if(!sm2.html5Only){event.add(window,"unload",doNothing)}}catch(e){sm2._wD("js/flash exception: "+e.toString());debugTS("jstoflash",false);catchError({type:"JS_TO_FLASH_EXCEPTION",fatal:true});failSafely(true);initComplete();return false}initComplete();cleanup();return true};domContentLoaded=function(){if(didDCLoaded){return false}didDCLoaded=true;setProperties();initDebug();(function(){var a="sm2-usehtml5audio=",a2="sm2-preferflash=",b=null,b2=null,l=wl.toLowerCase();if(l.indexOf(a)!==-1){b=l.charAt(l.indexOf(a)+a.length)==="1";if(hasConsole){console.log((b?"Enabling ":"Disabling ")+"useHTML5Audio via URL parameter")}sm2.setup({useHTML5Audio:b})}if(l.indexOf(a2)!==-1){b2=l.charAt(l.indexOf(a2)+a2.length)==="1";if(hasConsole){console.log((b2?"Enabling ":"Disabling ")+"preferFlash via URL parameter")}sm2.setup({preferFlash:b2})}})();if(!hasFlash&&sm2.hasHTML5){sm2._wD("SoundManager 2: No Flash detected"+(!sm2.useHTML5Audio?", enabling HTML5.":". Trying HTML5-only mode."),1);sm2.setup({useHTML5Audio:true,preferFlash:false})}testHTML5();if(!hasFlash&&needsFlash){messages.push(strings.needFlash);sm2.setup({flashLoadTimeout:1})}if(doc.removeEventListener){doc.removeEventListener("DOMContentLoaded",domContentLoaded,false)}initMovie();return true};domContentLoadedIE=function(){if(doc.readyState==="complete"){domContentLoaded();doc.detachEvent("onreadystatechange",domContentLoadedIE)}return true};winOnLoad=function(){windowLoaded=true;domContentLoaded();event.remove(window,"load",winOnLoad)};preInit=function(){if(mobileHTML5){if(!sm2.setupOptions.useHTML5Audio||sm2.setupOptions.preferFlash){messages.push(strings.mobileUA)}sm2.setupOptions.useHTML5Audio=true;sm2.setupOptions.preferFlash=false;if(is_iDevice||isAndroid&&!ua.match(/android\s2\.3/i)){messages.push(strings.globalHTML5);if(is_iDevice){sm2.ignoreFlash=true}useGlobalHTML5Audio=true}}};preInit();detectFlash();event.add(window,"focus",handleFocus);event.add(window,"load",delayWaitForEI);event.add(window,"load",winOnLoad);if(doc.addEventListener){doc.addEventListener("DOMContentLoaded",domContentLoaded,false)}else if(doc.attachEvent){doc.attachEvent("onreadystatechange",domContentLoadedIE)}else{debugTS("onload",false);catchError({type:"NO_DOM2_EVENTS",fatal:true})}}if(window.SM2_DEFER===undefined||!SM2_DEFER){soundManager=new SoundManager}if(typeof module==="object"&&module&&typeof module.exports==="object"){window.soundManager=soundManager;module.exports.SoundManager=SoundManager;module.exports.soundManager=soundManager}else if(typeof define==="function"&&define.amd){define("SoundManager",[],function(){return{SoundManager:SoundManager,soundManager:soundManager}})}else{window.SoundManager=SoundManager;window.soundManager=soundManager}})(window);!function(name,definition){if(typeof module!="undefined"&&module.exports)module.exports=definition();else if(typeof define=="function"&&define.amd)define(definition);else this[name]=definition()}("bowser",function(){var t=true;function detect(ua){function getFirstMatch(regex){var match=ua.match(regex);return match&&match.length>1&&match[1]||""}function getSecondMatch(regex){var match=ua.match(regex);return match&&match.length>1&&match[2]||""}var iosdevice=getFirstMatch(/(ipod|iphone|ipad)/i).toLowerCase(),likeAndroid=/like android/i.test(ua),android=!likeAndroid&&/android/i.test(ua),chromeBook=/CrOS/.test(ua),edgeVersion=getFirstMatch(/edge\/(\d+(\.\d+)?)/i),versionIdentifier=getFirstMatch(/version\/(\d+(\.\d+)?)/i),tablet=/tablet/i.test(ua),mobile=!tablet&&/[^-]mobi/i.test(ua),result;if(/opera|opr/i.test(ua)){result={name:"Opera",opera:t,version:versionIdentifier||getFirstMatch(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i)}}else if(/yabrowser/i.test(ua)){result={name:"Yandex Browser",yandexbrowser:t,version:versionIdentifier||getFirstMatch(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}}else if(/windows phone/i.test(ua)){result={name:"Windows Phone",windowsphone:t};if(edgeVersion){result.msedge=t;result.version=edgeVersion}else{result.msie=t;result.version=getFirstMatch(/iemobile\/(\d+(\.\d+)?)/i)}}else if(/msie|trident/i.test(ua)){result={name:"Internet Explorer",msie:t,version:getFirstMatch(/(?:msie |rv:)(\d+(\.\d+)?)/i)}}else if(chromeBook){result={name:"Chrome",chromeBook:t,chrome:t,version:getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}}else if(/chrome.+? edge/i.test(ua)){result={name:"Microsoft Edge",msedge:t,version:edgeVersion}}else if(/chrome|crios|crmo/i.test(ua)){result={name:"Chrome",chrome:t,version:getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}}else if(iosdevice){result={name:iosdevice=="iphone"?"iPhone":iosdevice=="ipad"?"iPad":"iPod"};if(versionIdentifier){result.version=versionIdentifier}}else if(/sailfish/i.test(ua)){result={name:"Sailfish",sailfish:t,version:getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}}else if(/seamonkey\//i.test(ua)){result={name:"SeaMonkey",seamonkey:t,version:getFirstMatch(/seamonkey\/(\d+(\.\d+)?)/i)}}else if(/firefox|iceweasel/i.test(ua)){result={name:"Firefox",firefox:t,version:getFirstMatch(/(?:firefox|iceweasel)[ \/](\d+(\.\d+)?)/i)};if(/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(ua)){result.firefoxos=t}}else if(/silk/i.test(ua)){result={name:"Amazon Silk",silk:t,version:getFirstMatch(/silk\/(\d+(\.\d+)?)/i)}}else if(android){result={name:"Android",version:versionIdentifier}}else if(/phantom/i.test(ua)){result={name:"PhantomJS",phantom:t,version:getFirstMatch(/phantomjs\/(\d+(\.\d+)?)/i)}}else if(/blackberry|\bbb\d+/i.test(ua)||/rim\stablet/i.test(ua)){result={name:"BlackBerry",blackberry:t,version:versionIdentifier||getFirstMatch(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}}else if(/(web|hpw)os/i.test(ua)){result={name:"WebOS",webos:t,version:versionIdentifier||getFirstMatch(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)};/touchpad\//i.test(ua)&&(result.touchpad=t)}else if(/bada/i.test(ua)){result={name:"Bada",bada:t,version:getFirstMatch(/dolfin\/(\d+(\.\d+)?)/i)}}else if(/tizen/i.test(ua)){result={name:"Tizen",tizen:t,version:getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||versionIdentifier}}else if(/safari/i.test(ua)){result={name:"Safari",safari:t,version:versionIdentifier}}else{result={name:getFirstMatch(/^(.*)\/(.*) /),version:getSecondMatch(/^(.*)\/(.*) /)}}if(!result.msedge&&/(apple)?webkit/i.test(ua)){result.name=result.name||"Webkit";result.webkit=t;if(!result.version&&versionIdentifier){result.version=versionIdentifier}}else if(!result.opera&&/gecko\//i.test(ua)){result.name=result.name||"Gecko";result.gecko=t;result.version=result.version||getFirstMatch(/gecko\/(\d+(\.\d+)?)/i)}if(!result.msedge&&(android||result.silk)){result.android=t}else if(iosdevice){result[iosdevice]=t;result.ios=t}var osVersion="";if(result.windowsphone){osVersion=getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i)}else if(iosdevice){osVersion=getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i);osVersion=osVersion.replace(/[_\s]/g,".")}else if(android){osVersion=getFirstMatch(/android[ \/-](\d+(\.\d+)*)/i)}else if(result.webos){osVersion=getFirstMatch(/(?:web|hpw)os\/(\d+(\.\d+)*)/i)}else if(result.blackberry){osVersion=getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i)}else if(result.bada){osVersion=getFirstMatch(/bada\/(\d+(\.\d+)*)/i)}else if(result.tizen){osVersion=getFirstMatch(/tizen[\/\s](\d+(\.\d+)*)/i)}if(osVersion){result.osversion=osVersion}var osMajorVersion=osVersion.split(".")[0];if(tablet||iosdevice=="ipad"||android&&(osMajorVersion==3||osMajorVersion==4&&!mobile)||result.silk){result.tablet=t}else if(mobile||iosdevice=="iphone"||iosdevice=="ipod"||android||result.blackberry||result.webos||result.bada){result.mobile=t}if(result.msedge||result.msie&&result.version>=10||result.yandexbrowser&&result.version>=15||result.chrome&&result.version>=20||result.firefox&&result.version>=20||result.safari&&result.version>=6||result.opera&&result.version>=10||result.ios&&result.osversion&&result.osversion.split(".")[0]>=6||result.blackberry&&result.version>=10.1){result.a=t}else if(result.msie&&result.version<10||result.chrome&&result.version<20||result.firefox&&result.version<20||result.safari&&result.version<6||result.opera&&result.version<10||result.ios&&result.osversion&&result.osversion.split(".")[0]<6){result.c=t}else result.x=t;return result}var bowser=detect(typeof navigator!=="undefined"?navigator.userAgent:"");bowser.test=function(browserList){for(var i=0;i<browserList.length;++i){var browserItem=browserList[i];if(typeof browserItem==="string"){if(browserItem in bowser){return true}}}return false};bowser._detect=detect;return bowser});(function(global){function SignalBinding(signal,listener,isOnce,listenerContext,priority){this._listener=listener;this._isOnce=isOnce;this.context=listenerContext;this._signal=signal;this._priority=priority||0}SignalBinding.prototype={active:true,params:null,execute:function(paramsArr){var handlerReturn,params;if(this.active&&!!this._listener){params=this.params?this.params.concat(paramsArr):paramsArr;handlerReturn=this._listener.apply(this.context,params);if(this._isOnce){this.detach()}}return handlerReturn},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;delete this._listener;delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};function validateListener(listener,fnName){if(typeof listener!=="function"){throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",fnName))}}function Signal(){this._bindings=[];this._prevParams=null;var self=this;this.dispatch=function(){Signal.prototype.dispatch.apply(self,arguments)}}Signal.prototype={VERSION:"1.0.0",memorize:false,_shouldPropagate:true,active:true,_registerListener:function(listener,isOnce,listenerContext,priority){var prevIndex=this._indexOfListener(listener,listenerContext),binding;if(prevIndex!==-1){binding=this._bindings[prevIndex];if(binding.isOnce()!==isOnce){throw new Error("You cannot add"+(isOnce?"":"Once")+"() then add"+(!isOnce?"":"Once")+"() the same listener without removing the relationship first.")}}else{binding=new SignalBinding(this,listener,isOnce,listenerContext,priority);this._addBinding(binding)}if(this.memorize&&this._prevParams){binding.execute(this._prevParams)}return binding},_addBinding:function(binding){var n=this._bindings.length;do{--n}while(this._bindings[n]&&binding._priority<=this._bindings[n]._priority);this._bindings.splice(n+1,0,binding)},_indexOfListener:function(listener,context){var n=this._bindings.length,cur;while(n--){cur=this._bindings[n];if(cur._listener===listener&&cur.context===context){return n}}return-1},has:function(listener,context){return this._indexOfListener(listener,context)!==-1},add:function(listener,listenerContext,priority){validateListener(listener,"add");return this._registerListener(listener,false,listenerContext,priority)},addOnce:function(listener,listenerContext,priority){validateListener(listener,"addOnce");return this._registerListener(listener,true,listenerContext,priority)},remove:function(listener,context){validateListener(listener,"remove");var i=this._indexOfListener(listener,context);if(i!==-1){this._bindings[i]._destroy();this._bindings.splice(i,1)}return listener},removeAll:function(){var n=this._bindings.length;while(n--){this._bindings[n]._destroy()}this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=false},dispatch:function(params){if(!this.active){return}var paramsArr=Array.prototype.slice.call(arguments),n=this._bindings.length,bindings;if(this.memorize){this._prevParams=paramsArr}if(!n){return}bindings=this._bindings.slice();this._shouldPropagate=true;do{n--}while(bindings[n]&&this._shouldPropagate&&bindings[n].execute(paramsArr)!==false)},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var signals=Signal;signals.Signal=Signal;if(typeof define==="function"&&define.amd){define(function(){return signals})}else if(typeof module!=="undefined"&&module.exports){module.exports=signals}else{global["signals"]=signals}})(this);(function(window,True,False,Null,undefined){"use strict";var document=window.document,documentElement=document.documentElement,windowHistory=window.history||{},windowLocation=window.location,api=!!windowHistory.pushState,initialState=api&&windowHistory.state===undefined,initialFire=windowLocation.href,JSON=window.JSON||{},defineProp=Object.defineProperty,defineGetter=Object.prototype.__defineGetter__,defineSetter=Object.prototype.__defineSetter__,historyPushState=windowHistory.pushState,historyReplaceState=windowHistory.replaceState,sessionStorage=window.sessionStorage,hasOwnProperty=Object.prototype.hasOwnProperty,toString=Object.prototype.toString,msie=+((window.eval&&eval("/*@cc_on 1;@*/")&&/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0),libID=(new Date).getTime(),VBInc=(defineProp||defineGetter)&&(!msie||msie>8)?0:1,iframe=msie<8?document.createElement("iframe"):False,_a,_r,_d,eventPrefix="",addEvent=(_a="addEventListener",window[_a])||(_a="attachEvent",eventPrefix="on",window[_a]),removeEvent=(_r="removeEventListener",window[_r])||(_r="detachEvent",window[_r]),fireEvent=(_d="dispatchEvent",window[_d])||(_d="fireEvent",window[_d]),eventsListPopState=[],eventsListHashChange=[],skipHashChange=0,eventsList={onpopstate:eventsListPopState,popstate:eventsListPopState,onhashchange:eventsListHashChange,hashchange:eventsListHashChange},sets=function(){var i,m,s,config={basepath:"/",redirect:0,type:"/"},el=document.getElementsByTagName("SCRIPT");for(i=0;el[i];i++){if(m=/(.*)\/(?:history|spike)(?:\.iegte8)?(?:-\d\.\d(?:\.\d)?\w?)?(?:\.min)?.js\?(.*)$/i.exec(el[i].src)||i===el.length-1&&(m=el[i].src.split("?")).length===2&&(m[2]=m[1])&&m){for(i=0,s=m[2].split("&");s[i];){m=s[i++].split("=");config[m[0]]=m[1]=="true"?True:m[1]=="false"?False:m[1]||""}config["basepath"]=config["basepath"]||"/";break}}return config}(),normalizeUrl=function(a){var _href,relative,special,nohash,host,port,pathname;return function(href,test){var re=new RegExp("^"+sets["basepath"],"i");if(!href){href=windowLocation.href;if(!api||test){href=windowLocation.protocol+"//"+windowLocation.host+sets["basepath"]+(href.replace(/^[^#]*/,"")||"#").replace(new RegExp("^#[/]?(?:"+sets["type"]+")?"),"")}}else if(!api||msie){var current=normalizeUrl(),_pathname=current._pathname,_protocol=current._protocol;href=/^(?:[\w0-9]+\:)?\/\//.test(href)?href.indexOf("/")===0?_protocol+href:href:_protocol+"//"+current._host+(href.indexOf("/")===0?href:href.indexOf("?")===0?_pathname+href:href.indexOf("#")===0?_pathname+current._search+href:_pathname.replace(/[^\/]+$/g,"")+href)}if(_href!==href){a.href=_href=href;port=a.port;host=a.host;pathname=a.pathname;if(a.protocol==="http:"&&port==80||a.protocol==="https:"&&port==443){host=a.hostname;port=""}pathname=pathname.indexOf("/")===0?pathname:"/"+pathname;relative=pathname+a.search+a.hash;nohash=pathname.replace(re,sets["type"])+a.search;special=nohash+a.hash}return{_href:a.protocol+"//"+host+relative,_protocol:a.protocol,_host:host,_hostname:a.hostname||windowLocation.hostname,_port:port||windowLocation.port,_pathname:pathname,_search:a.search,_hash:a.hash,_relative:relative,_nohash:nohash,_special:special}}}(document.createElement("a")),History=!VBInc?windowHistory:{back:windowHistory.back,forward:windowHistory.forward,go:windowHistory.go,pushState:Null,replaceState:Null,emulate:!api,toString:function(){return"[object History]"}},HistoryAccessors={state:{get:function(){return iframe&&iframe["storage"]||historyStorage()[History.location.href]||Null}},length:{get:function(){return windowHistory.length}},location:{set:function(val){window.location=val},get:function(){return api?windowLocation:Location}}},Location={assign:function(url){windowLocation.assign(api||url.indexOf("#")!==0?url:"#"+normalizeUrl()._nohash+url)},reload:windowLocation.reload,replace:function(url){windowLocation.replace(api||url.indexOf("#")!==0?url:"#"+normalizeUrl()._nohash+url)},toString:function(){return this.href}},LocationAccessors={href:{set:function(val){windowLocation.href=val},get:function(){return normalizeUrl()._href}},protocol:{set:function(val){windowLocation.protocol=val},get:function(){return windowLocation.protocol}},host:{set:function(val){windowLocation.host=val},get:function(){return windowLocation.host}},hostname:{set:function(val){windowLocation.hostname=val},get:function(){return windowLocation.hostname}},port:{set:function(val){windowLocation.port=val},get:function(){return windowLocation.port}},pathname:{set:function(val){windowLocation.pathname=val},get:function(){return normalizeUrl()._pathname}},search:{set:function(val){windowLocation.search=val},get:function(){return normalizeUrl()._search}},hash:{set:function(val){var hash=val.indexOf("#")===0?val:"#"+val,urlObject=normalizeUrl();if(iframe){if(hash!=urlObject._hash){History.pushState(Null,Null,urlObject._nohash+hash);hashChanged({oldURL:urlObject._href})}}else{windowLocation.hash="#"+urlObject._nohash+hash}},get:function(){return normalizeUrl()._hash}}},createStaticObject=function(obj,props,novb){var tmp=obj,key,vb=False;if(defineProp||defineGetter){for(key in props){if(hasOwnProperty.call(props,key)){if(defineGetter){props[key].get&&defineGetter.call(obj,key,props[key].get);props[key].set&&defineSetter.call(obj,key,props[key].set)}else if(defineProp){try{defineProp(obj,key,props[key])}catch(_e_){if(novb){return False}vb=True;break}}}}}else vb=True;if(vb&&VBInc){var staticClass="StaticClass"+libID+VBInc++,parts=["Class "+staticClass];if(!("execVB"in window)){execScript("Function execVB(c) ExecuteGlobal(c) End Function","VBScript")}if(!("VBCVal"in window)){execScript("Function VBCVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript")}for(key in obj){parts[parts.length]="Public ["+key+"]"}if(hasOwnProperty.call(obj,"toString")){if(!obj.propertyIsEnumerable("toString")){parts[parts.length]="Public [toString]"}props["(toString)"]={get:function(){return this.toString.call(this)}}}for(key in props){if(hasOwnProperty.call(props,key)){if(props[key].get){obj["get "+key]=props[key].get;parts.push("Public [get "+key+"]","Public "+(key==="(toString)"?"Default ":"")+"Property Get ["+key+"]","Call VBCVal(me.[get "+key+"].call(me),["+key+"])","End Property")}if(props[key].set){obj["set "+key]=props[key].set;parts.push("Public [set "+key+"]","Public Property Let ["+key+"](v)","Call me.[set "+key+"].call(me,v)","End Property","Public Property Set ["+key+"](v)","Call me.[set "+key+"].call(me,v)","End Property")}}}parts.push("End Class","Function "+staticClass+"Factory()","Set "+staticClass+"Factory=New "+staticClass,"End Function");execVB(parts.join("\n"));tmp=window[staticClass+"Factory"]();for(key in obj){tmp[key]=obj[key]}if(hasOwnProperty.call(obj,"toString")){tmp.toString=obj.toString}}return tmp},JSONStringify=JSON.stringify||function(undefined){function quote(string){var escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}var str=function(value){var isArray,result,k,n=(typeof value).charCodeAt(2);return n===114?quote(value):n===109?isFinite(value)?String(value):"null":n===111||n===108?String(value):n===106?function(){if(!value)return"null";isArray=toString.apply(value)==="[object Array]";result=isArray?"[":"{";if(isArray){for(k=0;k<value.length;k++){result+=(k==0?"":",")+str(value[k])}}else{for(k in value){if(hasOwnProperty.call(value,k)&&value[k]!==undefined){result+=(result.length==1?"":",")+quote(k)+":"+str(value[k])}}}return result+(isArray?"]":"}")}():undefined};return str}(),JSONParse=function(){var parse=JSON.parse;return function(source){return source?parse?parse(source):new Function("return "+source)():Null}}(),historyStorage=function(state){return sessionStorage?state?sessionStorage.setItem("__hitoryapi__",JSONStringify(state)):JSONParse(sessionStorage.getItem("__hitoryapi__"))||{}:{}},fireStateChange=function(type,oldURL,newURL){var winHndl=type===2?window.onhashchange:window.onpopstate,name=type===2?"hashchange":"popstate",o,list=eventsList[name];if(document.createEvent){o=document.createEvent("Events");o.initEvent(name,False,False)}else{o=document.createEventObject();o.type=name}o.state=History.state;o.oldURL=oldURL;o.newURL=newURL;if(winHndl){winHndl.call(window,o)}for(var i=0,len=list.length;i<len;i++){list[i].call(window,o)}},hashChanged=function(){var windowPopState=window.onpopstate||Null,windowHashChange=window.onhashchange||Null,popstateFired=0,initialStateHandler=Null,urlObject=normalizeUrl(),oldURL=urlObject._href,oldHash=urlObject._hash.replace(/^#/,""),fireInitialState=function(){if(initialFire&&!(initialFire=0)&&urlObject._relative!==sets["basepath"]){clearInterval(initialStateHandler);setTimeout(fireStateChange,10)}},change=function(e){var urlObject=normalizeUrl();if(skipHashChange){oldURL=urlObject._href;return skipHashChange=0}var oldUrl=e.oldURL||oldURL,newUrl=oldURL=e.newURL||urlObject._href,oldHash=oldUrl.replace(/^.*?(#|$)/,""),newHash=newUrl.replace(/^.*?(#|$)/,"");if(oldUrl!=newUrl&&!popstateFired){fireStateChange()}popstateFired=0;initialFire=0;if(oldHash!=newHash){fireStateChange(2,oldUrl,newUrl)}};addEvent(eventPrefix+"hashchange",change,False);addEvent(eventPrefix+"popstate",function(){if(initialFire===windowLocation.href){return initialFire=0}initialFire=0;fireStateChange(popstateFired=1)},False);History["redirect"]=function(type,basepath){sets["type"]=type==Null?sets["type"]:type;sets["basepath"]=basepath==Null?sets["basepath"]:basepath;if(window.top==window.self){var relative=normalizeUrl(Null,True)._relative,search=windowLocation.search,path=windowLocation.pathname,basepath=sets["basepath"];if(api){if(relative!=basepath&&new RegExp("^"+basepath+"$","i").test(path)){windowLocation.href=relative}if(new RegExp("^"+basepath+"$","i").test(path+"/")){windowLocation.href=basepath}else if(!new RegExp("^"+basepath,"i").test(path)){windowLocation.href=path.replace(/^\//,basepath)+search}}else if(path!=basepath){windowLocation.href=basepath+"#"+path.replace(new RegExp("^"+basepath,"i"),sets["type"])+search+windowLocation.hash;
}}};History=createStaticObject(History,VBInc?HistoryAccessors:windowHistory.state===undefined?{state:HistoryAccessors.state,location:HistoryAccessors.location}:{location:HistoryAccessors.location});Location=createStaticObject(Location,LocationAccessors);window[_a]=function(event,listener,capture){if(eventsList[event]){eventsList[event].push(listener);if(!api&&eventsListPopState===eventsList[event]){fireInitialState()}}else{if(arguments.length>3){addEvent(event,listener,capture,arguments[3])}else{addEvent(event,listener,capture)}}};window[_r]=function(event,listener,capture){var list=eventsList[event];if(list){for(var i=list.length;--i;){if(list[i]===listener){list.splice(i,1);break}}}else{removeEvent(event,listener,capture)}};window[_d]=function(event,eventObject){var type=event&&event.type||event,list=eventsList[event],winHndl=list===eventsListPopState?window.onpopstate:window.onhashchange;if(list){eventObject=eventObject||(typeof event=="string"?window.event:event);try{eventObject&&(eventObject.target=window)}catch(_e_){try{eventObject.srcElement=window}catch(_e_){}}if(winHndl){winHndl.call(window,eventObject)}for(var i=0,len=list.length;i<len;i++){list[i].call(window,eventObject)}return True}else{return fireEvent(event,eventObject)}};if(VBInc){execScript("Public history, onhashchange","VBScript")}if((!defineProp&&!defineGetter||!createStaticObject(window,{onhashchange:{get:function(){return windowHashChange},set:function(val){windowHashChange=val||Null}},onpopstate:{get:function(){return windowPopState},set:function(val){if(windowPopState=val||Null){!api&&fireInitialState()}}}},1))&&!api){initialStateHandler=setInterval(function(){if(window.onpopstate){fireInitialState()}},100)}if(sets["redirect"]){History["redirect"]()}if(!api){document[_a](eventPrefix+"click",function(e){var event=e||window.event,target=event.target||event.srcElement,defaultPrevented="defaultPrevented"in event?event.defaultPrevented:event.returnValue===False;if(target&&target.nodeName==="A"&&!defaultPrevented){e=normalizeUrl(target.getAttribute("href",2),True);if(e._hash&&e._hash!=="#"&&e._hash===e._href.replace(normalizeUrl()._href.split("#").shift(),"")){history.location.hash=e._hash;e=e._hash.replace(/^#/,"");if((target=document.getElementById(e))&&target.id===e&&target.nodeName==="A"){var rect=target.getBoundingClientRect();window.scrollTo(documentElement.scrollLeft||0,rect.top+(documentElement.scrollTop||0)-(documentElement.clientTop||0))}if(event.preventDefault){event.preventDefault()}else{event.returnValue=false}}}},False)}return change}();History.pushState=function(state,title,url,replace){var stateObject=historyStorage(),currentHref=normalizeUrl()._href,urlObject=url&&normalizeUrl(url);initialFire=0;url=urlObject?urlObject._href:currentHref;if(replace&&stateObject[currentHref]){delete stateObject[currentHref]}if((!api||initialState)&&sessionStorage&&state){stateObject[url]=state;historyStorage(stateObject);state=Null}if(historyPushState&&historyReplaceState){if(replace){historyReplaceState.call(History,state,title,url)}else{historyPushState.call(History,state,title,url)}}else if(urlObject&&urlObject._relative!=normalizeUrl()._relative){skipHashChange=1;if(replace){windowLocation.replace("#"+urlObject._special)}else{windowLocation.hash=urlObject._special}}};History.replaceState=function(state,title,url){History.pushState(state,title,url,1)};if(VBInc){window.history=History;(function(cookie,currentHref){if(!iframe)return;var pushState,hashCheckerHandler,checker=function(){var href=normalizeUrl()._href;if(currentHref!=href){hashChanged({oldURL:currentHref,newURL:currentHref=href})}};hashCheckerHandler=setInterval(checker,100);iframe.src="javascript:true;";iframe=documentElement.firstChild.appendChild(iframe).contentWindow;History.pushState=pushState=function(state,title,url,replace,lfirst){var i=iframe.document,content=["<script>","lfirst=1;",,"storage="+JSONStringify(state)+";","</script>"],urlObject=url&&normalizeUrl(url);if(!urlObject){iframe["storage"]=state;return}if(!lfirst){clearInterval(hashCheckerHandler)}if(replace){if(iframe["lfirst"]){history.back();pushState(state,title,urlObject._href,0,1)}else{iframe["storage"]=state;windowLocation.replace("#"+urlObject._special)}}else if(urlObject._href!=currentHref||lfirst){if(!iframe["lfirst"]){iframe["lfirst"]=1;pushState(iframe["storage"],title,currentHref,0,1)}content[2]='parent.location.hash="'+urlObject._special.replace(/"/g,'\\"')+'";';i.open();i.write(content.join(""));i.close()}if(!lfirst){currentHref=normalizeUrl()._href;hashCheckerHandler=setInterval(checker,100)}};addEvent(eventPrefix+"unload",function(){if(iframe["storage"]){var state={};state[normalizeUrl()._href]=iframe["storage"];document.cookie="_historyAPI="+escape(JSONStringify(state))}clearInterval(hashCheckerHandler)},False);if(cookie.length>1){cookie=unescape(cookie.pop().split(";").shift());try{iframe["storage"]=JSONParse(cookie)[normalizeUrl()._href]}catch(_e_){}}if(!JSON.parse&&!JSON.stringify){JSON.parse=JSONParse;JSON.stringify=JSONStringify;window.JSON=JSON}})(document.cookie.split("_historyAPI="),normalizeUrl()._href)}else{window.history["emulate"]=!api}})(window,true,false,null);function createCookie(name,value,days,domain){if(days){var date=new Date;date.setTime(date.getTime()+days*24*60*60*1e3);var expires="; expires="+date.toGMTString()}else var expires="";var domain=domain?"; domain="+domain:"";document.cookie=name+"="+value+expires+domain+"; path=/"}function readCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" ")c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length)}return null}function eraseCookie(name,domain){var domain=domain?"; domain="+domain:"";createCookie(name,"",-1,domain)}(function(local_setup){function emoji(){}emoji.img_set="apple";emoji.img_sets={apple:{path:"/emoji-data/img-apple-64/",sheet:"/emoji-data/sheet_apple_64.png",mask:1},google:{path:"/emoji-data/img-google-64/",sheet:"/emoji-data/sheet_google_64.png",mask:2},twitter:{path:"/emoji-data/img-twitter-64/",sheet:"/emoji-data/sheet_twitter_64.png",mask:4},emojione:{path:"/emoji-data/img-emojione-64/",sheet:"/emoji-data/sheet_emojione_64.png",mask:8}};emoji.use_css_imgs=false;emoji.colons_mode=false;emoji.text_mode=false;emoji.include_title=false;emoji.allow_native=true;emoji.use_sheet=false;emoji.avoid_ms_emoji=true;emoji.inits={};emoji.map={};emoji.replace_emoticons=function(str){emoji.init_emoticons();return str.replace(emoji.rx_emoticons,function(m,$1,$2){var val=emoji.map.emoticons[$2];return val?$1+emoji.replacement(val,$2):m})};emoji.replace_emoticons_with_colons=function(str){emoji.init_emoticons();return str.replace(emoji.rx_emoticons,function(m,$1,$2){var val=emoji.data[emoji.map.emoticons[$2]][3][0];return val?$1+":"+val+":":m})};emoji.replace_colons=function(str){emoji.init_colons();return str.replace(emoji.rx_colons,function(m){var idx=m.substr(1,m.length-2);if(idx.indexOf("::skin-tone-")>-1){var skin_tone=idx.substr(-1,1);var skin_idx="skin-tone-"+skin_tone;var skin_val=emoji.map.colons[skin_idx];idx=idx.substr(0,idx.length-13);var val=emoji.map.colons[idx];if(val){return emoji.replacement(val,idx,":",{idx:skin_val,actual:skin_idx,wrapper:":"})}else{return":"+idx+":"+emoji.replacement(skin_val,skin_idx,":")}}else{var val=emoji.map.colons[idx];return val?emoji.replacement(val,idx,":"):m}})};emoji.replace_unified=function(str){emoji.init_unified();return str.replace(emoji.rx_unified,function(m,p1,p2){var val=emoji.map.unified[p1];if(!val)return m;var idx=null;if(p2=="")idx="1f3fb";if(p2=="")idx="1f3fc";if(p2=="")idx="1f3fd";if(p2=="")idx="1f3fe";if(p2=="")idx="1f3ff";if(idx){return emoji.replacement(val,null,null,{idx:idx,actual:p2,wrapper:""})}return emoji.replacement(val)})};emoji.replacement=function(idx,actual,wrapper,variation){var extra="";var variation_idx=0;if(typeof variation==="object"){extra=emoji.replacement(variation.idx,variation.actual,variation.wrapper);variation_idx=idx+"-"+variation.idx}var img_set=emoji.img_set;if(!emoji.use_sheet&&!(emoji.data[idx][6]&emoji.img_sets[emoji.img_set].mask)){img_set="apple"}wrapper=wrapper||"";if(emoji.colons_mode)return":"+emoji.data[idx][3][0]+":"+extra;var text_name=actual?wrapper+actual+wrapper:emoji.data[idx][8]||wrapper+emoji.data[idx][3][0]+wrapper;if(emoji.text_mode)return text_name+extra;emoji.init_env();if(emoji.replace_mode=="unified"&&emoji.allow_native&&emoji.data[idx][0][0])return emoji.data[idx][0][0]+extra;if(emoji.replace_mode=="softbank"&&emoji.allow_native&&emoji.data[idx][1])return emoji.data[idx][1]+extra;if(emoji.replace_mode=="google"&&emoji.allow_native&&emoji.data[idx][2])return emoji.data[idx][2]+extra;var img=emoji.data[idx][7]||emoji.img_sets[img_set].path+idx+".png";var title=emoji.include_title?' title="'+(actual||emoji.data[idx][3][0])+'"':"";var text=emoji.include_text?wrapper+(actual||emoji.data[idx][3][0])+wrapper:"";var px=emoji.data[idx][4];var py=emoji.data[idx][5];if(variation_idx&&emoji.variations_data[variation_idx]&&emoji.variations_data[variation_idx][2]&&!emoji.data[idx][7]){if(emoji.variations_data[variation_idx][2]&emoji.img_sets[emoji.img_set].mask){img=emoji.img_sets[emoji.img_set].path+variation_idx+".png";px=emoji.variations_data[variation_idx][0];py=emoji.variations_data[variation_idx][1];extra=""}}if(emoji.supports_css){if(emoji.use_sheet&&px!=null&&py!=null){var mul=100/(emoji.sheet_size-1);var style="background: url("+emoji.img_sets[img_set].sheet+");background-position:"+mul*px+"% "+mul*py+"%;background-size:"+emoji.sheet_size+"00%";return'<span class="emoji-outer emoji-sizer"><span class="emoji-inner" style="'+style+'"'+title+">"+text+"</span></span>"+extra}else if(emoji.use_css_imgs){return'<span class="emoji emoji-'+idx+'"'+title+">"+text+"</span>"+extra}else{return'<span class="emoji emoji-sizer" style="background-image:url('+img+')"'+title+">"+text+"</span>"+extra}}return'<img src="'+img+'" class="emoji" '+title+"/>"+extra};emoji.init_emoticons=function(){if(emoji.inits.emoticons)return;emoji.init_colons();emoji.inits.emoticons=1;var a=[];emoji.map.emoticons={};for(var i in emoji.emoticons_data){var emoticon=i.replace(/\&/g,"&amp;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;");if(!emoji.map.colons[emoji.emoticons_data[i]])continue;emoji.map.emoticons[emoticon]=emoji.map.colons[emoji.emoticons_data[i]];a.push(emoji.escape_rx(emoticon))}emoji.rx_emoticons=new RegExp("(^|\\s)("+a.join("|")+")(?=$|[\\s|\\?\\.,!])","g")};emoji.init_colons=function(){if(emoji.inits.colons)return;emoji.inits.colons=1;emoji.rx_colons=new RegExp(":[a-zA-Z0-9-_+]+:(:skin-tone-[2-6]:)?","g");emoji.map.colons={};for(var i in emoji.data){for(var j=0;j<emoji.data[i][3].length;j++){emoji.map.colons[emoji.data[i][3][j]]=i}}};emoji.init_unified=function(){if(emoji.inits.unified)return;emoji.inits.unified=1;var a=[];emoji.map.unified={};for(var i in emoji.data){for(var j=0;j<emoji.data[i][0].length;j++){a.push(emoji.data[i][0][j]);emoji.map.unified[emoji.data[i][0][j]]=i}}emoji.rx_unified=new RegExp("("+a.join("|")+")([-])?","g")};emoji.init_env=function(){if(emoji.inits.env)return;emoji.inits.env=1;emoji.replace_mode="img";emoji.supports_css=false;var ua=navigator.userAgent;if(window.getComputedStyle){var st=window.getComputedStyle(document.body);if(st["background-size"]||st["backgroundSize"]){emoji.supports_css=true}}if(ua.match(/(iPhone|iPod|iPad|iPhone\s+Simulator)/i)){if(ua.match(/OS\s+[12345]/i)){emoji.replace_mode="softbank";return}if(ua.match(/OS\s+[6789]/i)){emoji.replace_mode="unified";return}}if(ua.match(/Mac OS X 10[._ ](?:[789]|1\d)/i)){if(!ua.match(/Chrome/i)&&!ua.match(/Firefox/i)){emoji.replace_mode="unified";return}}if(!emoji.avoid_ms_emoji){if(ua.match(/Windows NT 6.[1-9]/i)||ua.match(/Windows NT 10.[0-9]/i)){if(!ua.match(/Chrome/i)&&!ua.match(/MSIE 8/i)){emoji.replace_mode="unified";return}}}if(false&&ua.match(/Android/i)){emoji.replace_mode="google";return}if(emoji.supports_css){emoji.replace_mode="css"}};emoji.escape_rx=function(text){return text.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};emoji.sheet_size=35;emoji.data={"00a9":[["",""],"","",["copyright"],0,0,11,0],"00ae":[["",""],"","",["registered"],0,1,11,0],"203c":[["",""],"","",["bangbang"],0,2,15,0],2049:[["",""],"","",["interrobang"],0,3,15,0],2122:[["",""],"","",["tm"],0,4,15,0],2139:[["",""],"","",["information_source"],0,5,15,0],2194:[["",""],"","",["left_right_arrow"],0,6,15,0],2195:[["",""],"","",["arrow_up_down"],0,7,15,0],2196:[["",""],"","",["arrow_upper_left"],0,8,15,0],2197:[["",""],"","",["arrow_upper_right"],0,9,15,0],2198:[["",""],"","",["arrow_lower_right"],0,10,15,0],2199:[["",""],"","",["arrow_lower_left"],0,11,15,0],"21a9":[["",""],"","",["leftwards_arrow_with_hook"],0,12,15,0],"21aa":[["",""],"","",["arrow_right_hook"],0,13,15,0],"231a":[["",""],"","",["watch"],0,14,15,0],"231b":[["",""],"","",["hourglass"],0,15,15,0],"23e9":[[""],"","",["fast_forward"],0,16,15,0],"23ea":[[""],"","",["rewind"],0,17,15,0],"23eb":[[""],"","",["arrow_double_up"],0,18,15,0],"23ec":[[""],"","",["arrow_double_down"],0,19,15,0],"23f0":[[""],"","",["alarm_clock"],0,20,15,0],"23f3":[[""],"","",["hourglass_flowing_sand"],0,21,15,0],"24c2":[["",""],"","",["m"],0,22,15,0],"25aa":[["",""],"","",["black_small_square"],0,23,15,0],"25ab":[["",""],"","",["white_small_square"],0,24,15,0],"25b6":[["",""],"","",["arrow_forward"],0,25,15,0],"25c0":[["",""],"","",["arrow_backward"],0,26,15,0],"25fb":[["",""],"","",["white_medium_square"],0,27,15,0],"25fc":[["",""],"","",["black_medium_square"],0,28,15,0],"25fd":[["",""],"","",["white_medium_small_square"],0,29,15,0],"25fe":[["",""],"","",["black_medium_small_square"],0,30,15,0],2600:[["",""],"","",["sunny"],0,31,15,0],2601:[["",""],"","",["cloud"],0,32,15,0],"260e":[["",""],"","",["phone","telephone"],0,33,15,0],2611:[["",""],"","",["ballot_box_with_check"],0,34,15,0],2614:[["",""],"","",["umbrella"],1,0,15,0],2615:[["",""],"","",["coffee"],1,1,15,0],"261d":[["",""],"","",["point_up"],1,2,15,0],"263a":[["",""],"","",["relaxed"],1,8,15,0],2648:[["",""],"","",["aries"],1,9,15,0],2649:[["",""],"","",["taurus"],1,10,15,0],"264a":[["",""],"","",["gemini"],1,11,15,0],"264b":[["",""],"","",["cancer"],1,12,15,0],"264c":[["",""],"","",["leo"],1,13,15,0],"264d":[["",""],"","",["virgo"],1,14,15,0],"264e":[["",""],"","",["libra"],1,15,15,0],"264f":[["",""],"","",["scorpius"],1,16,15,0],2650:[["",""],"","",["sagittarius"],1,17,15,0],2651:[["",""],"","",["capricorn"],1,18,15,0],2652:[["",""],"","",["aquarius"],1,19,15,0],2653:[["",""],"","",["pisces"],1,20,15,0],2660:[["",""],"","",["spades"],1,21,15,0],2663:[["",""],"","",["clubs"],1,22,15,0],2665:[["",""],"","",["hearts"],1,23,15,0],2666:[["",""],"","",["diamonds"],1,24,15,0],2668:[["",""],"","",["hotsprings"],1,25,15,0],"267b":[["",""],"","",["recycle"],1,26,15,0],"267f":[["",""],"","",["wheelchair"],1,27,15,0],2693:[["",""],"","",["anchor"],1,28,15,0],"26a0":[["",""],"","",["warning"],1,29,15,0],"26a1":[["",""],"","",["zap"],1,30,15,0],"26aa":[["",""],"","",["white_circle"],1,31,15,0],"26ab":[["",""],"","",["black_circle"],1,32,15,0],"26bd":[["",""],"","",["soccer"],1,33,15,0],"26be":[["",""],"","",["baseball"],1,34,15,0],"26c4":[["",""],"","",["snowman"],2,0,15,0],"26c5":[["",""],"","",["partly_sunny"],2,1,15,0],"26ce":[[""],"","",["ophiuchus"],2,2,15,0],"26d4":[["",""],"","",["no_entry"],2,3,15,0],"26ea":[["",""],"","",["church"],2,4,15,0],"26f2":[["",""],"","",["fountain"],2,5,15,0],"26f3":[["",""],"","",["golf"],2,6,15,0],"26f5":[["",""],"","",["boat","sailboat"],2,7,15,0],"26fa":[["",""],"","",["tent"],2,8,15,0],"26fd":[["",""],"","",["fuelpump"],2,9,15,0],2702:[["",""],"","",["scissors"],2,10,15,0],2705:[[""],"","",["white_check_mark"],2,11,15,0],2708:[["",""],"","",["airplane"],2,12,15,0],2709:[["",""],"","",["email","envelope"],2,13,15,0],"270a":[[""],"","",["fist"],2,14,15,0],"270b":[[""],"","",["hand","raised_hand"],2,20,15,0],"270c":[["",""],"","",["v"],2,26,15,0],"270f":[["",""],"","",["pencil2"],2,32,15,0],2712:[["",""],"","",["black_nib"],2,33,15,0],2714:[["",""],"","",["heavy_check_mark"],2,34,15,0],2716:[["",""],"","",["heavy_multiplication_x"],3,0,15,0],2728:[[""],"","",["sparkles"],3,1,15,0],2733:[["",""],"","",["eight_spoked_asterisk"],3,2,15,0],2734:[["",""],"","",["eight_pointed_black_star"],3,3,15,0],2744:[["",""],"","",["snowflake"],3,4,15,0],2747:[["",""],"","",["sparkle"],3,5,15,0],"274c":[[""],"","",["x"],3,6,15,0],"274e":[[""],"","",["negative_squared_cross_mark"],3,7,15,0],2753:[[""],"","",["question"],3,8,15,0],2754:[[""],"","",["grey_question"],3,9,15,0],2755:[[""],"","",["grey_exclamation"],3,10,15,0],2757:[["",""],"","",["exclamation","heavy_exclamation_mark"],3,11,15,0],2764:[["",""],"","",["heart"],3,12,15,0,"<3"],2795:[[""],"","",["heavy_plus_sign"],3,13,15,0],2796:[[""],"","",["heavy_minus_sign"],3,14,15,0],2797:[[""],"","",["heavy_division_sign"],3,15,15,0],"27a1":[["",""],"","",["arrow_right"],3,16,15,0],"27b0":[[""],"","",["curly_loop"],3,17,15,0],"27bf":[[""],"","",["loop"],3,18,15,0],2934:[["",""],"","",["arrow_heading_up"],3,19,15,0],2935:[["",""],"","",["arrow_heading_down"],3,20,15,0],"2b05":[["",""],"","",["arrow_left"],3,21,15,0],"2b06":[["",""],"","",["arrow_up"],3,22,15,0],"2b07":[["",""],"","",["arrow_down"],3,23,15,0],"2b1b":[["",""],"","",["black_large_square"],3,24,15,0],"2b1c":[["",""],"","",["white_large_square"],3,25,15,0],"2b50":[["",""],"","",["star"],3,26,15,0],"2b55":[["",""],"","",["o"],3,27,15,0],3030:[["",""],"","",["wavy_dash"],3,28,15,0],"303d":[["",""],"","",["part_alternation_mark"],3,29,15,0],3297:[["",""],"","",["congratulations"],3,30,15,0],3299:[["",""],"","",["secret"],3,31,15,0],"1f004":[["",""],"","",["mahjong"],3,32,15,0],"1f0cf":[[""],"","",["black_joker"],3,33,15,0],"1f170":[["",""],"","",["a"],3,34,15,0],"1f171":[["",""],"","",["b"],4,0,15,0],"1f17e":[["",""],"","",["o2"],4,1,15,0],"1f17f":[["",""],"","",["parking"],4,2,15,0],"1f18e":[[""],"","",["ab"],4,3,15,0],"1f191":[[""],"","",["cl"],4,4,15,0],"1f192":[[""],"","",["cool"],4,5,15,0],"1f193":[[""],"","",["free"],4,6,15,0],"1f194":[[""],"","",["id"],4,7,15,0],"1f195":[[""],"","",["new"],4,8,15,0],"1f196":[[""],"","",["ng"],4,9,15,0],"1f197":[[""],"","",["ok"],4,10,15,0],"1f198":[[""],"","",["sos"],4,11,15,0],"1f199":[[""],"","",["up"],4,12,15,0],"1f19a":[[""],"","",["vs"],4,13,15,0],"1f201":[[""],"","",["koko"],4,14,15,0],"1f202":[["",""],"","",["sa"],4,15,15,0],"1f21a":[["",""],"","",["u7121"],4,16,15,0],"1f22f":[["",""],"","",["u6307"],4,17,15,0],"1f232":[[""],"","",["u7981"],4,18,15,0],"1f233":[[""],"","",["u7a7a"],4,19,15,0],"1f234":[[""],"","",["u5408"],4,20,15,0],"1f235":[[""],"","",["u6e80"],4,21,15,0],"1f236":[[""],"","",["u6709"],4,22,15,0],"1f237":[["",""],"","",["u6708"],4,23,15,0],"1f238":[[""],"","",["u7533"],4,24,15,0],"1f239":[[""],"","",["u5272"],4,25,15,0],"1f23a":[[""],"","",["u55b6"],4,26,15,0],"1f250":[[""],"","",["ideograph_advantage"],4,27,15,0],"1f251":[[""],"","",["accept"],4,28,15,0],"1f300":[[""],"","",["cyclone"],4,29,15,0],"1f301":[[""],"","",["foggy"],4,30,15,0],"1f302":[[""],"","",["closed_umbrella"],4,31,15,0],"1f303":[[""],"","",["night_with_stars"],4,32,15,0],"1f304":[[""],"","",["sunrise_over_mountains"],4,33,15,0],"1f305":[[""],"","",["sunrise"],4,34,15,0],"1f306":[[""],"","",["city_sunset"],5,0,15,0],"1f307":[[""],"","",["city_sunrise"],5,1,15,0],"1f308":[[""],"","",["rainbow"],5,2,15,0],"1f309":[[""],"","",["bridge_at_night"],5,3,15,0],"1f30a":[[""],"","",["ocean"],5,4,15,0],"1f30b":[[""],"","",["volcano"],5,5,15,0],"1f30c":[[""],"","",["milky_way"],5,6,15,0],"1f30d":[[""],"","",["earth_africa"],5,7,15,0],"1f30e":[[""],"","",["earth_americas"],5,8,15,0],"1f30f":[[""],"","",["earth_asia"],5,9,15,0],"1f310":[[""],"","",["globe_with_meridians"],5,10,15,0],"1f311":[[""],"","",["new_moon"],5,11,15,0],"1f312":[[""],"","",["waxing_crescent_moon"],5,12,15,0],"1f313":[[""],"","",["first_quarter_moon"],5,13,15,0],"1f314":[[""],"","",["moon","waxing_gibbous_moon"],5,14,15,0],"1f315":[[""],"","",["full_moon"],5,15,15,0],"1f316":[[""],"","",["waning_gibbous_moon"],5,16,15,0],"1f317":[[""],"","",["last_quarter_moon"],5,17,15,0],"1f318":[[""],"","",["waning_crescent_moon"],5,18,15,0],"1f319":[[""],"","",["crescent_moon"],5,19,15,0],"1f31a":[[""],"","",["new_moon_with_face"],5,20,15,0],"1f31b":[[""],"","",["first_quarter_moon_with_face"],5,21,15,0],"1f31c":[[""],"","",["last_quarter_moon_with_face"],5,22,15,0],"1f31d":[[""],"","",["full_moon_with_face"],5,23,15,0],"1f31e":[[""],"","",["sun_with_face"],5,24,15,0],"1f31f":[[""],"","",["star2"],5,25,15,0],"1f320":[[""],"","",["stars"],5,26,15,0],"1f330":[[""],"","",["chestnut"],5,27,15,0],"1f331":[[""],"","",["seedling"],5,28,15,0],"1f332":[[""],"","",["evergreen_tree"],5,29,15,0],"1f333":[[""],"","",["deciduous_tree"],5,30,15,0],"1f334":[[""],"","",["palm_tree"],5,31,15,0],"1f335":[[""],"","",["cactus"],5,32,15,0],"1f337":[[""],"","",["tulip"],5,33,15,0],"1f338":[[""],"","",["cherry_blossom"],5,34,15,0],"1f339":[[""],"","",["rose"],6,0,15,0],"1f33a":[[""],"","",["hibiscus"],6,1,15,0],"1f33b":[[""],"","",["sunflower"],6,2,15,0],"1f33c":[[""],"","",["blossom"],6,3,15,0],"1f33d":[[""],"","",["corn"],6,4,15,0],"1f33e":[[""],"","",["ear_of_rice"],6,5,15,0],"1f33f":[[""],"","",["herb"],6,6,15,0],"1f340":[[""],"","",["four_leaf_clover"],6,7,15,0],"1f341":[[""],"","",["maple_leaf"],6,8,15,0],"1f342":[[""],"","",["fallen_leaf"],6,9,15,0],"1f343":[[""],"","",["leaves"],6,10,15,0],"1f344":[[""],"","",["mushroom"],6,11,15,0],"1f345":[[""],"","",["tomato"],6,12,15,0],"1f346":[[""],"","",["eggplant"],6,13,15,0],"1f347":[[""],"","",["grapes"],6,14,15,0],"1f348":[[""],"","",["melon"],6,15,15,0],"1f349":[[""],"","",["watermelon"],6,16,15,0],"1f34a":[[""],"","",["tangerine"],6,17,15,0],"1f34b":[[""],"","",["lemon"],6,18,15,0],"1f34c":[[""],"","",["banana"],6,19,15,0],"1f34d":[[""],"","",["pineapple"],6,20,15,0],"1f34e":[[""],"","",["apple"],6,21,15,0],"1f34f":[[""],"","",["green_apple"],6,22,15,0],"1f350":[[""],"","",["pear"],6,23,15,0],"1f351":[[""],"","",["peach"],6,24,15,0],"1f352":[[""],"","",["cherries"],6,25,15,0],"1f353":[[""],"","",["strawberry"],6,26,15,0],"1f354":[[""],"","",["hamburger"],6,27,15,0],"1f355":[[""],"","",["pizza"],6,28,15,0],"1f356":[[""],"","",["meat_on_bone"],6,29,15,0],"1f357":[[""],"","",["poultry_leg"],6,30,15,0],"1f358":[[""],"","",["rice_cracker"],6,31,15,0],"1f359":[[""],"","",["rice_ball"],6,32,15,0],"1f35a":[[""],"","",["rice"],6,33,15,0],"1f35b":[[""],"","",["curry"],6,34,15,0],"1f35c":[[""],"","",["ramen"],7,0,15,0],"1f35d":[[""],"","",["spaghetti"],7,1,15,0],"1f35e":[[""],"","",["bread"],7,2,15,0],"1f35f":[[""],"","",["fries"],7,3,15,0],"1f360":[[""],"","",["sweet_potato"],7,4,15,0],"1f361":[[""],"","",["dango"],7,5,15,0],"1f362":[[""],"","",["oden"],7,6,15,0],"1f363":[[""],"","",["sushi"],7,7,15,0],"1f364":[[""],"","",["fried_shrimp"],7,8,15,0],"1f365":[[""],"","",["fish_cake"],7,9,15,0],"1f366":[[""],"","",["icecream"],7,10,15,0],"1f367":[[""],"","",["shaved_ice"],7,11,15,0],"1f368":[[""],"","",["ice_cream"],7,12,15,0],"1f369":[[""],"","",["doughnut"],7,13,15,0],"1f36a":[[""],"","",["cookie"],7,14,15,0],"1f36b":[[""],"","",["chocolate_bar"],7,15,15,0],"1f36c":[[""],"","",["candy"],7,16,15,0],"1f36d":[[""],"","",["lollipop"],7,17,15,0],"1f36e":[[""],"","",["custard"],7,18,15,0],"1f36f":[[""],"","",["honey_pot"],7,19,15,0],"1f370":[[""],"","",["cake"],7,20,15,0],"1f371":[[""],"","",["bento"],7,21,15,0],"1f372":[[""],"","",["stew"],7,22,15,0],"1f373":[[""],"","",["egg"],7,23,15,0],"1f374":[[""],"","",["fork_and_knife"],7,24,15,0],"1f375":[[""],"","",["tea"],7,25,15,0],"1f376":[[""],"","",["sake"],7,26,15,0],"1f377":[[""],"","",["wine_glass"],7,27,15,0],"1f378":[[""],"","",["cocktail"],7,28,15,0],"1f379":[[""],"","",["tropical_drink"],7,29,15,0],"1f37a":[[""],"","",["beer"],7,30,15,0],"1f37b":[[""],"","",["beers"],7,31,15,0],"1f37c":[[""],"","",["baby_bottle"],7,32,15,0],"1f380":[[""],"","",["ribbon"],7,33,15,0],"1f381":[[""],"","",["gift"],7,34,15,0],"1f382":[[""],"","",["birthday"],8,0,15,0],"1f383":[[""],"","",["jack_o_lantern"],8,1,15,0],"1f384":[[""],"","",["christmas_tree"],8,2,15,0],"1f385":[[""],"","",["santa"],8,3,15,0],"1f386":[[""],"","",["fireworks"],8,9,15,0],"1f387":[[""],"","",["sparkler"],8,10,15,0],"1f388":[[""],"","",["balloon"],8,11,15,0],"1f389":[[""],"","",["tada"],8,12,15,0],"1f38a":[[""],"","",["confetti_ball"],8,13,15,0],"1f38b":[[""],"","",["tanabata_tree"],8,14,15,0],"1f38c":[[""],"","",["crossed_flags"],8,15,15,0],"1f38d":[[""],"","",["bamboo"],8,16,15,0],"1f38e":[[""],"","",["dolls"],8,17,15,0],"1f38f":[[""],"","",["flags"],8,18,15,0],"1f390":[[""],"","",["wind_chime"],8,19,15,0],"1f391":[[""],"","",["rice_scene"],8,20,15,0],"1f392":[[""],"","",["school_satchel"],8,21,15,0],"1f393":[[""],"","",["mortar_board"],8,22,15,0],"1f3a0":[[""],"","",["carousel_horse"],8,23,15,0],"1f3a1":[[""],"","",["ferris_wheel"],8,24,15,0],"1f3a2":[[""],"","",["roller_coaster"],8,25,15,0],"1f3a3":[[""],"","",["fishing_pole_and_fish"],8,26,15,0],"1f3a4":[[""],"","",["microphone"],8,27,15,0],"1f3a5":[[""],"","",["movie_camera"],8,28,15,0],"1f3a6":[[""],"","",["cinema"],8,29,15,0],"1f3a7":[[""],"","",["headphones"],8,30,15,0],"1f3a8":[[""],"","",["art"],8,31,15,0],"1f3a9":[[""],"","",["tophat"],8,32,15,0],"1f3aa":[[""],"","",["circus_tent"],8,33,15,0],"1f3ab":[[""],"","",["ticket"],8,34,15,0],"1f3ac":[[""],"","",["clapper"],9,0,15,0],"1f3ad":[[""],"","",["performing_arts"],9,1,15,0],"1f3ae":[[""],"","",["video_game"],9,2,15,0],"1f3af":[[""],"","",["dart"],9,3,15,0],"1f3b0":[[""],"","",["slot_machine"],9,4,15,0],"1f3b1":[[""],"","",["8ball"],9,5,15,0],"1f3b2":[[""],"","",["game_die"],9,6,15,0],"1f3b3":[[""],"","",["bowling"],9,7,15,0],"1f3b4":[[""],"","",["flower_playing_cards"],9,8,15,0],"1f3b5":[[""],"","",["musical_note"],9,9,15,0],"1f3b6":[[""],"","",["notes"],9,10,15,0],"1f3b7":[[""],"","",["saxophone"],9,11,15,0],"1f3b8":[[""],"","",["guitar"],9,12,15,0],"1f3b9":[[""],"","",["musical_keyboard"],9,13,15,0],"1f3ba":[[""],"","",["trumpet"],9,14,15,0],"1f3bb":[[""],"","",["violin"],9,15,15,0],"1f3bc":[[""],"","",["musical_score"],9,16,15,0],"1f3bd":[[""],"","",["running_shirt_with_sash"],9,17,15,0],"1f3be":[[""],"","",["tennis"],9,18,15,0],"1f3bf":[[""],"","",["ski"],9,19,15,0],"1f3c0":[[""],"","",["basketball"],9,20,15,0],"1f3c1":[[""],"","",["checkered_flag"],9,21,15,0],"1f3c2":[[""],"","",["snowboarder"],9,22,15,0],"1f3c3":[[""],"","",["runner","running"],9,23,15,0],"1f3c4":[[""],"","",["surfer"],9,29,15,0],"1f3c6":[[""],"","",["trophy"],10,0,15,0],"1f3c7":[[""],"","",["horse_racing"],10,1,15,0],"1f3c8":[[""],"","",["football"],10,7,15,0],"1f3c9":[[""],"","",["rugby_football"],10,8,15,0],"1f3ca":[[""],"","",["swimmer"],10,9,15,0],"1f3e0":[[""],"","",["house"],10,15,15,0],"1f3e1":[[""],"","",["house_with_garden"],10,16,15,0],"1f3e2":[[""],"","",["office"],10,17,15,0],"1f3e3":[[""],"","",["post_office"],10,18,15,0],"1f3e4":[[""],"","",["european_post_office"],10,19,15,0],"1f3e5":[[""],"","",["hospital"],10,20,15,0],"1f3e6":[[""],"","",["bank"],10,21,15,0],"1f3e7":[[""],"","",["atm"],10,22,15,0],"1f3e8":[[""],"","",["hotel"],10,23,15,0],"1f3e9":[[""],"","",["love_hotel"],10,24,15,0],"1f3ea":[[""],"","",["convenience_store"],10,25,15,0],"1f3eb":[[""],"","",["school"],10,26,15,0],"1f3ec":[[""],"","",["department_store"],10,27,15,0],"1f3ed":[[""],"","",["factory"],10,28,15,0],"1f3ee":[[""],"","",["izakaya_lantern","lantern"],10,29,15,0],"1f3ef":[[""],"","",["japanese_castle"],10,30,15,0],"1f3f0":[[""],"","",["european_castle"],10,31,15,0],"1f3fb":[[""],"","",["skin-tone-2"],10,32,1,0],"1f3fc":[[""],"","",["skin-tone-3"],10,33,1,0],"1f3fd":[[""],"","",["skin-tone-4"],10,34,1,0],"1f3fe":[[""],"","",["skin-tone-5"],11,0,1,0],"1f3ff":[[""],"","",["skin-tone-6"],11,1,1,0],"1f400":[[""],"","",["rat"],11,2,15,0],"1f401":[[""],"","",["mouse2"],11,3,15,0],"1f402":[[""],"","",["ox"],11,4,15,0],"1f403":[[""],"","",["water_buffalo"],11,5,15,0],"1f404":[[""],"","",["cow2"],11,6,15,0],"1f405":[[""],"","",["tiger2"],11,7,15,0],"1f406":[[""],"","",["leopard"],11,8,15,0],"1f407":[[""],"","",["rabbit2"],11,9,15,0],"1f408":[[""],"","",["cat2"],11,10,15,0],"1f409":[[""],"","",["dragon"],11,11,15,0],"1f40a":[[""],"","",["crocodile"],11,12,15,0],"1f40b":[[""],"","",["whale2"],11,13,15,0],"1f40c":[[""],"","",["snail"],11,14,15,0],"1f40d":[[""],"","",["snake"],11,15,15,0],"1f40e":[[""],"","",["racehorse"],11,16,15,0],"1f40f":[[""],"","",["ram"],11,17,15,0],"1f410":[[""],"","",["goat"],11,18,15,0],"1f411":[[""],"","",["sheep"],11,19,15,0],"1f412":[[""],"","",["monkey"],11,20,15,0],"1f413":[[""],"","",["rooster"],11,21,15,0],"1f414":[[""],"","",["chicken"],11,22,15,0],"1f415":[[""],"","",["dog2"],11,23,15,0],"1f416":[[""],"","",["pig2"],11,24,15,0],"1f417":[[""],"","",["boar"],11,25,15,0],"1f418":[[""],"","",["elephant"],11,26,15,0],"1f419":[[""],"","",["octopus"],11,27,15,0],"1f41a":[[""],"","",["shell"],11,28,15,0],"1f41b":[[""],"","",["bug"],11,29,15,0],"1f41c":[[""],"","",["ant"],11,30,15,0],"1f41d":[[""],"","",["bee","honeybee"],11,31,15,0],"1f41e":[[""],"","",["beetle"],11,32,15,0],"1f41f":[[""],"","",["fish"],11,33,15,0],"1f420":[[""],"","",["tropical_fish"],11,34,15,0],"1f421":[[""],"","",["blowfish"],12,0,15,0],"1f422":[[""],"","",["turtle"],12,1,15,0],"1f423":[[""],"","",["hatching_chick"],12,2,15,0],"1f424":[[""],"","",["baby_chick"],12,3,15,0],"1f425":[[""],"","",["hatched_chick"],12,4,15,0],"1f426":[[""],"","",["bird"],12,5,15,0],"1f427":[[""],"","",["penguin"],12,6,15,0],"1f428":[[""],"","",["koala"],12,7,15,0],"1f429":[[""],"","",["poodle"],12,8,15,0],"1f42a":[[""],"","",["dromedary_camel"],12,9,15,0],"1f42b":[[""],"","",["camel"],12,10,15,0],"1f42c":[[""],"","",["dolphin","flipper"],12,11,15,0],"1f42d":[[""],"","",["mouse"],12,12,15,0],"1f42e":[[""],"","",["cow"],12,13,15,0],"1f42f":[[""],"","",["tiger"],12,14,15,0],"1f430":[[""],"","",["rabbit"],12,15,15,0],"1f431":[[""],"","",["cat"],12,16,15,0],"1f432":[[""],"","",["dragon_face"],12,17,15,0],"1f433":[[""],"","",["whale"],12,18,15,0],"1f434":[[""],"","",["horse"],12,19,15,0],
"1f435":[[""],"","",["monkey_face"],12,20,15,0],"1f436":[[""],"","",["dog"],12,21,15,0],"1f437":[[""],"","",["pig"],12,22,15,0],"1f438":[[""],"","",["frog"],12,23,15,0],"1f439":[[""],"","",["hamster"],12,24,15,0],"1f43a":[[""],"","",["wolf"],12,25,15,0],"1f43b":[[""],"","",["bear"],12,26,15,0],"1f43c":[[""],"","",["panda_face"],12,27,15,0],"1f43d":[[""],"","",["pig_nose"],12,28,15,0],"1f43e":[[""],"","",["feet","paw_prints"],12,29,15,0],"1f440":[[""],"","",["eyes"],12,30,15,0],"1f442":[[""],"","",["ear"],12,31,15,0],"1f443":[[""],"","",["nose"],13,2,15,0],"1f444":[[""],"","",["lips"],13,8,15,0],"1f445":[[""],"","",["tongue"],13,9,15,0],"1f446":[[""],"","",["point_up_2"],13,10,15,0],"1f447":[[""],"","",["point_down"],13,16,15,0],"1f448":[[""],"","",["point_left"],13,22,15,0],"1f449":[[""],"","",["point_right"],13,28,15,0],"1f44a":[[""],"","",["facepunch","punch"],13,34,15,0],"1f44b":[[""],"","",["wave"],14,5,15,0],"1f44c":[[""],"","",["ok_hand"],14,11,15,0],"1f44d":[[""],"","",["+1","thumbsup"],14,17,15,0],"1f44e":[[""],"","",["-1","thumbsdown"],14,23,15,0],"1f44f":[[""],"","",["clap"],14,29,15,0],"1f450":[[""],"","",["open_hands"],15,0,15,0],"1f451":[[""],"","",["crown"],15,6,15,0],"1f452":[[""],"","",["womans_hat"],15,7,15,0],"1f453":[[""],"","",["eyeglasses"],15,8,15,0],"1f454":[[""],"","",["necktie"],15,9,15,0],"1f455":[[""],"","",["shirt","tshirt"],15,10,15,0],"1f456":[[""],"","",["jeans"],15,11,15,0],"1f457":[[""],"","",["dress"],15,12,15,0],"1f458":[[""],"","",["kimono"],15,13,15,0],"1f459":[[""],"","",["bikini"],15,14,15,0],"1f45a":[[""],"","",["womans_clothes"],15,15,15,0],"1f45b":[[""],"","",["purse"],15,16,15,0],"1f45c":[[""],"","",["handbag"],15,17,15,0],"1f45d":[[""],"","",["pouch"],15,18,15,0],"1f45e":[[""],"","",["mans_shoe","shoe"],15,19,15,0],"1f45f":[[""],"","",["athletic_shoe"],15,20,15,0],"1f460":[[""],"","",["high_heel"],15,21,15,0],"1f461":[[""],"","",["sandal"],15,22,15,0],"1f462":[[""],"","",["boot"],15,23,15,0],"1f463":[[""],"","",["footprints"],15,24,15,0],"1f464":[[""],"","",["bust_in_silhouette"],15,25,15,0],"1f465":[[""],"","",["busts_in_silhouette"],15,26,15,0],"1f466":[[""],"","",["boy"],15,27,15,0],"1f467":[[""],"","",["girl"],15,33,15,0],"1f468":[[""],"","",["man"],16,4,15,0],"1f469":[[""],"","",["woman"],16,10,15,0],"1f46a":[[""],"","",["family"],16,16,15,0],"1f46b":[[""],"","",["couple"],16,17,15,0],"1f46c":[[""],"","",["two_men_holding_hands"],16,18,15,0],"1f46d":[[""],"","",["two_women_holding_hands"],16,19,15,0],"1f46e":[[""],"","",["cop"],16,20,15,0],"1f46f":[[""],"","",["dancers"],16,26,15,0],"1f470":[[""],"","",["bride_with_veil"],16,27,15,0],"1f471":[[""],"","",["person_with_blond_hair"],16,33,15,0],"1f472":[[""],"","",["man_with_gua_pi_mao"],17,4,15,0],"1f473":[[""],"","",["man_with_turban"],17,10,15,0],"1f474":[[""],"","",["older_man"],17,16,15,0],"1f475":[[""],"","",["older_woman"],17,22,15,0],"1f476":[[""],"","",["baby"],17,28,15,0],"1f477":[[""],"","",["construction_worker"],17,34,15,0],"1f478":[[""],"","",["princess"],18,5,15,0],"1f479":[[""],"","",["japanese_ogre"],18,11,15,0],"1f47a":[[""],"","",["japanese_goblin"],18,12,15,0],"1f47b":[[""],"","",["ghost"],18,13,15,0],"1f47c":[[""],"","",["angel"],18,14,15,0],"1f47d":[[""],"","",["alien"],18,20,15,0],"1f47e":[[""],"","",["space_invader"],18,21,15,0],"1f47f":[[""],"","",["imp"],18,22,15,0],"1f480":[[""],"","",["skull"],18,23,15,0],"1f481":[[""],"","",["information_desk_person"],18,24,15,0],"1f482":[[""],"","",["guardsman"],18,30,15,0],"1f483":[[""],"","",["dancer"],19,1,15,0],"1f484":[[""],"","",["lipstick"],19,7,15,0],"1f485":[[""],"","",["nail_care"],19,8,15,0],"1f486":[[""],"","",["massage"],19,14,15,0],"1f487":[[""],"","",["haircut"],19,20,15,0],"1f488":[[""],"","",["barber"],19,26,15,0],"1f489":[[""],"","",["syringe"],19,27,15,0],"1f48a":[[""],"","",["pill"],19,28,15,0],"1f48b":[[""],"","",["kiss"],19,29,15,0],"1f48c":[[""],"","",["love_letter"],19,30,15,0],"1f48d":[[""],"","",["ring"],19,31,15,0],"1f48e":[[""],"","",["gem"],19,32,15,0],"1f48f":[[""],"","",["couplekiss"],19,33,15,0],"1f490":[[""],"","",["bouquet"],19,34,15,0],"1f491":[[""],"","",["couple_with_heart"],20,0,15,0],"1f492":[[""],"","",["wedding"],20,1,15,0],"1f493":[[""],"","",["heartbeat"],20,2,15,0],"1f494":[[""],"","",["broken_heart"],20,3,15,0,"</3"],"1f495":[[""],"","",["two_hearts"],20,4,15,0],"1f496":[[""],"","",["sparkling_heart"],20,5,15,0],"1f497":[[""],"","",["heartpulse"],20,6,15,0],"1f498":[[""],"","",["cupid"],20,7,15,0],"1f499":[[""],"","",["blue_heart"],20,8,15,0,"<3"],"1f49a":[[""],"","",["green_heart"],20,9,15,0,"<3"],"1f49b":[[""],"","",["yellow_heart"],20,10,15,0,"<3"],"1f49c":[[""],"","",["purple_heart"],20,11,15,0,"<3"],"1f49d":[[""],"","",["gift_heart"],20,12,15,0],"1f49e":[[""],"","",["revolving_hearts"],20,13,15,0],"1f49f":[[""],"","",["heart_decoration"],20,14,15,0],"1f4a0":[[""],"","",["diamond_shape_with_a_dot_inside"],20,15,15,0],"1f4a1":[[""],"","",["bulb"],20,16,15,0],"1f4a2":[[""],"","",["anger"],20,17,15,0],"1f4a3":[[""],"","",["bomb"],20,18,15,0],"1f4a4":[[""],"","",["zzz"],20,19,15,0],"1f4a5":[[""],"","",["boom","collision"],20,20,15,0],"1f4a6":[[""],"","",["sweat_drops"],20,21,15,0],"1f4a7":[[""],"","",["droplet"],20,22,15,0],"1f4a8":[[""],"","",["dash"],20,23,15,0],"1f4a9":[[""],"","",["hankey","poop","shit"],20,24,15,0],"1f4aa":[[""],"","",["muscle"],20,25,15,0],"1f4ab":[[""],"","",["dizzy"],20,31,15,0],"1f4ac":[[""],"","",["speech_balloon"],20,32,15,0],"1f4ad":[[""],"","",["thought_balloon"],20,33,15,0],"1f4ae":[[""],"","",["white_flower"],20,34,15,0],"1f4af":[[""],"","",["100"],21,0,15,0],"1f4b0":[[""],"","",["moneybag"],21,1,15,0],"1f4b1":[[""],"","",["currency_exchange"],21,2,15,0],"1f4b2":[[""],"","",["heavy_dollar_sign"],21,3,15,0],"1f4b3":[[""],"","",["credit_card"],21,4,15,0],"1f4b4":[[""],"","",["yen"],21,5,15,0],"1f4b5":[[""],"","",["dollar"],21,6,15,0],"1f4b6":[[""],"","",["euro"],21,7,15,0],"1f4b7":[[""],"","",["pound"],21,8,15,0],"1f4b8":[[""],"","",["money_with_wings"],21,9,15,0],"1f4b9":[[""],"","",["chart"],21,10,15,0],"1f4ba":[[""],"","",["seat"],21,11,15,0],"1f4bb":[[""],"","",["computer"],21,12,15,0],"1f4bc":[[""],"","",["briefcase"],21,13,15,0],"1f4bd":[[""],"","",["minidisc"],21,14,15,0],"1f4be":[[""],"","",["floppy_disk"],21,15,15,0],"1f4bf":[[""],"","",["cd"],21,16,15,0],"1f4c0":[[""],"","",["dvd"],21,17,15,0],"1f4c1":[[""],"","",["file_folder"],21,18,15,0],"1f4c2":[[""],"","",["open_file_folder"],21,19,15,0],"1f4c3":[[""],"","",["page_with_curl"],21,20,15,0],"1f4c4":[[""],"","",["page_facing_up"],21,21,15,0],"1f4c5":[[""],"","",["date"],21,22,15,0],"1f4c6":[[""],"","",["calendar"],21,23,15,0],"1f4c7":[[""],"","",["card_index"],21,24,15,0],"1f4c8":[[""],"","",["chart_with_upwards_trend"],21,25,15,0],"1f4c9":[[""],"","",["chart_with_downwards_trend"],21,26,15,0],"1f4ca":[[""],"","",["bar_chart"],21,27,15,0],"1f4cb":[[""],"","",["clipboard"],21,28,15,0],"1f4cc":[[""],"","",["pushpin"],21,29,15,0],"1f4cd":[[""],"","",["round_pushpin"],21,30,15,0],"1f4ce":[[""],"","",["paperclip"],21,31,15,0],"1f4cf":[[""],"","",["straight_ruler"],21,32,15,0],"1f4d0":[[""],"","",["triangular_ruler"],21,33,15,0],"1f4d1":[[""],"","",["bookmark_tabs"],21,34,15,0],"1f4d2":[[""],"","",["ledger"],22,0,15,0],"1f4d3":[[""],"","",["notebook"],22,1,15,0],"1f4d4":[[""],"","",["notebook_with_decorative_cover"],22,2,15,0],"1f4d5":[[""],"","",["closed_book"],22,3,15,0],"1f4d6":[[""],"","",["book","open_book"],22,4,15,0],"1f4d7":[[""],"","",["green_book"],22,5,15,0],"1f4d8":[[""],"","",["blue_book"],22,6,15,0],"1f4d9":[[""],"","",["orange_book"],22,7,15,0],"1f4da":[[""],"","",["books"],22,8,15,0],"1f4db":[[""],"","",["name_badge"],22,9,15,0],"1f4dc":[[""],"","",["scroll"],22,10,15,0],"1f4dd":[[""],"","",["memo","pencil"],22,11,15,0],"1f4de":[[""],"","",["telephone_receiver"],22,12,15,0],"1f4df":[[""],"","",["pager"],22,13,15,0],"1f4e0":[[""],"","",["fax"],22,14,15,0],"1f4e1":[[""],"","",["satellite"],22,15,15,0],"1f4e2":[[""],"","",["loudspeaker"],22,16,15,0],"1f4e3":[[""],"","",["mega"],22,17,15,0],"1f4e4":[[""],"","",["outbox_tray"],22,18,15,0],"1f4e5":[[""],"","",["inbox_tray"],22,19,15,0],"1f4e6":[[""],"","",["package"],22,20,15,0],"1f4e7":[[""],"","",["e-mail"],22,21,15,0],"1f4e8":[[""],"","",["incoming_envelope"],22,22,15,0],"1f4e9":[[""],"","",["envelope_with_arrow"],22,23,15,0],"1f4ea":[[""],"","",["mailbox_closed"],22,24,15,0],"1f4eb":[[""],"","",["mailbox"],22,25,15,0],"1f4ec":[[""],"","",["mailbox_with_mail"],22,26,15,0],"1f4ed":[[""],"","",["mailbox_with_no_mail"],22,27,15,0],"1f4ee":[[""],"","",["postbox"],22,28,15,0],"1f4ef":[[""],"","",["postal_horn"],22,29,15,0],"1f4f0":[[""],"","",["newspaper"],22,30,15,0],"1f4f1":[[""],"","",["iphone"],22,31,15,0],"1f4f2":[[""],"","",["calling"],22,32,15,0],"1f4f3":[[""],"","",["vibration_mode"],22,33,15,0],"1f4f4":[[""],"","",["mobile_phone_off"],22,34,15,0],"1f4f5":[[""],"","",["no_mobile_phones"],23,0,15,0],"1f4f6":[[""],"","",["signal_strength"],23,1,15,0],"1f4f7":[[""],"","",["camera"],23,2,15,0],"1f4f9":[[""],"","",["video_camera"],23,3,15,0],"1f4fa":[[""],"","",["tv"],23,4,15,0],"1f4fb":[[""],"","",["radio"],23,5,15,0],"1f4fc":[[""],"","",["vhs"],23,6,15,0],"1f500":[[""],"","",["twisted_rightwards_arrows"],23,7,15,0],"1f501":[[""],"","",["repeat"],23,8,15,0],"1f502":[[""],"","",["repeat_one"],23,9,15,0],"1f503":[[""],"","",["arrows_clockwise"],23,10,15,0],"1f504":[[""],"","",["arrows_counterclockwise"],23,11,15,0],"1f505":[[""],"","",["low_brightness"],23,12,15,0],"1f506":[[""],"","",["high_brightness"],23,13,15,0],"1f507":[[""],"","",["mute"],23,14,15,0],"1f508":[[""],"","",["speaker"],23,15,15,0],"1f509":[[""],"","",["sound"],23,16,15,0],"1f50a":[[""],"","",["loud_sound"],23,17,15,0],"1f50b":[[""],"","",["battery"],23,18,15,0],"1f50c":[[""],"","",["electric_plug"],23,19,15,0],"1f50d":[[""],"","",["mag"],23,20,15,0],"1f50e":[[""],"","",["mag_right"],23,21,15,0],"1f50f":[[""],"","",["lock_with_ink_pen"],23,22,15,0],"1f510":[[""],"","",["closed_lock_with_key"],23,23,15,0],"1f511":[[""],"","",["key"],23,24,15,0],"1f512":[[""],"","",["lock"],23,25,15,0],"1f513":[[""],"","",["unlock"],23,26,15,0],"1f514":[[""],"","",["bell"],23,27,15,0],"1f515":[[""],"","",["no_bell"],23,28,15,0],"1f516":[[""],"","",["bookmark"],23,29,15,0],"1f517":[[""],"","",["link"],23,30,15,0],"1f518":[[""],"","",["radio_button"],23,31,15,0],"1f519":[[""],"","",["back"],23,32,15,0],"1f51a":[[""],"","",["end"],23,33,15,0],"1f51b":[[""],"","",["on"],23,34,15,0],"1f51c":[[""],"","",["soon"],24,0,15,0],"1f51d":[[""],"","",["top"],24,1,15,0],"1f51e":[[""],"","",["underage"],24,2,15,0],"1f51f":[[""],"","",["keycap_ten"],24,3,15,0],"1f520":[[""],"","",["capital_abcd"],24,4,15,0],"1f521":[[""],"","",["abcd"],24,5,15,0],"1f522":[[""],"","",["1234"],24,6,15,0],"1f523":[[""],"","",["symbols"],24,7,15,0],"1f524":[[""],"","",["abc"],24,8,15,0],"1f525":[[""],"","",["fire"],24,9,15,0],"1f526":[[""],"","",["flashlight"],24,10,15,0],"1f527":[[""],"","",["wrench"],24,11,15,0],"1f528":[[""],"","",["hammer"],24,12,15,0],"1f529":[[""],"","",["nut_and_bolt"],24,13,15,0],"1f52a":[[""],"","",["hocho","knife"],24,14,15,0],"1f52b":[[""],"","",["gun"],24,15,15,0],"1f52c":[[""],"","",["microscope"],24,16,15,0],"1f52d":[[""],"","",["telescope"],24,17,15,0],"1f52e":[[""],"","",["crystal_ball"],24,18,15,0],"1f52f":[[""],"","",["six_pointed_star"],24,19,15,0],"1f530":[[""],"","",["beginner"],24,20,15,0],"1f531":[[""],"","",["trident"],24,21,15,0],"1f532":[[""],"","",["black_square_button"],24,22,15,0],"1f533":[[""],"","",["white_square_button"],24,23,15,0],"1f534":[[""],"","",["red_circle"],24,24,15,0],"1f535":[[""],"","",["large_blue_circle"],24,25,15,0],"1f536":[[""],"","",["large_orange_diamond"],24,26,15,0],"1f537":[[""],"","",["large_blue_diamond"],24,27,15,0],"1f538":[[""],"","",["small_orange_diamond"],24,28,15,0],"1f539":[[""],"","",["small_blue_diamond"],24,29,15,0],"1f53a":[[""],"","",["small_red_triangle"],24,30,15,0],"1f53b":[[""],"","",["small_red_triangle_down"],24,31,15,0],"1f53c":[[""],"","",["arrow_up_small"],24,32,15,0],"1f53d":[[""],"","",["arrow_down_small"],24,33,15,0],"1f550":[[""],"","",["clock1"],24,34,15,0],"1f551":[[""],"","",["clock2"],25,0,15,0],"1f552":[[""],"","",["clock3"],25,1,15,0],"1f553":[[""],"","",["clock4"],25,2,15,0],"1f554":[[""],"","",["clock5"],25,3,15,0],"1f555":[[""],"","",["clock6"],25,4,15,0],"1f556":[[""],"","",["clock7"],25,5,15,0],"1f557":[[""],"","",["clock8"],25,6,15,0],"1f558":[[""],"","",["clock9"],25,7,15,0],"1f559":[[""],"","",["clock10"],25,8,15,0],"1f55a":[[""],"","",["clock11"],25,9,15,0],"1f55b":[[""],"","",["clock12"],25,10,15,0],"1f55c":[[""],"","",["clock130"],25,11,15,0],"1f55d":[[""],"","",["clock230"],25,12,15,0],"1f55e":[[""],"","",["clock330"],25,13,15,0],"1f55f":[[""],"","",["clock430"],25,14,15,0],"1f560":[[""],"","",["clock530"],25,15,15,0],"1f561":[[""],"","",["clock630"],25,16,15,0],"1f562":[[""],"","",["clock730"],25,17,15,0],"1f563":[[""],"","",["clock830"],25,18,15,0],"1f564":[[""],"","",["clock930"],25,19,15,0],"1f565":[[""],"","",["clock1030"],25,20,15,0],"1f566":[[""],"","",["clock1130"],25,21,15,0],"1f567":[[""],"","",["clock1230"],25,22,15,0],"1f5fb":[[""],"","",["mount_fuji"],25,23,15,0],"1f5fc":[[""],"","",["tokyo_tower"],25,24,15,0],"1f5fd":[[""],"","",["statue_of_liberty"],25,25,15,0],"1f5fe":[[""],"","",["japan"],25,26,15,0],"1f5ff":[[""],"","",["moyai"],25,27,15,0],"1f600":[[""],"","",["grinning"],25,28,15,0,":D"],"1f601":[[""],"","",["grin"],25,29,15,0],"1f602":[[""],"","",["joy"],25,30,15,0],"1f603":[[""],"","",["smiley"],25,31,15,0,":)"],"1f604":[[""],"","",["smile"],25,32,15,0,":)"],"1f605":[[""],"","",["sweat_smile"],25,33,15,0],"1f606":[[""],"","",["laughing","satisfied"],25,34,15,0],"1f607":[[""],"","",["innocent"],26,0,15,0],"1f608":[[""],"","",["smiling_imp"],26,1,15,0],"1f609":[[""],"","",["wink"],26,2,15,0,";)"],"1f60a":[[""],"","",["blush"],26,3,15,0,":)"],"1f60b":[[""],"","",["yum"],26,4,15,0],"1f60c":[[""],"","",["relieved"],26,5,15,0],"1f60d":[[""],"","",["heart_eyes"],26,6,15,0],"1f60e":[[""],"","",["sunglasses"],26,7,15,0],"1f60f":[[""],"","",["smirk"],26,8,15,0],"1f610":[[""],"","",["neutral_face"],26,9,15,0],"1f611":[[""],"","",["expressionless"],26,10,15,0],"1f612":[[""],"","",["unamused"],26,11,15,0,":("],"1f613":[[""],"","",["sweat"],26,12,15,0],"1f614":[[""],"","",["pensive"],26,13,15,0],"1f615":[[""],"","",["confused"],26,14,15,0],"1f616":[[""],"","",["confounded"],26,15,15,0],"1f617":[[""],"","",["kissing"],26,16,15,0],"1f618":[[""],"","",["kissing_heart"],26,17,15,0],"1f619":[[""],"","",["kissing_smiling_eyes"],26,18,15,0],"1f61a":[[""],"","",["kissing_closed_eyes"],26,19,15,0],"1f61b":[[""],"","",["stuck_out_tongue"],26,20,15,0,":p"],"1f61c":[[""],"","",["stuck_out_tongue_winking_eye"],26,21,15,0,";p"],"1f61d":[[""],"","",["stuck_out_tongue_closed_eyes"],26,22,15,0],"1f61e":[[""],"","",["disappointed"],26,23,15,0,":("],"1f61f":[[""],"","",["worried"],26,24,15,0],"1f620":[[""],"","",["angry"],26,25,15,0],"1f621":[[""],"","",["rage"],26,26,15,0],"1f622":[[""],"","",["cry"],26,27,15,0,":'("],"1f623":[[""],"","",["persevere"],26,28,15,0],"1f624":[[""],"","",["triumph"],26,29,15,0],"1f625":[[""],"","",["disappointed_relieved"],26,30,15,0],"1f626":[[""],"","",["frowning"],26,31,15,0],"1f627":[[""],"","",["anguished"],26,32,15,0],"1f628":[[""],"","",["fearful"],26,33,15,0],"1f629":[[""],"","",["weary"],26,34,15,0],"1f62a":[[""],"","",["sleepy"],27,0,15,0],"1f62b":[[""],"","",["tired_face"],27,1,15,0],"1f62c":[[""],"","",["grimacing"],27,2,15,0],"1f62d":[[""],"","",["sob"],27,3,15,0,":'("],"1f62e":[[""],"","",["open_mouth"],27,4,15,0],"1f62f":[[""],"","",["hushed"],27,5,15,0],"1f630":[[""],"","",["cold_sweat"],27,6,15,0],"1f631":[[""],"","",["scream"],27,7,15,0],"1f632":[[""],"","",["astonished"],27,8,15,0],"1f633":[[""],"","",["flushed"],27,9,15,0],"1f634":[[""],"","",["sleeping"],27,10,15,0],"1f635":[[""],"","",["dizzy_face"],27,11,15,0],"1f636":[[""],"","",["no_mouth"],27,12,15,0],"1f637":[[""],"","",["mask"],27,13,15,0],"1f638":[[""],"","",["smile_cat"],27,14,15,0],"1f639":[[""],"","",["joy_cat"],27,15,15,0],"1f63a":[[""],"","",["smiley_cat"],27,16,15,0],"1f63b":[[""],"","",["heart_eyes_cat"],27,17,15,0],"1f63c":[[""],"","",["smirk_cat"],27,18,15,0],"1f63d":[[""],"","",["kissing_cat"],27,19,15,0],"1f63e":[[""],"","",["pouting_cat"],27,20,15,0],"1f63f":[[""],"","",["crying_cat_face"],27,21,15,0],"1f640":[[""],"","",["scream_cat"],27,22,15,0],"1f645":[[""],"","",["no_good"],27,23,15,0],"1f646":[[""],"","",["ok_woman"],27,29,15,0],"1f647":[[""],"","",["bow"],28,0,15,0],"1f648":[[""],"","",["see_no_evil"],28,6,15,0],"1f649":[[""],"","",["hear_no_evil"],28,7,15,0],"1f64a":[[""],"","",["speak_no_evil"],28,8,15,0],"1f64b":[[""],"","",["raising_hand"],28,9,15,0],"1f64c":[[""],"","",["raised_hands"],28,15,15,0],"1f64d":[[""],"","",["person_frowning"],28,21,15,0],"1f64e":[[""],"","",["person_with_pouting_face"],28,27,15,0],"1f64f":[[""],"","",["pray"],28,33,15,0],"1f680":[[""],"","",["rocket"],29,4,15,0],"1f681":[[""],"","",["helicopter"],29,5,15,0],"1f682":[[""],"","",["steam_locomotive"],29,6,15,0],"1f683":[[""],"","",["railway_car"],29,7,15,0],"1f684":[[""],"","",["bullettrain_side"],29,8,15,0],"1f685":[[""],"","",["bullettrain_front"],29,9,15,0],"1f686":[[""],"","",["train2"],29,10,15,0],"1f687":[[""],"","",["metro"],29,11,15,0],"1f688":[[""],"","",["light_rail"],29,12,15,0],"1f689":[[""],"","",["station"],29,13,15,0],"1f68a":[[""],"","",["tram"],29,14,15,0],"1f68b":[[""],"","",["train"],29,15,15,0],"1f68c":[[""],"","",["bus"],29,16,15,0],"1f68d":[[""],"","",["oncoming_bus"],29,17,15,0],"1f68e":[[""],"","",["trolleybus"],29,18,15,0],"1f68f":[[""],"","",["busstop"],29,19,15,0],"1f690":[[""],"","",["minibus"],29,20,15,0],"1f691":[[""],"","",["ambulance"],29,21,15,0],"1f692":[[""],"","",["fire_engine"],29,22,15,0],"1f693":[[""],"","",["police_car"],29,23,15,0],"1f694":[[""],"","",["oncoming_police_car"],29,24,15,0],"1f695":[[""],"","",["taxi"],29,25,15,0],"1f696":[[""],"","",["oncoming_taxi"],29,26,15,0],"1f697":[[""],"","",["car","red_car"],29,27,15,0],"1f698":[[""],"","",["oncoming_automobile"],29,28,15,0],"1f699":[[""],"","",["blue_car"],29,29,15,0],"1f69a":[[""],"","",["truck"],29,30,15,0],"1f69b":[[""],"","",["articulated_lorry"],29,31,15,0],"1f69c":[[""],"","",["tractor"],29,32,15,0],"1f69d":[[""],"","",["monorail"],29,33,15,0],"1f69e":[[""],"","",["mountain_railway"],29,34,15,0],"1f69f":[[""],"","",["suspension_railway"],30,0,15,0],"1f6a0":[[""],"","",["mountain_cableway"],30,1,15,0],"1f6a1":[[""],"","",["aerial_tramway"],30,2,15,0],"1f6a2":[[""],"","",["ship"],30,3,15,0],"1f6a3":[[""],"","",["rowboat"],30,4,15,0],"1f6a4":[[""],"","",["speedboat"],30,10,15,0],"1f6a5":[[""],"","",["traffic_light"],30,11,15,0],"1f6a6":[[""],"","",["vertical_traffic_light"],30,12,15,0],"1f6a7":[[""],"","",["construction"],30,13,15,0],"1f6a8":[[""],"","",["rotating_light"],30,14,15,0],"1f6a9":[[""],"","",["triangular_flag_on_post"],30,15,15,0],"1f6aa":[[""],"","",["door"],30,16,15,0],"1f6ab":[[""],"","",["no_entry_sign"],30,17,15,0],"1f6ac":[[""],"","",["smoking"],30,18,15,0],"1f6ad":[[""],"","",["no_smoking"],30,19,15,0],"1f6ae":[[""],"","",["put_litter_in_its_place"],30,20,15,0],"1f6af":[[""],"","",["do_not_litter"],30,21,15,0],"1f6b0":[[""],"","",["potable_water"],30,22,15,0],"1f6b1":[[""],"","",["non-potable_water"],30,23,15,0],"1f6b2":[[""],"","",["bike"],30,24,15,0],"1f6b3":[[""],"","",["no_bicycles"],30,25,15,0],"1f6b4":[[""],"","",["bicyclist"],30,26,15,0],"1f6b5":[[""],"","",["mountain_bicyclist"],30,32,15,0],"1f6b6":[[""],"","",["walking"],31,3,15,0],"1f6b7":[[""],"","",["no_pedestrians"],31,9,15,0],"1f6b8":[[""],"","",["children_crossing"],31,10,15,0],"1f6b9":[[""],"","",["mens"],31,11,15,0],"1f6ba":[[""],"","",["womens"],31,12,15,0],"1f6bb":[[""],"","",["restroom"],31,13,15,0],"1f6bc":[[""],"","",["baby_symbol"],31,14,15,0],"1f6bd":[[""],"","",["toilet"],31,15,15,0],"1f6be":[[""],"","",["wc"],31,16,15,0],"1f6bf":[[""],"","",["shower"],31,17,15,0],"1f6c0":[[""],"","",["bath"],31,18,15,0],"1f6c1":[[""],"","",["bathtub"],31,24,15,0],"1f6c2":[[""],"","",["passport_control"],31,25,15,0],"1f6c3":[[""],"","",["customs"],31,26,15,0],"1f6c4":[[""],"","",["baggage_claim"],31,27,15,0],"1f6c5":[[""],"","",["left_luggage"],31,28,15,0],"0023-20e3":[["#","#"],"","",["hash"],31,29,15,0],"0030-20e3":[["0","0"],"","",["zero"],31,30,15,0],"0031-20e3":[["1","1"],"","",["one"],31,31,15,0],"0032-20e3":[["2","2"],"","",["two"],31,32,15,0],"0033-20e3":[["3","3"],"","",["three"],31,33,15,0],"0034-20e3":[["4","4"],"","",["four"],31,34,15,0],"0035-20e3":[["5","5"],"","",["five"],32,0,15,0],"0036-20e3":[["6","6"],"","",["six"],32,1,15,0],"0037-20e3":[["7","7"],"","",["seven"],32,2,15,0],"0038-20e3":[["8","8"],"","",["eight"],32,3,15,0],"0039-20e3":[["9","9"],"","",["nine"],32,4,15,0],"1f1e6-1f1ea":[[""],"","",["flag-ae"],32,5,11,0],"1f1e6-1f1f9":[[""],"","",["flag-at"],32,6,11,0],"1f1e6-1f1fa":[[""],"","",["flag-au"],32,7,11,0],"1f1e7-1f1ea":[[""],"","",["flag-be"],32,8,11,0],"1f1e7-1f1f7":[[""],"","",["flag-br"],32,9,11,0],"1f1e8-1f1e6":[[""],"","",["flag-ca"],32,10,11,0],"1f1e8-1f1ed":[[""],"","",["flag-ch"],32,11,11,0],"1f1e8-1f1f1":[[""],"","",["flag-cl"],32,12,11,0],"1f1e8-1f1f3":[[""],"","",["flag-cn","cn"],32,13,15,0],"1f1e8-1f1f4":[[""],"","",["flag-co"],32,14,11,0],"1f1e9-1f1ea":[[""],"","",["flag-de","de"],32,15,15,0],"1f1e9-1f1f0":[[""],"","",["flag-dk"],32,16,11,0],"1f1ea-1f1f8":[[""],"","",["flag-es","es"],32,17,15,0],"1f1eb-1f1ee":[[""],"","",["flag-fi"],32,18,11,0],"1f1eb-1f1f7":[[""],"","",["flag-fr","fr"],32,19,15,0],"1f1ec-1f1e7":[[""],"","",["flag-gb","gb","uk"],32,20,15,0],"1f1ed-1f1f0":[[""],"","",["flag-hk"],32,21,11,0],"1f1ee-1f1e9":[[""],"","",["flag-id"],32,22,11,0],"1f1ee-1f1ea":[[""],"","",["flag-ie"],32,23,11,0],"1f1ee-1f1f1":[[""],"","",["flag-il"],32,24,11,0],"1f1ee-1f1f3":[[""],"","",["flag-in"],32,25,11,0],"1f1ee-1f1f9":[[""],"","",["flag-it","it"],32,26,15,0],"1f1ef-1f1f5":[[""],"","",["flag-jp","jp"],32,27,15,0],"1f1f0-1f1f7":[[""],"","",["flag-kr","kr"],32,28,15,0],"1f1f2-1f1f4":[[""],"","",["flag-mo"],32,29,11,0],"1f1f2-1f1fd":[[""],"","",["flag-mx"],32,30,11,0],"1f1f2-1f1fe":[[""],"","",["flag-my"],32,31,11,0],"1f1f3-1f1f1":[[""],"","",["flag-nl"],32,32,11,0],"1f1f3-1f1f4":[[""],"","",["flag-no"],32,33,11,0],"1f1f3-1f1ff":[[""],"","",["flag-nz"],32,34,11,0],"1f1f5-1f1ed":[[""],"","",["flag-ph"],33,0,11,0],"1f1f5-1f1f1":[[""],"","",["flag-pl"],33,1,11,0],"1f1f5-1f1f7":[[""],"","",["flag-pr"],33,2,11,0],"1f1f5-1f1f9":[[""],"","",["flag-pt"],33,3,11,0],"1f1f7-1f1fa":[[""],"","",["flag-ru","ru"],33,4,15,0],"1f1f8-1f1e6":[[""],"","",["flag-sa"],33,5,11,0],"1f1f8-1f1ea":[[""],"","",["flag-se"],33,6,11,0],"1f1f8-1f1ec":[[""],"","",["flag-sg"],33,7,11,0],"1f1f9-1f1f7":[[""],"","",["flag-tr"],33,8,11,0],"1f1fa-1f1f8":[[""],"","",["flag-us","us"],33,9,15,0],"1f1fb-1f1f3":[[""],"","",["flag-vn"],33,10,11,0],"1f1ff-1f1e6":[[""],"","",["flag-za"],33,11,11,0],"1f468-200d-1f468-200d-1f466":[[""],"","",["man-man-boy"],33,12,1,0],"1f468-200d-1f468-200d-1f466-200d-1f466":[[""],"","",["man-man-boy-boy"],33,13,1,0],"1f468-200d-1f468-200d-1f467":[[""],"","",["man-man-girl"],33,14,1,0],"1f468-200d-1f468-200d-1f467-200d-1f466":[[""],"","",["man-man-girl-boy"],33,15,1,0],"1f468-200d-1f468-200d-1f467-200d-1f467":[[""],"","",["man-man-girl-girl"],33,16,1,0],"1f468-200d-1f469-200d-1f466":[[""],"","",["man-woman-boy"],33,17,1,0],"1f468-200d-1f469-200d-1f466-200d-1f466":[[""],"","",["man-woman-boy-boy"],33,18,1,0],"1f468-200d-1f469-200d-1f467":[[""],"","",["man-woman-girl"],33,19,1,0],"1f468-200d-1f469-200d-1f467-200d-1f466":[[""],"","",["man-woman-girl-boy"],33,20,1,0],"1f468-200d-1f469-200d-1f467-200d-1f467":[[""],"","",["man-woman-girl-girl"],33,21,1,0],"1f468-200d-2764-fe0f-200d-1f468":[[""],"","",["man-heart-man"],33,22,1,0],"1f468-200d-2764-fe0f-200d-1f48b-200d-1f468":[[""],"","",["man-kiss-man"],33,23,1,0],"1f469-200d-1f469-200d-1f466":[[""],"","",["woman-woman-boy"],33,24,1,0],"1f469-200d-1f469-200d-1f466-200d-1f466":[[""],"","",["woman-woman-boy-boy"],33,25,1,0],"1f469-200d-1f469-200d-1f467":[[""],"","",["woman-woman-girl"],33,26,1,0],"1f469-200d-1f469-200d-1f467-200d-1f466":[[""],"","",["woman-woman-girl-boy"],33,27,1,0],"1f469-200d-1f469-200d-1f467-200d-1f467":[[""],"","",["woman-woman-girl-girl"],33,28,1,0],"1f469-200d-2764-fe0f-200d-1f469":[[""],"","",["woman-heart-woman"],33,29,1,0],"1f469-200d-2764-fe0f-200d-1f48b-200d-1f469":[[""],"","",["woman-kiss-woman"],33,30,1,0]};emoji.emoticons_data={"<3":"heart",":o)":"monkey_face",":*":"kiss",":-*":"kiss","</3":"broken_heart","=)":"smiley","=-)":"smiley","C:":"smile","c:":"smile",":D":"smile",":-D":"smile",":>":"laughing",":->":"laughing",";)":"wink",";-)":"wink",":)":"blush","(:":"blush",":-)":"blush","8)":"sunglasses",":|":"neutral_face",":-|":"neutral_face",":\\":"confused",":-\\":"confused",":/":"confused",":-/":"confused",":p":"stuck_out_tongue",":-p":"stuck_out_tongue",":P":"stuck_out_tongue",":-P":"stuck_out_tongue",":b":"stuck_out_tongue",":-b":"stuck_out_tongue",";p":"stuck_out_tongue_winking_eye",";-p":"stuck_out_tongue_winking_eye",";b":"stuck_out_tongue_winking_eye",";-b":"stuck_out_tongue_winking_eye",";P":"stuck_out_tongue_winking_eye",";-P":"stuck_out_tongue_winking_eye","):":"disappointed",":(":"disappointed",":-(":"disappointed",">:(":"angry",">:-(":"angry",":'(":"cry","D:":"anguished",":o":"open_mouth",":-o":"open_mouth"};emoji.variations_data={"261d-1f3fb":[1,3,1],"261d-1f3fc":[1,4,1],"261d-1f3fd":[1,5,1],"261d-1f3fe":[1,6,1],"261d-1f3ff":[1,7,1],"270a-1f3fb":[2,15,1],"270a-1f3fc":[2,16,1],"270a-1f3fd":[2,17,1],"270a-1f3fe":[2,18,1],"270a-1f3ff":[2,19,1],"270b-1f3fb":[2,21,1],"270b-1f3fc":[2,22,1],"270b-1f3fd":[2,23,1],"270b-1f3fe":[2,24,1],"270b-1f3ff":[2,25,1],"270c-1f3fb":[2,27,1],"270c-1f3fc":[2,28,1],"270c-1f3fd":[2,29,1],"270c-1f3fe":[2,30,1],"270c-1f3ff":[2,31,1],"1f385-1f3fb":[8,4,1],"1f385-1f3fc":[8,5,1],"1f385-1f3fd":[8,6,1],"1f385-1f3fe":[8,7,1],"1f385-1f3ff":[8,8,1],"1f3c3-1f3fb":[9,24,1],"1f3c3-1f3fc":[9,25,1],"1f3c3-1f3fd":[9,26,1],"1f3c3-1f3fe":[9,27,1],"1f3c3-1f3ff":[9,28,1],"1f3c4-1f3fb":[9,30,1],"1f3c4-1f3fc":[9,31,1],"1f3c4-1f3fd":[9,32,1],"1f3c4-1f3fe":[9,33,1],"1f3c4-1f3ff":[9,34,1],"1f3c7-1f3fb":[10,2,1],"1f3c7-1f3fc":[10,3,1],"1f3c7-1f3fd":[10,4,1],"1f3c7-1f3fe":[10,5,1],"1f3c7-1f3ff":[10,6,1],"1f3ca-1f3fb":[10,10,1],"1f3ca-1f3fc":[10,11,1],"1f3ca-1f3fd":[10,12,1],"1f3ca-1f3fe":[10,13,1],"1f3ca-1f3ff":[10,14,1],"1f442-1f3fb":[12,32,1],"1f442-1f3fc":[12,33,1],"1f442-1f3fd":[12,34,1],"1f442-1f3fe":[13,0,1],"1f442-1f3ff":[13,1,1],"1f443-1f3fb":[13,3,1],"1f443-1f3fc":[13,4,1],"1f443-1f3fd":[13,5,1],"1f443-1f3fe":[13,6,1],"1f443-1f3ff":[13,7,1],"1f446-1f3fb":[13,11,1],"1f446-1f3fc":[13,12,1],"1f446-1f3fd":[13,13,1],"1f446-1f3fe":[13,14,1],"1f446-1f3ff":[13,15,1],"1f447-1f3fb":[13,17,1],"1f447-1f3fc":[13,18,1],"1f447-1f3fd":[13,19,1],"1f447-1f3fe":[13,20,1],"1f447-1f3ff":[13,21,1],"1f448-1f3fb":[13,23,1],"1f448-1f3fc":[13,24,1],"1f448-1f3fd":[13,25,1],"1f448-1f3fe":[13,26,1],"1f448-1f3ff":[13,27,1],"1f449-1f3fb":[13,29,1],"1f449-1f3fc":[13,30,1],"1f449-1f3fd":[13,31,1],"1f449-1f3fe":[13,32,1],"1f449-1f3ff":[13,33,1],"1f44a-1f3fb":[14,0,1],"1f44a-1f3fc":[14,1,1],"1f44a-1f3fd":[14,2,1],"1f44a-1f3fe":[14,3,1],"1f44a-1f3ff":[14,4,1],"1f44b-1f3fb":[14,6,1],"1f44b-1f3fc":[14,7,1],"1f44b-1f3fd":[14,8,1],"1f44b-1f3fe":[14,9,1],"1f44b-1f3ff":[14,10,1],"1f44c-1f3fb":[14,12,1],"1f44c-1f3fc":[14,13,1],"1f44c-1f3fd":[14,14,1],"1f44c-1f3fe":[14,15,1],"1f44c-1f3ff":[14,16,1],"1f44d-1f3fb":[14,18,1],"1f44d-1f3fc":[14,19,1],"1f44d-1f3fd":[14,20,1],"1f44d-1f3fe":[14,21,1],"1f44d-1f3ff":[14,22,1],"1f44e-1f3fb":[14,24,1],"1f44e-1f3fc":[14,25,1],"1f44e-1f3fd":[14,26,1],"1f44e-1f3fe":[14,27,1],"1f44e-1f3ff":[14,28,1],"1f44f-1f3fb":[14,30,1],"1f44f-1f3fc":[14,31,1],"1f44f-1f3fd":[14,32,1],"1f44f-1f3fe":[14,33,1],"1f44f-1f3ff":[14,34,1],"1f450-1f3fb":[15,1,1],"1f450-1f3fc":[15,2,1],"1f450-1f3fd":[15,3,1],"1f450-1f3fe":[15,4,1],"1f450-1f3ff":[15,5,1],"1f466-1f3fb":[15,28,1],"1f466-1f3fc":[15,29,1],"1f466-1f3fd":[15,30,1],"1f466-1f3fe":[15,31,1],"1f466-1f3ff":[15,32,1],"1f467-1f3fb":[15,34,1],"1f467-1f3fc":[16,0,1],"1f467-1f3fd":[16,1,1],"1f467-1f3fe":[16,2,1],"1f467-1f3ff":[16,3,1],"1f468-1f3fb":[16,5,1],"1f468-1f3fc":[16,6,1],"1f468-1f3fd":[16,7,1],"1f468-1f3fe":[16,8,1],"1f468-1f3ff":[16,9,1],"1f469-1f3fb":[16,11,1],"1f469-1f3fc":[16,12,1],"1f469-1f3fd":[16,13,1],"1f469-1f3fe":[16,14,1],"1f469-1f3ff":[16,15,1],"1f46e-1f3fb":[16,21,1],"1f46e-1f3fc":[16,22,1],"1f46e-1f3fd":[16,23,1],"1f46e-1f3fe":[16,24,1],"1f46e-1f3ff":[16,25,1],"1f470-1f3fb":[16,28,1],"1f470-1f3fc":[16,29,1],"1f470-1f3fd":[16,30,1],"1f470-1f3fe":[16,31,1],"1f470-1f3ff":[16,32,1],"1f471-1f3fb":[16,34,1],"1f471-1f3fc":[17,0,1],"1f471-1f3fd":[17,1,1],"1f471-1f3fe":[17,2,1],"1f471-1f3ff":[17,3,1],"1f472-1f3fb":[17,5,1],"1f472-1f3fc":[17,6,1],"1f472-1f3fd":[17,7,1],"1f472-1f3fe":[17,8,1],"1f472-1f3ff":[17,9,1],"1f473-1f3fb":[17,11,1],"1f473-1f3fc":[17,12,1],"1f473-1f3fd":[17,13,1],"1f473-1f3fe":[17,14,1],"1f473-1f3ff":[17,15,1],"1f474-1f3fb":[17,17,1],"1f474-1f3fc":[17,18,1],"1f474-1f3fd":[17,19,1],"1f474-1f3fe":[17,20,1],"1f474-1f3ff":[17,21,1],"1f475-1f3fb":[17,23,1],"1f475-1f3fc":[17,24,1],"1f475-1f3fd":[17,25,1],"1f475-1f3fe":[17,26,1],"1f475-1f3ff":[17,27,1],"1f476-1f3fb":[17,29,1],"1f476-1f3fc":[17,30,1],"1f476-1f3fd":[17,31,1],"1f476-1f3fe":[17,32,1],"1f476-1f3ff":[17,33,1],"1f477-1f3fb":[18,0,1],"1f477-1f3fc":[18,1,1],"1f477-1f3fd":[18,2,1],"1f477-1f3fe":[18,3,1],"1f477-1f3ff":[18,4,1],"1f478-1f3fb":[18,6,1],"1f478-1f3fc":[18,7,1],"1f478-1f3fd":[18,8,1],"1f478-1f3fe":[18,9,1],"1f478-1f3ff":[18,10,1],"1f47c-1f3fb":[18,15,1],"1f47c-1f3fc":[18,16,1],
"1f47c-1f3fd":[18,17,1],"1f47c-1f3fe":[18,18,1],"1f47c-1f3ff":[18,19,1],"1f481-1f3fb":[18,25,1],"1f481-1f3fc":[18,26,1],"1f481-1f3fd":[18,27,1],"1f481-1f3fe":[18,28,1],"1f481-1f3ff":[18,29,1],"1f482-1f3fb":[18,31,1],"1f482-1f3fc":[18,32,1],"1f482-1f3fd":[18,33,1],"1f482-1f3fe":[18,34,1],"1f482-1f3ff":[19,0,1],"1f483-1f3fb":[19,2,1],"1f483-1f3fc":[19,3,1],"1f483-1f3fd":[19,4,1],"1f483-1f3fe":[19,5,1],"1f483-1f3ff":[19,6,1],"1f485-1f3fb":[19,9,1],"1f485-1f3fc":[19,10,1],"1f485-1f3fd":[19,11,1],"1f485-1f3fe":[19,12,1],"1f485-1f3ff":[19,13,1],"1f486-1f3fb":[19,15,1],"1f486-1f3fc":[19,16,1],"1f486-1f3fd":[19,17,1],"1f486-1f3fe":[19,18,1],"1f486-1f3ff":[19,19,1],"1f487-1f3fb":[19,21,1],"1f487-1f3fc":[19,22,1],"1f487-1f3fd":[19,23,1],"1f487-1f3fe":[19,24,1],"1f487-1f3ff":[19,25,1],"1f4aa-1f3fb":[20,26,1],"1f4aa-1f3fc":[20,27,1],"1f4aa-1f3fd":[20,28,1],"1f4aa-1f3fe":[20,29,1],"1f4aa-1f3ff":[20,30,1],"1f645-1f3fb":[27,24,1],"1f645-1f3fc":[27,25,1],"1f645-1f3fd":[27,26,1],"1f645-1f3fe":[27,27,1],"1f645-1f3ff":[27,28,1],"1f646-1f3fb":[27,30,1],"1f646-1f3fc":[27,31,1],"1f646-1f3fd":[27,32,1],"1f646-1f3fe":[27,33,1],"1f646-1f3ff":[27,34,1],"1f647-1f3fb":[28,1,1],"1f647-1f3fc":[28,2,1],"1f647-1f3fd":[28,3,1],"1f647-1f3fe":[28,4,1],"1f647-1f3ff":[28,5,1],"1f64b-1f3fb":[28,10,1],"1f64b-1f3fc":[28,11,1],"1f64b-1f3fd":[28,12,1],"1f64b-1f3fe":[28,13,1],"1f64b-1f3ff":[28,14,1],"1f64c-1f3fb":[28,16,1],"1f64c-1f3fc":[28,17,1],"1f64c-1f3fd":[28,18,1],"1f64c-1f3fe":[28,19,1],"1f64c-1f3ff":[28,20,1],"1f64d-1f3fb":[28,22,1],"1f64d-1f3fc":[28,23,1],"1f64d-1f3fd":[28,24,1],"1f64d-1f3fe":[28,25,1],"1f64d-1f3ff":[28,26,1],"1f64e-1f3fb":[28,28,1],"1f64e-1f3fc":[28,29,1],"1f64e-1f3fd":[28,30,1],"1f64e-1f3fe":[28,31,1],"1f64e-1f3ff":[28,32,1],"1f64f-1f3fb":[28,34,1],"1f64f-1f3fc":[29,0,1],"1f64f-1f3fd":[29,1,1],"1f64f-1f3fe":[29,2,1],"1f64f-1f3ff":[29,3,1],"1f6a3-1f3fb":[30,5,1],"1f6a3-1f3fc":[30,6,1],"1f6a3-1f3fd":[30,7,1],"1f6a3-1f3fe":[30,8,1],"1f6a3-1f3ff":[30,9,1],"1f6b4-1f3fb":[30,27,1],"1f6b4-1f3fc":[30,28,1],"1f6b4-1f3fd":[30,29,1],"1f6b4-1f3fe":[30,30,1],"1f6b4-1f3ff":[30,31,1],"1f6b5-1f3fb":[30,33,1],"1f6b5-1f3fc":[30,34,1],"1f6b5-1f3fd":[31,0,1],"1f6b5-1f3fe":[31,1,1],"1f6b5-1f3ff":[31,2,1],"1f6b6-1f3fb":[31,4,1],"1f6b6-1f3fc":[31,5,1],"1f6b6-1f3fd":[31,6,1],"1f6b6-1f3fe":[31,7,1],"1f6b6-1f3ff":[31,8,1],"1f6c0-1f3fb":[31,19,1],"1f6c0-1f3fc":[31,20,1],"1f6c0-1f3fd":[31,21,1],"1f6c0-1f3fe":[31,22,1],"1f6c0-1f3ff":[31,23,1]};if(typeof exports==="object"){module.exports=emoji}else if(typeof define==="function"&&define.amd){define(function(){return emoji})}else{this.emoji=emoji}if(local_setup)local_setup(emoji)}).call(function(){return this||(typeof window!=="undefined"?window:global)}(),function(emoji){emoji.include_title=true;emoji.allow_native=false;var ssb_local=function(){if(!window.TSSSB)return false;if(!TSSSB.env)return false;if(!TSSSB.env.mac_ssb_version&&!TSSSB.env.win_ssb_version)return false;if(TSSSB.env.mac_ssb_version){if(TSSSB.env.mac_ssb_version>1.1&&TSSSB.env.mac_ssb_version<2)return true;if(TSSSB.env.mac_ssb_version==1.1&&TSSSB.env.mac_ssb_version_minor>=1)return true}if(TSSSB.env.win_ssb_version){if(TSSSB.env.win_ssb_version>1.1)return true;if(TSSSB.env.win_ssb_version==1.1&&TSSSB.env.win_ssb_version_minor>=5)return true}return false}();if(window.inc_js_setup_data===undefined){window.inc_js_setup_data={}}if(window.inc_js_setup_data.emoji_sheets===undefined){window.inc_js_setup_data.emoji_sheets={apple:"/img/emoji_2015/sheet_apple_64_indexed_256colors.png",google:"/img/emoji_2015/sheet_google_64_indexed_128colors.png",twitter:"/img/emoji_2015/sheet_twitter_64_indexed_128colors.png",emojione:"/img/emoji_2015/sheet_emojione_64_indexed_128colors.png"}}emoji.img_sets={apple:{path:"https://slack-assets2.s3-us-west-2.amazonaws.com/ad0d/img/emoji_2015/apple/",sheet:ssb_local?"slack-resources:emoji_2015_apple_64_indexed_256colors.png":window.inc_js_setup_data.emoji_sheets.apple,mask:1},google:{path:"https://slack-assets2.s3-us-west-2.amazonaws.com/9500/img/emoji_2015/google/",sheet:ssb_local?"slack-resources:emoji_2015_google_64_indexed_128colors.png":window.inc_js_setup_data.emoji_sheets.google,mask:2},twitter:{path:"https://slack-assets2.s3-us-west-2.amazonaws.com/9500/img/emoji_2015/twitter/",sheet:ssb_local?"slack-resources:emoji_2015_twitter_64_indexed_128colors.png":window.inc_js_setup_data.emoji_sheets.twitter,mask:4},emojione:{path:"https://slack-assets2.s3-us-west-2.amazonaws.com/9500/img/emoji_2015/emojione/",sheet:ssb_local?"slack-resources:emoji_2015_emojione_64_indexed_128colors.png":window.inc_js_setup_data.emoji_sheets.emojione,mask:8}};delete emoji.emoticons_data["C:"];delete emoji.emoticons_data["c:"];emoji.replace_colons=function(str,tokenizerFunc){var returner=function(val){return tokenizerFunc?tokenizerFunc(val):val};emoji.init_colons();return str.replace(emoji.rx_colons,function(m){var idx=m.substr(1,m.length-2);if(idx.indexOf("::skin-tone-")>-1){var skin_tone=idx.substr(-1,1);var skin_idx="skin-tone-"+skin_tone;var skin_val=emoji.map.colons[skin_idx];idx=idx.substr(0,idx.length-13);var val=emoji.map.colons[idx];if(val){return returner(emoji.replacement(val,idx,":",{idx:skin_val,actual:skin_idx,wrapper:":"}))}else{return returner(":"+idx+":"+emoji.replacement(skin_val,skin_idx,":"))}}else{var val=emoji.map.colons[idx];return val?returner(emoji.replacement(val,idx,":")):m}})};emoji.replace_colons_with_unified=function(str){emoji.init_colons();return str.replace(emoji.rx_colons,function(m){var idx=m.substr(1,m.length-2).toLowerCase();if(idx.indexOf("::skin-tone-")>-1){var skin_tone=idx.substr(-1,1);var skin_idx="skin-tone-"+skin_tone;var skin_val=emoji.map.colons[skin_idx];idx=idx.substr(0,idx.length-13);var val=emoji.map.colons[idx];var ret=val&&emoji.data[val][0][0]?emoji.data[val][0][0]:":"+idx+":";ret+=skin_val&&emoji.data[skin_val][0][0]?emoji.data[skin_val][0][0]:":"+skin_idx+":";return ret}else{var val=emoji.map.colons.hasOwnProperty(idx)&&emoji.map.colons[idx];return val&&emoji.data[val][0][0]?emoji.data[val][0][0]:m}})};emoji.skin_tones=["1f3fb","1f3fc","1f3fd","1f3fe","1f3ff"];var keywords={2049:["symbol"],2122:["symbol"],2139:["symbol"],2194:["symbol"],2195:["symbol","arrow"],2196:["symbol","arrow"],2197:["symbol","arrow"],2198:["symbol","arrow"],2199:["symbol","arrow"],2600:["sun","weather"],2601:["weather","sky"],2611:["check_box_black","check"],2614:[],2615:["drink","food"],2648:["horoscope","astrology"],2649:["horoscope","astrology"],2650:["horoscope","astrology"],2651:["horoscope","astrology"],2652:["horoscope","astrology"],2653:["horoscope","astrology"],2660:["symbol"],2663:["symbol"],2665:["heart"],2666:["symbol"],2668:["symbol"],2693:[],2702:[],2705:["check_green","check"],2708:["plane","travel","fly","transport"],2709:["mail","envelope"],2712:["symbol"],2714:["check","symbol"],2716:["symbol"],2728:["glitter","shine","star"],2733:["symbol"],2734:["symbol"],2744:["snow","weather"],2747:["symbol"],2753:["symbol"],2754:["symbol"],2755:["symbol"],2757:["symbol"],2764:[],2795:["symbol"],2796:["symbol"],2797:["symbol"],2934:["symbol","arrow"],2935:["symbol","arrow"],3030:["symbol"],3297:["symbol"],3299:["symbol"],"00a9":["symbol"],"00ae":["symbol"],"203c":["symbols"],"21a9":["symbol"],"21aa":["symbol","arrow"],"231a":["clock","time"],"231b":[],"23e9":["symbol"],"23ea":["symbol"],"23eb":["symbol","arrow"],"23ec":["symbol","arrow"],"23f0":["alarm","clock"],"23f3":[],"24c2":[],"25aa":["symbol"],"25ab":["symbol"],"25b6":["symbol","arrow"],"25c0":["symbol","arrow"],"25fb":["symbol"],"25fc":["symbol"],"25fd":["symbol"],"25fe":["symbol"],"260e":["telephone"],"261d":["hand","finger","person","people"],"263a":["people","person","face"],"264a":["horoscope","astrology"],"264b":["horoscope","astrology"],"264c":["horoscope","astrology"],"264d":["horoscope","astrology"],"264e":["horoscope","astrology"],"264f":["horoscope","astrology"],"267b":["symbol"],"267f":["symbol"],"26a0":["symbol"],"26a1":["lightning","bolt","shock","weather"],"26aa":["symbol"],"26ab":["symbol"],"26bd":["sport"],"26be":["sports"],"26c4":["snow"],"26c5":["sun_with_clouds"],"26ce":["symbol"],"26d4":["symbol"],"26ea":["building"],"26f2":[],"26f3":["sport"],"26f5":[],"26fa":["camping"],"26fd":["gas"],"270a":["facepunch","fistbump","punch","hand","person","people"],"270b":["people","person"],"270c":["peace","hand","people","person"],"270f":[],"274c":["letter","cross","symbol"],"274e":["cross_green","x"],"27a1":["symbol","arrow"],"27b0":["symbol"],"27bf":["symbol"],"2b05":["symbol","arrow"],"2b06":["symbol","arrow"],"2b07":["symbol","arrow"],"2b1b":["symbol"],"2b1c":["symbol"],"2b50":[],"2b55":["symbol","letter","circle"],"303d":["symbol"],"1f004":["game"],"1f0cf":["card","symbol"],"1f170":["letters"],"1f171":["symbols"],"1f17e":["symbol"],"1f17f":["symbol"],"1f18e":["letters"],"1f191":[],"1f192":["symbol"],"1f193":["symbol"],"1f194":[],"1f195":[],"1f196":[],"1f197":["letters","symbol"],"1f198":["symbol"],"1f199":["symbol"],"1f19a":[],"1f201":["symbol"],"1f202":[],"1f21a":[],"1f22f":[],"1f232":[],"1f233":[],"1f234":[],"1f235":[],"1f236":[],"1f237":[],"1f238":[],"1f239":[],"1f23a":[],"1f250":["symbol"],"1f251":[],"1f300":["symbol"],"1f301":[],"1f302":["umbrella"],"1f303":["sky","night"],"1f304":[],"1f305":[],"1f306":[],"1f307":[],"1f308":[],"1f309":["bridge"],"1f30a":["tidal_wave","wave","water"],"1f30b":["eruption"],"1f30c":["galaxy","space"],"1f30d":["world","globe"],"1f30e":["world","globe"],"1f30f":["world","globe"],"1f310":["globe","world"],"1f311":["moon_new","moon"],"1f312":["moon_waxing_crescent","moon"],"1f313":["moon_first_quarter","moon"],"1f314":[],"1f315":["moon_full","moon"],"1f316":["moon_waning_gibbous","moon"],"1f317":["moon_last_quarter"],"1f318":["moon_waning_crescent","moon"],"1f319":["moon_crescent","moon"],"1f31a":["moon_new_with_face","moon"],"1f31b":["moon_first_quarter_with_face","moon"],"1f31c":["moon_last_quarter_with_face"],"1f31d":["moon_full_with_face","moon"],"1f31e":["sun","weather","face"],"1f31f":[],"1f320":[],"1f330":["food"],"1f331":["plant"],"1f332":["tree_evergreen","tree","plant"],"1f333":["tree_deciduous","tree","plant"],"1f334":["tree","plant"],"1f335":["plant"],"1f337":["flower","plant"],"1f338":["sakura","flower"],"1f339":["flower","plant"],"1f33a":["plant"],"1f33b":["flower","plant"],"1f33c":["flower","plant"],"1f33d":["vegetable","food"],"1f33e":["food"],"1f33f":["plant"],"1f340":["clover","plant"],"1f341":["leaf","plant"],"1f342":["leaves_brown","plant","leaf"],"1f343":["leaf","plant"],"1f344":["food"],"1f345":["vegetable","food"],"1f346":["vegetable","food"],"1f347":["fruit","food"],"1f348":["fruit","food"],"1f349":["fruit","food"],"1f34a":["orange","fruit","food"],"1f34b":["fruit","food"],"1f34c":["fruit","food"],"1f34d":["fruit","food"],"1f34e":["fruit","food"],"1f34f":["apple_green","fruit","food"],"1f350":["fruit","food"],"1f351":["fruit","food"],"1f352":["fruit","food"],"1f353":["fruit","food"],"1f354":["cheeseburger","burger","food"],"1f355":["food"],"1f356":["food"],"1f357":["drumstick","meat","food"],"1f358":["food"],"1f359":["food"],"1f35a":["food"],"1f35b":["food"],"1f35c":["noodles","food"],"1f35d":["pasta","food"],"1f35e":[],"1f35f":["french_fries","food"],"1f360":["yam","vegetable","food"],"1f361":["food"],"1f362":["food"],"1f363":["food"],"1f364":["shrimp","tempura","food"],"1f365":["food"],"1f366":["ice_cream","food"],"1f367":["snow_cone","food"],"1f368":["icecream","food"],"1f369":["donut","food"],"1f36a":["food"],"1f36b":["candy_bar","food"],"1f36c":["food"],"1f36d":["food","candy"],"1f36e":["food"],"1f36f":["food"],"1f370":["birthday","food"],"1f371":["food"],"1f372":["food"],"1f373":["food"],"1f374":["cutlery","silverware","food"],"1f375":["drink","food"],"1f376":["drink","food"],"1f377":["drink","food"],"1f378":["drink","martini","food"],"1f379":["drink","food"],"1f37a":["ale","drink","food"],"1f37b":["beer","ale","drink","food"],"1f37c":["infant"],"1f380":["bow","present","gift"],"1f381":["present"],"1f382":["cake","food"],"1f383":["pumpkin","scary"],"1f384":["plant","tree"],"1f385":["christmas","holidays"],"1f386":["explosions","celebrate","celebration"],"1f387":["celebration"],"1f388":[],"1f389":["celebrate","fan_fare","celebration","confetti"],"1f38a":["party_ball","celebrate","celebration"],"1f38b":["tree","plant"],"1f38c":["flag"],"1f38d":["plants"],"1f38e":[],"1f38f":["flag"],"1f390":[],"1f391":[],"1f392":["bag"],"1f393":["hat","graduation","cap"],"1f3a0":["carnival"],"1f3a1":["carnival"],"1f3a2":["ride","carnival"],"1f3a3":["fishing_rod","fish"],"1f3a4":["music","instrument"],"1f3a5":["film"],"1f3a6":["symbol"],"1f3a7":["music"],"1f3a8":["palette","paint"],"1f3a9":["hat","clothing"],"1f3aa":["big_top"],"1f3ab":[],"1f3ac":["movie","cinema"],"1f3ad":["comedy_tragedy","tragedy_comedy","mask"],"1f3ae":["controller","game"],"1f3af":["target","bullseye"],"1f3b0":["gambling","casino"],"1f3b1":["eightball"],"1f3b2":["die","dice","game"],"1f3b3":["sport"],"1f3b4":["card"],"1f3b5":["music"],"1f3b6":["music"],"1f3b7":["music","instrument"],"1f3b8":["music","instrument"],"1f3b9":["music","instrument"],"1f3ba":["horn","instrument","music"],"1f3bb":["instrument","music"],"1f3bc":["music"],"1f3bd":["clothing"],"1f3be":["sport"],"1f3bf":["sport"],"1f3c0":["sports"],"1f3c1":["finish_line","race"],"1f3c2":["sport"],"1f3c3":["run","sport"],"1f3c4":["sport"],"1f3c6":[],"1f3c7":["animal"],"1f3c8":["sport"],"1f3c9":["sport"],"1f3ca":["sport"],"1f3e0":["building"],"1f3e1":["building"],"1f3e2":["building"],"1f3e3":["building"],"1f3e4":["building"],"1f3e5":["building"],"1f3e6":["building"],"1f3e7":["symbols"],"1f3e8":["building"],"1f3e9":["building"],"1f3ea":["building"],"1f3eb":["building"],"1f3ec":["building"],"1f3ed":["building"],"1f3ee":["lantern"],"1f3ef":["castle","building"],"1f3f0":["castle"],"1f3fb":[],"1f3fc":[],"1f3fd":[],"1f3fe":[],"1f3ff":[],"1f400":["animal"],"1f401":["animal"],"1f402":["animal"],"1f403":["buffalo","animal"],"1f404":["animal"],"1f405":["animal","cat"],"1f406":["cat","animal"],"1f407":["animal"],"1f408":["animal"],"1f409":["animal"],"1f40a":["alligator","animal"],"1f40b":["animal","fish"],"1f40c":["bug","insect"],"1f40d":["animal"],"1f40e":["animal"],"1f40f":["animal"],"1f410":["animal"],"1f411":["animal"],"1f412":["animal"],"1f413":["animal"],"1f414":["animal","bird"],"1f415":["animal"],"1f416":["animal"],"1f417":["animal"],"1f418":["animal"],"1f419":["animal","fish"],"1f41a":["beach"],"1f41b":["caterpiller","insect"],"1f41c":["bug","insect"],"1f41d":["honeybee","bug","insect"],"1f41e":["ladybug","bug","insect"],"1f41f":["animal"],"1f420":["fish","animal"],"1f421":["fish","animal"],"1f422":["tortoise","animal"],"1f423":["animal","bird"],"1f424":["animal"],"1f425":["animal","bird"],"1f426":["animal"],"1f427":["bird","animal"],"1f428":["bear","animal"],"1f429":["dog","animal"],"1f42a":["animal","camel"],"1f42b":["animal"],"1f42c":["animal","fish"],"1f42d":["animal"],"1f42e":["animal"],"1f42f":["animal","cat"],"1f430":["animal"],"1f431":["animal"],"1f432":["animal"],"1f433":["animal","fish"],"1f434":["animal"],"1f435":["animal","face"],"1f436":["animal"],"1f437":["animal"],"1f438":["toad","animal"],"1f439":["animal"],"1f43a":["animal"],"1f43b":["animal"],"1f43c":["bear","panda","face"],"1f43d":["animal","face"],"1f43e":["paw_prints","paws"],"1f440":["face","person","people"],"1f442":["person","people","head"],"1f443":["face","people","person"],"1f444":["mouth","face","person","people"],"1f445":["face","person","people"],"1f446":["hand","finger","person","people"],"1f447":["hand","finger","person","people"],"1f448":["hand","finger","person","people"],"1f449":["hand","finger","person","people"],"1f44a":["fistbump","punch","hand","person","people"],"1f44b":["hand","people","person"],"1f44c":["hand","people","person"],"1f44d":["thumbsup","y","yes","hand","people","person"],"1f44e":["thumbsdown","n","no","hand","people","person"],"1f44f":["hands","people","person"],"1f450":["hands","people","person"],"1f451":["hat"],"1f452":["hat","woman"],"1f453":["glasses","spectacles"],"1f454":["clothing"],"1f455":["clothing"],"1f456":["pants","trousers","clothing"],"1f457":["clothing"],"1f458":["clothing"],"1f459":["swimsuit","clothes"],"1f45a":["clothes","woman"],"1f45b":["handbag","bag"],"1f45c":["purse"],"1f45d":["clutch","bag"],"1f45e":["shoe","clothing"],"1f45f":["sneaker","runner","shoe","clothing"],"1f460":["stiletto","shoe","clothing"],"1f461":["clothing","shoe"],"1f462":["shoe","clothes"],"1f463":["feet","foot"],"1f464":["person","people"],"1f465":["person","people"],"1f466":["person","people","face"],"1f467":["person","people","face"],"1f468":["person","people","face"],"1f469":["lady","face","person","people"],"1f46a":["man_woman_boy","people","person"],"1f46b":["man_woman","woman_man","people"],"1f46c":["man","couple","person","people"],"1f46d":["woman","couple","person","people"],"1f46e":["police_officer","people","person","face"],"1f46f":["people","person"],"1f470":["bride","person","people","face","woman","wedding","marriage"],"1f471":["face","person","people"],"1f472":["person","people","face"],"1f473":["person","people","face"],"1f474":["senior_man","elder_man","man","person","people","face"],"1f475":["senior_woman","senior_woman","woman","people","person","face"],"1f476":["infant","face","people","person"],"1f477":["person","people","face"],"1f478":["face","crown","people","person","woman"],"1f479":["ogre","face"],"1f47a":["goblin","face"],"1f47b":["ghoul","scary"],"1f47c":["heaven","saint","people","person"],"1f47d":["martian","space"],"1f47e":["video_game","game"],"1f47f":["devil","evil","face","person","people"],"1f480":["dead","skeleton","scary"],"1f481":["help_desk","person","people","becky"],"1f482":["face","people","person"],"1f483":["person","people"],"1f484":["makeup"],"1f485":["manicure","hand","people","person"],"1f486":["relax","becky"],"1f487":["face","people","person","barber","salon"],"1f488":[],"1f489":["needle","medicine"],"1f48a":["medicine","drugs"],"1f48b":["love","lips","mouth","face"],"1f48c":["letter","mail"],"1f48d":["jewellery"],"1f48e":["jewel","diamond"],"1f48f":["man_woman_kiss","woman_man_kiss","people"],"1f490":["flower","plant"],"1f491":["man_heart_woman","woman_heart_man","people"],"1f492":["marriage"],"1f493":["heart"],"1f494":["heartbreak","heart"],"1f495":["heart"],"1f496":["heart_sparkling","glitter","shine"],"1f497":["pulse"],"1f498":["heart_arrow","heart"],"1f499":["heart_blue","heart"],"1f49a":["heart_green","heart"],"1f49b":["heart"],"1f49c":["heart_purple","heart"],"1f49d":["present_heart"],"1f49e":["heart"],"1f49f":["heart"],"1f4a0":["diamond","gem","jewel"],"1f4a1":["light_bulb"],"1f4a2":["mad","angry","face","people","person"],"1f4a3":[],"1f4a4":["snore","sleep","snooze"],"1f4a5":["bang","explosion","collision","bomb"],"1f4a6":["water","spray"],"1f4a7":["water","sweat","tear","cry"],"1f4a8":["gust","whoosh","wind","fart"],"1f4a9":["poo","poop","shit"],"1f4aa":["bicep","arm","person","people"],"1f4ab":["shooting_star","star"],"1f4ac":["talk","bubble"],"1f4ad":["bubble"],"1f4ae":["flower","plant"],"1f4af":["hundred"],"1f4b0":["money","cash","dollar"],"1f4b1":["symbol"],"1f4b2":["symbol"],"1f4b3":[],"1f4b4":["money","cash"],"1f4b5":["money","cash"],"1f4b6":["money","cash"],"1f4b7":["money","cash"],"1f4b8":["money","cash","dollar"],"1f4b9":["graph"],"1f4ba":["airplane_seat","chair"],"1f4bb":["desktop","pc","work"],"1f4bc":["work"],"1f4bd":[],"1f4be":["computer"],"1f4bf":[],"1f4c0":["cd","disk","disc"],"1f4c1":["folder","work"],"1f4c2":["folder_open","folder","work"],"1f4c3":["paper","document"],"1f4c4":["paper","document"],"1f4c5":["calendar"],"1f4c6":["work","date"],"1f4c7":[],"1f4c8":["graph_with_upwards_trend"],"1f4c9":["graph_with_downwards_trend"],"1f4ca":["graph","chart"],"1f4cb":["work"],"1f4cc":["thumbtack"],"1f4cd":["map_pin"],"1f4ce":["work"],"1f4cf":["ruler"],"1f4d0":[],"1f4d1":[],"1f4d2":["book"],"1f4d3":["book"],"1f4d4":["book"],"1f4d5":["book"],"1f4d6":[],"1f4d7":["book"],"1f4d8":["book"],"1f4d9":["book"],"1f4da":[],"1f4db":[],"1f4dc":["paper"],"1f4dd":["note","pencil","work"],"1f4de":["phone"],"1f4df":[],"1f4e0":["work"],"1f4e1":["dish","tv"],"1f4e2":["speaker"],"1f4e3":["sound","speaker"],"1f4e4":["mail","letter"],"1f4e5":["mail","email","work"],"1f4e6":["box","shipping"],"1f4e7":["envelope","mail"],"1f4e8":["mail","email","work"],"1f4e9":[],"1f4ea":["mail","post"],"1f4eb":["mail","post"],"1f4ec":["mail","post"],"1f4ed":["mail","post"],"1f4ee":["mail","post"],"1f4ef":["horn"],"1f4f0":["paper","news"],"1f4f1":["phone","ios"],"1f4f2":["phone"],"1f4f3":["symbol"],"1f4f4":["phone"],"1f4f5":["phone","symbol"],"1f4f6":["symbol"],"1f4f7":[],"1f4f9":["camera"],"1f4fa":["television"],"1f4fb":["stereo"],"1f4fc":["tape"],"1f500":["symbol"],"1f501":["symbol"],"1f502":["symbol"],"1f503":["symbol","arrow"],"1f504":["symbol","arrow"],"1f505":["symbol"],"1f506":["symbol"],"1f507":["sound","speaker","volume"],"1f508":["volume","sound"],"1f509":["speaker"],"1f50a":["sound","speaker"],"1f50b":[],"1f50c":["plug","cord"],"1f50d":["zoom","search"],"1f50e":["zoom","search"],"1f50f":["security"],"1f510":[],"1f511":["lock"],"1f512":[],"1f513":["lock","security"],"1f514":[],"1f515":["bell"],"1f516":[],"1f517":["symbol"],"1f518":[],"1f519":["symbol"],"1f51a":["symbol"],"1f51b":["symbol"],"1f51c":["symbol"],"1f51d":["symbol"],"1f51e":["symbol"],"1f51f":["number"],"1f520":["letters"],"1f521":["letters"],"1f522":[],"1f523":[],"1f524":["letters"],"1f525":["flames","burn"],"1f526":["torch"],"1f527":["tool"],"1f528":["tool"],"1f529":[],"1f52a":["knife"],"1f52b":["bullet","shoot"],"1f52c":["science"],"1f52d":[],"1f52e":["future","fortune"],"1f52f":["symbol"],"1f530":["symbol"],"1f531":[],"1f532":["symbol"],"1f533":["symbol"],"1f534":["symbol"],"1f535":["symbol"],"1f536":["symbol"],"1f537":["symbol"],"1f538":["symbol"],"1f539":["symbol"],"1f53a":["symbol"],"1f53b":["symbol"],"1f53c":["symbol","arrow"],"1f53d":["symbol","arrow"],"1f550":["time"],"1f551":["time"],"1f552":["time"],"1f553":["time"],"1f554":["time"],"1f555":["time"],"1f556":["time"],"1f557":["time"],"1f558":["time"],"1f559":["time"],"1f55a":["time"],"1f55b":["time"],"1f55c":["time"],"1f55d":["time"],"1f55e":["time"],"1f55f":["time"],"1f560":["time"],"1f561":["time"],"1f562":["time"],"1f563":["time"],"1f564":["time"],"1f565":["time"],"1f566":["time"],"1f567":["time"],"1f5fb":[],"1f5fc":["building"],"1f5fd":["statue"],"1f5fe":[],"1f5ff":["easter_island_head","statue"],"1f600":["face","people","person"],"1f601":["face","people","person"],"1f602":["happy","face","person","people"],"1f603":["face","person","people"],"1f604":["face","person","people"],"1f605":["face","person","people"],"1f606":["face","person","people","funny","lol"],"1f607":["saint","angel","face","person","people"],"1f608":["face","person","people","devil","evil"],"1f609":["face","person","people"],"1f60a":["smile","face","person","people"],"1f60b":["delicious","face","person","people"],"1f60c":["people","person","face"],"1f60d":["heart","face","person","people"],"1f60e":["shades","face","person","people"],"1f60f":["face","person","people"],"1f610":["nonplussed","face","people","person"],"1f611":["deadpan","face","people","person"],"1f612":["unimpressed","face","person","people"],"1f613":["face","person","people"],"1f614":["face","person","people"],"1f615":["face","person","people"],"1f616":["dumbfounded","face","person","people"],"1f617":["face","person","people"],"1f618":["face","person","people","heart"],"1f619":["face","person","people"],"1f61a":["face","person","people"],"1f61b":["tongue","face","person","people"],"1f61c":["tongue","face","person","people"],"1f61d":["tongue","face","person","people"],"1f61e":["face","person","people"],"1f61f":["face","person","people"],"1f620":["mad","anger","face","people","person"],"1f621":["anger","mad","angry","face","person","people"],"1f622":["tears","face","people","person"],"1f623":["face","person","people"],"1f624":["hmph","person","people","face"],"1f625":["phew","face","person","people"],"1f626":["face","people","person"],"1f627":["upset","shocked","face","people","person"],"1f628":["scared","face","people","person"],"1f629":["face","person","people"],"1f62a":["face","person","people"],"1f62b":["tantrum","face","person","people"],"1f62c":["face","people","person"],"1f62d":["face","person","people"],"1f62e":["surprised","face","people","person"],"1f62f":["face","person","people"],"1f630":["nervous","face","person","people"],"1f631":["face","person","people"],"1f632":["shocked","face","people","person"],"1f633":["embarrassed","face","people","person"],"1f634":["face","person","people"],"1f635":["face","person","people"],"1f636":["face","person","people"],"1f637":[],"1f638":["face","animal","cat"],"1f639":["happy","face","cat","animal"],"1f63a":["face","animal","cat"],"1f63b":["heart","animal","face","cat"],"1f63c":["face","animal","cat"],"1f63d":["face","cat","animal"],"1f63e":["face","animal","cat","sad"],"1f63f":["face","animal","cat"],"1f640":["face","animal","cat"],"1f645":["person","peopl","becky"],"1f646":["woman","people","person","becky"],"1f647":["person","people"],"1f648":["face","animal","monkey"],"1f649":["face","animal","monkey"],"1f64a":["face","monkey","animal"],"1f64b":["hand","people","person","becky"],"1f64c":["hand","people","person"],"1f64d":["face","person","people","sad"],"1f64e":["face","person","people"],"1f64f":["bless","hand","people","person"],"1f680":["spaceship","space"],"1f681":["chopper","fly"],"1f682":["train","transport"],"1f683":["train","transport"],"1f684":["train","transport"],"1f685":["transport"],"1f686":["vehicle","transport"],"1f687":["symbol"],"1f688":["transport","train"],"1f689":["building"],"1f68a":["vehicle","transport","train"],"1f68b":["transport"],"1f68c":["automobile","transport","vehicle"],"1f68d":["bus_front","bus","vehicle","automobile","transport"],"1f68e":["bus","vehicle","automobile"],"1f68f":["bus"],"1f690":["bus","vehicle","transport","automobile"],"1f691":["paramedic"],"1f692":["fire_truck","vehicle","automobile"],"1f693":["cop_car","car","automobile","vehicle","transport"],"1f694":["police_car_front","cop","car","vehicle","automobile","transport"],"1f695":["cab","car","automobile","vehicle","transport"],"1f696":["taxi_fron","cab","car","vehicle","automobile","transport"],"1f697":["vehicle","automobile","transport"],"1f698":["car_front","car","vehicle","automobile","transport"],"1f699":["car","automobile","transport"],"1f69a":["vehicle","automobile","transport"],"1f69b":["truck","automobile","vehicle","transport"],"1f69c":["vehicle","farm"],"1f69d":["train","transport"],"1f69e":["train"],"1f69f":["train","transport"],"1f6a0":["gondola","transport"],"1f6a1":["gondola","transport"],"1f6a2":["boat"],"1f6a3":["boat"],"1f6a4":["boat"],"1f6a5":[],"1f6a6":[],"1f6a7":[],"1f6a8":["siren","police"],"1f6a9":["flag"],"1f6aa":[],"1f6ab":["symbol"],"1f6ac":["cigarette"],"1f6ad":["symbol"],"1f6ae":["symbol","garbage"],"1f6af":["symbol"],"1f6b0":["symbol"],"1f6b1":["symbol"],"1f6b2":["bicycle","cycle","sport","cyclist"],"1f6b3":["bike","symbol"],"1f6b4":["cyclist","bike","sport"],"1f6b5":["bike","cyclist","sport"],"1f6b6":["person","people"],"1f6b7":["symbol"],"1f6b8":["symbol"],"1f6b9":["symbol"],"1f6ba":["symbol"],"1f6bb":["symbol"],"1f6bc":["symbol"],"1f6bd":["bathroom","washroom","restroom"],"1f6be":["symbol"],"1f6bf":["bathroom","restroom","washroom"],"1f6c0":["washroom","restroom"],"1f6c1":["washroom","restroom"],"1f6c2":["symbol"],"1f6c3":["symbol"],"1f6c4":["symbol"],"1f6c5":["symbol"],"0023-20e3":["symbol"],"0030-20e3":["number"],"0031-20e3":["number"],"0032-20e3":["number"],"0033-20e3":["number"],"0034-20e3":["number"],"0035-20e3":["number"],"0036-20e3":["number"],"0037-20e3":["number"],"0038-20e3":["number"],"0039-20e3":["number"],"1f1e6-1f1ea":["flag"],"1f1e6-1f1f9":["flag"],"1f1e6-1f1fa":["flag"],"1f1e7-1f1ea":["flag"],"1f1e7-1f1f7":["flag"],"1f1e8-1f1e6":["flag"],"1f1e8-1f1ed":["flag"],"1f1e8-1f1f1":["flag"],"1f1e8-1f1f3":["flag"],"1f1e8-1f1f4":["flag"],"1f1e9-1f1ea":["flag"],"1f1e9-1f1f0":["flag"],"1f1ea-1f1f8":["flag"],"1f1eb-1f1ee":["flag"],"1f1eb-1f1f7":["flag"],"1f1ec-1f1e7":["flag"],"1f1ed-1f1f0":["flag"],"1f1ee-1f1e9":["flag"],"1f1ee-1f1ea":["flag"],"1f1ee-1f1f1":["flag"],"1f1ee-1f1f3":["flag"],"1f1ee-1f1f9":["flag"],"1f1ef-1f1f5":["flag"],"1f1f0-1f1f7":["flag"],"1f1f2-1f1f4":["flag"],"1f1f2-1f1fd":["flag"],"1f1f2-1f1fe":["flag"],"1f1f3-1f1f1":["flag"],"1f1f3-1f1f4":["flag"],"1f1f3-1f1ff":["flag"],"1f1f5-1f1ed":["flag"],"1f1f5-1f1f1":["flag"],"1f1f5-1f1f7":["flag"],"1f1f5-1f1f9":["flag"],"1f1f7-1f1fa":["flag"],"1f1f8-1f1e6":["flag"],"1f1f8-1f1ea":["flag"],"1f1f8-1f1ec":["flag"],"1f1f9-1f1f7":["flag"],"1f1fa-1f1f8":["flag"],"1f1fb-1f1f3":["flag"],"1f1ff-1f1e6":["flag"],"1f468-200d-1f468-200d-1f466":["person","people","family"],"1f468-200d-1f468-200d-1f466-200d-1f466":["person","people","family"],"1f468-200d-1f468-200d-1f467":["person","people","family"],"1f468-200d-1f468-200d-1f467-200d-1f466":["person","people","family"],"1f468-200d-1f468-200d-1f467-200d-1f467":["person","people","family"],"1f468-200d-1f469-200d-1f466":["person","people","family"],"1f468-200d-1f469-200d-1f466-200d-1f466":["person","people","family"],"1f468-200d-1f469-200d-1f467":["person","people","family"],"1f468-200d-1f469-200d-1f467-200d-1f466":["person","people","family"],"1f468-200d-1f469-200d-1f467-200d-1f467":["person","people","family"],"1f468-200d-2764-fe0f-200d-1f468":["person","people","couple"],"1f468-200d-2764-fe0f-200d-1f48b-200d-1f468":["person","people","couple"],"1f469-200d-1f469-200d-1f466":["family","people","person","woman"],"1f469-200d-1f469-200d-1f466-200d-1f466":["family","people","person","woman"],"1f469-200d-1f469-200d-1f467":["family","people","person","woman"],"1f469-200d-1f469-200d-1f467-200d-1f466":["family","people","person","woman"],"1f469-200d-1f469-200d-1f467-200d-1f467":["family","people","person","woman"],"1f469-200d-2764-fe0f-200d-1f469":["couple","people","person","woman"],"1f469-200d-2764-fe0f-200d-1f48b-200d-1f469":["couple","people","person","woman"]};emoji.unaltered_data=JSON.parse(JSON.stringify(emoji.data));emoji.init_colons();window._private_emoji=window.emoji;delete window.emoji});(function(){var $,AbstractChosen,Chosen,SelectParser,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};SelectParser=function(){function SelectParser(){this.options_index=0;this.parsed=[]}SelectParser.prototype.add_node=function(child){if(child.nodeName.toUpperCase()==="OPTGROUP"){return this.add_group(child)}else{return this.add_option(child)}};SelectParser.prototype.add_group=function(group){var group_position,option,_i,_len,_ref,_results;group_position=this.parsed.length;this.parsed.push({array_index:group_position,group:true,label:this.escapeExpression(group.label),title:group.title?group.title:void 0,children:0,disabled:group.disabled,classes:group.className});_ref=group.childNodes;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];_results.push(this.add_option(option,group_position,group.disabled))}return _results};SelectParser.prototype.add_option=function(option,group_position,group_disabled){if(option.nodeName.toUpperCase()==="OPTION"){if(option.text!==""){if(group_position!=null){this.parsed[group_position].children+=1}this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:option.value,text:option.text,html:option.innerHTML,extra:option.getAttribute("data-additional-search-field"),image:option.getAttribute("data-img-src"),presence_id:option.getAttribute("data-presence-id"),title:option.title?option.title:void 0,selected:option.selected,disabled:group_disabled===true?group_disabled:option.disabled,group_array_index:group_position,group_label:group_position!=null?this.parsed[group_position].label:null,classes:option.className,
style:option.style.cssText})}else{this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:true})}return this.options_index+=1}};SelectParser.prototype.escapeExpression=function(text){var map,unsafe_chars;if(text==null||text===false){return""}if(!/[\&\<\>\"\'\`]/.test(text)){return text}map={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};unsafe_chars=/&(?!\w+;)|[\<\>\"\'\`]/g;return text.replace(unsafe_chars,function(chr){return map[chr]||"&amp;"})};return SelectParser}();SelectParser.select_to_array=function(select){var child,parser,_i,_len,_ref;parser=new SelectParser;_ref=select.childNodes;for(_i=0,_len=_ref.length;_i<_len;_i++){child=_ref[_i];parser.add_node(child)}return parser.parsed};AbstractChosen=function(){function AbstractChosen(form_field,options){this.form_field=form_field;this.options=options!=null?options:{};if(!AbstractChosen.browser_is_supported()){return}this.is_multiple=this.form_field.multiple;if(!this.is_multiple)this.options.multiple_always_open=false;this.set_default_text();this.set_default_values();this.setup();this.set_up_html();this.register_observers();if(this.options.multiple_always_open){this.container_mousedown()}this.on_ready()}AbstractChosen.prototype.set_default_values=function(){var _this=this;this.click_test_action=function(evt){return _this.test_active_click(evt)};this.activate_action=function(evt){return _this.activate_field(evt)};this.active_field=false;this.mouse_on_container=false;this.results_showing=false;this.result_highlighted=null;this.allow_single_deselect=this.options.allow_single_deselect!=null&&this.form_field.options[0]!=null&&this.form_field.options[0].text===""?this.options.allow_single_deselect:false;this.disable_search_threshold=this.options.disable_search_threshold||0;this.disable_search=this.options.disable_search||false;this.enable_split_word_search=this.options.enable_split_word_search!=null?this.options.enable_split_word_search:true;this.group_search=this.options.group_search!=null?this.options.group_search:true;this.search_contains=this.options.search_contains||false;this.single_backstroke_delete=this.options.single_backstroke_delete!=null?this.options.single_backstroke_delete:false;this.max_selected_options=this.options.max_selected_options||Infinity;this.optional_prefix=this.options.optional_prefix||null;this.inherit_select_classes=this.options.inherit_select_classes||false;this.display_selected_options=this.options.display_selected_options!=null?this.options.display_selected_options:true;this.display_disabled_options=this.options.display_disabled_options!=null?this.options.display_disabled_options:true;return this.include_group_label_in_selected=this.options.include_group_label_in_selected||false};AbstractChosen.prototype.set_default_text=function(){if(this.form_field.getAttribute("data-placeholder")){this.default_text=this.form_field.getAttribute("data-placeholder")}else if(this.is_multiple){this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||AbstractChosen.default_multiple_text}else{this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||AbstractChosen.default_single_text}return this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||AbstractChosen.default_no_result_text};AbstractChosen.prototype.choice_label=function(item){if(this.include_group_label_in_selected&&item.group_label!=null){return"<b class='group-name'>"+item.group_label+"</b>"+item.html}else{return item.html}};AbstractChosen.prototype.mouse_enter=function(){return this.mouse_on_container=true};AbstractChosen.prototype.mouse_leave=function(){return this.mouse_on_container=false};AbstractChosen.prototype.input_focus=function(evt){var _this=this;if(this.is_multiple){if(!this.active_field){return setTimeout(function(){return _this.container_mousedown()},50)}}else{if(!this.active_field){return this.activate_field()}}};AbstractChosen.prototype.input_blur=function(evt){var _this=this;if(!this.mouse_on_container){this.active_field=false;return setTimeout(function(){return _this.blur_test()},100)}};AbstractChosen.prototype.results_option_build=function(options){var content,data,_i,_len,_ref;content="";_ref=this.results_data;for(_i=0,_len=_ref.length;_i<_len;_i++){data=_ref[_i];if(data.group){content+=this.result_add_group(data)}else{content+=this.result_add_option(data)}if(options!=null?options.first:void 0){if(data.selected&&this.is_multiple){this.choice_build(data)}else if(data.selected&&!this.is_multiple){this.single_set_selected_text(this.choice_label(data))}}}return content};AbstractChosen.prototype.result_add_option=function(option){var classes,option_el;if(!option.search_match){return""}if(!this.include_option_in_results(option)){return""}classes=[];if(!option.disabled&&!(option.selected&&this.is_multiple)){classes.push("active-result")}if(option.disabled&&!(option.selected&&this.is_multiple)){classes.push("disabled-result")}if(option.selected){classes.push("result-selected")}if(option.group_array_index!=null){classes.push("group-option")}if(option.classes!==""){classes.push(option.classes)}option_el=document.createElement("li");option_el.className=classes.join(" ");option_el.style.cssText=option.style;option_el.setAttribute("data-option-array-index",option.array_index);option_el.innerHTML=option.search_text;if(option.image){$(option_el).prepend($("<img>").attr("src",option.image))}if(option.presence_id&&TS&&TS.members){var member=TS.members.getMemberById(option.presence_id);if(member){$(option_el).append(TS.templates.makeMemberPresenceIcon(member));$(option_el).addClass(member.presence)}}if(option.title){option_el.title=option.title}return this.outerHTML(option_el)};AbstractChosen.prototype.result_add_group=function(group){var classes,group_el;if(!(group.search_match||group.group_match)){return""}if(!(group.active_options>0)){return""}classes=[];classes.push("group-result");if(group.classes){classes.push(group.classes)}group_el=document.createElement("li");group_el.className=classes.join(" ");group_el.innerHTML=group.search_text;if(group.title){group_el.title=group.title}return this.outerHTML(group_el)};AbstractChosen.prototype.results_update_field=function(){this.set_default_text();if(!this.is_multiple){this.results_reset_cleanup()}this.result_clear_highlight();this.results_build();if(this.results_showing){return this.winnow_results()}};AbstractChosen.prototype.reset_single_select_options=function(){var result,_i,_len,_ref,_results;_ref=this.results_data;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){result=_ref[_i];if(result.selected){_results.push(result.selected=false)}else{_results.push(void 0)}}return _results};AbstractChosen.prototype.results_toggle=function(){if(this.results_showing){return this.results_hide()}else{return this.results_show()}};AbstractChosen.prototype.results_search=function(evt){if(this.results_showing){return this.winnow_results()}else{return this.results_show()}};AbstractChosen.prototype.winnow_results=function(){var escapedSearchText,option,regex,results,results_group,searchText,startpos,text,zregex,_i,_len,_ref;this.no_results_clear();results=0;searchText=this.get_search_text();escapedSearchText=searchText.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");zregex=new RegExp(escapedSearchText,"i");regex=this.get_search_regex(escapedSearchText);_ref=this.results_data;for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];option.search_match=false;results_group=null;if(this.include_option_in_results(option)){if(option.group){option.group_match=false;option.active_options=0}if(option.group_array_index!=null&&this.results_data[option.group_array_index]){results_group=this.results_data[option.group_array_index];if(results_group.active_options===0&&results_group.search_match){results+=1}results_group.active_options+=1}option.search_text=(option.group?option.label:option.html)+(option.extra?" "+option.extra:"");if(!(option.group&&!this.group_search)){option.search_match=this.search_string_match(option.search_text,regex);if(option.search_match&&!option.group){results+=1}if(option.search_match){if(searchText.length){startpos=option.search_text.search(zregex);text=option.search_text.substr(0,startpos+searchText.length)+"</em>"+option.search_text.substr(startpos+searchText.length);option.search_text=text.substr(0,startpos)+"<em>"+text.substr(startpos)}if(results_group!=null){results_group.group_match=true}}else if(option.group_array_index!=null&&this.results_data[option.group_array_index].search_match){option.search_match=true}}}}this.result_clear_highlight();if(results<1&&searchText.length){this.update_results_content("");return this.no_results(searchText)}else{this.update_results_content(this.results_option_build());return this.winnow_results_set_highlight()}};AbstractChosen.prototype.get_search_regex=function(escaped_search_string){var regex_anchor;regex_anchor=this.search_contains?"":"^";if(this.optional_prefix){regex_anchor+=this.optional_prefix+"?"}return new RegExp(regex_anchor+escaped_search_string,"i")};AbstractChosen.prototype.search_string_match=function(search_string,regex){var part,parts,_i,_len;if(regex.test(search_string)){return true}else if(this.enable_split_word_search&&(search_string.indexOf(" ")>=0||search_string.indexOf("[")===0)){parts=search_string.replace(/\[|\]/g,"").split(" ");if(parts.length){for(_i=0,_len=parts.length;_i<_len;_i++){part=parts[_i];if(regex.test(part)){return true}}}}};AbstractChosen.prototype.choices_count=function(){var option,_i,_len,_ref;if(this.selected_option_count!=null){return this.selected_option_count}this.selected_option_count=0;_ref=this.form_field.options;for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];if(option.selected){this.selected_option_count+=1}}return this.selected_option_count};AbstractChosen.prototype.choices_click=function(evt){evt.preventDefault();if(!(this.results_showing||this.is_disabled)){return this.results_show()}};AbstractChosen.prototype.keyup_checker=function(evt){var stroke,_ref;stroke=(_ref=evt.which)!=null?_ref:evt.keyCode;this.search_field_scale();switch(stroke){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0){return this.keydown_backstroke()}else if(!this.pending_backstroke){this.result_clear_highlight();return this.results_search()}break;case 13:evt.preventDefault();if(this.results_showing){return this.result_select(evt)}break;case 27:if(this.results_showing){this.results_hide()}return true;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}};AbstractChosen.prototype.clipboard_event_checker=function(evt){var _this=this;return setTimeout(function(){return _this.results_search()},50)};AbstractChosen.prototype.container_width=function(){if(this.options.width!=null){return this.options.width}else{return""+this.form_field.offsetWidth+"px"}};AbstractChosen.prototype.include_option_in_results=function(option){if(this.is_multiple&&(!this.display_selected_options&&option.selected)){return false}if(!this.display_disabled_options&&option.disabled){return false}if(option.empty){return false}return true};AbstractChosen.prototype.search_results_touchstart=function(evt){this.touch_started=true;return this.search_results_mouseover(evt)};AbstractChosen.prototype.search_results_touchmove=function(evt){this.touch_started=false;return this.search_results_mouseout(evt)};AbstractChosen.prototype.search_results_touchend=function(evt){if(this.touch_started){return this.search_results_mouseup(evt)}};AbstractChosen.prototype.outerHTML=function(element){var tmp;if(element.outerHTML){return element.outerHTML}tmp=document.createElement("div");tmp.appendChild(element);return tmp.innerHTML};AbstractChosen.browser_is_supported=function(){if(window.navigator.appName==="Microsoft Internet Explorer"){return document.documentMode>=8}if(/iP(od|hone)/i.test(window.navigator.userAgent)){return false}if(/Android/i.test(window.navigator.userAgent)){if(/Mobile/i.test(window.navigator.userAgent)){return false}}return true};AbstractChosen.default_multiple_text="Select Some Options";AbstractChosen.default_single_text="Select an Option";AbstractChosen.default_no_result_text="No results match";return AbstractChosen}();$=jQuery;$.fn.extend({chosen:function(options){if(!AbstractChosen.browser_is_supported()){return this}return this.each(function(input_field){var $this,chosen;$this=$(this);chosen=$this.data("chosen");if(options==="destroy"&&chosen instanceof Chosen){chosen.destroy()}else if(!(chosen instanceof Chosen)){$this.data("chosen",new Chosen(this,options))}})}});Chosen=function(_super){__extends(Chosen,_super);function Chosen(){_ref=Chosen.__super__.constructor.apply(this,arguments);return _ref}Chosen.prototype.setup=function(){this.form_field_jq=$(this.form_field);this.current_selectedIndex=this.form_field.selectedIndex;return this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")};Chosen.prototype.set_up_html=function(){var container_classes,container_props;container_classes=["chzn-container"];container_classes.push("chzn-container-"+(this.is_multiple?"multi":"single"));if(this.inherit_select_classes&&this.form_field.className){container_classes.push(this.form_field.className)}if(this.is_rtl){container_classes.push("chzn-rtl")}container_props={"class":container_classes.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title};if(this.form_field.id.length){container_props.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chzn"}this.container=$("<div />",container_props);if(this.is_multiple){this.container.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop"><ul class="chzn-results"></ul></div>')}else{this.container.html('<a class="chzn-single chzn-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>')}this.form_field_jq.hide().after(this.container);this.dropdown=this.container.find("div.chzn-drop").first();this.search_field=this.container.find("input").first();this.search_results=this.container.find("ul.chzn-results").first();this.search_field_scale();this.search_no_results=this.container.find("li.no-results").first();if(this.is_multiple){this.search_choices=this.container.find("ul.chzn-choices").first();this.search_container=this.container.find("li.search-field").first()}else{this.search_container=this.container.find("div.chzn-search").first();this.selected_item=this.container.find(".chzn-single").first()}this.results_build();this.set_tab_index();return this.set_label_behavior()};Chosen.prototype.on_ready=function(){return this.form_field_jq.trigger("chosen:ready",{chosen:this})};Chosen.prototype.register_observers=function(){var _this=this;this.container.bind("touchstart.chosen",function(evt){_this.container_mousedown(evt);return evt.preventDefault()});this.container.bind("touchend.chosen",function(evt){_this.container_mouseup(evt);return evt.preventDefault()});this.container.bind("mousedown.chosen",function(evt){_this.container_mousedown(evt)});this.container.bind("mouseup.chosen",function(evt){_this.container_mouseup(evt)});this.container.bind("mouseenter.chosen",function(evt){_this.mouse_enter(evt)});this.container.bind("mouseleave.chosen",function(evt){_this.mouse_leave(evt)});this.search_results.bind("mouseup.chosen",function(evt){_this.search_results_mouseup(evt)});this.search_results.bind("mouseover.chosen",function(evt){_this.search_results_mouseover(evt)});this.search_results.bind("mouseout.chosen",function(evt){_this.search_results_mouseout(evt)});this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(evt){_this.search_results_mousewheel(evt)});this.search_results.bind("touchstart.chosen",function(evt){_this.search_results_touchstart(evt)});this.search_results.bind("touchmove.chosen",function(evt){_this.search_results_touchmove(evt)});this.search_results.bind("touchend.chosen",function(evt){_this.search_results_touchend(evt)});this.form_field_jq.bind("chosen:updated.chosen",function(evt){_this.results_update_field(evt)});this.form_field_jq.bind("chosen:activate.chosen",function(evt){_this.activate_field(evt)});this.form_field_jq.bind("chosen:open.chosen",function(evt){_this.container_mousedown(evt)});this.form_field_jq.bind("chosen:close.chosen",function(evt){_this.input_blur(evt)});this.search_field.bind("blur.chosen",function(evt){_this.input_blur(evt)});this.search_field.bind("keyup.chosen",function(evt){_this.keyup_checker(evt)});this.search_field.bind("keydown.chosen",function(evt){_this.keydown_checker(evt)});this.search_field.bind("focus.chosen",function(evt){_this.input_focus(evt)});this.search_field.bind("cut.chosen",function(evt){_this.clipboard_event_checker(evt)});this.search_field.bind("paste.chosen",function(evt){_this.clipboard_event_checker(evt)});if(this.is_multiple){return this.search_choices.bind("click.chosen",function(evt){_this.choices_click(evt)})}else{return this.container.bind("click.chosen",function(evt){evt.preventDefault()})}};Chosen.prototype.destroy=function(){$(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action);if(this.search_field[0].tabIndex){this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex}this.container.remove();this.form_field_jq.removeData("chosen");return this.form_field_jq.show()};Chosen.prototype.search_field_disabled=function(){this.is_disabled=this.form_field_jq[0].disabled;if(this.is_disabled){this.container.addClass("chzn-disabled");this.search_field[0].disabled=true;if(!this.is_multiple){this.selected_item.unbind("focus.chosen",this.activate_action)}return this.close_field()}else{this.container.removeClass("chzn-disabled");this.search_field[0].disabled=false;if(!this.is_multiple){return this.selected_item.bind("focus.chosen",this.activate_action)}}};Chosen.prototype.container_mousedown=function(evt){if(!this.is_disabled){if(evt&&evt.type==="mousedown"&&!this.results_showing){evt.preventDefault()}if(!(evt!=null&&$(evt.target).hasClass("search-choice-close"))){if(!this.active_field&&!this.multiple_always_open){if(this.is_multiple){this.search_field.val("")}$(this.container[0].ownerDocument).bind("click.chosen",this.click_test_action);this.results_show()}else if(!this.is_multiple&&evt&&($(evt.target)[0]===this.selected_item[0]||$(evt.target).parents("a.chzn-single").length)){evt.preventDefault();this.results_toggle()}return this.activate_field()}}};Chosen.prototype.container_mouseup=function(evt){if(evt.target.nodeName==="ABBR"&&!this.is_disabled){return this.results_reset(evt)}};Chosen.prototype.search_results_mousewheel=function(evt){var delta;if(evt.originalEvent){delta=evt.originalEvent.deltaY||-evt.originalEvent.wheelDelta||evt.originalEvent.detail}if(delta!=null){evt.preventDefault();if(evt.type==="DOMMouseScroll"){delta=delta*40}return this.search_results.scrollTop(delta+this.search_results.scrollTop())}};Chosen.prototype.blur_test=function(evt){if(!this.active_field&&this.container.hasClass("chzn-container-active")){return this.close_field()}};Chosen.prototype.close_field=function(){$(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action);this.active_field=false;this.results_hide();this.container.removeClass("chzn-container-active");this.clear_backstroke();this.show_search_field_default();return this.search_field_scale()};Chosen.prototype.activate_field=function(){this.container.addClass("chzn-container-active");this.active_field=true;this.search_field.val(this.search_field.val());return this.search_field.focus()};Chosen.prototype.test_active_click=function(evt){var active_container;active_container=$(evt.target).closest(".chzn-container");if(active_container.length&&this.container[0]===active_container[0]){return this.active_field=true}else{return this.close_field()}};Chosen.prototype.results_build=function(){this.parsing=true;this.selected_option_count=null;this.results_data=SelectParser.select_to_array(this.form_field);if(this.is_multiple){this.search_choices.find("li.search-choice").remove()}else if(!this.is_multiple){this.single_set_selected_text();if(this.disable_search||this.form_field.options.length<=this.disable_search_threshold){this.search_field[0].readOnly=true;this.container.addClass("chzn-container-single-nosearch")}else{this.search_field[0].readOnly=false;this.container.removeClass("chzn-container-single-nosearch")}}this.update_results_content(this.results_option_build({first:true}));this.search_field_disabled();this.show_search_field_default();this.search_field_scale();return this.parsing=false};Chosen.prototype.result_do_highlight=function(el){var high_bottom,high_top,maxHeight,visible_bottom,visible_top;if(el.length){this.result_clear_highlight();this.result_highlight=el;this.result_highlight.addClass("highlighted");maxHeight=parseInt(this.search_results.css("maxHeight"),10);visible_top=this.search_results.scrollTop();visible_bottom=maxHeight+visible_top;high_top=this.result_highlight.position().top+this.search_results.scrollTop();high_bottom=high_top+this.result_highlight.outerHeight();if(high_bottom>=visible_bottom){return this.search_results.scrollTop(high_bottom-maxHeight>0?high_bottom-maxHeight:0)}else if(high_top<visible_top){return this.search_results.scrollTop(high_top)}}};Chosen.prototype.result_clear_highlight=function(){if(this.result_highlight){this.result_highlight.removeClass("highlighted")}return this.result_highlight=null};Chosen.prototype.results_show=function(){if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",{chosen:this});return false}this.container.addClass("chzn-with-drop");this.results_showing=true;this.search_field.focus();this.search_field.val(this.search_field.val());this.winnow_results();return this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this})};Chosen.prototype.update_results_content=function(content){return this.search_results.html(content)};Chosen.prototype.results_hide=function(){if(this.options.multiple_always_open)return;if(this.results_showing){this.result_clear_highlight();this.container.removeClass("chzn-with-drop");this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})}return this.results_showing=false};Chosen.prototype.set_tab_index=function(el){var ti;if(this.form_field.tabIndex){ti=this.form_field.tabIndex;this.form_field.tabIndex=-1;return this.search_field[0].tabIndex=ti}};Chosen.prototype.set_label_behavior=function(){var _this=this;this.form_field_label=this.form_field_jq.parents("label");if(!this.form_field_label.length&&this.form_field.id.length){this.form_field_label=$("label[for='"+this.form_field.id+"']")}if(this.form_field_label.length>0){return this.form_field_label.bind("click.chosen",function(evt){if(_this.is_multiple){return _this.container_mousedown(evt)}else{return _this.activate_field()}})}};Chosen.prototype.show_search_field_default=function(){if(this.is_multiple&&this.choices_count()<1&&!this.active_field){if(!this.options.multiple_always_open){this.search_field.val(this.default_text)}return this.search_field.addClass("default")}else{this.search_field.val("");return this.search_field.removeClass("default")}};Chosen.prototype.search_results_mouseup=function(evt){var target;target=$(evt.target).hasClass("active-result")?$(evt.target):$(evt.target).parents(".active-result").first();if(target.length){this.result_highlight=target;this.result_select(evt);return this.search_field.focus()}};Chosen.prototype.search_results_mouseover=function(evt){var target;target=$(evt.target).hasClass("active-result")?$(evt.target):$(evt.target).parents(".active-result").first();if(target){return this.result_do_highlight(target)}};Chosen.prototype.search_results_mouseout=function(evt){if($(evt.target).hasClass("active-result"||$(evt.target).parents(".active-result").first())){return this.result_clear_highlight()}};Chosen.prototype.choice_build=function(item){var choice,close_link,_this=this;choice=$("<li />",{"class":"search-choice"}).html("<span>"+this.choice_label(item)+"</span>");if(item.disabled){choice.addClass("search-choice-disabled")}else{close_link=$("<a />",{"class":"search-choice-close","data-option-array-index":item.array_index});close_link.bind("click.chosen",function(evt){return _this.choice_destroy_link_click(evt)});choice.append(close_link)}return this.search_container.before(choice)};Chosen.prototype.choice_destroy_link_click=function(evt){evt.preventDefault();evt.stopPropagation();if(!this.is_disabled){return this.choice_destroy($(evt.target))}};Chosen.prototype.choice_destroy=function(link){if(this.result_deselect(link[0].getAttribute("data-option-array-index"))){if(!this.options.multiple_always_open){this.show_search_field_default();if(this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1){this.results_hide()}}if(this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1){this.results_hide()}link.parents("li").first().remove();if(this.options.multiple_always_open)this.search_field.focus();return this.search_field_scale()}};Chosen.prototype.results_reset=function(){this.reset_single_select_options();this.form_field.options[0].selected=true;this.single_set_selected_text();this.show_search_field_default();this.results_reset_cleanup();this.form_field_jq.trigger("change");if(this.active_field){return this.results_hide()}};Chosen.prototype.results_reset_cleanup=function(){this.current_selectedIndex=this.form_field.selectedIndex;return this.selected_item.find("abbr").remove()};Chosen.prototype.result_select=function(evt){var high,item;if(this.result_highlight){high=this.result_highlight;this.result_clear_highlight();if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",{chosen:this});return false}if(this.is_multiple){high.removeClass("active-result")}else{this.reset_single_select_options()}high.addClass("result-selected");item=this.results_data[high[0].getAttribute("data-option-array-index")];item.selected=true;this.form_field.options[item.options_index].selected=true;this.selected_option_count=null;if(this.is_multiple){this.choice_build(item)}else{this.single_set_selected_text(this.choice_label(item))}if(!((evt.metaKey||evt.ctrlKey)&&this.is_multiple)){this.results_hide()}this.search_field.val("");if(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex){this.form_field_jq.trigger("change",{selected:this.form_field.options[item.options_index].value})}this.current_selectedIndex=this.form_field.selectedIndex;evt.preventDefault();return this.search_field_scale()}};Chosen.prototype.single_set_selected_text=function(text){if(text==null){text=this.default_text}if(text===this.default_text){this.selected_item.addClass("chzn-default")}else{this.single_deselect_control_build();this.selected_item.removeClass("chzn-default")}return this.selected_item.find("span").html(text)};Chosen.prototype.result_deselect=function(pos){var result_data;result_data=this.results_data[pos];if(!this.form_field.options[result_data.options_index].disabled){result_data.selected=false;this.form_field.options[result_data.options_index].selected=false;this.selected_option_count=null;this.result_clear_highlight();if(this.results_showing){this.winnow_results()}this.form_field_jq.trigger("change",{deselected:this.form_field.options[result_data.options_index].value});this.search_field_scale();return true}else{return false}};Chosen.prototype.single_deselect_control_build=function(){if(!this.allow_single_deselect){return}if(!this.selected_item.find("abbr").length){this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')}return this.selected_item.addClass("chzn-single-with-deselect")};Chosen.prototype.get_search_text=function(){return $("<div/>").text($.trim(this.search_field.val())).html()};Chosen.prototype.winnow_results_set_highlight=function(){var do_high,selected_results;selected_results=!this.is_multiple?this.search_results.find(".result-selected.active-result"):[];do_high=selected_results.length?selected_results.first():this.search_results.find(".active-result").first();if(do_high!=null){return this.result_do_highlight(do_high)}};Chosen.prototype.no_results=function(terms){var no_results_html;no_results_html=$('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');no_results_html.find("span").first().html(terms);this.search_results.append(no_results_html);return this.form_field_jq.trigger("chosen:no_results",{chosen:this})};Chosen.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()};Chosen.prototype.keydown_arrow=function(){var next_sib;if(this.results_showing&&this.result_highlight){next_sib=this.result_highlight.nextAll("li.active-result").first();if(next_sib){return this.result_do_highlight(next_sib)}}else{return this.results_show()}};Chosen.prototype.keyup_arrow=function(){var prev_sibs;if(!this.results_showing&&!this.is_multiple){return this.results_show()}else if(this.result_highlight){prev_sibs=this.result_highlight.prevAll("li.active-result");if(prev_sibs.length){return this.result_do_highlight(prev_sibs.first())}else{if(this.choices_count()>0){this.results_hide()}return this.result_clear_highlight()}}};Chosen.prototype.key_tab=function(evt){var next_sib;if(this.results_showing&&this.result_highlight){evt.preventDefault();next_sib=this.result_highlight.nextAll("li.active-result").first();if(next_sib.length){return this.result_do_highlight(next_sib)}else{var first_result=this.search_results.find(".active-result").first();return this.result_do_highlight(first_result)}}};Chosen.prototype.key_tab_shift=function(evt){var next_sib;if(this.results_showing&&this.result_highlight){evt.preventDefault();prev_sib=this.result_highlight.prevAll("li.active-result").first();if(prev_sib.length){return this.result_do_highlight(prev_sib)}else{var last_result=this.search_results.find(".active-result").last();return this.result_do_highlight(last_result)}}};Chosen.prototype.keydown_backstroke=function(){var next_available_destroy;if(this.pending_backstroke){this.choice_destroy(this.pending_backstroke.find("a").first());return this.clear_backstroke()}else{next_available_destroy=this.search_container.siblings("li.search-choice").last();if(next_available_destroy.length&&!next_available_destroy.hasClass("search-choice-disabled")){this.pending_backstroke=next_available_destroy;if(this.single_backstroke_delete){return this.keydown_backstroke()}else{return this.pending_backstroke.addClass("search-choice-focus")}}}};Chosen.prototype.clear_backstroke=function(){if(this.pending_backstroke){this.pending_backstroke.removeClass("search-choice-focus")}return this.pending_backstroke=null};Chosen.prototype.keydown_checker=function(evt){var stroke,_ref1;stroke=(_ref1=evt.which)!=null?_ref1:evt.keyCode;this.search_field_scale();if(stroke!==8&&this.pending_backstroke){this.clear_backstroke()}switch(stroke){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:if(evt.shiftKey){this.key_tab_shift(evt)}else{this.key_tab(evt)}break;case 13:if(this.results_showing){evt.preventDefault()}break;case 32:if(this.disable_search){evt.preventDefault()}break;case 38:evt.preventDefault();this.keyup_arrow();break;case 40:evt.preventDefault();this.keydown_arrow();break}};Chosen.prototype.search_field_scale=function(){var div,f_width,h,style,style_block,styles,w,_i,_len;if(this.is_multiple){h=0;w=0;style_block="position:absolute; left: -1000px; top: -1000px; display:none;";styles=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];for(_i=0,_len=styles.length;_i<_len;_i++){style=styles[_i];style_block+=style+":"+this.search_field.css(style)+";";
}div=$("<div />",{style:style_block});div.text(this.search_field.val());$("body").append(div);w=div.width()+25;div.remove();f_width=this.container.outerWidth();if(w>f_width-10){w=f_width-10}return this.search_field.css({width:w+"px"})}};return Chosen}(AbstractChosen)}).call(this);(function($,window,document,undefined){var $window=$(window);var loaded_url_cache={};var window_cache={innerHeight:null,scrollTop:null,scrollLeft:null};var active_instances=0;var window_events_attached=false;var cache_count=0;function resize_handler(){window_cache.innerHeight=window.innerHeight||$window.height();window_cache.scrollTop=$window.scrollTop();window_cache.scrollLeft=$window.scrollLeft()}function scroll_handler(){window_cache.scrollLeft=$window.scrollLeft();window_cache.scrollTop=$window.scrollTop()}function attach_window_events(){if(window_events_attached){return}$window.bind("scroll",scroll_handler);$window.bind("resize",resize_handler);scroll_handler();resize_handler();window_events_attached=true}function detach_window_events(){if(!window_events_attached){return}window_events_attached=false;$window.unbind("scroll",scroll_handler);$window.unbind("resize",resize_handler)}function add_lazyload_instance(){attach_window_events();active_instances++}function remove_lazyload_instance(){active_instances=Math.max(0,active_instances-1);if(active_instances===0){detach_window_events()}}$.fn.lazyload=function(options){var elements=this;var $container;var $ignore_when_hidden_element;var layout_cache=null;var size_cache={width:null,height:null};var settings={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:window,data_attribute:"original",skip_invisible:options&&options.skip_invisible!==undefined?options.skip_invisible:true,ignore_when_hidden_element:options&&options.ignore_when_hidden_element?options.ignore_when_hidden_element:null,check_horizontal_offscreen:options&&options.check_horizontal_offscreen!==undefined?options.check_horizontal_offscreen:false,all_images_same_size:options&&options.all_images_same_size!==undefined?options.all_images_same_size:false,appear:null,load:null,placeholder:null};add_lazyload_instance();options=options||{};options.throttle=options.throttle||125;function update_wrapper(){if(!$container||!$container.length){return}if(window.TS===undefined||!options.throttle){cache_get_layout(true);return update()}else{TS.utility.throttle.method(function(){cache_get_layout(true);update()},"jquery_lazyload",options.throttle)}}function cache_get_layout(ignore_cache){if(!$container||!$container.length){return}if(!layout_cache||ignore_cache){layout_cache={container_offset:$container.offset(),container_width:$container.width(),container_height:$container.height()}}return layout_cache}function belowthefold(element,settings,element_offset,layout_cache){var fold;if(settings.container===undefined||settings.container===window){fold=window_cache.scrollTop+window_cache.innerHeight}else{fold=layout_cache.container_offset.top+layout_cache.container_height}return fold<=element_offset.top-settings.threshold}function rightoffold(element,settings,element_offset,layout_cache){var fold;if(settings.container===undefined||settings.container===window){fold=window_cache.width+window_cache.scrollLeft}else{fold=layout_cache.container_offset.left+layout_cache.container_width}return fold<=element_offset.left-settings.threshold}function abovethetop(element,settings,element_offset,layout_cache){var fold;if(settings.container===undefined||settings.container===window){fold=window_cache.scrollTop}else{fold=layout_cache.container_offset.top}return fold>=element_offset.top+settings.threshold+(size_cache.height||$(element).height())}function leftofbegin(element,settings,element_offset,layout_cache){var fold;if(settings.container===undefined||settings.container===window){fold=window_cache.scrollLeft}else{fold=layout_cache.container_offset.left}return fold>=element_offset.left+settings.threshold+(size_cache.width||$(element).width())}function update(){var counter=0;var loaded=0;var element_count;if(!elements||!elements.each||!elements.length){detachEvents();return false}element_count=elements.length;if(settings.skip_invisible){if($ignore_when_hidden_element&&$ignore_when_hidden_element[0]&&(!$ignore_when_hidden_element[0].offsetWidth||!$ignore_when_hidden_element[0].offsetHeight)){return}else if($container[0]&&$container[0]!==window&&(!$container[0].offsetWidth||!$container[0].offsetHeight)){return}}if(settings.all_images_same_size&&!size_cache.width&&elements&&elements[0]){size_cache.width=$(elements[0]).width();size_cache.height=$(elements[0]).height()}layout_cache=cache_get_layout();elements.each(function(index){var $this=$(this);if(settings.skip_invisible&&(!$this[0].offsetWidth||!$this[0].offsetHeight)){$this=null;return}var element_offset=$this.offset();if(abovethetop(this,settings,element_offset,layout_cache)||settings.check_horizontal_offscreen&&leftofbegin(this,settings,element_offset,layout_cache)){}else if(!belowthefold(this,settings,element_offset,layout_cache)&&(!settings.check_horizontal_offscreen||!rightoffold(this,settings,element_offset,layout_cache))){$this.trigger("appear");counter=0}else{if(++counter>settings.failure_limit){$this=null;return false}}$this=null})}function detachEvents(){if($container&&elements){$container.unbind(settings.event+".lazyload");$window.unbind("resize",update_wrapper);$window.unbind("resize-immediate",update);elements.each(function(){$(this).unbind()})}$container=null;$ignore_when_hidden_element=null;elements=null;remove_lazyload_instance()}function detachSome(element){if(!elements)return;elements=elements.not(element);if(!elements.length){detachEvents()}}if(options){$.extend(settings,options)}$container=settings.container===undefined||settings.container===window?$window:$(settings.container);$ignore_when_hidden_element=settings.ignore_when_hidden_element;if(settings.event.indexOf("scroll")===0){$container.bind(settings.event+".lazyload",update_wrapper)}this.each(function(){var self=this;var $self=$(self);var src=$self.attr("src");var data_src=$self.attr("data-"+settings.data_attribute);self.loaded=false;function imgLoaded(){var temp;if($self.is("img")){$self.attr("src",data_src)}else{if(data_src.indexOf("url(")!==-1){$self.css("background-image",data_src)}else{$self.css("background-image","url('"+data_src+"')")}}self.loaded=true;if(elements){temp=$.grep(elements,function(element){return!element.loaded});elements=$(temp)}loaded_url_cache[data_src]=true;if(settings.load&&elements){var elements_left=elements.length;settings.load.call(self,elements_left,settings)}$self.trigger("lazyloaded")}$self.one("appear",function(){if(!this.loaded){if(settings.appear){if(elements){var elements_left=elements.length;settings.appear.call(self,elements_left,settings)}}if(data_src.indexOf("url(")!==-1){imgLoaded()}else{var $img=$(new Image);$img.one("load",imgLoaded);$img.attr("src",data_src)}}});if(src===undefined||src===false){if($self.is("img")){if(loaded_url_cache[data_src]){$self.trigger("appear")}else if(settings.placeholder){$self.attr("src",settings.placeholder)}}}else{if(loaded_url_cache[data_src]){$self.trigger("appear")}}if(settings.event.indexOf("scroll")!==0){$self.bind(settings.event,function(){if(!self.loaded){$self.trigger("appear")}})}});$window.bind("resize",update_wrapper);$window.bind("resize-immediate",update);if(/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)){$window.bind("pageshow",function(event){if(event.originalEvent&&event.originalEvent.persisted){elements.each(function(){$(this).trigger("appear")})}})}$(document).ready(update_wrapper);this.detachEvents=detachEvents;this.detachSome=detachSome;return this}})(jQuery,window,document);(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory();else if(typeof define==="function"&&define.amd)define(factory);else if(typeof exports==="object")exports["Handlebars"]=factory();else root["Handlebars"]=factory()})(this,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(8)["default"];exports.__esModule=true;var _runtime=__webpack_require__(1);var _runtime2=_interopRequireWildcard(_runtime);var _AST=__webpack_require__(2);var _AST2=_interopRequireWildcard(_AST);var _Parser$parse=__webpack_require__(3);var _Compiler$compile$precompile=__webpack_require__(4);var _JavaScriptCompiler=__webpack_require__(5);var _JavaScriptCompiler2=_interopRequireWildcard(_JavaScriptCompiler);var _Visitor=__webpack_require__(6);var _Visitor2=_interopRequireWildcard(_Visitor);var _noConflict=__webpack_require__(7);var _noConflict2=_interopRequireWildcard(_noConflict);var _create=_runtime2["default"].create;function create(){var hb=_create();hb.compile=function(input,options){return _Compiler$compile$precompile.compile(input,options,hb)};hb.precompile=function(input,options){return _Compiler$compile$precompile.precompile(input,options,hb)};hb.AST=_AST2["default"];hb.Compiler=_Compiler$compile$precompile.Compiler;hb.JavaScriptCompiler=_JavaScriptCompiler2["default"];hb.Parser=_Parser$parse.parser;hb.parse=_Parser$parse.parse;return hb}var inst=create();inst.create=create;_noConflict2["default"](inst);inst.Visitor=_Visitor2["default"];inst["default"]=inst;exports["default"]=inst;module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(8)["default"];exports.__esModule=true;var _import=__webpack_require__(9);var base=_interopRequireWildcard(_import);var _SafeString=__webpack_require__(10);var _SafeString2=_interopRequireWildcard(_SafeString);var _Exception=__webpack_require__(11);var _Exception2=_interopRequireWildcard(_Exception);var _import2=__webpack_require__(12);var Utils=_interopRequireWildcard(_import2);var _import3=__webpack_require__(13);var runtime=_interopRequireWildcard(_import3);var _noConflict=__webpack_require__(7);var _noConflict2=_interopRequireWildcard(_noConflict);function create(){var hb=new base.HandlebarsEnvironment;Utils.extend(hb,base);hb.SafeString=_SafeString2["default"];hb.Exception=_Exception2["default"];hb.Utils=Utils;hb.escapeExpression=Utils.escapeExpression;hb.VM=runtime;hb.template=function(spec){return runtime.template(spec,hb)};return hb}var inst=create();inst.create=create;_noConflict2["default"](inst);inst["default"]=inst;exports["default"]=inst;module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;var AST={Program:function Program(statements,blockParams,strip,locInfo){this.loc=locInfo;this.type="Program";this.body=statements;this.blockParams=blockParams;this.strip=strip},MustacheStatement:function MustacheStatement(path,params,hash,escaped,strip,locInfo){this.loc=locInfo;this.type="MustacheStatement";this.path=path;this.params=params||[];this.hash=hash;this.escaped=escaped;this.strip=strip},BlockStatement:function BlockStatement(path,params,hash,program,inverse,openStrip,inverseStrip,closeStrip,locInfo){this.loc=locInfo;this.type="BlockStatement";this.path=path;this.params=params||[];this.hash=hash;this.program=program;this.inverse=inverse;this.openStrip=openStrip;this.inverseStrip=inverseStrip;this.closeStrip=closeStrip},PartialStatement:function PartialStatement(name,params,hash,strip,locInfo){this.loc=locInfo;this.type="PartialStatement";this.name=name;this.params=params||[];this.hash=hash;this.indent="";this.strip=strip},ContentStatement:function ContentStatement(string,locInfo){this.loc=locInfo;this.type="ContentStatement";this.original=this.value=string},CommentStatement:function CommentStatement(comment,strip,locInfo){this.loc=locInfo;this.type="CommentStatement";this.value=comment;this.strip=strip},SubExpression:function SubExpression(path,params,hash,locInfo){this.loc=locInfo;this.type="SubExpression";this.path=path;this.params=params||[];this.hash=hash},PathExpression:function PathExpression(data,depth,parts,original,locInfo){this.loc=locInfo;this.type="PathExpression";this.data=data;this.original=original;this.parts=parts;this.depth=depth},StringLiteral:function StringLiteral(string,locInfo){this.loc=locInfo;this.type="StringLiteral";this.original=this.value=string},NumberLiteral:function NumberLiteral(number,locInfo){this.loc=locInfo;this.type="NumberLiteral";this.original=this.value=Number(number)},BooleanLiteral:function BooleanLiteral(bool,locInfo){this.loc=locInfo;this.type="BooleanLiteral";this.original=this.value=bool==="true"},UndefinedLiteral:function UndefinedLiteral(locInfo){this.loc=locInfo;this.type="UndefinedLiteral";this.original=this.value=undefined},NullLiteral:function NullLiteral(locInfo){this.loc=locInfo;this.type="NullLiteral";this.original=this.value=null},Hash:function Hash(pairs,locInfo){this.loc=locInfo;this.type="Hash";this.pairs=pairs},HashPair:function HashPair(key,value,locInfo){this.loc=locInfo;this.type="HashPair";this.key=key;this.value=value},helpers:{helperExpression:function helperExpression(node){return!!(node.type==="SubExpression"||node.params.length||node.hash)},scopedId:function scopedId(path){return/^\.|this\b/.test(path.original)},simpleId:function simpleId(path){return path.parts.length===1&&!AST.helpers.scopedId(path)&&!path.depth}}};exports["default"]=AST;module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(8)["default"];exports.__esModule=true;exports.parse=parse;var _parser=__webpack_require__(14);var _parser2=_interopRequireWildcard(_parser);var _AST=__webpack_require__(2);var _AST2=_interopRequireWildcard(_AST);var _WhitespaceControl=__webpack_require__(15);var _WhitespaceControl2=_interopRequireWildcard(_WhitespaceControl);var _import=__webpack_require__(16);var Helpers=_interopRequireWildcard(_import);var _extend=__webpack_require__(12);exports.parser=_parser2["default"];var yy={};_extend.extend(yy,Helpers,_AST2["default"]);function parse(input,options){if(input.type==="Program"){return input}_parser2["default"].yy=yy;yy.locInfo=function(locInfo){return new yy.SourceLocation(options&&options.srcName,locInfo)};var strip=new _WhitespaceControl2["default"];return strip.accept(_parser2["default"].parse(input))}},function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(8)["default"];exports.__esModule=true;exports.Compiler=Compiler;exports.precompile=precompile;exports.compile=compile;var _Exception=__webpack_require__(11);var _Exception2=_interopRequireWildcard(_Exception);var _isArray$indexOf=__webpack_require__(12);var _AST=__webpack_require__(2);var _AST2=_interopRequireWildcard(_AST);var slice=[].slice;function Compiler(){}Compiler.prototype={compiler:Compiler,equals:function equals(other){var len=this.opcodes.length;if(other.opcodes.length!==len){return false}for(var i=0;i<len;i++){var opcode=this.opcodes[i],otherOpcode=other.opcodes[i];if(opcode.opcode!==otherOpcode.opcode||!argEquals(opcode.args,otherOpcode.args)){return false}}len=this.children.length;for(var i=0;i<len;i++){if(!this.children[i].equals(other.children[i])){return false}}return true},guid:0,compile:function compile(program,options){this.sourceNode=[];this.opcodes=[];this.children=[];this.options=options;this.stringParams=options.stringParams;this.trackIds=options.trackIds;options.blockParams=options.blockParams||[];var knownHelpers=options.knownHelpers;options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,"if":true,unless:true,"with":true,log:true,lookup:true};if(knownHelpers){for(var _name in knownHelpers){if(_name in knownHelpers){options.knownHelpers[_name]=knownHelpers[_name]}}}return this.accept(program)},compileProgram:function compileProgram(program){var childCompiler=new this.compiler,result=childCompiler.compile(program,this.options),guid=this.guid++;this.usePartial=this.usePartial||result.usePartial;this.children[guid]=result;this.useDepths=this.useDepths||result.useDepths;return guid},accept:function accept(node){this.sourceNode.unshift(node);var ret=this[node.type](node);this.sourceNode.shift();return ret},Program:function Program(program){this.options.blockParams.unshift(program.blockParams);var body=program.body,bodyLength=body.length;for(var i=0;i<bodyLength;i++){this.accept(body[i])}this.options.blockParams.shift();this.isSimple=bodyLength===1;this.blockParams=program.blockParams?program.blockParams.length:0;return this},BlockStatement:function BlockStatement(block){transformLiteralToPath(block);var program=block.program,inverse=block.inverse;program=program&&this.compileProgram(program);inverse=inverse&&this.compileProgram(inverse);var type=this.classifySexpr(block);if(type==="helper"){this.helperSexpr(block,program,inverse)}else if(type==="simple"){this.simpleSexpr(block);this.opcode("pushProgram",program);this.opcode("pushProgram",inverse);this.opcode("emptyHash");this.opcode("blockValue",block.path.original)}else{this.ambiguousSexpr(block,program,inverse);this.opcode("pushProgram",program);this.opcode("pushProgram",inverse);this.opcode("emptyHash");this.opcode("ambiguousBlockValue")}this.opcode("append")},PartialStatement:function PartialStatement(partial){this.usePartial=true;var params=partial.params;if(params.length>1){throw new _Exception2["default"]("Unsupported number of partial arguments: "+params.length,partial)}else if(!params.length){params.push({type:"PathExpression",parts:[],depth:0})}var partialName=partial.name.original,isDynamic=partial.name.type==="SubExpression";if(isDynamic){this.accept(partial.name)}this.setupFullMustacheParams(partial,undefined,undefined,true);var indent=partial.indent||"";if(this.options.preventIndent&&indent){this.opcode("appendContent",indent);indent=""}this.opcode("invokePartial",isDynamic,partialName,indent);this.opcode("append")},MustacheStatement:function MustacheStatement(mustache){this.SubExpression(mustache);if(mustache.escaped&&!this.options.noEscape){this.opcode("appendEscaped")}else{this.opcode("append")}},ContentStatement:function ContentStatement(content){if(content.value){this.opcode("appendContent",content.value)}},CommentStatement:function CommentStatement(){},SubExpression:function SubExpression(sexpr){transformLiteralToPath(sexpr);var type=this.classifySexpr(sexpr);if(type==="simple"){this.simpleSexpr(sexpr)}else if(type==="helper"){this.helperSexpr(sexpr)}else{this.ambiguousSexpr(sexpr)}},ambiguousSexpr:function ambiguousSexpr(sexpr,program,inverse){var path=sexpr.path,name=path.parts[0],isBlock=program!=null||inverse!=null;this.opcode("getContext",path.depth);this.opcode("pushProgram",program);this.opcode("pushProgram",inverse);this.accept(path);this.opcode("invokeAmbiguous",name,isBlock)},simpleSexpr:function simpleSexpr(sexpr){this.accept(sexpr.path);this.opcode("resolvePossibleLambda")},helperSexpr:function helperSexpr(sexpr,program,inverse){var params=this.setupFullMustacheParams(sexpr,program,inverse),path=sexpr.path,name=path.parts[0];if(this.options.knownHelpers[name]){this.opcode("invokeKnownHelper",params.length,name)}else if(this.options.knownHelpersOnly){throw new _Exception2["default"]("You specified knownHelpersOnly, but used the unknown helper "+name,sexpr)}else{path.falsy=true;this.accept(path);this.opcode("invokeHelper",params.length,path.original,_AST2["default"].helpers.simpleId(path))}},PathExpression:function PathExpression(path){this.addDepth(path.depth);this.opcode("getContext",path.depth);var name=path.parts[0],scoped=_AST2["default"].helpers.scopedId(path),blockParamId=!path.depth&&!scoped&&this.blockParamIndex(name);if(blockParamId){this.opcode("lookupBlockParam",blockParamId,path.parts)}else if(!name){this.opcode("pushContext")}else if(path.data){this.options.data=true;this.opcode("lookupData",path.depth,path.parts)}else{this.opcode("lookupOnContext",path.parts,path.falsy,scoped)}},StringLiteral:function StringLiteral(string){this.opcode("pushString",string.value)},NumberLiteral:function NumberLiteral(number){this.opcode("pushLiteral",number.value)},BooleanLiteral:function BooleanLiteral(bool){this.opcode("pushLiteral",bool.value)},UndefinedLiteral:function UndefinedLiteral(){this.opcode("pushLiteral","undefined")},NullLiteral:function NullLiteral(){this.opcode("pushLiteral","null")},Hash:function Hash(hash){var pairs=hash.pairs,i=0,l=pairs.length;this.opcode("pushHash");for(;i<l;i++){this.pushParam(pairs[i].value)}while(i--){this.opcode("assignToHash",pairs[i].key)}this.opcode("popHash")},opcode:function opcode(name){this.opcodes.push({opcode:name,args:slice.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function addDepth(depth){if(!depth){return}this.useDepths=true},classifySexpr:function classifySexpr(sexpr){var isSimple=_AST2["default"].helpers.simpleId(sexpr.path);var isBlockParam=isSimple&&!!this.blockParamIndex(sexpr.path.parts[0]);var isHelper=!isBlockParam&&_AST2["default"].helpers.helperExpression(sexpr);var isEligible=!isBlockParam&&(isHelper||isSimple);if(isEligible&&!isHelper){var _name2=sexpr.path.parts[0],options=this.options;if(options.knownHelpers[_name2]){isHelper=true}else if(options.knownHelpersOnly){isEligible=false}}if(isHelper){return"helper"}else if(isEligible){return"ambiguous"}else{return"simple"}},pushParams:function pushParams(params){for(var i=0,l=params.length;i<l;i++){this.pushParam(params[i])}},pushParam:function pushParam(val){var value=val.value!=null?val.value:val.original||"";if(this.stringParams){if(value.replace){value=value.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")}if(val.depth){this.addDepth(val.depth)}this.opcode("getContext",val.depth||0);this.opcode("pushStringParam",value,val.type);if(val.type==="SubExpression"){this.accept(val)}}else{if(this.trackIds){var blockParamIndex=undefined;if(val.parts&&!_AST2["default"].helpers.scopedId(val)&&!val.depth){blockParamIndex=this.blockParamIndex(val.parts[0])}if(blockParamIndex){var blockParamChild=val.parts.slice(1).join(".");this.opcode("pushId","BlockParam",blockParamIndex,blockParamChild)}else{value=val.original||value;if(value.replace){value=value.replace(/^\.\//g,"").replace(/^\.$/g,"")}this.opcode("pushId",val.type,value)}}this.accept(val)}},setupFullMustacheParams:function setupFullMustacheParams(sexpr,program,inverse,omitEmpty){var params=sexpr.params;this.pushParams(params);this.opcode("pushProgram",program);this.opcode("pushProgram",inverse);if(sexpr.hash){this.accept(sexpr.hash)}else{this.opcode("emptyHash",omitEmpty)}return params},blockParamIndex:function blockParamIndex(name){for(var depth=0,len=this.options.blockParams.length;depth<len;depth++){var blockParams=this.options.blockParams[depth],param=blockParams&&_isArray$indexOf.indexOf(blockParams,name);if(blockParams&&param>=0){return[depth,param]}}}};function precompile(input,options,env){if(input==null||typeof input!=="string"&&input.type!=="Program"){throw new _Exception2["default"]("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+input)}options=options||{};if(!("data"in options)){options.data=true}if(options.compat){options.useDepths=true}var ast=env.parse(input,options),environment=(new env.Compiler).compile(ast,options);return(new env.JavaScriptCompiler).compile(environment,options)}function compile(input,_x,env){var options=arguments[1]===undefined?{}:arguments[1];if(input==null||typeof input!=="string"&&input.type!=="Program"){throw new _Exception2["default"]("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+input)}if(!("data"in options)){options.data=true}if(options.compat){options.useDepths=true}var compiled=undefined;function compileInput(){var ast=env.parse(input,options),environment=(new env.Compiler).compile(ast,options),templateSpec=(new env.JavaScriptCompiler).compile(environment,options,undefined,true);return env.template(templateSpec)}function ret(context,execOptions){if(!compiled){compiled=compileInput()}return compiled.call(this,context,execOptions)}ret._setup=function(setupOptions){if(!compiled){compiled=compileInput()}return compiled._setup(setupOptions)};ret._child=function(i,data,blockParams,depths){if(!compiled){compiled=compileInput()}return compiled._child(i,data,blockParams,depths)};return ret}function argEquals(a,b){if(a===b){return true}if(_isArray$indexOf.isArray(a)&&_isArray$indexOf.isArray(b)&&a.length===b.length){for(var i=0;i<a.length;i++){if(!argEquals(a[i],b[i])){return false}}return true}}function transformLiteralToPath(sexpr){if(!sexpr.path.parts){var literal=sexpr.path;sexpr.path=new _AST2["default"].PathExpression(false,0,[literal.original+""],literal.original+"",literal.loc)}}},function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(8)["default"];exports.__esModule=true;var _COMPILER_REVISION$REVISION_CHANGES=__webpack_require__(9);var _Exception=__webpack_require__(11);var _Exception2=_interopRequireWildcard(_Exception);var _isArray=__webpack_require__(12);var _CodeGen=__webpack_require__(17);var _CodeGen2=_interopRequireWildcard(_CodeGen);function Literal(value){this.value=value}function JavaScriptCompiler(){}JavaScriptCompiler.prototype={nameLookup:function nameLookup(parent,name){if(JavaScriptCompiler.isValidJavaScriptVariableName(name)){return[parent,".",name]}else{return[parent,"['",name,"']"]}},depthedLookup:function depthedLookup(name){return[this.aliasable("this.lookup"),'(depths, "',name,'")']},compilerInfo:function compilerInfo(){var revision=_COMPILER_REVISION$REVISION_CHANGES.COMPILER_REVISION,versions=_COMPILER_REVISION$REVISION_CHANGES.REVISION_CHANGES[revision];return[revision,versions]},appendToBuffer:function appendToBuffer(source,location,explicit){if(!_isArray.isArray(source)){source=[source]}source=this.source.wrap(source,location);if(this.environment.isSimple){return["return ",source,";"]}else if(explicit){return["buffer += ",source,";"]}else{source.appendToBuffer=true;return source}},initializeBuffer:function initializeBuffer(){return this.quotedString("")},compile:function compile(environment,options,context,asObject){this.environment=environment;this.options=options;this.stringParams=this.options.stringParams;this.trackIds=this.options.trackIds;this.precompile=!asObject;this.name=this.environment.name;this.isChild=!!context;this.context=context||{programs:[],environments:[]};this.preamble();this.stackSlot=0;this.stackVars=[];this.aliases={};this.registers={list:[]};this.hashes=[];this.compileStack=[];this.inlineStack=[];this.blockParams=[];this.compileChildren(environment,options);this.useDepths=this.useDepths||environment.useDepths||this.options.compat;this.useBlockParams=this.useBlockParams||environment.useBlockParams;var opcodes=environment.opcodes,opcode=undefined,firstLoc=undefined,i=undefined,l=undefined;for(i=0,l=opcodes.length;i<l;i++){opcode=opcodes[i];this.source.currentLocation=opcode.loc;firstLoc=firstLoc||opcode.loc;this[opcode.opcode].apply(this,opcode.args)}this.source.currentLocation=firstLoc;this.pushSource("");if(this.stackSlot||this.inlineStack.length||this.compileStack.length){throw new _Exception2["default"]("Compile completed with content left on stack")}var fn=this.createFunctionContext(asObject);if(!this.isChild){var ret={compiler:this.compilerInfo(),main:fn};var programs=this.context.programs;for(i=0,l=programs.length;i<l;i++){if(programs[i]){ret[i]=programs[i]}}if(this.environment.usePartial){ret.usePartial=true}if(this.options.data){ret.useData=true}if(this.useDepths){ret.useDepths=true}if(this.useBlockParams){ret.useBlockParams=true}if(this.options.compat){ret.compat=true}if(!asObject){ret.compiler=JSON.stringify(ret.compiler);this.source.currentLocation={start:{line:1,column:0}};ret=this.objectLiteral(ret);if(options.srcName){ret=ret.toStringWithSourceMap({file:options.destName});ret.map=ret.map&&ret.map.toString()}else{ret=ret.toString()}}else{ret.compilerOptions=this.options}return ret}else{return fn}},preamble:function preamble(){this.lastContext=0;this.source=new _CodeGen2["default"](this.options.srcName)},createFunctionContext:function createFunctionContext(asObject){var varDeclarations="";var locals=this.stackVars.concat(this.registers.list);if(locals.length>0){varDeclarations+=", "+locals.join(", ")}var aliasCount=0;for(var alias in this.aliases){var node=this.aliases[alias];if(this.aliases.hasOwnProperty(alias)&&node.children&&node.referenceCount>1){varDeclarations+=", alias"+ ++aliasCount+"="+alias;node.children[0]="alias"+aliasCount}}var params=["depth0","helpers","partials","data"];if(this.useBlockParams||this.useDepths){params.push("blockParams")}if(this.useDepths){params.push("depths")}var source=this.mergeSource(varDeclarations);if(asObject){params.push(source);return Function.apply(this,params)}else{return this.source.wrap(["function(",params.join(","),") {\n  ",source,"}"])}},mergeSource:function mergeSource(varDeclarations){var isSimple=this.environment.isSimple,appendOnly=!this.forceBuffer,appendFirst=undefined,sourceSeen=undefined,bufferStart=undefined,bufferEnd=undefined;this.source.each(function(line){if(line.appendToBuffer){if(bufferStart){line.prepend("  + ")}else{bufferStart=line}bufferEnd=line}else{if(bufferStart){if(!sourceSeen){appendFirst=true}else{bufferStart.prepend("buffer += ")}bufferEnd.add(";");bufferStart=bufferEnd=undefined}sourceSeen=true;if(!isSimple){appendOnly=false}}});if(appendOnly){if(bufferStart){bufferStart.prepend("return ");bufferEnd.add(";")}else if(!sourceSeen){this.source.push('return "";')}}else{varDeclarations+=", buffer = "+(appendFirst?"":this.initializeBuffer());if(bufferStart){bufferStart.prepend("return buffer + ");bufferEnd.add(";")}else{this.source.push("return buffer;")}}if(varDeclarations){this.source.prepend("var "+varDeclarations.substring(2)+(appendFirst?"":";\n"))}return this.source.merge()},blockValue:function blockValue(name){var blockHelperMissing=this.aliasable("helpers.blockHelperMissing"),params=[this.contextName(0)];this.setupHelperArgs(name,0,params);var blockName=this.popStack();params.splice(1,0,blockName);this.push(this.source.functionCall(blockHelperMissing,"call",params))},ambiguousBlockValue:function ambiguousBlockValue(){var blockHelperMissing=this.aliasable("helpers.blockHelperMissing"),params=[this.contextName(0)];this.setupHelperArgs("",0,params,true);this.flushInline();var current=this.topStack();params.splice(1,0,current);this.pushSource(["if (!",this.lastHelper,") { ",current," = ",this.source.functionCall(blockHelperMissing,"call",params),"}"])},appendContent:function appendContent(content){if(this.pendingContent){content=this.pendingContent+content}else{this.pendingLocation=this.source.currentLocation}this.pendingContent=content},append:function append(){if(this.isInline()){this.replaceStack(function(current){return[" != null ? ",current,' : ""']});this.pushSource(this.appendToBuffer(this.popStack()))}else{var local=this.popStack();this.pushSource(["if (",local," != null) { ",this.appendToBuffer(local,undefined,true)," }"]);if(this.environment.isSimple){this.pushSource(["else { ",this.appendToBuffer("''",undefined,true)," }"])}}},appendEscaped:function appendEscaped(){this.pushSource(this.appendToBuffer([this.aliasable("this.escapeExpression"),"(",this.popStack(),")"]))},getContext:function getContext(depth){this.lastContext=depth},pushContext:function pushContext(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function lookupOnContext(parts,falsy,scoped){var i=0;if(!scoped&&this.options.compat&&!this.lastContext){
this.push(this.depthedLookup(parts[i++]))}else{this.pushContext()}this.resolvePath("context",parts,i,falsy)},lookupBlockParam:function lookupBlockParam(blockParamId,parts){this.useBlockParams=true;this.push(["blockParams[",blockParamId[0],"][",blockParamId[1],"]"]);this.resolvePath("context",parts,1)},lookupData:function lookupData(depth,parts){if(!depth){this.pushStackLiteral("data")}else{this.pushStackLiteral("this.data(data, "+depth+")")}this.resolvePath("data",parts,0,true)},resolvePath:function resolvePath(type,parts,i,falsy){var _this=this;if(this.options.strict||this.options.assumeObjects){this.push(strictLookup(this.options.strict,this,parts,type));return}var len=parts.length;for(;i<len;i++){this.replaceStack(function(current){var lookup=_this.nameLookup(current,parts[i],type);if(!falsy){return[" != null ? ",lookup," : ",current]}else{return[" && ",lookup]}})}},resolvePossibleLambda:function resolvePossibleLambda(){this.push([this.aliasable("this.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function pushStringParam(string,type){this.pushContext();this.pushString(type);if(type!=="SubExpression"){if(typeof string==="string"){this.pushString(string)}else{this.pushStackLiteral(string)}}},emptyHash:function emptyHash(omitEmpty){if(this.trackIds){this.push("{}")}if(this.stringParams){this.push("{}");this.push("{}")}this.pushStackLiteral(omitEmpty?"undefined":"{}")},pushHash:function pushHash(){if(this.hash){this.hashes.push(this.hash)}this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function popHash(){var hash=this.hash;this.hash=this.hashes.pop();if(this.trackIds){this.push(this.objectLiteral(hash.ids))}if(this.stringParams){this.push(this.objectLiteral(hash.contexts));this.push(this.objectLiteral(hash.types))}this.push(this.objectLiteral(hash.values))},pushString:function pushString(string){this.pushStackLiteral(this.quotedString(string))},pushLiteral:function pushLiteral(value){this.pushStackLiteral(value)},pushProgram:function pushProgram(guid){if(guid!=null){this.pushStackLiteral(this.programExpression(guid))}else{this.pushStackLiteral(null)}},invokeHelper:function invokeHelper(paramSize,name,isSimple){var nonHelper=this.popStack(),helper=this.setupHelper(paramSize,name),simple=isSimple?[helper.name," || "]:"";var lookup=["("].concat(simple,nonHelper);if(!this.options.strict){lookup.push(" || ",this.aliasable("helpers.helperMissing"))}lookup.push(")");this.push(this.source.functionCall(lookup,"call",helper.callParams))},invokeKnownHelper:function invokeKnownHelper(paramSize,name){var helper=this.setupHelper(paramSize,name);this.push(this.source.functionCall(helper.name,"call",helper.callParams))},invokeAmbiguous:function invokeAmbiguous(name,helperCall){this.useRegister("helper");var nonHelper=this.popStack();this.emptyHash();var helper=this.setupHelper(0,name,helperCall);var helperName=this.lastHelper=this.nameLookup("helpers",name,"helper");var lookup=["(","(helper = ",helperName," || ",nonHelper,")"];if(!this.options.strict){lookup[0]="(helper = ";lookup.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))}this.push(["(",lookup,helper.paramsInit?["),(",helper.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",helper.callParams)," : helper))"])},invokePartial:function invokePartial(isDynamic,name,indent){var params=[],options=this.setupParams(name,1,params,false);if(isDynamic){name=this.popStack();delete options.name}if(indent){options.indent=JSON.stringify(indent)}options.helpers="helpers";options.partials="partials";if(!isDynamic){params.unshift(this.nameLookup("partials",name,"partial"))}else{params.unshift(name)}if(this.options.compat){options.depths="depths"}options=this.objectLiteral(options);params.push(options);this.push(this.source.functionCall("this.invokePartial","",params))},assignToHash:function assignToHash(key){var value=this.popStack(),context=undefined,type=undefined,id=undefined;if(this.trackIds){id=this.popStack()}if(this.stringParams){type=this.popStack();context=this.popStack()}var hash=this.hash;if(context){hash.contexts[key]=context}if(type){hash.types[key]=type}if(id){hash.ids[key]=id}hash.values[key]=value},pushId:function pushId(type,name,child){if(type==="BlockParam"){this.pushStackLiteral("blockParams["+name[0]+"].path["+name[1]+"]"+(child?" + "+JSON.stringify("."+child):""))}else if(type==="PathExpression"){this.pushString(name)}else if(type==="SubExpression"){this.pushStackLiteral("true")}else{this.pushStackLiteral("null")}},compiler:JavaScriptCompiler,compileChildren:function compileChildren(environment,options){var children=environment.children,child=undefined,compiler=undefined;for(var i=0,l=children.length;i<l;i++){child=children[i];compiler=new this.compiler;var index=this.matchExistingProgram(child);if(index==null){this.context.programs.push("");index=this.context.programs.length;child.index=index;child.name="program"+index;this.context.programs[index]=compiler.compile(child,options,this.context,!this.precompile);this.context.environments[index]=child;this.useDepths=this.useDepths||compiler.useDepths;this.useBlockParams=this.useBlockParams||compiler.useBlockParams}else{child.index=index;child.name="program"+index;this.useDepths=this.useDepths||child.useDepths;this.useBlockParams=this.useBlockParams||child.useBlockParams}}},matchExistingProgram:function matchExistingProgram(child){for(var i=0,len=this.context.environments.length;i<len;i++){var environment=this.context.environments[i];if(environment&&environment.equals(child)){return i}}},programExpression:function programExpression(guid){var child=this.environment.children[guid],programParams=[child.index,"data",child.blockParams];if(this.useBlockParams||this.useDepths){programParams.push("blockParams")}if(this.useDepths){programParams.push("depths")}return"this.program("+programParams.join(", ")+")"},useRegister:function useRegister(name){if(!this.registers[name]){this.registers[name]=true;this.registers.list.push(name)}},push:function push(expr){if(!(expr instanceof Literal)){expr=this.source.wrap(expr)}this.inlineStack.push(expr);return expr},pushStackLiteral:function pushStackLiteral(item){this.push(new Literal(item))},pushSource:function pushSource(source){if(this.pendingContent){this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation));this.pendingContent=undefined}if(source){this.source.push(source)}},replaceStack:function replaceStack(callback){var prefix=["("],stack=undefined,createdStack=undefined,usedLiteral=undefined;if(!this.isInline()){throw new _Exception2["default"]("replaceStack on non-inline")}var top=this.popStack(true);if(top instanceof Literal){stack=[top.value];prefix=["(",stack];usedLiteral=true}else{createdStack=true;var _name=this.incrStack();prefix=["((",this.push(_name)," = ",top,")"];stack=this.topStack()}var item=callback.call(this,stack);if(!usedLiteral){this.popStack()}if(createdStack){this.stackSlot--}this.push(prefix.concat(item,")"))},incrStack:function incrStack(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push("stack"+this.stackSlot)}return this.topStackName()},topStackName:function topStackName(){return"stack"+this.stackSlot},flushInline:function flushInline(){var inlineStack=this.inlineStack;this.inlineStack=[];for(var i=0,len=inlineStack.length;i<len;i++){var entry=inlineStack[i];if(entry instanceof Literal){this.compileStack.push(entry)}else{var stack=this.incrStack();this.pushSource([stack," = ",entry,";"]);this.compileStack.push(stack)}}},isInline:function isInline(){return this.inlineStack.length},popStack:function popStack(wrapped){var inline=this.isInline(),item=(inline?this.inlineStack:this.compileStack).pop();if(!wrapped&&item instanceof Literal){return item.value}else{if(!inline){if(!this.stackSlot){throw new _Exception2["default"]("Invalid stack pop")}this.stackSlot--}return item}},topStack:function topStack(){var stack=this.isInline()?this.inlineStack:this.compileStack,item=stack[stack.length-1];if(item instanceof Literal){return item.value}else{return item}},contextName:function contextName(context){if(this.useDepths&&context){return"depths["+context+"]"}else{return"depth"+context}},quotedString:function quotedString(str){return this.source.quotedString(str)},objectLiteral:function objectLiteral(obj){return this.source.objectLiteral(obj)},aliasable:function aliasable(name){var ret=this.aliases[name];if(ret){ret.referenceCount++;return ret}ret=this.aliases[name]=this.source.wrap(name);ret.aliasable=true;ret.referenceCount=1;return ret},setupHelper:function setupHelper(paramSize,name,blockHelper){var params=[],paramsInit=this.setupHelperArgs(name,paramSize,params,blockHelper);var foundHelper=this.nameLookup("helpers",name,"helper");return{params:params,paramsInit:paramsInit,name:foundHelper,callParams:[this.contextName(0)].concat(params)}},setupParams:function setupParams(helper,paramSize,params){var options={},contexts=[],types=[],ids=[],param=undefined;options.name=this.quotedString(helper);options.hash=this.popStack();if(this.trackIds){options.hashIds=this.popStack()}if(this.stringParams){options.hashTypes=this.popStack();options.hashContexts=this.popStack()}var inverse=this.popStack(),program=this.popStack();if(program||inverse){options.fn=program||"this.noop";options.inverse=inverse||"this.noop"}var i=paramSize;while(i--){param=this.popStack();params[i]=param;if(this.trackIds){ids[i]=this.popStack()}if(this.stringParams){types[i]=this.popStack();contexts[i]=this.popStack()}}if(this.trackIds){options.ids=this.source.generateArray(ids)}if(this.stringParams){options.types=this.source.generateArray(types);options.contexts=this.source.generateArray(contexts)}if(this.options.data){options.data="data"}if(this.useBlockParams){options.blockParams="blockParams"}return options},setupHelperArgs:function setupHelperArgs(helper,paramSize,params,useRegister){var options=this.setupParams(helper,paramSize,params,true);options=this.objectLiteral(options);if(useRegister){this.useRegister("options");params.push("options");return["options=",options]}else{params.push(options);return""}}};(function(){var reservedWords=("break else new var"+" case finally return void"+" catch for switch while"+" continue function this with"+" default if throw"+" delete in try"+" do instanceof typeof"+" abstract enum int short"+" boolean export interface static"+" byte extends long super"+" char final native synchronized"+" class float package throws"+" const goto private transient"+" debugger implements protected volatile"+" double import public let yield await"+" null true false").split(" ");var compilerWords=JavaScriptCompiler.RESERVED_WORDS={};for(var i=0,l=reservedWords.length;i<l;i++){compilerWords[reservedWords[i]]=true}})();JavaScriptCompiler.isValidJavaScriptVariableName=function(name){return!JavaScriptCompiler.RESERVED_WORDS[name]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(name)};function strictLookup(requireTerminal,compiler,parts,type){var stack=compiler.popStack(),i=0,len=parts.length;if(requireTerminal){len--}for(;i<len;i++){stack=compiler.nameLookup(stack,parts[i],type)}if(requireTerminal){return[compiler.aliasable("this.strict"),"(",stack,", ",compiler.quotedString(parts[i]),")"]}else{return stack}}exports["default"]=JavaScriptCompiler;module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(8)["default"];exports.__esModule=true;var _Exception=__webpack_require__(11);var _Exception2=_interopRequireWildcard(_Exception);var _AST=__webpack_require__(2);var _AST2=_interopRequireWildcard(_AST);function Visitor(){this.parents=[]}Visitor.prototype={constructor:Visitor,mutating:false,acceptKey:function acceptKey(node,name){var value=this.accept(node[name]);if(this.mutating){if(value&&(!value.type||!_AST2["default"][value.type])){throw new _Exception2["default"]('Unexpected node type "'+value.type+'" found when accepting '+name+" on "+node.type)}node[name]=value}},acceptRequired:function acceptRequired(node,name){this.acceptKey(node,name);if(!node[name]){throw new _Exception2["default"](node.type+" requires "+name)}},acceptArray:function acceptArray(array){for(var i=0,l=array.length;i<l;i++){this.acceptKey(array,i);if(!array[i]){array.splice(i,1);i--;l--}}},accept:function accept(object){if(!object){return}if(this.current){this.parents.unshift(this.current)}this.current=object;var ret=this[object.type](object);this.current=this.parents.shift();if(!this.mutating||ret){return ret}else if(ret!==false){return object}},Program:function Program(program){this.acceptArray(program.body)},MustacheStatement:function MustacheStatement(mustache){this.acceptRequired(mustache,"path");this.acceptArray(mustache.params);this.acceptKey(mustache,"hash")},BlockStatement:function BlockStatement(block){this.acceptRequired(block,"path");this.acceptArray(block.params);this.acceptKey(block,"hash");this.acceptKey(block,"program");this.acceptKey(block,"inverse")},PartialStatement:function PartialStatement(partial){this.acceptRequired(partial,"name");this.acceptArray(partial.params);this.acceptKey(partial,"hash")},ContentStatement:function ContentStatement(){},CommentStatement:function CommentStatement(){},SubExpression:function SubExpression(sexpr){this.acceptRequired(sexpr,"path");this.acceptArray(sexpr.params);this.acceptKey(sexpr,"hash")},PathExpression:function PathExpression(){},StringLiteral:function StringLiteral(){},NumberLiteral:function NumberLiteral(){},BooleanLiteral:function BooleanLiteral(){},UndefinedLiteral:function UndefinedLiteral(){},NullLiteral:function NullLiteral(){},Hash:function Hash(hash){this.acceptArray(hash.pairs)},HashPair:function HashPair(pair){this.acceptRequired(pair,"value")}};exports["default"]=Visitor;module.exports=exports["default"]},function(module,exports,__webpack_require__){(function(global){"use strict";exports.__esModule=true;exports["default"]=function(Handlebars){var root=typeof global!=="undefined"?global:window,$Handlebars=root.Handlebars;Handlebars.noConflict=function(){if(root.Handlebars===Handlebars){root.Handlebars=$Handlebars}}};module.exports=exports["default"]}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){"use strict";exports["default"]=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};exports.__esModule=true},function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(8)["default"];exports.__esModule=true;exports.HandlebarsEnvironment=HandlebarsEnvironment;exports.createFrame=createFrame;var _import=__webpack_require__(12);var Utils=_interopRequireWildcard(_import);var _Exception=__webpack_require__(11);var _Exception2=_interopRequireWildcard(_Exception);var VERSION="3.0.1";exports.VERSION=VERSION;var COMPILER_REVISION=6;exports.COMPILER_REVISION=COMPILER_REVISION;var REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};exports.REVISION_CHANGES=REVISION_CHANGES;var isArray=Utils.isArray,isFunction=Utils.isFunction,toString=Utils.toString,objectType="[object Object]";function HandlebarsEnvironment(helpers,partials){this.helpers=helpers||{};this.partials=partials||{};registerDefaultHelpers(this)}HandlebarsEnvironment.prototype={constructor:HandlebarsEnvironment,logger:logger,log:log,registerHelper:function registerHelper(name,fn){if(toString.call(name)===objectType){if(fn){throw new _Exception2["default"]("Arg not supported with multiple helpers")}Utils.extend(this.helpers,name)}else{this.helpers[name]=fn}},unregisterHelper:function unregisterHelper(name){delete this.helpers[name]},registerPartial:function registerPartial(name,partial){if(toString.call(name)===objectType){Utils.extend(this.partials,name)}else{if(typeof partial==="undefined"){throw new _Exception2["default"]("Attempting to register a partial as undefined")}this.partials[name]=partial}},unregisterPartial:function unregisterPartial(name){delete this.partials[name]}};function registerDefaultHelpers(instance){instance.registerHelper("helperMissing",function(){if(arguments.length===1){return undefined}else{throw new _Exception2["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')}});instance.registerHelper("blockHelperMissing",function(context,options){var inverse=options.inverse,fn=options.fn;if(context===true){return fn(this)}else if(context===false||context==null){return inverse(this)}else if(isArray(context)){if(context.length>0){if(options.ids){options.ids=[options.name]}return instance.helpers.each(context,options)}else{return inverse(this)}}else{if(options.data&&options.ids){var data=createFrame(options.data);data.contextPath=Utils.appendContextPath(options.data.contextPath,options.name);options={data:data}}return fn(context,options)}});instance.registerHelper("each",function(context,options){if(!options){throw new _Exception2["default"]("Must pass iterator to #each")}var fn=options.fn,inverse=options.inverse,i=0,ret="",data=undefined,contextPath=undefined;if(options.data&&options.ids){contextPath=Utils.appendContextPath(options.data.contextPath,options.ids[0])+"."}if(isFunction(context)){context=context.call(this)}if(options.data){data=createFrame(options.data)}function execIteration(field,index,last){if(data){data.key=field;data.index=index;data.first=index===0;data.last=!!last;if(contextPath){data.contextPath=contextPath+field}}ret=ret+fn(context[field],{data:data,blockParams:Utils.blockParams([context[field],field],[contextPath+field,null])})}if(context&&typeof context==="object"){if(isArray(context)){for(var j=context.length;i<j;i++){execIteration(i,i,i===context.length-1)}}else{var priorKey=undefined;for(var key in context){if(context.hasOwnProperty(key)){if(priorKey){execIteration(priorKey,i-1)}priorKey=key;i++}}if(priorKey){execIteration(priorKey,i-1,true)}}}if(i===0){ret=inverse(this)}return ret});instance.registerHelper("if",function(conditional,options){if(isFunction(conditional)){conditional=conditional.call(this)}if(!options.hash.includeZero&&!conditional||Utils.isEmpty(conditional)){return options.inverse(this)}else{return options.fn(this)}});instance.registerHelper("unless",function(conditional,options){return instance.helpers["if"].call(this,conditional,{fn:options.inverse,inverse:options.fn,hash:options.hash})});instance.registerHelper("with",function(context,options){if(isFunction(context)){context=context.call(this)}var fn=options.fn;if(!Utils.isEmpty(context)){if(options.data&&options.ids){var data=createFrame(options.data);data.contextPath=Utils.appendContextPath(options.data.contextPath,options.ids[0]);options={data:data}}return fn(context,options)}else{return options.inverse(this)}});instance.registerHelper("log",function(message,options){var level=options.data&&options.data.level!=null?parseInt(options.data.level,10):1;instance.log(level,message)});instance.registerHelper("lookup",function(obj,field){return obj&&obj[field]})}var logger={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function log(level,message){if(typeof console!=="undefined"&&logger.level<=level){var method=logger.methodMap[level];(console[method]||console.log).call(console,message)}}};exports.logger=logger;var log=logger.log;exports.log=log;function createFrame(object){var frame=Utils.extend({},object);frame._parent=object;return frame}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;function SafeString(string){this.string=string}SafeString.prototype.toString=SafeString.prototype.toHTML=function(){return""+this.string};exports["default"]=SafeString;module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;var errorProps=["description","fileName","lineNumber","message","name","number","stack"];function Exception(message,node){var loc=node&&node.loc,line=undefined,column=undefined;if(loc){line=loc.start.line;column=loc.start.column;message+=" - "+line+":"+column}var tmp=Error.prototype.constructor.call(this,message);for(var idx=0;idx<errorProps.length;idx++){this[errorProps[idx]]=tmp[errorProps[idx]]}if(Error.captureStackTrace){Error.captureStackTrace(this,Exception)}if(loc){this.lineNumber=line;this.column=column}}Exception.prototype=new Error;exports["default"]=Exception;module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.extend=extend;exports.indexOf=indexOf;exports.escapeExpression=escapeExpression;exports.isEmpty=isEmpty;exports.blockParams=blockParams;exports.appendContextPath=appendContextPath;var escape={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var badChars=/[&<>"'`]/g,possible=/[&<>"'`]/;function escapeChar(chr){return escape[chr]}function extend(obj){for(var i=1;i<arguments.length;i++){for(var key in arguments[i]){if(Object.prototype.hasOwnProperty.call(arguments[i],key)){obj[key]=arguments[i][key]}}}return obj}var toString=Object.prototype.toString;exports.toString=toString;var isFunction=function isFunction(value){return typeof value==="function"};if(isFunction(/x/)){exports.isFunction=isFunction=function(value){return typeof value==="function"&&toString.call(value)==="[object Function]"}}var isFunction;exports.isFunction=isFunction;var isArray=Array.isArray||function(value){return value&&typeof value==="object"?toString.call(value)==="[object Array]":false};exports.isArray=isArray;function indexOf(array,value){for(var i=0,len=array.length;i<len;i++){if(array[i]===value){return i}}return-1}function escapeExpression(string){if(typeof string!=="string"){if(string&&string.toHTML){return string.toHTML()}else if(string==null){return""}else if(!string){return string+""}string=""+string}if(!possible.test(string)){return string}return string.replace(badChars,escapeChar)}function isEmpty(value){if(!value&&value!==0){return true}else if(isArray(value)&&value.length===0){return true}else{return false}}function blockParams(params,ids){params.path=ids;return params}function appendContextPath(contextPath,id){return(contextPath?contextPath+".":"")+id}},function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(8)["default"];exports.__esModule=true;exports.checkRevision=checkRevision;exports.template=template;exports.wrapProgram=wrapProgram;exports.resolvePartial=resolvePartial;exports.invokePartial=invokePartial;exports.noop=noop;var _import=__webpack_require__(12);var Utils=_interopRequireWildcard(_import);var _Exception=__webpack_require__(11);var _Exception2=_interopRequireWildcard(_Exception);var _COMPILER_REVISION$REVISION_CHANGES$createFrame=__webpack_require__(9);function checkRevision(compilerInfo){var compilerRevision=compilerInfo&&compilerInfo[0]||1,currentRevision=_COMPILER_REVISION$REVISION_CHANGES$createFrame.COMPILER_REVISION;if(compilerRevision!==currentRevision){if(compilerRevision<currentRevision){var runtimeVersions=_COMPILER_REVISION$REVISION_CHANGES$createFrame.REVISION_CHANGES[currentRevision],compilerVersions=_COMPILER_REVISION$REVISION_CHANGES$createFrame.REVISION_CHANGES[compilerRevision];throw new _Exception2["default"]("Template was precompiled with an older version of Handlebars than the current runtime. "+"Please update your precompiler to a newer version ("+runtimeVersions+") or downgrade your runtime to an older version ("+compilerVersions+").")}else{throw new _Exception2["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. "+"Please update your runtime to a newer version ("+compilerInfo[1]+").")}}}function template(templateSpec,env){if(!env){throw new _Exception2["default"]("No environment passed to template")}if(!templateSpec||!templateSpec.main){throw new _Exception2["default"]("Unknown template object: "+typeof templateSpec)}env.VM.checkRevision(templateSpec.compiler);function invokePartialWrapper(partial,context,options){if(options.hash){context=Utils.extend({},context,options.hash)}partial=env.VM.resolvePartial.call(this,partial,context,options);var result=env.VM.invokePartial.call(this,partial,context,options);if(result==null&&env.compile){options.partials[options.name]=env.compile(partial,templateSpec.compilerOptions,env);result=options.partials[options.name](context,options)}if(result!=null){if(options.indent){var lines=result.split("\n");for(var i=0,l=lines.length;i<l;i++){if(!lines[i]&&i+1===l){break}lines[i]=options.indent+lines[i]}result=lines.join("\n")}return result}else{throw new _Exception2["default"]("The partial "+options.name+" could not be compiled when running in runtime-only mode")}}var container={strict:function strict(obj,name){if(!(name in obj)){throw new _Exception2["default"]('"'+name+'" not defined in '+obj)}return obj[name]},lookup:function lookup(depths,name){var len=depths.length;for(var i=0;i<len;i++){if(depths[i]&&depths[i][name]!=null){return depths[i][name]}}},lambda:function lambda(current,context){return typeof current==="function"?current.call(context):current},escapeExpression:Utils.escapeExpression,invokePartial:invokePartialWrapper,fn:function fn(i){return templateSpec[i]},programs:[],program:function program(i,data,declaredBlockParams,blockParams,depths){var programWrapper=this.programs[i],fn=this.fn(i);if(data||depths||blockParams||declaredBlockParams){programWrapper=wrapProgram(this,i,fn,data,declaredBlockParams,blockParams,depths)}else if(!programWrapper){programWrapper=this.programs[i]=wrapProgram(this,i,fn)}return programWrapper},data:function data(value,depth){while(value&&depth--){value=value._parent}return value},merge:function merge(param,common){var obj=param||common;if(param&&common&&param!==common){obj=Utils.extend({},common,param)}return obj},noop:env.VM.noop,compilerInfo:templateSpec.compiler};function ret(context){var options=arguments[1]===undefined?{}:arguments[1];var data=options.data;ret._setup(options);if(!options.partial&&templateSpec.useData){data=initData(context,data)}var depths=undefined,blockParams=templateSpec.useBlockParams?[]:undefined;if(templateSpec.useDepths){depths=options.depths?[context].concat(options.depths):[context]}return templateSpec.main.call(container,context,container.helpers,container.partials,data,blockParams,depths)}ret.isTop=true;ret._setup=function(options){if(!options.partial){container.helpers=container.merge(options.helpers,env.helpers);if(templateSpec.usePartial){container.partials=container.merge(options.partials,env.partials)}}else{container.helpers=options.helpers;container.partials=options.partials}};ret._child=function(i,data,blockParams,depths){if(templateSpec.useBlockParams&&!blockParams){throw new _Exception2["default"]("must pass block params")}if(templateSpec.useDepths&&!depths){throw new _Exception2["default"]("must pass parent depths")}return wrapProgram(container,i,templateSpec[i],data,0,blockParams,depths)};return ret}function wrapProgram(container,i,fn,data,declaredBlockParams,blockParams,depths){function prog(context){var options=arguments[1]===undefined?{}:arguments[1];return fn.call(container,context,container.helpers,container.partials,options.data||data,blockParams&&[options.blockParams].concat(blockParams),depths&&[context].concat(depths))}prog.program=i;prog.depth=depths?depths.length:0;prog.blockParams=declaredBlockParams||0;return prog}function resolvePartial(partial,context,options){if(!partial){partial=options.partials[options.name]}else if(!partial.call&&!options.name){options.name=partial;partial=options.partials[partial]}return partial}function invokePartial(partial,context,options){options.partial=true;if(partial===undefined){throw new _Exception2["default"]("The partial "+options.name+" could not be found")}else if(partial instanceof Function){return partial(context,options)}}function noop(){return""}function initData(context,data){if(!data||!("root"in data)){data=data?_COMPILER_REVISION$REVISION_CHANGES$createFrame.createFrame(data):{};data.root=context}return data}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;var handlebars=function(){var parser={trace:function trace(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,content:12,COMMENT:13,CONTENT:14,openRawBlock:15,END_RAW_BLOCK:16,OPEN_RAW_BLOCK:17,helperName:18,openRawBlock_repetition0:19,openRawBlock_option0:20,CLOSE_RAW_BLOCK:21,openBlock:22,block_option0:23,closeBlock:24,openInverse:25,block_option1:26,OPEN_BLOCK:27,openBlock_repetition0:28,openBlock_option0:29,openBlock_option1:30,CLOSE:31,OPEN_INVERSE:32,openInverse_repetition0:33,openInverse_option0:34,openInverse_option1:35,openInverseChain:36,OPEN_INVERSE_CHAIN:37,openInverseChain_repetition0:38,openInverseChain_option0:39,openInverseChain_option1:40,inverseAndProgram:41,INVERSE:42,inverseChain:43,inverseChain_option0:44,OPEN_ENDBLOCK:45,OPEN:46,mustache_repetition0:47,mustache_option0:48,OPEN_UNESCAPED:49,mustache_repetition1:50,mustache_option1:51,CLOSE_UNESCAPED:52,OPEN_PARTIAL:53,partialName:54,partial_repetition0:55,partial_option0:56,param:57,sexpr:58,OPEN_SEXPR:59,sexpr_repetition0:60,sexpr_option0:61,CLOSE_SEXPR:62,hash:63,hash_repetition_plus0:64,hashSegment:65,ID:66,EQUALS:67,blockParams:68,OPEN_BLOCK_PARAMS:69,blockParams_repetition_plus0:70,CLOSE_BLOCK_PARAMS:71,path:72,dataName:73,STRING:74,NUMBER:75,BOOLEAN:76,UNDEFINED:77,NULL:78,DATA:79,pathSegments:80,SEP:81,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",13:"COMMENT",14:"CONTENT",16:"END_RAW_BLOCK",17:"OPEN_RAW_BLOCK",21:"CLOSE_RAW_BLOCK",27:"OPEN_BLOCK",31:"CLOSE",32:"OPEN_INVERSE",37:"OPEN_INVERSE_CHAIN",42:"INVERSE",45:"OPEN_ENDBLOCK",46:"OPEN",49:"OPEN_UNESCAPED",52:"CLOSE_UNESCAPED",53:"OPEN_PARTIAL",59:"OPEN_SEXPR",62:"CLOSE_SEXPR",66:"ID",67:"EQUALS",69:"OPEN_BLOCK_PARAMS",71:"CLOSE_BLOCK_PARAMS",74:"STRING",75:"NUMBER",76:"BOOLEAN",77:"UNDEFINED",78:"NULL",79:"DATA",81:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[12,1],[10,3],[15,5],[9,4],[9,4],[22,6],[25,6],[36,6],[41,2],[43,3],[43,1],[24,3],[8,5],[8,5],[11,5],[57,1],[57,1],[58,5],[63,1],[65,3],[68,3],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[54,1],[54,1],[73,2],[72,1],[80,3],[80,1],[6,0],[6,2],[19,0],[19,2],[20,0],[20,1],[23,0],[23,1],[26,0],[26,1],[28,0],[28,2],[29,0],[29,1],[30,0],[30,1],[33,0],[33,2],[34,0],[34,1],[35,0],[35,1],[38,0],[38,2],[39,0],[39,1],[40,0],[40,1],[44,0],[44,1],[47,0],[47,2],[48,0],[48,1],[50,0],[50,2],[51,0],[51,1],[55,0],[55,2],[56,0],[56,1],[60,0],[60,2],[61,0],[61,1],[64,1],[64,2],[70,1],[70,2]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];break;case 2:this.$=new yy.Program($$[$0],null,{},yy.locInfo(this._$));break;case 3:this.$=$$[$0];break;case 4:this.$=$$[$0];break;case 5:this.$=$$[$0];break;case 6:this.$=$$[$0];break;case 7:this.$=$$[$0];break;case 8:this.$=new yy.CommentStatement(yy.stripComment($$[$0]),yy.stripFlags($$[$0],$$[$0]),yy.locInfo(this._$));break;case 9:this.$=new yy.ContentStatement($$[$0],yy.locInfo(this._$));break;case 10:this.$=yy.prepareRawBlock($$[$0-2],$$[$0-1],$$[$0],this._$);break;case 11:this.$={path:$$[$0-3],params:$$[$0-2],hash:$$[$0-1]};break;case 12:this.$=yy.prepareBlock($$[$0-3],$$[$0-2],$$[$0-1],$$[$0],false,this._$);break;case 13:this.$=yy.prepareBlock($$[$0-3],$$[$0-2],$$[$0-1],$$[$0],true,this._$);break;case 14:this.$={path:$$[$0-4],params:$$[$0-3],hash:$$[$0-2],blockParams:$$[$0-1],strip:yy.stripFlags($$[$0-5],$$[$0])};break;case 15:this.$={path:$$[$0-4],params:$$[$0-3],hash:$$[$0-2],blockParams:$$[$0-1],strip:yy.stripFlags($$[$0-5],$$[$0])};break;case 16:this.$={path:$$[$0-4],params:$$[$0-3],hash:$$[$0-2],blockParams:$$[$0-1],strip:yy.stripFlags($$[$0-5],$$[$0])};break;case 17:this.$={strip:yy.stripFlags($$[$0-1],$$[$0-1]),
program:$$[$0]};break;case 18:var inverse=yy.prepareBlock($$[$0-2],$$[$0-1],$$[$0],$$[$0],false,this._$),program=new yy.Program([inverse],null,{},yy.locInfo(this._$));program.chained=true;this.$={strip:$$[$0-2].strip,program:program,chain:true};break;case 19:this.$=$$[$0];break;case 20:this.$={path:$$[$0-1],strip:yy.stripFlags($$[$0-2],$$[$0])};break;case 21:this.$=yy.prepareMustache($$[$0-3],$$[$0-2],$$[$0-1],$$[$0-4],yy.stripFlags($$[$0-4],$$[$0]),this._$);break;case 22:this.$=yy.prepareMustache($$[$0-3],$$[$0-2],$$[$0-1],$$[$0-4],yy.stripFlags($$[$0-4],$$[$0]),this._$);break;case 23:this.$=new yy.PartialStatement($$[$0-3],$$[$0-2],$$[$0-1],yy.stripFlags($$[$0-4],$$[$0]),yy.locInfo(this._$));break;case 24:this.$=$$[$0];break;case 25:this.$=$$[$0];break;case 26:this.$=new yy.SubExpression($$[$0-3],$$[$0-2],$$[$0-1],yy.locInfo(this._$));break;case 27:this.$=new yy.Hash($$[$0],yy.locInfo(this._$));break;case 28:this.$=new yy.HashPair(yy.id($$[$0-2]),$$[$0],yy.locInfo(this._$));break;case 29:this.$=yy.id($$[$0-1]);break;case 30:this.$=$$[$0];break;case 31:this.$=$$[$0];break;case 32:this.$=new yy.StringLiteral($$[$0],yy.locInfo(this._$));break;case 33:this.$=new yy.NumberLiteral($$[$0],yy.locInfo(this._$));break;case 34:this.$=new yy.BooleanLiteral($$[$0],yy.locInfo(this._$));break;case 35:this.$=new yy.UndefinedLiteral(yy.locInfo(this._$));break;case 36:this.$=new yy.NullLiteral(yy.locInfo(this._$));break;case 37:this.$=$$[$0];break;case 38:this.$=$$[$0];break;case 39:this.$=yy.preparePath(true,$$[$0],this._$);break;case 40:this.$=yy.preparePath(false,$$[$0],this._$);break;case 41:$$[$0-2].push({part:yy.id($$[$0]),original:$$[$0],separator:$$[$0-1]});this.$=$$[$0-2];break;case 42:this.$=[{part:yy.id($$[$0]),original:$$[$0]}];break;case 43:this.$=[];break;case 44:$$[$0-1].push($$[$0]);break;case 45:this.$=[];break;case 46:$$[$0-1].push($$[$0]);break;case 53:this.$=[];break;case 54:$$[$0-1].push($$[$0]);break;case 59:this.$=[];break;case 60:$$[$0-1].push($$[$0]);break;case 65:this.$=[];break;case 66:$$[$0-1].push($$[$0]);break;case 73:this.$=[];break;case 74:$$[$0-1].push($$[$0]);break;case 77:this.$=[];break;case 78:$$[$0-1].push($$[$0]);break;case 81:this.$=[];break;case 82:$$[$0-1].push($$[$0]);break;case 85:this.$=[];break;case 86:$$[$0-1].push($$[$0]);break;case 89:this.$=[$$[$0]];break;case 90:$$[$0-1].push($$[$0]);break;case 91:this.$=[$$[$0]];break;case 92:$$[$0-1].push($$[$0]);break}},table:[{3:1,4:2,5:[2,43],6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],46:[2,43],49:[2,43],53:[2,43]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:[1,11],14:[1,18],15:16,17:[1,21],22:14,25:15,27:[1,19],32:[1,20],37:[2,2],42:[2,2],45:[2,2],46:[1,12],49:[1,13],53:[1,17]},{1:[2,1]},{5:[2,44],13:[2,44],14:[2,44],17:[2,44],27:[2,44],32:[2,44],37:[2,44],42:[2,44],45:[2,44],46:[2,44],49:[2,44],53:[2,44]},{5:[2,3],13:[2,3],14:[2,3],17:[2,3],27:[2,3],32:[2,3],37:[2,3],42:[2,3],45:[2,3],46:[2,3],49:[2,3],53:[2,3]},{5:[2,4],13:[2,4],14:[2,4],17:[2,4],27:[2,4],32:[2,4],37:[2,4],42:[2,4],45:[2,4],46:[2,4],49:[2,4],53:[2,4]},{5:[2,5],13:[2,5],14:[2,5],17:[2,5],27:[2,5],32:[2,5],37:[2,5],42:[2,5],45:[2,5],46:[2,5],49:[2,5],53:[2,5]},{5:[2,6],13:[2,6],14:[2,6],17:[2,6],27:[2,6],32:[2,6],37:[2,6],42:[2,6],45:[2,6],46:[2,6],49:[2,6],53:[2,6]},{5:[2,7],13:[2,7],14:[2,7],17:[2,7],27:[2,7],32:[2,7],37:[2,7],42:[2,7],45:[2,7],46:[2,7],49:[2,7],53:[2,7]},{5:[2,8],13:[2,8],14:[2,8],17:[2,8],27:[2,8],32:[2,8],37:[2,8],42:[2,8],45:[2,8],46:[2,8],49:[2,8],53:[2,8]},{18:22,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:33,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:34,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{4:35,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{12:36,14:[1,18]},{18:38,54:37,58:39,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,9],13:[2,9],14:[2,9],16:[2,9],17:[2,9],27:[2,9],32:[2,9],37:[2,9],42:[2,9],45:[2,9],46:[2,9],49:[2,9],53:[2,9]},{18:41,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:42,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:43,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[2,73],47:44,59:[2,73],66:[2,73],74:[2,73],75:[2,73],76:[2,73],77:[2,73],78:[2,73],79:[2,73]},{21:[2,30],31:[2,30],52:[2,30],59:[2,30],62:[2,30],66:[2,30],69:[2,30],74:[2,30],75:[2,30],76:[2,30],77:[2,30],78:[2,30],79:[2,30]},{21:[2,31],31:[2,31],52:[2,31],59:[2,31],62:[2,31],66:[2,31],69:[2,31],74:[2,31],75:[2,31],76:[2,31],77:[2,31],78:[2,31],79:[2,31]},{21:[2,32],31:[2,32],52:[2,32],59:[2,32],62:[2,32],66:[2,32],69:[2,32],74:[2,32],75:[2,32],76:[2,32],77:[2,32],78:[2,32],79:[2,32]},{21:[2,33],31:[2,33],52:[2,33],59:[2,33],62:[2,33],66:[2,33],69:[2,33],74:[2,33],75:[2,33],76:[2,33],77:[2,33],78:[2,33],79:[2,33]},{21:[2,34],31:[2,34],52:[2,34],59:[2,34],62:[2,34],66:[2,34],69:[2,34],74:[2,34],75:[2,34],76:[2,34],77:[2,34],78:[2,34],79:[2,34]},{21:[2,35],31:[2,35],52:[2,35],59:[2,35],62:[2,35],66:[2,35],69:[2,35],74:[2,35],75:[2,35],76:[2,35],77:[2,35],78:[2,35],79:[2,35]},{21:[2,36],31:[2,36],52:[2,36],59:[2,36],62:[2,36],66:[2,36],69:[2,36],74:[2,36],75:[2,36],76:[2,36],77:[2,36],78:[2,36],79:[2,36]},{21:[2,40],31:[2,40],52:[2,40],59:[2,40],62:[2,40],66:[2,40],69:[2,40],74:[2,40],75:[2,40],76:[2,40],77:[2,40],78:[2,40],79:[2,40],81:[1,45]},{66:[1,32],80:46},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{50:47,52:[2,77],59:[2,77],66:[2,77],74:[2,77],75:[2,77],76:[2,77],77:[2,77],78:[2,77],79:[2,77]},{23:48,36:50,37:[1,52],41:51,42:[1,53],43:49,45:[2,49]},{26:54,41:55,42:[1,53],45:[2,51]},{16:[1,56]},{31:[2,81],55:57,59:[2,81],66:[2,81],74:[2,81],75:[2,81],76:[2,81],77:[2,81],78:[2,81],79:[2,81]},{31:[2,37],59:[2,37],66:[2,37],74:[2,37],75:[2,37],76:[2,37],77:[2,37],78:[2,37],79:[2,37]},{31:[2,38],59:[2,38],66:[2,38],74:[2,38],75:[2,38],76:[2,38],77:[2,38],78:[2,38],79:[2,38]},{18:58,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{28:59,31:[2,53],59:[2,53],66:[2,53],69:[2,53],74:[2,53],75:[2,53],76:[2,53],77:[2,53],78:[2,53],79:[2,53]},{31:[2,59],33:60,59:[2,59],66:[2,59],69:[2,59],74:[2,59],75:[2,59],76:[2,59],77:[2,59],78:[2,59],79:[2,59]},{19:61,21:[2,45],59:[2,45],66:[2,45],74:[2,45],75:[2,45],76:[2,45],77:[2,45],78:[2,45],79:[2,45]},{18:65,31:[2,75],48:62,57:63,58:66,59:[1,40],63:64,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{66:[1,70]},{21:[2,39],31:[2,39],52:[2,39],59:[2,39],62:[2,39],66:[2,39],69:[2,39],74:[2,39],75:[2,39],76:[2,39],77:[2,39],78:[2,39],79:[2,39],81:[1,45]},{18:65,51:71,52:[2,79],57:72,58:66,59:[1,40],63:73,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{24:74,45:[1,75]},{45:[2,50]},{4:76,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{45:[2,19]},{18:77,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:78,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{24:79,45:[1,75]},{45:[2,52]},{5:[2,10],13:[2,10],14:[2,10],17:[2,10],27:[2,10],32:[2,10],37:[2,10],42:[2,10],45:[2,10],46:[2,10],49:[2,10],53:[2,10]},{18:65,31:[2,83],56:80,57:81,58:66,59:[1,40],63:82,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{59:[2,85],60:83,62:[2,85],66:[2,85],74:[2,85],75:[2,85],76:[2,85],77:[2,85],78:[2,85],79:[2,85]},{18:65,29:84,31:[2,55],57:85,58:66,59:[1,40],63:86,64:67,65:68,66:[1,69],69:[2,55],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,31:[2,61],34:87,57:88,58:66,59:[1,40],63:89,64:67,65:68,66:[1,69],69:[2,61],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,20:90,21:[2,47],57:91,58:66,59:[1,40],63:92,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[1,93]},{31:[2,74],59:[2,74],66:[2,74],74:[2,74],75:[2,74],76:[2,74],77:[2,74],78:[2,74],79:[2,74]},{31:[2,76]},{21:[2,24],31:[2,24],52:[2,24],59:[2,24],62:[2,24],66:[2,24],69:[2,24],74:[2,24],75:[2,24],76:[2,24],77:[2,24],78:[2,24],79:[2,24]},{21:[2,25],31:[2,25],52:[2,25],59:[2,25],62:[2,25],66:[2,25],69:[2,25],74:[2,25],75:[2,25],76:[2,25],77:[2,25],78:[2,25],79:[2,25]},{21:[2,27],31:[2,27],52:[2,27],62:[2,27],65:94,66:[1,95],69:[2,27]},{21:[2,89],31:[2,89],52:[2,89],62:[2,89],66:[2,89],69:[2,89]},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],67:[1,96],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{21:[2,41],31:[2,41],52:[2,41],59:[2,41],62:[2,41],66:[2,41],69:[2,41],74:[2,41],75:[2,41],76:[2,41],77:[2,41],78:[2,41],79:[2,41],81:[2,41]},{52:[1,97]},{52:[2,78],59:[2,78],66:[2,78],74:[2,78],75:[2,78],76:[2,78],77:[2,78],78:[2,78],79:[2,78]},{52:[2,80]},{5:[2,12],13:[2,12],14:[2,12],17:[2,12],27:[2,12],32:[2,12],37:[2,12],42:[2,12],45:[2,12],46:[2,12],49:[2,12],53:[2,12]},{18:98,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{36:50,37:[1,52],41:51,42:[1,53],43:100,44:99,45:[2,71]},{31:[2,65],38:101,59:[2,65],66:[2,65],69:[2,65],74:[2,65],75:[2,65],76:[2,65],77:[2,65],78:[2,65],79:[2,65]},{45:[2,17]},{5:[2,13],13:[2,13],14:[2,13],17:[2,13],27:[2,13],32:[2,13],37:[2,13],42:[2,13],45:[2,13],46:[2,13],49:[2,13],53:[2,13]},{31:[1,102]},{31:[2,82],59:[2,82],66:[2,82],74:[2,82],75:[2,82],76:[2,82],77:[2,82],78:[2,82],79:[2,82]},{31:[2,84]},{18:65,57:104,58:66,59:[1,40],61:103,62:[2,87],63:105,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{30:106,31:[2,57],68:107,69:[1,108]},{31:[2,54],59:[2,54],66:[2,54],69:[2,54],74:[2,54],75:[2,54],76:[2,54],77:[2,54],78:[2,54],79:[2,54]},{31:[2,56],69:[2,56]},{31:[2,63],35:109,68:110,69:[1,108]},{31:[2,60],59:[2,60],66:[2,60],69:[2,60],74:[2,60],75:[2,60],76:[2,60],77:[2,60],78:[2,60],79:[2,60]},{31:[2,62],69:[2,62]},{21:[1,111]},{21:[2,46],59:[2,46],66:[2,46],74:[2,46],75:[2,46],76:[2,46],77:[2,46],78:[2,46],79:[2,46]},{21:[2,48]},{5:[2,21],13:[2,21],14:[2,21],17:[2,21],27:[2,21],32:[2,21],37:[2,21],42:[2,21],45:[2,21],46:[2,21],49:[2,21],53:[2,21]},{21:[2,90],31:[2,90],52:[2,90],62:[2,90],66:[2,90],69:[2,90]},{67:[1,96]},{18:65,57:112,58:66,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,22],13:[2,22],14:[2,22],17:[2,22],27:[2,22],32:[2,22],37:[2,22],42:[2,22],45:[2,22],46:[2,22],49:[2,22],53:[2,22]},{31:[1,113]},{45:[2,18]},{45:[2,72]},{18:65,31:[2,67],39:114,57:115,58:66,59:[1,40],63:116,64:67,65:68,66:[1,69],69:[2,67],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,23],13:[2,23],14:[2,23],17:[2,23],27:[2,23],32:[2,23],37:[2,23],42:[2,23],45:[2,23],46:[2,23],49:[2,23],53:[2,23]},{62:[1,117]},{59:[2,86],62:[2,86],66:[2,86],74:[2,86],75:[2,86],76:[2,86],77:[2,86],78:[2,86],79:[2,86]},{62:[2,88]},{31:[1,118]},{31:[2,58]},{66:[1,120],70:119},{31:[1,121]},{31:[2,64]},{14:[2,11]},{21:[2,28],31:[2,28],52:[2,28],62:[2,28],66:[2,28],69:[2,28]},{5:[2,20],13:[2,20],14:[2,20],17:[2,20],27:[2,20],32:[2,20],37:[2,20],42:[2,20],45:[2,20],46:[2,20],49:[2,20],53:[2,20]},{31:[2,69],40:122,68:123,69:[1,108]},{31:[2,66],59:[2,66],66:[2,66],69:[2,66],74:[2,66],75:[2,66],76:[2,66],77:[2,66],78:[2,66],79:[2,66]},{31:[2,68],69:[2,68]},{21:[2,26],31:[2,26],52:[2,26],59:[2,26],62:[2,26],66:[2,26],69:[2,26],74:[2,26],75:[2,26],76:[2,26],77:[2,26],78:[2,26],79:[2,26]},{13:[2,14],14:[2,14],17:[2,14],27:[2,14],32:[2,14],37:[2,14],42:[2,14],45:[2,14],46:[2,14],49:[2,14],53:[2,14]},{66:[1,125],71:[1,124]},{66:[2,91],71:[2,91]},{13:[2,15],14:[2,15],17:[2,15],27:[2,15],32:[2,15],42:[2,15],45:[2,15],46:[2,15],49:[2,15],53:[2,15]},{31:[1,126]},{31:[2,70]},{31:[2,29]},{66:[2,92],71:[2,92]},{13:[2,16],14:[2,16],17:[2,16],27:[2,16],32:[2,16],37:[2,16],42:[2,16],45:[2,16],46:[2,16],49:[2,16],53:[2,16]}],defaultActions:{4:[2,1],49:[2,50],51:[2,19],55:[2,52],64:[2,76],73:[2,80],78:[2,17],82:[2,84],92:[2,48],99:[2,18],100:[2,72],105:[2,88],107:[2,58],110:[2,64],111:[2,11],123:[2,70],124:[2,29]},parseError:function parseError(str,hash){throw new Error(str)},parse:function parse(input){var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext="",yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1;this.lexer.setInput(input);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;if(typeof this.lexer.yylloc=="undefined")this.lexer.yylloc={};var yyloc=this.lexer.yylloc;lstack.push(yyloc);var ranges=this.lexer.options&&this.lexer.options.ranges;if(typeof this.yy.parseError==="function")this.parseError=this.yy.parseError;function popStack(n){stack.length=stack.length-2*n;vstack.length=vstack.length-n;lstack.length=lstack.length-n}function lex(){var token;token=self.lexer.lex()||1;if(typeof token!=="number"){token=self.symbols_[token]||token}return token}var symbol,preErrorSymbol,state,action,a,r,yyval={},p,len,newState,expected;while(true){state=stack[stack.length-1];if(this.defaultActions[state]){action=this.defaultActions[state]}else{if(symbol===null||typeof symbol=="undefined"){symbol=lex()}action=table[state]&&table[state][symbol]}if(typeof action==="undefined"||!action.length||!action[0]){var errStr="";if(!recovering){expected=[];for(p in table[state])if(this.terminals_[p]&&p>2){expected.push("'"+this.terminals_[p]+"'")}if(this.lexer.showPosition){errStr="Parse error on line "+(yylineno+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+expected.join(", ")+", got '"+(this.terminals_[symbol]||symbol)+"'"}else{errStr="Parse error on line "+(yylineno+1)+": Unexpected "+(symbol==1?"end of input":"'"+(this.terminals_[symbol]||symbol)+"'")}this.parseError(errStr,{text:this.lexer.match,token:this.terminals_[symbol]||symbol,line:this.lexer.yylineno,loc:yyloc,expected:expected})}}if(action[0]instanceof Array&&action.length>1){throw new Error("Parse Error: multiple actions possible at state: "+state+", token: "+symbol)}switch(action[0]){case 1:stack.push(symbol);vstack.push(this.lexer.yytext);lstack.push(this.lexer.yylloc);stack.push(action[1]);symbol=null;if(!preErrorSymbol){yyleng=this.lexer.yyleng;yytext=this.lexer.yytext;yylineno=this.lexer.yylineno;yyloc=this.lexer.yylloc;if(recovering>0)recovering--}else{symbol=preErrorSymbol;preErrorSymbol=null}break;case 2:len=this.productions_[action[1]][1];yyval.$=vstack[vstack.length-len];yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column};if(ranges){yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]}r=this.performAction.call(yyval,yytext,yyleng,yylineno,this.yy,action[1],vstack,lstack);if(typeof r!=="undefined"){return r}if(len){stack=stack.slice(0,-1*len*2);vstack=vstack.slice(0,-1*len);lstack=lstack.slice(0,-1*len)}stack.push(this.productions_[action[1]][0]);vstack.push(yyval.$);lstack.push(yyval._$);newState=table[stack[stack.length-2]][stack[stack.length-1]];stack.push(newState);break;case 3:return true}}return true}};var lexer=function(){var lexer={EOF:1,parseError:function parseError(str,hash){if(this.yy.parser){this.yy.parser.parseError(str,hash)}else{throw new Error(str)}},setInput:function setInput(input){this._input=input;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges)this.yylloc.range=[0,0];this.offset=0;return this},input:function input(){var ch=this._input[0];this.yytext+=ch;this.yyleng++;this.offset++;this.match+=ch;this.matched+=ch;var lines=ch.match(/(?:\r\n?|\n).*/g);if(lines){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges)this.yylloc.range[1]++;this._input=this._input.slice(1);return ch},unput:function unput(ch){var len=ch.length;var lines=ch.split(/(?:\r\n?|\n)/g);this._input=ch+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-len-1);this.offset-=len;var oldLines=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(lines.length-1)this.yylineno-=lines.length-1;var r=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len};if(this.options.ranges){this.yylloc.range=[r[0],r[0]+this.yyleng-len]}return this},more:function more(){this._more=true;return this},less:function less(n){this.unput(this.match.slice(n))},pastInput:function pastInput(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?"...":"")+past.substr(-20).replace(/\n/g,"")},upcomingInput:function upcomingInput(){var next=this.match;if(next.length<20){next+=this._input.substr(0,20-next.length)}return(next.substr(0,20)+(next.length>20?"...":"")).replace(/\n/g,"")},showPosition:function showPosition(){var pre=this.pastInput();var c=new Array(pre.length+1).join("-");return pre+this.upcomingInput()+"\n"+c+"^"},next:function next(){if(this.done){return this.EOF}if(!this._input)this.done=true;var token,match,tempMatch,index,col,lines;if(!this._more){this.yytext="";this.match=""}var rules=this._currentRules();for(var i=0;i<rules.length;i++){tempMatch=this._input.match(this.rules[rules[i]]);if(tempMatch&&(!match||tempMatch[0].length>match[0].length)){match=tempMatch;index=i;if(!this.options.flex)break}}if(match){lines=match[0].match(/(?:\r\n?|\n).*/g);if(lines)this.yylineno+=lines.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+match[0].length};this.yytext+=match[0];this.match+=match[0];this.matches=match;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._input=this._input.slice(match[0].length);this.matched+=match[0];token=this.performAction.call(this,this.yy,this,rules[index],this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input)this.done=false;if(token){return token}else{return}}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function lex(){var r=this.next();if(typeof r!=="undefined"){return r}else{return this.lex()}},begin:function begin(condition){this.conditionStack.push(condition)},popState:function popState(){return this.conditionStack.pop()},_currentRules:function _currentRules(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function topState(){return this.conditionStack[this.conditionStack.length-2]},pushState:function begin(condition){this.begin(condition)}};lexer.options={};lexer.performAction=function anonymous(yy,yy_,$avoiding_name_collisions,YY_START){function strip(start,end){return yy_.yytext=yy_.yytext.substr(start,yy_.yyleng-end)}var YYSTATE=YY_START;switch($avoiding_name_collisions){case 0:if(yy_.yytext.slice(-2)==="\\\\"){strip(0,1);this.begin("mu")}else if(yy_.yytext.slice(-1)==="\\"){strip(0,1);this.begin("emu")}else{this.begin("mu")}if(yy_.yytext){return 14}break;case 1:return 14;break;case 2:this.popState();return 14;break;case 3:yy_.yytext=yy_.yytext.substr(5,yy_.yyleng-9);this.popState();return 16;break;case 4:return 14;break;case 5:this.popState();return 13;break;case 6:return 59;break;case 7:return 62;break;case 8:return 17;break;case 9:this.popState();this.begin("raw");return 21;break;case 10:return 53;break;case 11:return 27;break;case 12:return 45;break;case 13:this.popState();return 42;break;case 14:this.popState();return 42;break;case 15:return 32;break;case 16:return 37;break;case 17:return 49;break;case 18:return 46;break;case 19:this.unput(yy_.yytext);this.popState();this.begin("com");break;case 20:this.popState();return 13;break;case 21:return 46;break;case 22:return 67;break;case 23:return 66;break;case 24:return 66;break;case 25:return 81;break;case 26:break;case 27:this.popState();return 52;break;case 28:this.popState();return 31;break;case 29:yy_.yytext=strip(1,2).replace(/\\"/g,'"');return 74;break;case 30:yy_.yytext=strip(1,2).replace(/\\'/g,"'");return 74;break;case 31:return 79;break;case 32:return 76;break;case 33:return 76;break;case 34:return 77;break;case 35:return 78;break;case 36:return 75;break;case 37:return 69;break;case 38:return 71;break;case 39:return 66;break;case 40:return 66;break;case 41:return"INVALID";break;case 42:return 5;break}};lexer.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/];lexer.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],inclusive:false},emu:{rules:[2],inclusive:false},com:{rules:[5],inclusive:false},raw:{rules:[3,4],inclusive:false},INITIAL:{rules:[0,1,42],inclusive:true}};return lexer}();parser.lexer=lexer;function Parser(){this.yy={}}Parser.prototype=parser;parser.Parser=Parser;return new Parser}();exports["default"]=handlebars;module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(8)["default"];exports.__esModule=true;var _Visitor=__webpack_require__(6);var _Visitor2=_interopRequireWildcard(_Visitor);function WhitespaceControl(){}WhitespaceControl.prototype=new _Visitor2["default"];WhitespaceControl.prototype.Program=function(program){var isRoot=!this.isRootSeen;this.isRootSeen=true;var body=program.body;for(var i=0,l=body.length;i<l;i++){var current=body[i],strip=this.accept(current);if(!strip){continue}var _isPrevWhitespace=isPrevWhitespace(body,i,isRoot),_isNextWhitespace=isNextWhitespace(body,i,isRoot),openStandalone=strip.openStandalone&&_isPrevWhitespace,closeStandalone=strip.closeStandalone&&_isNextWhitespace,inlineStandalone=strip.inlineStandalone&&_isPrevWhitespace&&_isNextWhitespace;if(strip.close){omitRight(body,i,true)}if(strip.open){omitLeft(body,i,true)}if(inlineStandalone){omitRight(body,i);if(omitLeft(body,i)){if(current.type==="PartialStatement"){current.indent=/([ \t]+$)/.exec(body[i-1].original)[1]}}}if(openStandalone){omitRight((current.program||current.inverse).body);omitLeft(body,i)}if(closeStandalone){omitRight(body,i);omitLeft((current.inverse||current.program).body)}}return program};WhitespaceControl.prototype.BlockStatement=function(block){this.accept(block.program);this.accept(block.inverse);var program=block.program||block.inverse,inverse=block.program&&block.inverse,firstInverse=inverse,lastInverse=inverse;if(inverse&&inverse.chained){firstInverse=inverse.body[0].program;while(lastInverse.chained){lastInverse=lastInverse.body[lastInverse.body.length-1].program}}var strip={open:block.openStrip.open,close:block.closeStrip.close,openStandalone:isNextWhitespace(program.body),closeStandalone:isPrevWhitespace((firstInverse||program).body)};if(block.openStrip.close){omitRight(program.body,null,true)}if(inverse){var inverseStrip=block.inverseStrip;if(inverseStrip.open){omitLeft(program.body,null,true)}if(inverseStrip.close){omitRight(firstInverse.body,null,true)}if(block.closeStrip.open){omitLeft(lastInverse.body,null,true)}if(isPrevWhitespace(program.body)&&isNextWhitespace(firstInverse.body)){omitLeft(program.body);omitRight(firstInverse.body)}}else if(block.closeStrip.open){omitLeft(program.body,null,true)}return strip};WhitespaceControl.prototype.MustacheStatement=function(mustache){return mustache.strip};WhitespaceControl.prototype.PartialStatement=WhitespaceControl.prototype.CommentStatement=function(node){var strip=node.strip||{};return{inlineStandalone:true,open:strip.open,close:strip.close}};function isPrevWhitespace(body,i,isRoot){if(i===undefined){i=body.length}var prev=body[i-1],sibling=body[i-2];if(!prev){return isRoot}if(prev.type==="ContentStatement"){return(sibling||!isRoot?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(prev.original)}}function isNextWhitespace(body,i,isRoot){if(i===undefined){i=-1}var next=body[i+1],sibling=body[i+2];if(!next){return isRoot}if(next.type==="ContentStatement"){return(sibling||!isRoot?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(next.original)}}function omitRight(body,i,multiple){var current=body[i==null?0:i+1];if(!current||current.type!=="ContentStatement"||!multiple&&current.rightStripped){return}var original=current.value;current.value=current.value.replace(multiple?/^\s+/:/^[ \t]*\r?\n?/,"");current.rightStripped=current.value!==original}function omitLeft(body,i,multiple){var current=body[i==null?body.length-1:i-1];if(!current||current.type!=="ContentStatement"||!multiple&&current.leftStripped){return}var original=current.value;current.value=current.value.replace(multiple?/\s+$/:/[ \t]+$/,"");current.leftStripped=current.value!==original;return current.leftStripped}exports["default"]=WhitespaceControl;module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";var _interopRequireWildcard=__webpack_require__(8)["default"];exports.__esModule=true;exports.SourceLocation=SourceLocation;exports.id=id;exports.stripFlags=stripFlags;exports.stripComment=stripComment;exports.preparePath=preparePath;exports.prepareMustache=prepareMustache;exports.prepareRawBlock=prepareRawBlock;exports.prepareBlock=prepareBlock;var _Exception=__webpack_require__(11);var _Exception2=_interopRequireWildcard(_Exception);function SourceLocation(source,locInfo){this.source=source;this.start={line:locInfo.first_line,column:locInfo.first_column};this.end={line:locInfo.last_line,column:locInfo.last_column}}function id(token){if(/^\[.*\]$/.test(token)){return token.substr(1,token.length-2)}else{return token}}function stripFlags(open,close){return{open:open.charAt(2)==="~",close:close.charAt(close.length-3)==="~"}}function stripComment(comment){return comment.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function preparePath(data,parts,locInfo){locInfo=this.locInfo(locInfo);var original=data?"@":"",dig=[],depth=0,depthString="";for(var i=0,l=parts.length;i<l;i++){var part=parts[i].part,isLiteral=parts[i].original!==part;original+=(parts[i].separator||"")+part;if(!isLiteral&&(part===".."||part==="."||part==="this")){if(dig.length>0){throw new _Exception2["default"]("Invalid path: "+original,{loc:locInfo})}else if(part===".."){depth++;depthString+="../"}}else{dig.push(part)}}return new this.PathExpression(data,depth,dig,original,locInfo)}function prepareMustache(path,params,hash,open,strip,locInfo){var escapeFlag=open.charAt(3)||open.charAt(2),escaped=escapeFlag!=="{"&&escapeFlag!=="&";return new this.MustacheStatement(path,params,hash,escaped,strip,this.locInfo(locInfo))}function prepareRawBlock(openRawBlock,content,close,locInfo){if(openRawBlock.path.original!==close){var errorNode={loc:openRawBlock.path.loc};throw new _Exception2["default"](openRawBlock.path.original+" doesn't match "+close,errorNode)}locInfo=this.locInfo(locInfo);var program=new this.Program([content],null,{},locInfo);return new this.BlockStatement(openRawBlock.path,openRawBlock.params,openRawBlock.hash,program,undefined,{},{},{},locInfo)}function prepareBlock(openBlock,program,inverseAndProgram,close,inverted,locInfo){if(close&&close.path&&openBlock.path.original!==close.path.original){var errorNode={loc:openBlock.path.loc};throw new _Exception2["default"](openBlock.path.original+" doesn't match "+close.path.original,errorNode)}program.blockParams=openBlock.blockParams;var inverse=undefined,inverseStrip=undefined;if(inverseAndProgram){if(inverseAndProgram.chain){inverseAndProgram.program.body[0].closeStrip=close.strip}inverseStrip=inverseAndProgram.strip;inverse=inverseAndProgram.program}if(inverted){inverted=inverse;inverse=program;program=inverted}return new this.BlockStatement(openBlock.path,openBlock.params,openBlock.hash,program,inverse,openBlock.strip,inverseStrip,close&&close.strip,this.locInfo(locInfo))}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;var _isArray=__webpack_require__(12);var SourceNode=undefined;try{if(false){var SourceMap=require("source-map");SourceNode=SourceMap.SourceNode}}catch(err){}if(!SourceNode){SourceNode=function(line,column,srcFile,chunks){this.src="";if(chunks){this.add(chunks)}};SourceNode.prototype={add:function add(chunks){if(_isArray.isArray(chunks)){chunks=chunks.join("")}this.src+=chunks},prepend:function prepend(chunks){if(_isArray.isArray(chunks)){chunks=chunks.join("")}this.src=chunks+this.src},toStringWithSourceMap:function toStringWithSourceMap(){return{code:this.toString()}},toString:function toString(){return this.src}}}function castChunk(chunk,codeGen,loc){if(_isArray.isArray(chunk)){var ret=[];for(var i=0,len=chunk.length;i<len;i++){ret.push(codeGen.wrap(chunk[i],loc))}return ret}else if(typeof chunk==="boolean"||typeof chunk==="number"){return chunk+""}return chunk}function CodeGen(srcFile){this.srcFile=srcFile;this.source=[]}CodeGen.prototype={prepend:function prepend(source,loc){this.source.unshift(this.wrap(source,loc))},push:function push(source,loc){this.source.push(this.wrap(source,loc))},merge:function merge(){var source=this.empty();this.each(function(line){source.add(["  ",line,"\n"])});return source},each:function each(iter){for(var i=0,len=this.source.length;i<len;i++){iter(this.source[i])}},empty:function empty(){var loc=arguments[0]===undefined?this.currentLocation||{start:{}}:arguments[0];return new SourceNode(loc.start.line,loc.start.column,this.srcFile)},wrap:function wrap(chunk){var loc=arguments[1]===undefined?this.currentLocation||{start:{}}:arguments[1];if(chunk instanceof SourceNode){return chunk}chunk=castChunk(chunk,this,loc);return new SourceNode(loc.start.line,loc.start.column,this.srcFile,chunk)},functionCall:function functionCall(fn,type,params){params=this.generateList(params);return this.wrap([fn,type?"."+type+"(":"(",params,")"])},quotedString:function quotedString(str){return'"'+(str+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function objectLiteral(obj){var pairs=[];for(var key in obj){if(obj.hasOwnProperty(key)){
var value=castChunk(obj[key],this);if(value!=="undefined"){pairs.push([this.quotedString(key),":",value])}}}var ret=this.generateList(pairs);ret.prepend("{");ret.add("}");return ret},generateList:function generateList(entries,loc){var ret=this.empty(loc);for(var i=0,len=entries.length;i<len;i++){if(i){ret.add(",")}ret.add(castChunk(entries[i],this,loc))}return ret},generateArray:function generateArray(entries,loc){var ret=this.generateList(entries,loc);ret.prepend("[");ret.add("]");return ret}};exports["default"]=CodeGen;module.exports=exports["default"]}])});(function(window){var startOffset=Date.now?Date.now():+new Date,performance=window.performance||{},_entries=[],_marksIndex={},_filterEntries=function(key,value){var i=0,n=_entries.length,result=[];for(;i<n;i++){if(_entries[i][key]==value){result.push(_entries[i])}}return result},_clearEntries=function(type,name){var i=_entries.length,entry;while(i--){entry=_entries[i];if(entry.entryType==type&&(name===void 0||entry.name==name)){_entries.splice(i,1)}}};if(!performance.now){performance.now=performance.webkitNow||performance.mozNow||performance.msNow||function(){return(Date.now?Date.now():+new Date)-startOffset}}if(!performance.mark){performance.mark=performance.webkitMark||function(name){var mark={name:name,entryType:"mark",startTime:performance.now(),duration:0};_entries.push(mark);_marksIndex[name]=mark}}if(!performance.measure){performance.measure=performance.webkitMeasure||function(name,startMark,endMark){startMark=_marksIndex[startMark].startTime;endMark=_marksIndex[endMark].startTime;_entries.push({name:name,entryType:"measure",startTime:startMark,duration:endMark-startMark})}}if(!performance.getEntriesByType){performance.getEntriesByType=performance.webkitGetEntriesByType||function(type){return _filterEntries("entryType",type)}}if(!performance.getEntriesByName){performance.getEntriesByName=performance.webkitGetEntriesByName||function(name){return _filterEntries("name",name)}}if(!performance.clearMarks){performance.clearMarks=performance.webkitClearMarks||function(name){_clearEntries("mark",name)}}if(!performance.clearMeasures){performance.clearMeasures=performance.webkitClearMeasures||function(name){_clearEntries("measure",name)}}window.performance=performance;if(typeof define==="function"&&(define.amd||define.ajs)){define("performance",[],function(){return performance})}})(window);(function(mod){if(typeof exports=="object"&&typeof module=="object")module.exports=mod();else if(typeof define=="function"&&define.amd)return define([],mod);else this.CodeMirror=mod()})(function(){"use strict";var gecko=/gecko\/\d/i.test(navigator.userAgent);var ie_upto10=/MSIE \d/.test(navigator.userAgent);var ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);var ie=ie_upto10||ie_11up;var ie_version=ie&&(ie_upto10?document.documentMode||6:ie_11up[1]);var webkit=/WebKit\//.test(navigator.userAgent);var qtwebkit=webkit&&/Qt\/\d+\.\d+/.test(navigator.userAgent);var chrome=/Chrome\//.test(navigator.userAgent);var presto=/Opera\//.test(navigator.userAgent);var safari=/Apple Computer/.test(navigator.vendor);var khtml=/KHTML\//.test(navigator.userAgent);var mac_geMountainLion=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent);var phantom=/PhantomJS/.test(navigator.userAgent);var ios=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);var mobile=ios||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);var mac=ios||/Mac/.test(navigator.platform);var windows=/win/i.test(navigator.platform);var presto_version=presto&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);if(presto_version)presto_version=Number(presto_version[1]);if(presto_version&&presto_version>=15){presto=false;webkit=true}var flipCtrlCmd=mac&&(qtwebkit||presto&&(presto_version==null||presto_version<12.11));var captureRightClick=gecko||ie&&ie_version>=9;var sawReadOnlySpans=false,sawCollapsedSpans=false;function CodeMirror(place,options){if(!(this instanceof CodeMirror))return new CodeMirror(place,options);this.options=options=options?copyObj(options):{};copyObj(defaults,options,false);setGuttersForLineNumbers(options);var doc=options.value;if(typeof doc=="string")doc=new Doc(doc,options.mode);this.doc=doc;var display=this.display=new Display(place,doc);display.wrapper.CodeMirror=this;updateGutters(this);themeChanged(this);if(options.lineWrapping)this.display.wrapper.className+=" CodeMirror-wrap";if(options.autofocus&&!mobile)focusInput(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,focused:false,suppressEdits:false,pasteIncoming:false,cutIncoming:false,draggingText:false,highlight:new Delayed,keySeq:null};if(ie&&ie_version<11)setTimeout(bind(resetInput,this,true),20);registerEventHandlers(this);ensureGlobalHandlers();startOperation(this);this.curOp.forceUpdate=true;attachDoc(this,doc);if(options.autofocus&&!mobile||activeElt()==display.input)setTimeout(bind(onFocus,this),20);else onBlur(this);for(var opt in optionHandlers)if(optionHandlers.hasOwnProperty(opt))optionHandlers[opt](this,options[opt],Init);maybeUpdateLineNumberWidth(this);for(var i=0;i<initHooks.length;++i)initHooks[i](this);endOperation(this)}function Display(place,doc){var d=this;var input=d.input=elt("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");if(webkit)input.style.width="1000px";else input.setAttribute("wrap","off");if(ios)input.style.border="1px solid black";input.setAttribute("autocorrect","off");input.setAttribute("autocapitalize","off");input.setAttribute("spellcheck","false");d.inputDiv=elt("div",[input],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");d.scrollbarH=elt("div",[elt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");d.scrollbarV=elt("div",[elt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");d.scrollbarFiller=elt("div",null,"CodeMirror-scrollbar-filler");d.gutterFiller=elt("div",null,"CodeMirror-gutter-filler");d.lineDiv=elt("div",null,"CodeMirror-code");d.selectionDiv=elt("div",null,null,"position: relative; z-index: 1");d.cursorDiv=elt("div",null,"CodeMirror-cursors");d.measure=elt("div",null,"CodeMirror-measure");d.lineMeasure=elt("div",null,"CodeMirror-measure");d.lineSpace=elt("div",[d.measure,d.lineMeasure,d.selectionDiv,d.cursorDiv,d.lineDiv],null,"position: relative; outline: none");d.mover=elt("div",[elt("div",[d.lineSpace],"CodeMirror-lines")],null,"position: relative");d.sizer=elt("div",[d.mover],"CodeMirror-sizer");d.heightForcer=elt("div",null,null,"position: absolute; height: "+scrollerCutOff+"px; width: 1px;");d.gutters=elt("div",null,"CodeMirror-gutters");d.lineGutter=null;d.scroller=elt("div",[d.sizer,d.heightForcer,d.gutters],"CodeMirror-scroll");d.scroller.setAttribute("tabIndex","-1");d.wrapper=elt("div",[d.inputDiv,d.scrollbarH,d.scrollbarV,d.scrollbarFiller,d.gutterFiller,d.scroller],"CodeMirror");if(ie&&ie_version<8){d.gutters.style.zIndex=-1;d.scroller.style.paddingRight=0}if(ios)input.style.width="0px";if(!webkit)d.scroller.draggable=true;if(khtml){d.inputDiv.style.height="1px";d.inputDiv.style.position="absolute"}if(ie&&ie_version<8)d.scrollbarH.style.minHeight=d.scrollbarV.style.minWidth="18px";if(place){if(place.appendChild)place.appendChild(d.wrapper);else place(d.wrapper)}d.viewFrom=d.viewTo=doc.first;d.view=[];d.externalMeasured=null;d.viewOffset=0;d.lastWrapHeight=d.lastWrapWidth=0;d.updateLineNumbers=null;d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null;d.prevInput="";d.alignWidgets=false;d.pollingFast=false;d.poll=new Delayed;d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null;d.inaccurateSelection=false;d.maxLine=null;d.maxLineLength=0;d.maxLineChanged=false;d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null;d.shift=false;d.selForContextMenu=null}function loadMode(cm){cm.doc.mode=CodeMirror.getMode(cm.options,cm.doc.modeOption);resetModeState(cm)}function resetModeState(cm){cm.doc.iter(function(line){if(line.stateAfter)line.stateAfter=null;if(line.styles)line.styles=null});cm.doc.frontier=cm.doc.first;startWorker(cm,100);cm.state.modeGen++;if(cm.curOp)regChange(cm)}function wrappingChanged(cm){if(cm.options.lineWrapping){addClass(cm.display.wrapper,"CodeMirror-wrap");cm.display.sizer.style.minWidth=""}else{rmClass(cm.display.wrapper,"CodeMirror-wrap");findMaxLine(cm)}estimateLineHeights(cm);regChange(cm);clearCaches(cm);setTimeout(function(){updateScrollbars(cm)},100)}function estimateHeight(cm){var th=textHeight(cm.display),wrapping=cm.options.lineWrapping;var perLine=wrapping&&Math.max(5,cm.display.scroller.clientWidth/charWidth(cm.display)-3);return function(line){if(lineIsHidden(cm.doc,line))return 0;var widgetsHeight=0;if(line.widgets)for(var i=0;i<line.widgets.length;i++){if(line.widgets[i].height)widgetsHeight+=line.widgets[i].height}if(wrapping)return widgetsHeight+(Math.ceil(line.text.length/perLine)||1)*th;else return widgetsHeight+th}}function estimateLineHeights(cm){var doc=cm.doc,est=estimateHeight(cm);doc.iter(function(line){var estHeight=est(line);if(estHeight!=line.height)updateLineHeight(line,estHeight)})}function themeChanged(cm){cm.display.wrapper.className=cm.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+cm.options.theme.replace(/(^|\s)\s*/g," cm-s-");clearCaches(cm)}function guttersChanged(cm){updateGutters(cm);regChange(cm);setTimeout(function(){alignHorizontally(cm)},20)}function updateGutters(cm){var gutters=cm.display.gutters,specs=cm.options.gutters;removeChildren(gutters);for(var i=0;i<specs.length;++i){var gutterClass=specs[i];var gElt=gutters.appendChild(elt("div",null,"CodeMirror-gutter "+gutterClass));if(gutterClass=="CodeMirror-linenumbers"){cm.display.lineGutter=gElt;gElt.style.width=(cm.display.lineNumWidth||1)+"px"}}gutters.style.display=i?"":"none";updateGutterSpace(cm)}function updateGutterSpace(cm){var width=cm.display.gutters.offsetWidth;cm.display.sizer.style.marginLeft=width+"px";cm.display.scrollbarH.style.left=cm.options.fixedGutter?width+"px":0}function lineLength(line){if(line.height==0)return 0;var len=line.text.length,merged,cur=line;while(merged=collapsedSpanAtStart(cur)){var found=merged.find(0,true);cur=found.from.line;len+=found.from.ch-found.to.ch}cur=line;while(merged=collapsedSpanAtEnd(cur)){var found=merged.find(0,true);len-=cur.text.length-found.from.ch;cur=found.to.line;len+=cur.text.length-found.to.ch}return len}function findMaxLine(cm){var d=cm.display,doc=cm.doc;d.maxLine=getLine(doc,doc.first);d.maxLineLength=lineLength(d.maxLine);d.maxLineChanged=true;doc.iter(function(line){var len=lineLength(line);if(len>d.maxLineLength){d.maxLineLength=len;d.maxLine=line}})}function setGuttersForLineNumbers(options){var found=indexOf(options.gutters,"CodeMirror-linenumbers");if(found==-1&&options.lineNumbers){options.gutters=options.gutters.concat(["CodeMirror-linenumbers"])}else if(found>-1&&!options.lineNumbers){options.gutters=options.gutters.slice(0);options.gutters.splice(found,1)}}function hScrollbarTakesSpace(cm){return cm.display.scroller.clientHeight-cm.display.wrapper.clientHeight<scrollerCutOff-3}function measureForScrollbars(cm){var scroll=cm.display.scroller;return{clientHeight:scroll.clientHeight,barHeight:cm.display.scrollbarV.clientHeight,scrollWidth:scroll.scrollWidth,clientWidth:scroll.clientWidth,hScrollbarTakesSpace:hScrollbarTakesSpace(cm),barWidth:cm.display.scrollbarH.clientWidth,docHeight:Math.round(cm.doc.height+paddingVert(cm.display))}}function updateScrollbars(cm,measure){if(!measure)measure=measureForScrollbars(cm);var d=cm.display,sWidth=scrollbarWidth(d.measure);var scrollHeight=measure.docHeight+scrollerCutOff;var needsH=measure.scrollWidth>measure.clientWidth;if(needsH&&measure.scrollWidth<=measure.clientWidth+1&&sWidth>0&&!measure.hScrollbarTakesSpace)needsH=false;var needsV=scrollHeight>measure.clientHeight;if(needsV){d.scrollbarV.style.display="block";d.scrollbarV.style.bottom=needsH?sWidth+"px":"0";d.scrollbarV.firstChild.style.height=Math.max(0,scrollHeight-measure.clientHeight+(measure.barHeight||d.scrollbarV.clientHeight))+"px"}else{d.scrollbarV.style.display="";d.scrollbarV.firstChild.style.height="0"}if(needsH){d.scrollbarH.style.display="block";d.scrollbarH.style.right=needsV?sWidth+"px":"0";d.scrollbarH.firstChild.style.width=measure.scrollWidth-measure.clientWidth+(measure.barWidth||d.scrollbarH.clientWidth)+"px"}else{d.scrollbarH.style.display="";d.scrollbarH.firstChild.style.width="0"}if(needsH&&needsV){d.scrollbarFiller.style.display="block";d.scrollbarFiller.style.height=d.scrollbarFiller.style.width=sWidth+"px"}else d.scrollbarFiller.style.display="";if(needsH&&cm.options.coverGutterNextToScrollbar&&cm.options.fixedGutter){d.gutterFiller.style.display="block";d.gutterFiller.style.height=sWidth+"px";d.gutterFiller.style.width=d.gutters.offsetWidth+"px"}else d.gutterFiller.style.display="";if(!cm.state.checkedOverlayScrollbar&&measure.clientHeight>0){if(sWidth===0){var w=mac&&!mac_geMountainLion?"12px":"18px";d.scrollbarV.style.minWidth=d.scrollbarH.style.minHeight=w;var barMouseDown=function(e){if(e_target(e)!=d.scrollbarV&&e_target(e)!=d.scrollbarH)operation(cm,onMouseDown)(e)};on(d.scrollbarV,"mousedown",barMouseDown);on(d.scrollbarH,"mousedown",barMouseDown)}cm.state.checkedOverlayScrollbar=true}}function visibleLines(display,doc,viewport){var top=viewport&&viewport.top!=null?Math.max(0,viewport.top):display.scroller.scrollTop;top=Math.floor(top-paddingTop(display));var bottom=viewport&&viewport.bottom!=null?viewport.bottom:top+display.wrapper.clientHeight;var from=lineAtHeight(doc,top),to=lineAtHeight(doc,bottom);if(viewport&&viewport.ensure){var ensureFrom=viewport.ensure.from.line,ensureTo=viewport.ensure.to.line;if(ensureFrom<from)return{from:ensureFrom,to:lineAtHeight(doc,heightAtLine(getLine(doc,ensureFrom))+display.wrapper.clientHeight)};if(Math.min(ensureTo,doc.lastLine())>=to)return{from:lineAtHeight(doc,heightAtLine(getLine(doc,ensureTo))-display.wrapper.clientHeight),to:ensureTo}}return{from:from,to:Math.max(to,from+1)}}function alignHorizontally(cm){var display=cm.display,view=display.view;if(!display.alignWidgets&&(!display.gutters.firstChild||!cm.options.fixedGutter))return;var comp=compensateForHScroll(display)-display.scroller.scrollLeft+cm.doc.scrollLeft;var gutterW=display.gutters.offsetWidth,left=comp+"px";for(var i=0;i<view.length;i++)if(!view[i].hidden){if(cm.options.fixedGutter&&view[i].gutter)view[i].gutter.style.left=left;var align=view[i].alignable;if(align)for(var j=0;j<align.length;j++)align[j].style.left=left}if(cm.options.fixedGutter)display.gutters.style.left=comp+gutterW+"px"}function maybeUpdateLineNumberWidth(cm){if(!cm.options.lineNumbers)return false;var doc=cm.doc,last=lineNumberFor(cm.options,doc.first+doc.size-1),display=cm.display;if(last.length!=display.lineNumChars){var test=display.measure.appendChild(elt("div",[elt("div",last)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var innerW=test.firstChild.offsetWidth,padding=test.offsetWidth-innerW;display.lineGutter.style.width="";display.lineNumInnerWidth=Math.max(innerW,display.lineGutter.offsetWidth-padding);display.lineNumWidth=display.lineNumInnerWidth+padding;display.lineNumChars=display.lineNumInnerWidth?last.length:-1;display.lineGutter.style.width=display.lineNumWidth+"px";updateGutterSpace(cm);return true}return false}function lineNumberFor(options,i){return String(options.lineNumberFormatter(i+options.firstLineNumber))}function compensateForHScroll(display){return display.scroller.getBoundingClientRect().left-display.sizer.getBoundingClientRect().left}function DisplayUpdate(cm,viewport,force){var display=cm.display;this.viewport=viewport;this.visible=visibleLines(display,cm.doc,viewport);this.editorIsHidden=!display.wrapper.offsetWidth;this.wrapperHeight=display.wrapper.clientHeight;this.wrapperWidth=display.wrapper.clientWidth;this.oldViewFrom=display.viewFrom;this.oldViewTo=display.viewTo;this.oldScrollerWidth=display.scroller.clientWidth;this.force=force;this.dims=getDimensions(cm)}function updateDisplayIfNeeded(cm,update){var display=cm.display,doc=cm.doc;if(update.editorIsHidden){resetView(cm);return false}if(!update.force&&update.visible.from>=display.viewFrom&&update.visible.to<=display.viewTo&&(display.updateLineNumbers==null||display.updateLineNumbers>=display.viewTo)&&countDirtyView(cm)==0)return false;if(maybeUpdateLineNumberWidth(cm)){resetView(cm);update.dims=getDimensions(cm)}var end=doc.first+doc.size;var from=Math.max(update.visible.from-cm.options.viewportMargin,doc.first);var to=Math.min(end,update.visible.to+cm.options.viewportMargin);if(display.viewFrom<from&&from-display.viewFrom<20)from=Math.max(doc.first,display.viewFrom);if(display.viewTo>to&&display.viewTo-to<20)to=Math.min(end,display.viewTo);if(sawCollapsedSpans){from=visualLineNo(cm.doc,from);to=visualLineEndNo(cm.doc,to)}var different=from!=display.viewFrom||to!=display.viewTo||display.lastWrapHeight!=update.wrapperHeight||display.lastWrapWidth!=update.wrapperWidth;adjustView(cm,from,to);display.viewOffset=heightAtLine(getLine(cm.doc,display.viewFrom));cm.display.mover.style.top=display.viewOffset+"px";var toUpdate=countDirtyView(cm);if(!different&&toUpdate==0&&!update.force&&(display.updateLineNumbers==null||display.updateLineNumbers>=display.viewTo))return false;var focused=activeElt();if(toUpdate>4)display.lineDiv.style.display="none";patchDisplay(cm,display.updateLineNumbers,update.dims);if(toUpdate>4)display.lineDiv.style.display="";if(focused&&activeElt()!=focused&&focused.offsetHeight)focused.focus();removeChildren(display.cursorDiv);removeChildren(display.selectionDiv);if(different){display.lastWrapHeight=update.wrapperHeight;display.lastWrapWidth=update.wrapperWidth;startWorker(cm,400)}display.updateLineNumbers=null;return true}function postUpdateDisplay(cm,update){var force=update.force,viewport=update.viewport;for(var first=true;;first=false){if(first&&cm.options.lineWrapping&&update.oldScrollerWidth!=cm.display.scroller.clientWidth){force=true}else{force=false;if(viewport&&viewport.top!=null)viewport={top:Math.min(cm.doc.height+paddingVert(cm.display)-scrollerCutOff-cm.display.scroller.clientHeight,viewport.top)};update.visible=visibleLines(cm.display,cm.doc,viewport);if(update.visible.from>=cm.display.viewFrom&&update.visible.to<=cm.display.viewTo)break}if(!updateDisplayIfNeeded(cm,update))break;updateHeightsInViewport(cm);var barMeasure=measureForScrollbars(cm);updateSelection(cm);setDocumentHeight(cm,barMeasure);updateScrollbars(cm,barMeasure)}signalLater(cm,"update",cm);if(cm.display.viewFrom!=update.oldViewFrom||cm.display.viewTo!=update.oldViewTo)signalLater(cm,"viewportChange",cm,cm.display.viewFrom,cm.display.viewTo)}function updateDisplaySimple(cm,viewport){var update=new DisplayUpdate(cm,viewport);if(updateDisplayIfNeeded(cm,update)){updateHeightsInViewport(cm);postUpdateDisplay(cm,update);var barMeasure=measureForScrollbars(cm);updateSelection(cm);setDocumentHeight(cm,barMeasure);updateScrollbars(cm,barMeasure)}}function setDocumentHeight(cm,measure){cm.display.sizer.style.minHeight=cm.display.heightForcer.style.top=measure.docHeight+"px";cm.display.gutters.style.height=Math.max(measure.docHeight,measure.clientHeight-scrollerCutOff)+"px"}function checkForWebkitWidthBug(cm,measure){if(cm.display.sizer.offsetWidth+cm.display.gutters.offsetWidth<cm.display.scroller.clientWidth-1){cm.display.sizer.style.minHeight=cm.display.heightForcer.style.top="0px";cm.display.gutters.style.height=measure.docHeight+"px"}}function updateHeightsInViewport(cm){var display=cm.display;var prevBottom=display.lineDiv.offsetTop;for(var i=0;i<display.view.length;i++){var cur=display.view[i],height;if(cur.hidden)continue;if(ie&&ie_version<8){var bot=cur.node.offsetTop+cur.node.offsetHeight;height=bot-prevBottom;prevBottom=bot}else{var box=cur.node.getBoundingClientRect();height=box.bottom-box.top}var diff=cur.line.height-height;if(height<2)height=textHeight(display);if(diff>.001||diff<-.001){updateLineHeight(cur.line,height);updateWidgetHeight(cur.line);if(cur.rest)for(var j=0;j<cur.rest.length;j++)updateWidgetHeight(cur.rest[j])}}}function updateWidgetHeight(line){if(line.widgets)for(var i=0;i<line.widgets.length;++i)line.widgets[i].height=line.widgets[i].node.offsetHeight}function getDimensions(cm){var d=cm.display,left={},width={};var gutterLeft=d.gutters.clientLeft;for(var n=d.gutters.firstChild,i=0;n;n=n.nextSibling,++i){left[cm.options.gutters[i]]=n.offsetLeft+n.clientLeft+gutterLeft;width[cm.options.gutters[i]]=n.clientWidth}return{fixedPos:compensateForHScroll(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:left,gutterWidth:width,wrapperWidth:d.wrapper.clientWidth}}function patchDisplay(cm,updateNumbersFrom,dims){var display=cm.display,lineNumbers=cm.options.lineNumbers;var container=display.lineDiv,cur=container.firstChild;function rm(node){var next=node.nextSibling;if(webkit&&mac&&cm.display.currentWheelTarget==node)node.style.display="none";else node.parentNode.removeChild(node);return next}var view=display.view,lineN=display.viewFrom;for(var i=0;i<view.length;i++){var lineView=view[i];if(lineView.hidden){}else if(!lineView.node){var node=buildLineElement(cm,lineView,lineN,dims);container.insertBefore(node,cur)}else{while(cur!=lineView.node)cur=rm(cur);var updateNumber=lineNumbers&&updateNumbersFrom!=null&&updateNumbersFrom<=lineN&&lineView.lineNumber;if(lineView.changes){if(indexOf(lineView.changes,"gutter")>-1)updateNumber=false;updateLineForChanges(cm,lineView,lineN,dims)}if(updateNumber){removeChildren(lineView.lineNumber);lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options,lineN)))}cur=lineView.node.nextSibling}lineN+=lineView.size}while(cur)cur=rm(cur)}function updateLineForChanges(cm,lineView,lineN,dims){for(var j=0;j<lineView.changes.length;j++){var type=lineView.changes[j];if(type=="text")updateLineText(cm,lineView);else if(type=="gutter")updateLineGutter(cm,lineView,lineN,dims);else if(type=="class")updateLineClasses(lineView);else if(type=="widget")updateLineWidgets(lineView,dims)}lineView.changes=null}function ensureLineWrapped(lineView){if(lineView.node==lineView.text){lineView.node=elt("div",null,null,"position: relative");if(lineView.text.parentNode)lineView.text.parentNode.replaceChild(lineView.node,lineView.text);lineView.node.appendChild(lineView.text);if(ie&&ie_version<8)lineView.node.style.zIndex=2}return lineView.node}function updateLineBackground(lineView){var cls=lineView.bgClass?lineView.bgClass+" "+(lineView.line.bgClass||""):lineView.line.bgClass;if(cls)cls+=" CodeMirror-linebackground";if(lineView.background){if(cls)lineView.background.className=cls;else{lineView.background.parentNode.removeChild(lineView.background);lineView.background=null}}else if(cls){var wrap=ensureLineWrapped(lineView);lineView.background=wrap.insertBefore(elt("div",null,cls),wrap.firstChild)}}function getLineContent(cm,lineView){var ext=cm.display.externalMeasured;if(ext&&ext.line==lineView.line){cm.display.externalMeasured=null;lineView.measure=ext.measure;return ext.built}return buildLineContent(cm,lineView)}function updateLineText(cm,lineView){var cls=lineView.text.className;var built=getLineContent(cm,lineView);if(lineView.text==lineView.node)lineView.node=built.pre;lineView.text.parentNode.replaceChild(built.pre,lineView.text);lineView.text=built.pre;if(built.bgClass!=lineView.bgClass||built.textClass!=lineView.textClass){lineView.bgClass=built.bgClass;lineView.textClass=built.textClass;updateLineClasses(lineView)}else if(cls){lineView.text.className=cls}}function updateLineClasses(lineView){updateLineBackground(lineView);if(lineView.line.wrapClass)ensureLineWrapped(lineView).className=lineView.line.wrapClass;else if(lineView.node!=lineView.text)lineView.node.className="";var textClass=lineView.textClass?lineView.textClass+" "+(lineView.line.textClass||""):lineView.line.textClass;lineView.text.className=textClass||""}function updateLineGutter(cm,lineView,lineN,dims){if(lineView.gutter){lineView.node.removeChild(lineView.gutter);lineView.gutter=null}var markers=lineView.line.gutterMarkers;if(cm.options.lineNumbers||markers){var wrap=ensureLineWrapped(lineView);var gutterWrap=lineView.gutter=wrap.insertBefore(elt("div",null,"CodeMirror-gutter-wrapper","left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px; width: "+dims.gutterTotalWidth+"px"),lineView.text);if(lineView.line.gutterClass)gutterWrap.className+=" "+lineView.line.gutterClass;if(cm.options.lineNumbers&&(!markers||!markers["CodeMirror-linenumbers"]))lineView.lineNumber=gutterWrap.appendChild(elt("div",lineNumberFor(cm.options,lineN),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+dims.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+cm.display.lineNumInnerWidth+"px"));if(markers)for(var k=0;k<cm.options.gutters.length;++k){var id=cm.options.gutters[k],found=markers.hasOwnProperty(id)&&markers[id];if(found)gutterWrap.appendChild(elt("div",[found],"CodeMirror-gutter-elt","left: "+dims.gutterLeft[id]+"px; width: "+dims.gutterWidth[id]+"px"))}}}function updateLineWidgets(lineView,dims){if(lineView.alignable)lineView.alignable=null;for(var node=lineView.node.firstChild,next;node;node=next){var next=node.nextSibling;if(node.className=="CodeMirror-linewidget")lineView.node.removeChild(node)}insertLineWidgets(lineView,dims)}function buildLineElement(cm,lineView,lineN,dims){var built=getLineContent(cm,lineView);lineView.text=lineView.node=built.pre;if(built.bgClass)lineView.bgClass=built.bgClass;if(built.textClass)lineView.textClass=built.textClass;updateLineClasses(lineView);updateLineGutter(cm,lineView,lineN,dims);insertLineWidgets(lineView,dims);return lineView.node}function insertLineWidgets(lineView,dims){insertLineWidgetsFor(lineView.line,lineView,dims,true);if(lineView.rest)for(var i=0;i<lineView.rest.length;i++)insertLineWidgetsFor(lineView.rest[i],lineView,dims,false)}function insertLineWidgetsFor(line,lineView,dims,allowAbove){if(!line.widgets)return;var wrap=ensureLineWrapped(lineView);for(var i=0,ws=line.widgets;i<ws.length;++i){var widget=ws[i],node=elt("div",[widget.node],"CodeMirror-linewidget");if(!widget.handleMouseEvents)node.ignoreEvents=true;positionLineWidget(widget,node,lineView,dims);if(allowAbove&&widget.above)wrap.insertBefore(node,lineView.gutter||lineView.text);else wrap.appendChild(node);signalLater(widget,"redraw")}}function positionLineWidget(widget,node,lineView,dims){if(widget.noHScroll){(lineView.alignable||(lineView.alignable=[])).push(node);var width=dims.wrapperWidth;node.style.left=dims.fixedPos+"px";if(!widget.coverGutter){width-=dims.gutterTotalWidth;node.style.paddingLeft=dims.gutterTotalWidth+"px"}node.style.width=width+"px"}if(widget.coverGutter){node.style.zIndex=5;node.style.position="relative";if(!widget.noHScroll)node.style.marginLeft=-dims.gutterTotalWidth+"px"}}var Pos=CodeMirror.Pos=function(line,ch){if(!(this instanceof Pos))return new Pos(line,ch);this.line=line;this.ch=ch};var cmp=CodeMirror.cmpPos=function(a,b){return a.line-b.line||a.ch-b.ch};function copyPos(x){return Pos(x.line,x.ch)}function maxPos(a,b){return cmp(a,b)<0?b:a}function minPos(a,b){return cmp(a,b)<0?a:b}function Selection(ranges,primIndex){this.ranges=ranges;this.primIndex=primIndex}Selection.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(other){if(other==this)return true;if(other.primIndex!=this.primIndex||other.ranges.length!=this.ranges.length)return false;for(var i=0;i<this.ranges.length;i++){var here=this.ranges[i],there=other.ranges[i];if(cmp(here.anchor,there.anchor)!=0||cmp(here.head,there.head)!=0)return false}return true},deepCopy:function(){for(var out=[],i=0;i<this.ranges.length;i++)out[i]=new Range(copyPos(this.ranges[i].anchor),copyPos(this.ranges[i].head));return new Selection(out,this.primIndex)},somethingSelected:function(){for(var i=0;i<this.ranges.length;i++)if(!this.ranges[i].empty())return true;return false},contains:function(pos,end){if(!end)end=pos;for(var i=0;i<this.ranges.length;i++){var range=this.ranges[i];if(cmp(end,range.from())>=0&&cmp(pos,range.to())<=0)return i}return-1}};function Range(anchor,head){this.anchor=anchor;this.head=head}Range.prototype={from:function(){return minPos(this.anchor,this.head)},to:function(){return maxPos(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};function normalizeSelection(ranges,primIndex){var prim=ranges[primIndex];ranges.sort(function(a,b){return cmp(a.from(),b.from())});primIndex=indexOf(ranges,prim);for(var i=1;i<ranges.length;i++){var cur=ranges[i],prev=ranges[i-1];if(cmp(prev.to(),cur.from())>=0){var from=minPos(prev.from(),cur.from()),to=maxPos(prev.to(),cur.to());var inv=prev.empty()?cur.from()==cur.head:prev.from()==prev.head;if(i<=primIndex)--primIndex;ranges.splice(--i,2,new Range(inv?to:from,inv?from:to))}}return new Selection(ranges,primIndex)}function simpleSelection(anchor,head){return new Selection([new Range(anchor,head||anchor)],0)}function clipLine(doc,n){return Math.max(doc.first,Math.min(n,doc.first+doc.size-1))}function clipPos(doc,pos){if(pos.line<doc.first)return Pos(doc.first,0);var last=doc.first+doc.size-1;if(pos.line>last)return Pos(last,getLine(doc,last).text.length);return clipToLen(pos,getLine(doc,pos.line).text.length)}function clipToLen(pos,linelen){var ch=pos.ch;if(ch==null||ch>linelen)return Pos(pos.line,linelen);else if(ch<0)return Pos(pos.line,0);else return pos}function isLine(doc,l){return l>=doc.first&&l<doc.first+doc.size}function clipPosArray(doc,array){for(var out=[],i=0;i<array.length;i++)out[i]=clipPos(doc,array[i]);return out}function extendRange(doc,range,head,other){if(doc.cm&&doc.cm.display.shift||doc.extend){var anchor=range.anchor;if(other){var posBefore=cmp(head,anchor)<0;if(posBefore!=cmp(other,anchor)<0){anchor=head;head=other}else if(posBefore!=cmp(head,other)<0){head=other}}return new Range(anchor,head)}else{return new Range(other||head,head)}}function extendSelection(doc,head,other,options){setSelection(doc,new Selection([extendRange(doc,doc.sel.primary(),head,other)],0),options)}function extendSelections(doc,heads,options){for(var out=[],i=0;i<doc.sel.ranges.length;i++)out[i]=extendRange(doc,doc.sel.ranges[i],heads[i],null);var newSel=normalizeSelection(out,doc.sel.primIndex);setSelection(doc,newSel,options)}function replaceOneSelection(doc,i,range,options){var ranges=doc.sel.ranges.slice(0);ranges[i]=range;setSelection(doc,normalizeSelection(ranges,doc.sel.primIndex),options)}function setSimpleSelection(doc,anchor,head,options){setSelection(doc,simpleSelection(anchor,head),options)}function filterSelectionChange(doc,sel){var obj={ranges:sel.ranges,update:function(ranges){this.ranges=[];for(var i=0;i<ranges.length;i++)this.ranges[i]=new Range(clipPos(doc,ranges[i].anchor),clipPos(doc,ranges[i].head))}};signal(doc,"beforeSelectionChange",doc,obj);if(doc.cm)signal(doc.cm,"beforeSelectionChange",doc.cm,obj);if(obj.ranges!=sel.ranges)return normalizeSelection(obj.ranges,obj.ranges.length-1);else return sel}function setSelectionReplaceHistory(doc,sel,options){var done=doc.history.done,last=lst(done);if(last&&last.ranges){done[done.length-1]=sel;setSelectionNoUndo(doc,sel,options)}else{setSelection(doc,sel,options)}}function setSelection(doc,sel,options){setSelectionNoUndo(doc,sel,options);addSelectionToHistory(doc,doc.sel,doc.cm?doc.cm.curOp.id:NaN,options)}function setSelectionNoUndo(doc,sel,options){if(hasHandler(doc,"beforeSelectionChange")||doc.cm&&hasHandler(doc.cm,"beforeSelectionChange"))sel=filterSelectionChange(doc,sel);var bias=options&&options.bias||(cmp(sel.primary().head,doc.sel.primary().head)<0?-1:1);setSelectionInner(doc,skipAtomicInSelection(doc,sel,bias,true));if(!(options&&options.scroll===false)&&doc.cm)ensureCursorVisible(doc.cm)}function setSelectionInner(doc,sel){if(sel.equals(doc.sel))return;doc.sel=sel;if(doc.cm){doc.cm.curOp.updateInput=doc.cm.curOp.selectionChanged=true;signalCursorActivity(doc.cm);
}signalLater(doc,"cursorActivity",doc)}function reCheckSelection(doc){setSelectionInner(doc,skipAtomicInSelection(doc,doc.sel,null,false),sel_dontScroll)}function skipAtomicInSelection(doc,sel,bias,mayClear){var out;for(var i=0;i<sel.ranges.length;i++){var range=sel.ranges[i];var newAnchor=skipAtomic(doc,range.anchor,bias,mayClear);var newHead=skipAtomic(doc,range.head,bias,mayClear);if(out||newAnchor!=range.anchor||newHead!=range.head){if(!out)out=sel.ranges.slice(0,i);out[i]=new Range(newAnchor,newHead)}}return out?normalizeSelection(out,sel.primIndex):sel}function skipAtomic(doc,pos,bias,mayClear){var flipped=false,curPos=pos;var dir=bias||1;doc.cantEdit=false;search:for(;;){var line=getLine(doc,curPos.line);if(line.markedSpans){for(var i=0;i<line.markedSpans.length;++i){var sp=line.markedSpans[i],m=sp.marker;if((sp.from==null||(m.inclusiveLeft?sp.from<=curPos.ch:sp.from<curPos.ch))&&(sp.to==null||(m.inclusiveRight?sp.to>=curPos.ch:sp.to>curPos.ch))){if(mayClear){signal(m,"beforeCursorEnter");if(m.explicitlyCleared){if(!line.markedSpans)break;else{--i;continue}}}if(!m.atomic)continue;var newPos=m.find(dir<0?-1:1);if(cmp(newPos,curPos)==0){newPos.ch+=dir;if(newPos.ch<0){if(newPos.line>doc.first)newPos=clipPos(doc,Pos(newPos.line-1));else newPos=null}else if(newPos.ch>line.text.length){if(newPos.line<doc.first+doc.size-1)newPos=Pos(newPos.line+1,0);else newPos=null}if(!newPos){if(flipped){if(!mayClear)return skipAtomic(doc,pos,bias,true);doc.cantEdit=true;return Pos(doc.first,0)}flipped=true;newPos=pos;dir=-dir}}curPos=newPos;continue search}}}return curPos}}function drawSelection(cm){var display=cm.display,doc=cm.doc,result={};var curFragment=result.cursors=document.createDocumentFragment();var selFragment=result.selection=document.createDocumentFragment();for(var i=0;i<doc.sel.ranges.length;i++){var range=doc.sel.ranges[i];var collapsed=range.empty();if(collapsed||cm.options.showCursorWhenSelecting)drawSelectionCursor(cm,range,curFragment);if(!collapsed)drawSelectionRange(cm,range,selFragment)}if(cm.options.moveInputWithCursor){var headPos=cursorCoords(cm,doc.sel.primary().head,"div");var wrapOff=display.wrapper.getBoundingClientRect(),lineOff=display.lineDiv.getBoundingClientRect();result.teTop=Math.max(0,Math.min(display.wrapper.clientHeight-10,headPos.top+lineOff.top-wrapOff.top));result.teLeft=Math.max(0,Math.min(display.wrapper.clientWidth-10,headPos.left+lineOff.left-wrapOff.left))}return result}function showSelection(cm,drawn){removeChildrenAndAdd(cm.display.cursorDiv,drawn.cursors);removeChildrenAndAdd(cm.display.selectionDiv,drawn.selection);if(drawn.teTop!=null){cm.display.inputDiv.style.top=drawn.teTop+"px";cm.display.inputDiv.style.left=drawn.teLeft+"px"}}function updateSelection(cm){showSelection(cm,drawSelection(cm))}function drawSelectionCursor(cm,range,output){var pos=cursorCoords(cm,range.head,"div",null,null,!cm.options.singleCursorHeightPerLine);var cursor=output.appendChild(elt("div","","CodeMirror-cursor"));cursor.style.left=pos.left+"px";cursor.style.top=pos.top+"px";cursor.style.height=Math.max(0,pos.bottom-pos.top)*cm.options.cursorHeight+"px";if(pos.other){var otherCursor=output.appendChild(elt("div","","CodeMirror-cursor CodeMirror-secondarycursor"));otherCursor.style.display="";otherCursor.style.left=pos.other.left+"px";otherCursor.style.top=pos.other.top+"px";otherCursor.style.height=(pos.other.bottom-pos.other.top)*.85+"px"}}function drawSelectionRange(cm,range,output){var display=cm.display,doc=cm.doc;var fragment=document.createDocumentFragment();var padding=paddingH(cm.display),leftSide=padding.left,rightSide=display.lineSpace.offsetWidth-padding.right;function add(left,top,width,bottom){if(top<0)top=0;top=Math.round(top);bottom=Math.round(bottom);fragment.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+left+"px; top: "+top+"px; width: "+(width==null?rightSide-left:width)+"px; height: "+(bottom-top)+"px"))}function drawForLine(line,fromArg,toArg){var lineObj=getLine(doc,line);var lineLen=lineObj.text.length;var start,end;function coords(ch,bias){return charCoords(cm,Pos(line,ch),"div",lineObj,bias)}iterateBidiSections(getOrder(lineObj),fromArg||0,toArg==null?lineLen:toArg,function(from,to,dir){var leftPos=coords(from,"left"),rightPos,left,right;if(from==to){rightPos=leftPos;left=right=leftPos.left}else{rightPos=coords(to-1,"right");if(dir=="rtl"){var tmp=leftPos;leftPos=rightPos;rightPos=tmp}left=leftPos.left;right=rightPos.right}if(fromArg==null&&from==0)left=leftSide;if(rightPos.top-leftPos.top>3){add(left,leftPos.top,null,leftPos.bottom);left=leftSide;if(leftPos.bottom<rightPos.top)add(left,leftPos.bottom,null,rightPos.top)}if(toArg==null&&to==lineLen)right=rightSide;if(!start||leftPos.top<start.top||leftPos.top==start.top&&leftPos.left<start.left)start=leftPos;if(!end||rightPos.bottom>end.bottom||rightPos.bottom==end.bottom&&rightPos.right>end.right)end=rightPos;if(left<leftSide+1)left=leftSide;add(left,rightPos.top,right-left,rightPos.bottom)});return{start:start,end:end}}var sFrom=range.from(),sTo=range.to();if(sFrom.line==sTo.line){drawForLine(sFrom.line,sFrom.ch,sTo.ch)}else{var fromLine=getLine(doc,sFrom.line),toLine=getLine(doc,sTo.line);var singleVLine=visualLine(fromLine)==visualLine(toLine);var leftEnd=drawForLine(sFrom.line,sFrom.ch,singleVLine?fromLine.text.length+1:null).end;var rightStart=drawForLine(sTo.line,singleVLine?0:null,sTo.ch).start;if(singleVLine){if(leftEnd.top<rightStart.top-2){add(leftEnd.right,leftEnd.top,null,leftEnd.bottom);add(leftSide,rightStart.top,rightStart.left,rightStart.bottom)}else{add(leftEnd.right,leftEnd.top,rightStart.left-leftEnd.right,leftEnd.bottom)}}if(leftEnd.bottom<rightStart.top)add(leftSide,leftEnd.bottom,null,rightStart.top)}output.appendChild(fragment)}function restartBlink(cm){if(!cm.state.focused)return;var display=cm.display;clearInterval(display.blinker);var on=true;display.cursorDiv.style.visibility="";if(cm.options.cursorBlinkRate>0)display.blinker=setInterval(function(){display.cursorDiv.style.visibility=(on=!on)?"":"hidden"},cm.options.cursorBlinkRate);else if(cm.options.cursorBlinkRate<0)display.cursorDiv.style.visibility="hidden"}function startWorker(cm,time){if(cm.doc.mode.startState&&cm.doc.frontier<cm.display.viewTo)cm.state.highlight.set(time,bind(highlightWorker,cm))}function highlightWorker(cm){var doc=cm.doc;if(doc.frontier<doc.first)doc.frontier=doc.first;if(doc.frontier>=cm.display.viewTo)return;var end=+new Date+cm.options.workTime;var state=copyState(doc.mode,getStateBefore(cm,doc.frontier));var changedLines=[];doc.iter(doc.frontier,Math.min(doc.first+doc.size,cm.display.viewTo+500),function(line){if(doc.frontier>=cm.display.viewFrom){var oldStyles=line.styles;var highlighted=highlightLine(cm,line,state,true);line.styles=highlighted.styles;var oldCls=line.styleClasses,newCls=highlighted.classes;if(newCls)line.styleClasses=newCls;else if(oldCls)line.styleClasses=null;var ischange=!oldStyles||oldStyles.length!=line.styles.length||oldCls!=newCls&&(!oldCls||!newCls||oldCls.bgClass!=newCls.bgClass||oldCls.textClass!=newCls.textClass);for(var i=0;!ischange&&i<oldStyles.length;++i)ischange=oldStyles[i]!=line.styles[i];if(ischange)changedLines.push(doc.frontier);line.stateAfter=copyState(doc.mode,state)}else{processLine(cm,line.text,state);line.stateAfter=doc.frontier%5==0?copyState(doc.mode,state):null}++doc.frontier;if(+new Date>end){startWorker(cm,cm.options.workDelay);return true}});if(changedLines.length)runInOp(cm,function(){for(var i=0;i<changedLines.length;i++)regLineChange(cm,changedLines[i],"text")})}function findStartLine(cm,n,precise){var minindent,minline,doc=cm.doc;var lim=precise?-1:n-(cm.doc.mode.innerMode?1e3:100);for(var search=n;search>lim;--search){if(search<=doc.first)return doc.first;var line=getLine(doc,search-1);if(line.stateAfter&&(!precise||search<=doc.frontier))return search;var indented=countColumn(line.text,null,cm.options.tabSize);if(minline==null||minindent>indented){minline=search-1;minindent=indented}}return minline}function getStateBefore(cm,n,precise){var doc=cm.doc,display=cm.display;if(!doc.mode.startState)return true;var pos=findStartLine(cm,n,precise),state=pos>doc.first&&getLine(doc,pos-1).stateAfter;if(!state)state=startState(doc.mode);else state=copyState(doc.mode,state);doc.iter(pos,n,function(line){processLine(cm,line.text,state);var save=pos==n-1||pos%5==0||pos>=display.viewFrom&&pos<display.viewTo;line.stateAfter=save?copyState(doc.mode,state):null;++pos});if(precise)doc.frontier=pos;return state}function paddingTop(display){return display.lineSpace.offsetTop}function paddingVert(display){return display.mover.offsetHeight-display.lineSpace.offsetHeight}function paddingH(display){if(display.cachedPaddingH)return display.cachedPaddingH;var e=removeChildrenAndAdd(display.measure,elt("pre","x"));var style=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle;var data={left:parseInt(style.paddingLeft),right:parseInt(style.paddingRight)};if(!isNaN(data.left)&&!isNaN(data.right))display.cachedPaddingH=data;return data}function ensureLineHeights(cm,lineView,rect){var wrapping=cm.options.lineWrapping;var curWidth=wrapping&&cm.display.scroller.clientWidth;if(!lineView.measure.heights||wrapping&&lineView.measure.width!=curWidth){var heights=lineView.measure.heights=[];if(wrapping){lineView.measure.width=curWidth;var rects=lineView.text.firstChild.getClientRects();for(var i=0;i<rects.length-1;i++){var cur=rects[i],next=rects[i+1];if(Math.abs(cur.bottom-next.bottom)>2)heights.push((cur.bottom+next.top)/2-rect.top)}}heights.push(rect.bottom-rect.top)}}function mapFromLineView(lineView,line,lineN){if(lineView.line==line)return{map:lineView.measure.map,cache:lineView.measure.cache};for(var i=0;i<lineView.rest.length;i++)if(lineView.rest[i]==line)return{map:lineView.measure.maps[i],cache:lineView.measure.caches[i]};for(var i=0;i<lineView.rest.length;i++)if(lineNo(lineView.rest[i])>lineN)return{map:lineView.measure.maps[i],cache:lineView.measure.caches[i],before:true}}function updateExternalMeasurement(cm,line){line=visualLine(line);var lineN=lineNo(line);var view=cm.display.externalMeasured=new LineView(cm.doc,line,lineN);view.lineN=lineN;var built=view.built=buildLineContent(cm,view);view.text=built.pre;removeChildrenAndAdd(cm.display.lineMeasure,built.pre);return view}function measureChar(cm,line,ch,bias){return measureCharPrepared(cm,prepareMeasureForLine(cm,line),ch,bias)}function findViewForLine(cm,lineN){if(lineN>=cm.display.viewFrom&&lineN<cm.display.viewTo)return cm.display.view[findViewIndex(cm,lineN)];var ext=cm.display.externalMeasured;if(ext&&lineN>=ext.lineN&&lineN<ext.lineN+ext.size)return ext}function prepareMeasureForLine(cm,line){var lineN=lineNo(line);var view=findViewForLine(cm,lineN);if(view&&!view.text)view=null;else if(view&&view.changes)updateLineForChanges(cm,view,lineN,getDimensions(cm));if(!view)view=updateExternalMeasurement(cm,line);var info=mapFromLineView(view,line,lineN);return{line:line,view:view,rect:null,map:info.map,cache:info.cache,before:info.before,hasHeights:false}}function measureCharPrepared(cm,prepared,ch,bias,varHeight){if(prepared.before)ch=-1;var key=ch+(bias||""),found;if(prepared.cache.hasOwnProperty(key)){found=prepared.cache[key]}else{if(!prepared.rect)prepared.rect=prepared.view.text.getBoundingClientRect();if(!prepared.hasHeights){ensureLineHeights(cm,prepared.view,prepared.rect);prepared.hasHeights=true}found=measureCharInner(cm,prepared,ch,bias);if(!found.bogus)prepared.cache[key]=found}return{left:found.left,right:found.right,top:varHeight?found.rtop:found.top,bottom:varHeight?found.rbottom:found.bottom}}var nullRect={left:0,right:0,top:0,bottom:0};function measureCharInner(cm,prepared,ch,bias){var map=prepared.map;var node,start,end,collapse;for(var i=0;i<map.length;i+=3){var mStart=map[i],mEnd=map[i+1];if(ch<mStart){start=0;end=1;collapse="left"}else if(ch<mEnd){start=ch-mStart;end=start+1}else if(i==map.length-3||ch==mEnd&&map[i+3]>ch){end=mEnd-mStart;start=end-1;if(ch>=mEnd)collapse="right"}if(start!=null){node=map[i+2];if(mStart==mEnd&&bias==(node.insertLeft?"left":"right"))collapse=bias;if(bias=="left"&&start==0)while(i&&map[i-2]==map[i-3]&&map[i-1].insertLeft){node=map[(i-=3)+2];collapse="left"}if(bias=="right"&&start==mEnd-mStart)while(i<map.length-3&&map[i+3]==map[i+4]&&!map[i+5].insertLeft){node=map[(i+=3)+2];collapse="right"}break}}var rect;if(node.nodeType==3){for(var i=0;i<4;i++){while(start&&isExtendingChar(prepared.line.text.charAt(mStart+start)))--start;while(mStart+end<mEnd&&isExtendingChar(prepared.line.text.charAt(mStart+end)))++end;if(ie&&ie_version<9&&start==0&&end==mEnd-mStart){rect=node.parentNode.getBoundingClientRect()}else if(ie&&cm.options.lineWrapping){var rects=range(node,start,end).getClientRects();if(rects.length)rect=rects[bias=="right"?rects.length-1:0];else rect=nullRect}else{rect=range(node,start,end).getBoundingClientRect()||nullRect}if(rect.left||rect.right||start==0)break;end=start;start=start-1;collapse="right"}if(ie&&ie_version<11)rect=maybeUpdateRectForZooming(cm.display.measure,rect)}else{if(start>0)collapse=bias="right";var rects;if(cm.options.lineWrapping&&(rects=node.getClientRects()).length>1)rect=rects[bias=="right"?rects.length-1:0];else rect=node.getBoundingClientRect()}if(ie&&ie_version<9&&!start&&(!rect||!rect.left&&!rect.right)){var rSpan=node.parentNode.getClientRects()[0];if(rSpan)rect={left:rSpan.left,right:rSpan.left+charWidth(cm.display),top:rSpan.top,bottom:rSpan.bottom};else rect=nullRect}var rtop=rect.top-prepared.rect.top,rbot=rect.bottom-prepared.rect.top;var mid=(rtop+rbot)/2;var heights=prepared.view.measure.heights;for(var i=0;i<heights.length-1;i++)if(mid<heights[i])break;var top=i?heights[i-1]:0,bot=heights[i];var result={left:(collapse=="right"?rect.right:rect.left)-prepared.rect.left,right:(collapse=="left"?rect.left:rect.right)-prepared.rect.left,top:top,bottom:bot};if(!rect.left&&!rect.right)result.bogus=true;if(!cm.options.singleCursorHeightPerLine){result.rtop=rtop;result.rbottom=rbot}return result}function maybeUpdateRectForZooming(measure,rect){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!hasBadZoomedRects(measure))return rect;var scaleX=screen.logicalXDPI/screen.deviceXDPI;var scaleY=screen.logicalYDPI/screen.deviceYDPI;return{left:rect.left*scaleX,right:rect.right*scaleX,top:rect.top*scaleY,bottom:rect.bottom*scaleY}}function clearLineMeasurementCacheFor(lineView){if(lineView.measure){lineView.measure.cache={};lineView.measure.heights=null;if(lineView.rest)for(var i=0;i<lineView.rest.length;i++)lineView.measure.caches[i]={}}}function clearLineMeasurementCache(cm){cm.display.externalMeasure=null;removeChildren(cm.display.lineMeasure);for(var i=0;i<cm.display.view.length;i++)clearLineMeasurementCacheFor(cm.display.view[i])}function clearCaches(cm){clearLineMeasurementCache(cm);cm.display.cachedCharWidth=cm.display.cachedTextHeight=cm.display.cachedPaddingH=null;if(!cm.options.lineWrapping)cm.display.maxLineChanged=true;cm.display.lineNumChars=null}function pageScrollX(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function pageScrollY(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function intoCoordSystem(cm,lineObj,rect,context){if(lineObj.widgets)for(var i=0;i<lineObj.widgets.length;++i)if(lineObj.widgets[i].above){var size=widgetHeight(lineObj.widgets[i]);rect.top+=size;rect.bottom+=size}if(context=="line")return rect;if(!context)context="local";var yOff=heightAtLine(lineObj);if(context=="local")yOff+=paddingTop(cm.display);else yOff-=cm.display.viewOffset;if(context=="page"||context=="window"){var lOff=cm.display.lineSpace.getBoundingClientRect();yOff+=lOff.top+(context=="window"?0:pageScrollY());var xOff=lOff.left+(context=="window"?0:pageScrollX());rect.left+=xOff;rect.right+=xOff}rect.top+=yOff;rect.bottom+=yOff;return rect}function fromCoordSystem(cm,coords,context){if(context=="div")return coords;var left=coords.left,top=coords.top;if(context=="page"){left-=pageScrollX();top-=pageScrollY()}else if(context=="local"||!context){var localBox=cm.display.sizer.getBoundingClientRect();left+=localBox.left;top+=localBox.top}var lineSpaceBox=cm.display.lineSpace.getBoundingClientRect();return{left:left-lineSpaceBox.left,top:top-lineSpaceBox.top}}function charCoords(cm,pos,context,lineObj,bias){if(!lineObj)lineObj=getLine(cm.doc,pos.line);return intoCoordSystem(cm,lineObj,measureChar(cm,lineObj,pos.ch,bias),context)}function cursorCoords(cm,pos,context,lineObj,preparedMeasure,varHeight){lineObj=lineObj||getLine(cm.doc,pos.line);if(!preparedMeasure)preparedMeasure=prepareMeasureForLine(cm,lineObj);function get(ch,right){var m=measureCharPrepared(cm,preparedMeasure,ch,right?"right":"left",varHeight);if(right)m.left=m.right;else m.right=m.left;return intoCoordSystem(cm,lineObj,m,context)}function getBidi(ch,partPos){var part=order[partPos],right=part.level%2;if(ch==bidiLeft(part)&&partPos&&part.level<order[partPos-1].level){part=order[--partPos];ch=bidiRight(part)-(part.level%2?0:1);right=true}else if(ch==bidiRight(part)&&partPos<order.length-1&&part.level<order[partPos+1].level){part=order[++partPos];ch=bidiLeft(part)-part.level%2;right=false}if(right&&ch==part.to&&ch>part.from)return get(ch-1);return get(ch,right)}var order=getOrder(lineObj),ch=pos.ch;if(!order)return get(ch);var partPos=getBidiPartAt(order,ch);var val=getBidi(ch,partPos);if(bidiOther!=null)val.other=getBidi(ch,bidiOther);return val}function estimateCoords(cm,pos){var left=0,pos=clipPos(cm.doc,pos);if(!cm.options.lineWrapping)left=charWidth(cm.display)*pos.ch;var lineObj=getLine(cm.doc,pos.line);var top=heightAtLine(lineObj)+paddingTop(cm.display);return{left:left,right:left,top:top,bottom:top+lineObj.height}}function PosWithInfo(line,ch,outside,xRel){var pos=Pos(line,ch);pos.xRel=xRel;if(outside)pos.outside=true;return pos}function coordsChar(cm,x,y){var doc=cm.doc;y+=cm.display.viewOffset;if(y<0)return PosWithInfo(doc.first,0,true,-1);var lineN=lineAtHeight(doc,y),last=doc.first+doc.size-1;if(lineN>last)return PosWithInfo(doc.first+doc.size-1,getLine(doc,last).text.length,true,1);if(x<0)x=0;var lineObj=getLine(doc,lineN);for(;;){var found=coordsCharInner(cm,lineObj,lineN,x,y);var merged=collapsedSpanAtEnd(lineObj);var mergedPos=merged&&merged.find(0,true);if(merged&&(found.ch>mergedPos.from.ch||found.ch==mergedPos.from.ch&&found.xRel>0))lineN=lineNo(lineObj=mergedPos.to.line);else return found}}function coordsCharInner(cm,lineObj,lineNo,x,y){var innerOff=y-heightAtLine(lineObj);var wrongLine=false,adjust=2*cm.display.wrapper.clientWidth;var preparedMeasure=prepareMeasureForLine(cm,lineObj);function getX(ch){var sp=cursorCoords(cm,Pos(lineNo,ch),"line",lineObj,preparedMeasure);wrongLine=true;if(innerOff>sp.bottom)return sp.left-adjust;else if(innerOff<sp.top)return sp.left+adjust;else wrongLine=false;return sp.left}var bidi=getOrder(lineObj),dist=lineObj.text.length;var from=lineLeft(lineObj),to=lineRight(lineObj);var fromX=getX(from),fromOutside=wrongLine,toX=getX(to),toOutside=wrongLine;if(x>toX)return PosWithInfo(lineNo,to,toOutside,1);for(;;){if(bidi?to==from||to==moveVisually(lineObj,from,1):to-from<=1){var ch=x<fromX||x-fromX<=toX-x?from:to;var xDiff=x-(ch==from?fromX:toX);while(isExtendingChar(lineObj.text.charAt(ch)))++ch;var pos=PosWithInfo(lineNo,ch,ch==from?fromOutside:toOutside,xDiff<-1?-1:xDiff>1?1:0);return pos}var step=Math.ceil(dist/2),middle=from+step;if(bidi){middle=from;for(var i=0;i<step;++i)middle=moveVisually(lineObj,middle,1)}var middleX=getX(middle);if(middleX>x){to=middle;toX=middleX;if(toOutside=wrongLine)toX+=1e3;dist=step}else{from=middle;fromX=middleX;fromOutside=wrongLine;dist-=step}}}var measureText;function textHeight(display){if(display.cachedTextHeight!=null)return display.cachedTextHeight;if(measureText==null){measureText=elt("pre");for(var i=0;i<49;++i){measureText.appendChild(document.createTextNode("x"));measureText.appendChild(elt("br"))}measureText.appendChild(document.createTextNode("x"))}removeChildrenAndAdd(display.measure,measureText);var height=measureText.offsetHeight/50;if(height>3)display.cachedTextHeight=height;removeChildren(display.measure);return height||1}function charWidth(display){if(display.cachedCharWidth!=null)return display.cachedCharWidth;var anchor=elt("span","xxxxxxxxxx");var pre=elt("pre",[anchor]);removeChildrenAndAdd(display.measure,pre);var rect=anchor.getBoundingClientRect(),width=(rect.right-rect.left)/10;if(width>2)display.cachedCharWidth=width;return width||10}var operationGroup=null;var nextOpId=0;function startOperation(cm){cm.curOp={cm:cm,viewChanged:false,startHeight:cm.doc.height,forceUpdate:false,updateInput:null,typing:false,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,id:++nextOpId};if(operationGroup){operationGroup.ops.push(cm.curOp)}else{cm.curOp.ownsGroup=operationGroup={ops:[cm.curOp],delayedCallbacks:[]}}}function fireCallbacksForOps(group){var callbacks=group.delayedCallbacks,i=0;do{for(;i<callbacks.length;i++)callbacks[i]();for(var j=0;j<group.ops.length;j++){var op=group.ops[j];if(op.cursorActivityHandlers)while(op.cursorActivityCalled<op.cursorActivityHandlers.length)op.cursorActivityHandlers[op.cursorActivityCalled++](op.cm)}}while(i<callbacks.length)}function endOperation(cm){var op=cm.curOp,group=op.ownsGroup;if(!group)return;try{fireCallbacksForOps(group)}finally{operationGroup=null;for(var i=0;i<group.ops.length;i++)group.ops[i].cm.curOp=null;endOperations(group)}}function endOperations(group){var ops=group.ops;for(var i=0;i<ops.length;i++)endOperation_R1(ops[i]);for(var i=0;i<ops.length;i++)endOperation_W1(ops[i]);for(var i=0;i<ops.length;i++)endOperation_R2(ops[i]);for(var i=0;i<ops.length;i++)endOperation_W2(ops[i]);for(var i=0;i<ops.length;i++)endOperation_finish(ops[i])}function endOperation_R1(op){var cm=op.cm,display=cm.display;if(op.updateMaxLine)findMaxLine(cm);op.mustUpdate=op.viewChanged||op.forceUpdate||op.scrollTop!=null||op.scrollToPos&&(op.scrollToPos.from.line<display.viewFrom||op.scrollToPos.to.line>=display.viewTo)||display.maxLineChanged&&cm.options.lineWrapping;op.update=op.mustUpdate&&new DisplayUpdate(cm,op.mustUpdate&&{top:op.scrollTop,ensure:op.scrollToPos},op.forceUpdate)}function endOperation_W1(op){op.updatedDisplay=op.mustUpdate&&updateDisplayIfNeeded(op.cm,op.update)}function endOperation_R2(op){var cm=op.cm,display=cm.display;if(op.updatedDisplay)updateHeightsInViewport(cm);op.barMeasure=measureForScrollbars(cm);if(display.maxLineChanged&&!cm.options.lineWrapping){op.adjustWidthTo=measureChar(cm,display.maxLine,display.maxLine.text.length).left+3;op.maxScrollLeft=Math.max(0,display.sizer.offsetLeft+op.adjustWidthTo+scrollerCutOff-display.scroller.clientWidth)}if(op.updatedDisplay||op.selectionChanged)op.newSelectionNodes=drawSelection(cm)}function endOperation_W2(op){var cm=op.cm;if(op.adjustWidthTo!=null){cm.display.sizer.style.minWidth=op.adjustWidthTo+"px";if(op.maxScrollLeft<cm.doc.scrollLeft)setScrollLeft(cm,Math.min(cm.display.scroller.scrollLeft,op.maxScrollLeft),true);cm.display.maxLineChanged=false}if(op.newSelectionNodes)showSelection(cm,op.newSelectionNodes);if(op.updatedDisplay)setDocumentHeight(cm,op.barMeasure);if(op.updatedDisplay||op.startHeight!=cm.doc.height)updateScrollbars(cm,op.barMeasure);if(op.selectionChanged)restartBlink(cm);if(cm.state.focused&&op.updateInput)resetInput(cm,op.typing)}function endOperation_finish(op){var cm=op.cm,display=cm.display,doc=cm.doc;if(op.adjustWidthTo!=null&&Math.abs(op.barMeasure.scrollWidth-cm.display.scroller.scrollWidth)>1)updateScrollbars(cm);if(op.updatedDisplay)postUpdateDisplay(cm,op.update);if(display.wheelStartX!=null&&(op.scrollTop!=null||op.scrollLeft!=null||op.scrollToPos))display.wheelStartX=display.wheelStartY=null;if(op.scrollTop!=null&&(display.scroller.scrollTop!=op.scrollTop||op.forceScroll)){var top=Math.max(0,Math.min(display.scroller.scrollHeight-display.scroller.clientHeight,op.scrollTop));display.scroller.scrollTop=display.scrollbarV.scrollTop=doc.scrollTop=top}if(op.scrollLeft!=null&&(display.scroller.scrollLeft!=op.scrollLeft||op.forceScroll)){var left=Math.max(0,Math.min(display.scroller.scrollWidth-display.scroller.clientWidth,op.scrollLeft));display.scroller.scrollLeft=display.scrollbarH.scrollLeft=doc.scrollLeft=left;alignHorizontally(cm)}if(op.scrollToPos){var coords=scrollPosIntoView(cm,clipPos(doc,op.scrollToPos.from),clipPos(doc,op.scrollToPos.to),op.scrollToPos.margin);if(op.scrollToPos.isCursor&&cm.state.focused)maybeScrollWindow(cm,coords)}var hidden=op.maybeHiddenMarkers,unhidden=op.maybeUnhiddenMarkers;if(hidden)for(var i=0;i<hidden.length;++i)if(!hidden[i].lines.length)signal(hidden[i],"hide");if(unhidden)for(var i=0;i<unhidden.length;++i)if(unhidden[i].lines.length)signal(unhidden[i],"unhide");if(display.wrapper.offsetHeight)doc.scrollTop=cm.display.scroller.scrollTop;if(op.updatedDisplay&&webkit){if(cm.options.lineWrapping)checkForWebkitWidthBug(cm,op.barMeasure);if(op.barMeasure.scrollWidth>op.barMeasure.clientWidth&&op.barMeasure.scrollWidth<op.barMeasure.clientWidth+1&&!hScrollbarTakesSpace(cm))updateScrollbars(cm)}if(op.changeObjs)signal(cm,"changes",cm,op.changeObjs)}function runInOp(cm,f){if(cm.curOp)return f();startOperation(cm);try{return f()}finally{endOperation(cm)}}function operation(cm,f){return function(){if(cm.curOp)return f.apply(cm,arguments);startOperation(cm);try{return f.apply(cm,arguments)}finally{endOperation(cm)}}}function methodOp(f){return function(){if(this.curOp)return f.apply(this,arguments);startOperation(this);try{return f.apply(this,arguments)}finally{endOperation(this)}}}function docMethodOp(f){return function(){var cm=this.cm;if(!cm||cm.curOp)return f.apply(this,arguments);startOperation(cm);try{return f.apply(this,arguments)}finally{endOperation(cm)}}}function LineView(doc,line,lineN){this.line=line;this.rest=visualLineContinued(line);this.size=this.rest?lineNo(lst(this.rest))-lineN+1:1;this.node=this.text=null;this.hidden=lineIsHidden(doc,line)}function buildViewArray(cm,from,to){var array=[],nextPos;for(var pos=from;pos<to;pos=nextPos){var view=new LineView(cm.doc,getLine(cm.doc,pos),pos);nextPos=pos+view.size;array.push(view)}return array}function regChange(cm,from,to,lendiff){if(from==null)from=cm.doc.first;if(to==null)to=cm.doc.first+cm.doc.size;if(!lendiff)lendiff=0;var display=cm.display;if(lendiff&&to<display.viewTo&&(display.updateLineNumbers==null||display.updateLineNumbers>from))display.updateLineNumbers=from;cm.curOp.viewChanged=true;if(from>=display.viewTo){if(sawCollapsedSpans&&visualLineNo(cm.doc,from)<display.viewTo)resetView(cm)}else if(to<=display.viewFrom){if(sawCollapsedSpans&&visualLineEndNo(cm.doc,to+lendiff)>display.viewFrom){resetView(cm)}else{display.viewFrom+=lendiff;display.viewTo+=lendiff}}else if(from<=display.viewFrom&&to>=display.viewTo){resetView(cm)}else if(from<=display.viewFrom){var cut=viewCuttingPoint(cm,to,to+lendiff,1);if(cut){display.view=display.view.slice(cut.index);display.viewFrom=cut.lineN;display.viewTo+=lendiff}else{resetView(cm)}}else if(to>=display.viewTo){var cut=viewCuttingPoint(cm,from,from,-1);if(cut){display.view=display.view.slice(0,cut.index);display.viewTo=cut.lineN}else{resetView(cm)}}else{var cutTop=viewCuttingPoint(cm,from,from,-1);var cutBot=viewCuttingPoint(cm,to,to+lendiff,1);if(cutTop&&cutBot){display.view=display.view.slice(0,cutTop.index).concat(buildViewArray(cm,cutTop.lineN,cutBot.lineN)).concat(display.view.slice(cutBot.index));display.viewTo+=lendiff}else{resetView(cm)}}var ext=display.externalMeasured;if(ext){if(to<ext.lineN)ext.lineN+=lendiff;else if(from<ext.lineN+ext.size)display.externalMeasured=null}}function regLineChange(cm,line,type){cm.curOp.viewChanged=true;var display=cm.display,ext=cm.display.externalMeasured;if(ext&&line>=ext.lineN&&line<ext.lineN+ext.size)display.externalMeasured=null;if(line<display.viewFrom||line>=display.viewTo)return;var lineView=display.view[findViewIndex(cm,line)];if(lineView.node==null)return;var arr=lineView.changes||(lineView.changes=[]);if(indexOf(arr,type)==-1)arr.push(type)}function resetView(cm){cm.display.viewFrom=cm.display.viewTo=cm.doc.first;cm.display.view=[];cm.display.viewOffset=0}function findViewIndex(cm,n){if(n>=cm.display.viewTo)return null;n-=cm.display.viewFrom;if(n<0)return null;var view=cm.display.view;for(var i=0;i<view.length;i++){n-=view[i].size;if(n<0)return i}}function viewCuttingPoint(cm,oldN,newN,dir){var index=findViewIndex(cm,oldN),diff,view=cm.display.view;if(!sawCollapsedSpans||newN==cm.doc.first+cm.doc.size)return{index:index,lineN:newN};for(var i=0,n=cm.display.viewFrom;i<index;i++)n+=view[i].size;if(n!=oldN){if(dir>0){if(index==view.length-1)return null;diff=n+view[index].size-oldN;index++}else{diff=n-oldN}oldN+=diff;newN+=diff}while(visualLineNo(cm.doc,newN)!=newN){if(index==(dir<0?0:view.length-1))return null;newN+=dir*view[index-(dir<0?1:0)].size;index+=dir}return{index:index,lineN:newN}}function adjustView(cm,from,to){var display=cm.display,view=display.view;if(view.length==0||from>=display.viewTo||to<=display.viewFrom){display.view=buildViewArray(cm,from,to);display.viewFrom=from}else{if(display.viewFrom>from)display.view=buildViewArray(cm,from,display.viewFrom).concat(display.view);else if(display.viewFrom<from)display.view=display.view.slice(findViewIndex(cm,from));display.viewFrom=from;if(display.viewTo<to)display.view=display.view.concat(buildViewArray(cm,display.viewTo,to));else if(display.viewTo>to)display.view=display.view.slice(0,findViewIndex(cm,to))}display.viewTo=to}function countDirtyView(cm){var view=cm.display.view,dirty=0;for(var i=0;i<view.length;i++){var lineView=view[i];if(!lineView.hidden&&(!lineView.node||lineView.changes))++dirty}return dirty}function slowPoll(cm){if(cm.display.pollingFast)return;cm.display.poll.set(cm.options.pollInterval,function(){readInput(cm);if(cm.state.focused)slowPoll(cm)})}function fastPoll(cm){var missed=false;cm.display.pollingFast=true;function p(){var changed=readInput(cm);if(!changed&&!missed){missed=true;cm.display.poll.set(60,p)}else{cm.display.pollingFast=false;slowPoll(cm)}}cm.display.poll.set(20,p)}var lastCopied=null;function readInput(cm){var input=cm.display.input,prevInput=cm.display.prevInput,doc=cm.doc;if(!cm.state.focused||hasSelection(input)&&!prevInput||isReadOnly(cm)||cm.options.disableInput||cm.state.keySeq)return false;if(cm.state.pasteIncoming&&cm.state.fakedLastChar){input.value=input.value.substring(0,input.value.length-1);cm.state.fakedLastChar=false}var text=input.value;if(text==prevInput&&!cm.somethingSelected())return false;if(ie&&ie_version>=9&&cm.display.inputHasSelection===text||mac&&/[\uf700-\uf7ff]/.test(text)){resetInput(cm);return false}var withOp=!cm.curOp;if(withOp)startOperation(cm);cm.display.shift=false;if(text.charCodeAt(0)==8203&&doc.sel==cm.display.selForContextMenu&&!prevInput)prevInput="";var same=0,l=Math.min(prevInput.length,text.length);while(same<l&&prevInput.charCodeAt(same)==text.charCodeAt(same))++same;var inserted=text.slice(same),textLines=splitLines(inserted);var multiPaste=null;if(cm.state.pasteIncoming&&doc.sel.ranges.length>1){if(lastCopied&&lastCopied.join("\n")==inserted)multiPaste=doc.sel.ranges.length%lastCopied.length==0&&map(lastCopied,splitLines);else if(textLines.length==doc.sel.ranges.length)multiPaste=map(textLines,function(l){return[l]})}for(var i=doc.sel.ranges.length-1;i>=0;i--){var range=doc.sel.ranges[i];var from=range.from(),to=range.to();if(same<prevInput.length)from=Pos(from.line,from.ch-(prevInput.length-same));else if(cm.state.overwrite&&range.empty()&&!cm.state.pasteIncoming)to=Pos(to.line,Math.min(getLine(doc,to.line).text.length,to.ch+lst(textLines).length));var updateInput=cm.curOp.updateInput;var changeEvent={from:from,to:to,text:multiPaste?multiPaste[i%multiPaste.length]:textLines,
origin:cm.state.pasteIncoming?"paste":cm.state.cutIncoming?"cut":"+input"};makeChange(cm.doc,changeEvent);signalLater(cm,"inputRead",cm,changeEvent);if(inserted&&!cm.state.pasteIncoming&&cm.options.electricChars&&cm.options.smartIndent&&range.head.ch<100&&(!i||doc.sel.ranges[i-1].head.line!=range.head.line)){var mode=cm.getModeAt(range.head);var end=changeEnd(changeEvent);if(mode.electricChars){for(var j=0;j<mode.electricChars.length;j++)if(inserted.indexOf(mode.electricChars.charAt(j))>-1){indentLine(cm,end.line,"smart");break}}else if(mode.electricInput){if(mode.electricInput.test(getLine(doc,end.line).text.slice(0,end.ch)))indentLine(cm,end.line,"smart")}}}ensureCursorVisible(cm);cm.curOp.updateInput=updateInput;cm.curOp.typing=true;if(text.length>1e3||text.indexOf("\n")>-1)input.value=cm.display.prevInput="";else cm.display.prevInput=text;if(withOp)endOperation(cm);cm.state.pasteIncoming=cm.state.cutIncoming=false;return true}function resetInput(cm,typing){var minimal,selected,doc=cm.doc;if(cm.somethingSelected()){cm.display.prevInput="";var range=doc.sel.primary();minimal=hasCopyEvent&&(range.to().line-range.from().line>100||(selected=cm.getSelection()).length>1e3);var content=minimal?"-":selected||cm.getSelection();cm.display.input.value=content;if(cm.state.focused)selectInput(cm.display.input);if(ie&&ie_version>=9)cm.display.inputHasSelection=content}else if(!typing){cm.display.prevInput=cm.display.input.value="";if(ie&&ie_version>=9)cm.display.inputHasSelection=null}cm.display.inaccurateSelection=minimal}function focusInput(cm){if(cm.options.readOnly!="nocursor"&&(!mobile||activeElt()!=cm.display.input))cm.display.input.focus()}function ensureFocus(cm){if(!cm.state.focused){focusInput(cm);onFocus(cm)}}function isReadOnly(cm){return cm.options.readOnly||cm.doc.cantEdit}function registerEventHandlers(cm){var d=cm.display;on(d.scroller,"mousedown",operation(cm,onMouseDown));if(ie&&ie_version<11)on(d.scroller,"dblclick",operation(cm,function(e){if(signalDOMEvent(cm,e))return;var pos=posFromMouse(cm,e);if(!pos||clickInGutter(cm,e)||eventInWidget(cm.display,e))return;e_preventDefault(e);var word=cm.findWordAt(pos);extendSelection(cm.doc,word.anchor,word.head)}));else on(d.scroller,"dblclick",function(e){signalDOMEvent(cm,e)||e_preventDefault(e)});on(d.lineSpace,"selectstart",function(e){if(!eventInWidget(d,e))e_preventDefault(e)});if(!captureRightClick)on(d.scroller,"contextmenu",function(e){onContextMenu(cm,e)});on(d.scroller,"scroll",function(){if(d.scroller.clientHeight){setScrollTop(cm,d.scroller.scrollTop);setScrollLeft(cm,d.scroller.scrollLeft,true);signal(cm,"scroll",cm)}});on(d.scrollbarV,"scroll",function(){if(d.scroller.clientHeight)setScrollTop(cm,d.scrollbarV.scrollTop)});on(d.scrollbarH,"scroll",function(){if(d.scroller.clientHeight)setScrollLeft(cm,d.scrollbarH.scrollLeft)});on(d.scroller,"mousewheel",function(e){onScrollWheel(cm,e)});on(d.scroller,"DOMMouseScroll",function(e){onScrollWheel(cm,e)});function reFocus(){if(cm.state.focused)setTimeout(bind(focusInput,cm),0)}on(d.scrollbarH,"mousedown",reFocus);on(d.scrollbarV,"mousedown",reFocus);on(d.wrapper,"scroll",function(){d.wrapper.scrollTop=d.wrapper.scrollLeft=0});on(d.input,"keyup",function(e){onKeyUp.call(cm,e)});on(d.input,"input",function(){if(ie&&ie_version>=9&&cm.display.inputHasSelection)cm.display.inputHasSelection=null;fastPoll(cm)});on(d.input,"keydown",operation(cm,onKeyDown));on(d.input,"keypress",operation(cm,onKeyPress));on(d.input,"focus",bind(onFocus,cm));on(d.input,"blur",bind(onBlur,cm));function drag_(e){if(!signalDOMEvent(cm,e))e_stop(e)}if(cm.options.dragDrop){on(d.scroller,"dragstart",function(e){onDragStart(cm,e)});on(d.scroller,"dragenter",drag_);on(d.scroller,"dragover",drag_);on(d.scroller,"drop",operation(cm,onDrop))}on(d.scroller,"paste",function(e){if(eventInWidget(d,e))return;cm.state.pasteIncoming=true;focusInput(cm);fastPoll(cm)});on(d.input,"paste",function(){if(webkit&&!cm.state.fakedLastChar&&!(new Date-cm.state.lastMiddleDown<200)){var start=d.input.selectionStart,end=d.input.selectionEnd;d.input.value+="$";d.input.selectionEnd=end;d.input.selectionStart=start;cm.state.fakedLastChar=true}cm.state.pasteIncoming=true;fastPoll(cm)});function prepareCopyCut(e){if(cm.somethingSelected()){lastCopied=cm.getSelections();if(d.inaccurateSelection){d.prevInput="";d.inaccurateSelection=false;d.input.value=lastCopied.join("\n");selectInput(d.input)}}else{var text=[],ranges=[];for(var i=0;i<cm.doc.sel.ranges.length;i++){var line=cm.doc.sel.ranges[i].head.line;var lineRange={anchor:Pos(line,0),head:Pos(line+1,0)};ranges.push(lineRange);text.push(cm.getRange(lineRange.anchor,lineRange.head))}if(e.type=="cut"){cm.setSelections(ranges,null,sel_dontScroll)}else{d.prevInput="";d.input.value=text.join("\n");selectInput(d.input)}lastCopied=text}if(e.type=="cut")cm.state.cutIncoming=true}on(d.input,"cut",prepareCopyCut);on(d.input,"copy",prepareCopyCut);if(khtml)on(d.sizer,"mouseup",function(){if(activeElt()==d.input)d.input.blur();focusInput(cm)})}function onResize(cm){var d=cm.display;if(d.lastWrapHeight==d.wrapper.clientHeight&&d.lastWrapWidth==d.wrapper.clientWidth)return;d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null;cm.setSize()}function eventInWidget(display,e){for(var n=e_target(e);n!=display.wrapper;n=n.parentNode){if(!n||n.ignoreEvents||n.parentNode==display.sizer&&n!=display.mover)return true}}function posFromMouse(cm,e,liberal,forRect){var display=cm.display;if(!liberal){var target=e_target(e);if(target==display.scrollbarH||target==display.scrollbarV||target==display.scrollbarFiller||target==display.gutterFiller)return null}var x,y,space=display.lineSpace.getBoundingClientRect();try{x=e.clientX-space.left;y=e.clientY-space.top}catch(e){return null}var coords=coordsChar(cm,x,y),line;if(forRect&&coords.xRel==1&&(line=getLine(cm.doc,coords.line).text).length==coords.ch){var colDiff=countColumn(line,line.length,cm.options.tabSize)-line.length;coords=Pos(coords.line,Math.max(0,Math.round((x-paddingH(cm.display).left)/charWidth(cm.display))-colDiff))}return coords}function onMouseDown(e){if(signalDOMEvent(this,e))return;var cm=this,display=cm.display;display.shift=e.shiftKey;if(eventInWidget(display,e)){if(!webkit){display.scroller.draggable=false;setTimeout(function(){display.scroller.draggable=true},100)}return}if(clickInGutter(cm,e))return;var start=posFromMouse(cm,e);window.focus();switch(e_button(e)){case 1:if(start)leftButtonDown(cm,e,start);else if(e_target(e)==display.scroller)e_preventDefault(e);break;case 2:if(webkit)cm.state.lastMiddleDown=+new Date;if(start)extendSelection(cm.doc,start);setTimeout(bind(focusInput,cm),20);e_preventDefault(e);break;case 3:if(captureRightClick)onContextMenu(cm,e);break}}var lastClick,lastDoubleClick;function leftButtonDown(cm,e,start){setTimeout(bind(ensureFocus,cm),0);var now=+new Date,type;if(lastDoubleClick&&lastDoubleClick.time>now-400&&cmp(lastDoubleClick.pos,start)==0){type="triple"}else if(lastClick&&lastClick.time>now-400&&cmp(lastClick.pos,start)==0){type="double";lastDoubleClick={time:now,pos:start}}else{type="single";lastClick={time:now,pos:start}}var sel=cm.doc.sel,modifier=mac?e.metaKey:e.ctrlKey;if(cm.options.dragDrop&&dragAndDrop&&!isReadOnly(cm)&&type=="single"&&sel.contains(start)>-1&&sel.somethingSelected())leftButtonStartDrag(cm,e,start,modifier);else leftButtonSelect(cm,e,start,type,modifier)}function leftButtonStartDrag(cm,e,start,modifier){var display=cm.display;var dragEnd=operation(cm,function(e2){if(webkit)display.scroller.draggable=false;cm.state.draggingText=false;off(document,"mouseup",dragEnd);off(display.scroller,"drop",dragEnd);if(Math.abs(e.clientX-e2.clientX)+Math.abs(e.clientY-e2.clientY)<10){e_preventDefault(e2);if(!modifier)extendSelection(cm.doc,start);focusInput(cm);if(ie&&ie_version==9)setTimeout(function(){document.body.focus();focusInput(cm)},20)}});if(webkit)display.scroller.draggable=true;cm.state.draggingText=dragEnd;if(display.scroller.dragDrop)display.scroller.dragDrop();on(document,"mouseup",dragEnd);on(display.scroller,"drop",dragEnd)}function leftButtonSelect(cm,e,start,type,addNew){var display=cm.display,doc=cm.doc;e_preventDefault(e);var ourRange,ourIndex,startSel=doc.sel;if(addNew&&!e.shiftKey){ourIndex=doc.sel.contains(start);if(ourIndex>-1)ourRange=doc.sel.ranges[ourIndex];else ourRange=new Range(start,start)}else{ourRange=doc.sel.primary()}if(e.altKey){type="rect";if(!addNew)ourRange=new Range(start,start);start=posFromMouse(cm,e,true,true);ourIndex=-1}else if(type=="double"){var word=cm.findWordAt(start);if(cm.display.shift||doc.extend)ourRange=extendRange(doc,ourRange,word.anchor,word.head);else ourRange=word}else if(type=="triple"){var line=new Range(Pos(start.line,0),clipPos(doc,Pos(start.line+1,0)));if(cm.display.shift||doc.extend)ourRange=extendRange(doc,ourRange,line.anchor,line.head);else ourRange=line}else{ourRange=extendRange(doc,ourRange,start)}if(!addNew){ourIndex=0;setSelection(doc,new Selection([ourRange],0),sel_mouse);startSel=doc.sel}else if(ourIndex>-1){replaceOneSelection(doc,ourIndex,ourRange,sel_mouse)}else{ourIndex=doc.sel.ranges.length;setSelection(doc,normalizeSelection(doc.sel.ranges.concat([ourRange]),ourIndex),{scroll:false,origin:"*mouse"})}var lastPos=start;function extendTo(pos){if(cmp(lastPos,pos)==0)return;lastPos=pos;if(type=="rect"){var ranges=[],tabSize=cm.options.tabSize;var startCol=countColumn(getLine(doc,start.line).text,start.ch,tabSize);var posCol=countColumn(getLine(doc,pos.line).text,pos.ch,tabSize);var left=Math.min(startCol,posCol),right=Math.max(startCol,posCol);for(var line=Math.min(start.line,pos.line),end=Math.min(cm.lastLine(),Math.max(start.line,pos.line));line<=end;line++){var text=getLine(doc,line).text,leftPos=findColumn(text,left,tabSize);if(left==right)ranges.push(new Range(Pos(line,leftPos),Pos(line,leftPos)));else if(text.length>leftPos)ranges.push(new Range(Pos(line,leftPos),Pos(line,findColumn(text,right,tabSize))))}if(!ranges.length)ranges.push(new Range(start,start));setSelection(doc,normalizeSelection(startSel.ranges.slice(0,ourIndex).concat(ranges),ourIndex),{origin:"*mouse",scroll:false});cm.scrollIntoView(pos)}else{var oldRange=ourRange;var anchor=oldRange.anchor,head=pos;if(type!="single"){if(type=="double")var range=cm.findWordAt(pos);else var range=new Range(Pos(pos.line,0),clipPos(doc,Pos(pos.line+1,0)));if(cmp(range.anchor,anchor)>0){head=range.head;anchor=minPos(oldRange.from(),range.anchor)}else{head=range.anchor;anchor=maxPos(oldRange.to(),range.head)}}var ranges=startSel.ranges.slice(0);ranges[ourIndex]=new Range(clipPos(doc,anchor),head);setSelection(doc,normalizeSelection(ranges,ourIndex),sel_mouse)}}var editorSize=display.wrapper.getBoundingClientRect();var counter=0;function extend(e){var curCount=++counter;var cur=posFromMouse(cm,e,true,type=="rect");if(!cur)return;if(cmp(cur,lastPos)!=0){ensureFocus(cm);extendTo(cur);var visible=visibleLines(display,doc);if(cur.line>=visible.to||cur.line<visible.from)setTimeout(operation(cm,function(){if(counter==curCount)extend(e)}),150)}else{var outside=e.clientY<editorSize.top?-20:e.clientY>editorSize.bottom?20:0;if(outside)setTimeout(operation(cm,function(){if(counter!=curCount)return;display.scroller.scrollTop+=outside;extend(e)}),50)}}function done(e){counter=Infinity;e_preventDefault(e);focusInput(cm);off(document,"mousemove",move);off(document,"mouseup",up);doc.history.lastSelOrigin=null}var move=operation(cm,function(e){if(!e_button(e))done(e);else extend(e)});var up=operation(cm,done);on(document,"mousemove",move);on(document,"mouseup",up)}function gutterEvent(cm,e,type,prevent,signalfn){try{var mX=e.clientX,mY=e.clientY}catch(e){return false}if(mX>=Math.floor(cm.display.gutters.getBoundingClientRect().right))return false;if(prevent)e_preventDefault(e);var display=cm.display;var lineBox=display.lineDiv.getBoundingClientRect();if(mY>lineBox.bottom||!hasHandler(cm,type))return e_defaultPrevented(e);mY-=lineBox.top-display.viewOffset;for(var i=0;i<cm.options.gutters.length;++i){var g=display.gutters.childNodes[i];if(g&&g.getBoundingClientRect().right>=mX){var line=lineAtHeight(cm.doc,mY);var gutter=cm.options.gutters[i];signalfn(cm,type,cm,line,gutter,e);return e_defaultPrevented(e)}}}function clickInGutter(cm,e){return gutterEvent(cm,e,"gutterClick",true,signalLater)}var lastDrop=0;function onDrop(e){var cm=this;if(signalDOMEvent(cm,e)||eventInWidget(cm.display,e))return;e_preventDefault(e);if(ie)lastDrop=+new Date;var pos=posFromMouse(cm,e,true),files=e.dataTransfer.files;if(!pos||isReadOnly(cm))return;if(files&&files.length&&window.FileReader&&window.File){var n=files.length,text=Array(n),read=0;var loadFile=function(file,i){var reader=new FileReader;reader.onload=operation(cm,function(){text[i]=reader.result;if(++read==n){pos=clipPos(cm.doc,pos);var change={from:pos,to:pos,text:splitLines(text.join("\n")),origin:"paste"};makeChange(cm.doc,change);setSelectionReplaceHistory(cm.doc,simpleSelection(pos,changeEnd(change)))}});reader.readAsText(file)};for(var i=0;i<n;++i)loadFile(files[i],i)}else{if(cm.state.draggingText&&cm.doc.sel.contains(pos)>-1){cm.state.draggingText(e);setTimeout(bind(focusInput,cm),20);return}try{var text=e.dataTransfer.getData("Text");if(text){if(cm.state.draggingText&&!(mac?e.metaKey:e.ctrlKey))var selected=cm.listSelections();setSelectionNoUndo(cm.doc,simpleSelection(pos,pos));if(selected)for(var i=0;i<selected.length;++i)replaceRange(cm.doc,"",selected[i].anchor,selected[i].head,"drag");cm.replaceSelection(text,"around","paste");focusInput(cm)}}catch(e){}}}function onDragStart(cm,e){if(ie&&(!cm.state.draggingText||+new Date-lastDrop<100)){e_stop(e);return}if(signalDOMEvent(cm,e)||eventInWidget(cm.display,e))return;e.dataTransfer.setData("Text",cm.getSelection());if(e.dataTransfer.setDragImage&&!safari){var img=elt("img",null,null,"position: fixed; left: 0; top: 0;");img.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(presto){img.width=img.height=1;cm.display.wrapper.appendChild(img);img._top=img.offsetTop}e.dataTransfer.setDragImage(img,0,0);if(presto)img.parentNode.removeChild(img)}}function setScrollTop(cm,val){if(Math.abs(cm.doc.scrollTop-val)<2)return;cm.doc.scrollTop=val;if(!gecko)updateDisplaySimple(cm,{top:val});if(cm.display.scroller.scrollTop!=val)cm.display.scroller.scrollTop=val;if(cm.display.scrollbarV.scrollTop!=val)cm.display.scrollbarV.scrollTop=val;if(gecko)updateDisplaySimple(cm);startWorker(cm,100)}function setScrollLeft(cm,val,isScroller){if(isScroller?val==cm.doc.scrollLeft:Math.abs(cm.doc.scrollLeft-val)<2)return;val=Math.min(val,cm.display.scroller.scrollWidth-cm.display.scroller.clientWidth);cm.doc.scrollLeft=val;alignHorizontally(cm);if(cm.display.scroller.scrollLeft!=val)cm.display.scroller.scrollLeft=val;if(cm.display.scrollbarH.scrollLeft!=val)cm.display.scrollbarH.scrollLeft=val}var wheelSamples=0,wheelPixelsPerUnit=null;if(ie)wheelPixelsPerUnit=-.53;else if(gecko)wheelPixelsPerUnit=15;else if(chrome)wheelPixelsPerUnit=-.7;else if(safari)wheelPixelsPerUnit=-1/3;function onScrollWheel(cm,e){var dx=e.wheelDeltaX,dy=e.wheelDeltaY;if(dx==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS)dx=e.detail;if(dy==null&&e.detail&&e.axis==e.VERTICAL_AXIS)dy=e.detail;else if(dy==null)dy=e.wheelDelta;var display=cm.display,scroll=display.scroller;if(!(dx&&scroll.scrollWidth>scroll.clientWidth||dy&&scroll.scrollHeight>scroll.clientHeight))return;if(dy&&mac&&webkit){outer:for(var cur=e.target,view=display.view;cur!=scroll;cur=cur.parentNode){for(var i=0;i<view.length;i++){if(view[i].node==cur){cm.display.currentWheelTarget=cur;break outer}}}}if(dx&&!gecko&&!presto&&wheelPixelsPerUnit!=null){if(dy)setScrollTop(cm,Math.max(0,Math.min(scroll.scrollTop+dy*wheelPixelsPerUnit,scroll.scrollHeight-scroll.clientHeight)));setScrollLeft(cm,Math.max(0,Math.min(scroll.scrollLeft+dx*wheelPixelsPerUnit,scroll.scrollWidth-scroll.clientWidth)));e_preventDefault(e);display.wheelStartX=null;return}if(dy&&wheelPixelsPerUnit!=null){var pixels=dy*wheelPixelsPerUnit;var top=cm.doc.scrollTop,bot=top+display.wrapper.clientHeight;if(pixels<0)top=Math.max(0,top+pixels-50);else bot=Math.min(cm.doc.height,bot+pixels+50);updateDisplaySimple(cm,{top:top,bottom:bot})}if(wheelSamples<20){if(display.wheelStartX==null){display.wheelStartX=scroll.scrollLeft;display.wheelStartY=scroll.scrollTop;display.wheelDX=dx;display.wheelDY=dy;setTimeout(function(){if(display.wheelStartX==null)return;var movedX=scroll.scrollLeft-display.wheelStartX;var movedY=scroll.scrollTop-display.wheelStartY;var sample=movedY&&display.wheelDY&&movedY/display.wheelDY||movedX&&display.wheelDX&&movedX/display.wheelDX;display.wheelStartX=display.wheelStartY=null;if(!sample)return;wheelPixelsPerUnit=(wheelPixelsPerUnit*wheelSamples+sample)/(wheelSamples+1);++wheelSamples},200)}else{display.wheelDX+=dx;display.wheelDY+=dy}}}function doHandleBinding(cm,bound,dropShift){if(typeof bound=="string"){bound=commands[bound];if(!bound)return false}if(cm.display.pollingFast&&readInput(cm))cm.display.pollingFast=false;var prevShift=cm.display.shift,done=false;try{if(isReadOnly(cm))cm.state.suppressEdits=true;if(dropShift)cm.display.shift=false;done=bound(cm)!=Pass}finally{cm.display.shift=prevShift;cm.state.suppressEdits=false}return done}function lookupKeyForEditor(cm,name,handle){for(var i=0;i<cm.state.keyMaps.length;i++){var result=lookupKey(name,cm.state.keyMaps[i],handle);if(result)return result}return cm.options.extraKeys&&lookupKey(name,cm.options.extraKeys,handle)||lookupKey(name,cm.options.keyMap,handle)}var stopSeq=new Delayed;function dispatchKey(cm,name,e,handle){var seq=cm.state.keySeq;if(seq){if(isModifierKey(name))return"handled";stopSeq.set(50,function(){if(cm.state.keySeq==seq){cm.state.keySeq=null;resetInput(cm)}});name=seq+" "+name}var result=lookupKeyForEditor(cm,name,handle);if(result=="multi")cm.state.keySeq=name;if(result=="handled")signalLater(cm,"keyHandled",cm,name,e);if(result=="handled"||result=="multi"){e_preventDefault(e);restartBlink(cm)}if(seq&&!result&&/\'$/.test(name)){e_preventDefault(e);return true}return!!result}function handleKeyBinding(cm,e){var name=keyName(e,true);if(!name)return false;if(e.shiftKey&&!cm.state.keySeq){return dispatchKey(cm,"Shift-"+name,e,function(b){return doHandleBinding(cm,b,true)})||dispatchKey(cm,name,e,function(b){if(typeof b=="string"?/^go[A-Z]/.test(b):b.motion)return doHandleBinding(cm,b)})}else{return dispatchKey(cm,name,e,function(b){return doHandleBinding(cm,b)})}}function handleCharBinding(cm,e,ch){return dispatchKey(cm,"'"+ch+"'",e,function(b){return doHandleBinding(cm,b,true)})}var lastStoppedKey=null;function onKeyDown(e){var cm=this;ensureFocus(cm);if(signalDOMEvent(cm,e))return;if(ie&&ie_version<11&&e.keyCode==27)e.returnValue=false;var code=e.keyCode;cm.display.shift=code==16||e.shiftKey;var handled=handleKeyBinding(cm,e);if(presto){lastStoppedKey=handled?code:null;if(!handled&&code==88&&!hasCopyEvent&&(mac?e.metaKey:e.ctrlKey))cm.replaceSelection("",null,"cut")}if(code==18&&!/\bCodeMirror-crosshair\b/.test(cm.display.lineDiv.className))showCrossHair(cm)}function showCrossHair(cm){var lineDiv=cm.display.lineDiv;addClass(lineDiv,"CodeMirror-crosshair");function up(e){if(e.keyCode==18||!e.altKey){rmClass(lineDiv,"CodeMirror-crosshair");off(document,"keyup",up);off(document,"mouseover",up)}}on(document,"keyup",up);on(document,"mouseover",up)}function onKeyUp(e){if(e.keyCode==16)this.doc.sel.shift=false;signalDOMEvent(this,e)}function onKeyPress(e){var cm=this;if(signalDOMEvent(cm,e)||e.ctrlKey&&!e.altKey||mac&&e.metaKey)return;var keyCode=e.keyCode,charCode=e.charCode;if(presto&&keyCode==lastStoppedKey){lastStoppedKey=null;e_preventDefault(e);return}if((presto&&(!e.which||e.which<10)||khtml)&&handleKeyBinding(cm,e))return;var ch=String.fromCharCode(charCode==null?keyCode:charCode);if(handleCharBinding(cm,e,ch))return;if(ie&&ie_version>=9)cm.display.inputHasSelection=null;fastPoll(cm)}function onFocus(cm){if(cm.options.readOnly=="nocursor")return;if(!cm.state.focused){signal(cm,"focus",cm);cm.state.focused=true;addClass(cm.display.wrapper,"CodeMirror-focused");if(!cm.curOp&&cm.display.selForContextMenu!=cm.doc.sel){resetInput(cm);if(webkit)setTimeout(bind(resetInput,cm,true),0)}}slowPoll(cm);restartBlink(cm)}function onBlur(cm){if(cm.state.focused){signal(cm,"blur",cm);cm.state.focused=false;rmClass(cm.display.wrapper,"CodeMirror-focused")}clearInterval(cm.display.blinker);setTimeout(function(){if(!cm.state.focused)cm.display.shift=false},150)}function onContextMenu(cm,e){if(signalDOMEvent(cm,e,"contextmenu"))return;var display=cm.display;if(eventInWidget(display,e)||contextMenuInGutter(cm,e))return;var pos=posFromMouse(cm,e),scrollPos=display.scroller.scrollTop;if(!pos||presto)return;var reset=cm.options.resetSelectionOnContextMenu;if(reset&&cm.doc.sel.contains(pos)==-1)operation(cm,setSelection)(cm.doc,simpleSelection(pos),sel_dontScroll);var oldCSS=display.input.style.cssText;display.inputDiv.style.position="absolute";display.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: "+(ie?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";if(webkit)var oldScrollY=window.scrollY;focusInput(cm);if(webkit)window.scrollTo(null,oldScrollY);resetInput(cm);if(!cm.somethingSelected())display.input.value=display.prevInput=" ";display.selForContextMenu=cm.doc.sel;clearTimeout(display.detectingSelectAll);function prepareSelectAllHack(){if(display.input.selectionStart!=null){var selected=cm.somethingSelected();var extval=display.input.value=""+(selected?display.input.value:"");display.prevInput=selected?"":"";display.input.selectionStart=1;display.input.selectionEnd=extval.length;display.selForContextMenu=cm.doc.sel}}function rehide(){display.inputDiv.style.position="relative";display.input.style.cssText=oldCSS;if(ie&&ie_version<9)display.scrollbarV.scrollTop=display.scroller.scrollTop=scrollPos;slowPoll(cm);if(display.input.selectionStart!=null){if(!ie||ie&&ie_version<9)prepareSelectAllHack();var i=0,poll=function(){if(display.selForContextMenu==cm.doc.sel&&display.input.selectionStart==0)operation(cm,commands.selectAll)(cm);else if(i++<10)display.detectingSelectAll=setTimeout(poll,500);else resetInput(cm)};display.detectingSelectAll=setTimeout(poll,200)}}if(ie&&ie_version>=9)prepareSelectAllHack();if(captureRightClick){e_stop(e);var mouseup=function(){off(window,"mouseup",mouseup);setTimeout(rehide,20)};on(window,"mouseup",mouseup)}else{setTimeout(rehide,50)}}function contextMenuInGutter(cm,e){if(!hasHandler(cm,"gutterContextMenu"))return false;return gutterEvent(cm,e,"gutterContextMenu",false,signal)}var changeEnd=CodeMirror.changeEnd=function(change){if(!change.text)return change.to;return Pos(change.from.line+change.text.length-1,lst(change.text).length+(change.text.length==1?change.from.ch:0))};function adjustForChange(pos,change){if(cmp(pos,change.from)<0)return pos;if(cmp(pos,change.to)<=0)return changeEnd(change);var line=pos.line+change.text.length-(change.to.line-change.from.line)-1,ch=pos.ch;if(pos.line==change.to.line)ch+=changeEnd(change).ch-change.to.ch;return Pos(line,ch)}function computeSelAfterChange(doc,change){var out=[];for(var i=0;i<doc.sel.ranges.length;i++){var range=doc.sel.ranges[i];out.push(new Range(adjustForChange(range.anchor,change),adjustForChange(range.head,change)))}return normalizeSelection(out,doc.sel.primIndex)}function offsetPos(pos,old,nw){if(pos.line==old.line)return Pos(nw.line,pos.ch-old.ch+nw.ch);else return Pos(nw.line+(pos.line-old.line),pos.ch)}function computeReplacedSel(doc,changes,hint){var out=[];var oldPrev=Pos(doc.first,0),newPrev=oldPrev;for(var i=0;i<changes.length;i++){var change=changes[i];var from=offsetPos(change.from,oldPrev,newPrev);var to=offsetPos(changeEnd(change),oldPrev,newPrev);oldPrev=change.to;newPrev=to;if(hint=="around"){var range=doc.sel.ranges[i],inv=cmp(range.head,range.anchor)<0;out[i]=new Range(inv?to:from,inv?from:to)}else{out[i]=new Range(from,from)}}return new Selection(out,doc.sel.primIndex)}function filterChange(doc,change,update){var obj={canceled:false,from:change.from,to:change.to,text:change.text,origin:change.origin,cancel:function(){this.canceled=true}};if(update)obj.update=function(from,to,text,origin){if(from)this.from=clipPos(doc,from);if(to)this.to=clipPos(doc,to);if(text)this.text=text;if(origin!==undefined)this.origin=origin};signal(doc,"beforeChange",doc,obj);if(doc.cm)signal(doc.cm,"beforeChange",doc.cm,obj);if(obj.canceled)return null;return{from:obj.from,to:obj.to,text:obj.text,origin:obj.origin}}function makeChange(doc,change,ignoreReadOnly){if(doc.cm){if(!doc.cm.curOp)return operation(doc.cm,makeChange)(doc,change,ignoreReadOnly);if(doc.cm.state.suppressEdits)return}if(hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange")){change=filterChange(doc,change,true);if(!change)return}var split=sawReadOnlySpans&&!ignoreReadOnly&&removeReadOnlyRanges(doc,change.from,change.to);if(split){for(var i=split.length-1;i>=0;--i)makeChangeInner(doc,{from:split[i].from,to:split[i].to,text:i?[""]:change.text})}else{makeChangeInner(doc,change)}}function makeChangeInner(doc,change){if(change.text.length==1&&change.text[0]==""&&cmp(change.from,change.to)==0)return;var selAfter=computeSelAfterChange(doc,change);addChangeToHistory(doc,change,selAfter,doc.cm?doc.cm.curOp.id:NaN);makeChangeSingleDoc(doc,change,selAfter,stretchSpansOverChange(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history)}makeChangeSingleDoc(doc,change,null,stretchSpansOverChange(doc,change))})}function makeChangeFromHistory(doc,type,allowSelectionOnly){if(doc.cm&&doc.cm.state.suppressEdits)return;var hist=doc.history,event,selAfter=doc.sel;var source=type=="undo"?hist.done:hist.undone,dest=type=="undo"?hist.undone:hist.done;for(var i=0;i<source.length;i++){event=source[i];if(allowSelectionOnly?event.ranges&&!event.equals(doc.sel):!event.ranges)break}if(i==source.length)return;hist.lastOrigin=hist.lastSelOrigin=null;for(;;){event=source.pop();if(event.ranges){pushSelectionToHistory(event,dest);if(allowSelectionOnly&&!event.equals(doc.sel)){setSelection(doc,event,{clearRedo:false});return}selAfter=event}else break}var antiChanges=[];pushSelectionToHistory(selAfter,dest);dest.push({changes:antiChanges,generation:hist.generation});hist.generation=event.generation||++hist.maxGeneration;var filter=hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange");for(var i=event.changes.length-1;i>=0;--i){var change=event.changes[i];change.origin=type;if(filter&&!filterChange(doc,change,false)){source.length=0;return}antiChanges.push(historyChangeFromChange(doc,change));var after=i?computeSelAfterChange(doc,change):lst(source);makeChangeSingleDoc(doc,change,after,mergeOldSpans(doc,change));if(!i&&doc.cm)doc.cm.scrollIntoView({from:change.from,to:changeEnd(change)});var rebased=[];linkedDocs(doc,function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history)}makeChangeSingleDoc(doc,change,null,mergeOldSpans(doc,change))})}}function shiftDoc(doc,distance){if(distance==0)return;doc.first+=distance;doc.sel=new Selection(map(doc.sel.ranges,function(range){return new Range(Pos(range.anchor.line+distance,range.anchor.ch),Pos(range.head.line+distance,range.head.ch))}),doc.sel.primIndex);if(doc.cm){regChange(doc.cm,doc.first,doc.first-distance,distance);for(var d=doc.cm.display,l=d.viewFrom;l<d.viewTo;l++)regLineChange(doc.cm,l,"gutter")}}function makeChangeSingleDoc(doc,change,selAfter,spans){if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,makeChangeSingleDoc)(doc,change,selAfter,spans);if(change.to.line<doc.first){shiftDoc(doc,change.text.length-1-(change.to.line-change.from.line));return}if(change.from.line>doc.lastLine())return;if(change.from.line<doc.first){var shift=change.text.length-1-(doc.first-change.from.line);shiftDoc(doc,shift);change={from:Pos(doc.first,0),to:Pos(change.to.line+shift,change.to.ch),text:[lst(change.text)],origin:change.origin}}var last=doc.lastLine();if(change.to.line>last){change={from:change.from,to:Pos(last,getLine(doc,last).text.length),text:[change.text[0]],origin:change.origin}}change.removed=getBetween(doc,change.from,change.to);if(!selAfter)selAfter=computeSelAfterChange(doc,change);if(doc.cm)makeChangeSingleDocInEditor(doc.cm,change,spans);else updateDoc(doc,change,spans);setSelectionNoUndo(doc,selAfter,sel_dontScroll)}function makeChangeSingleDocInEditor(cm,change,spans){var doc=cm.doc,display=cm.display,from=change.from,to=change.to;var recomputeMaxLength=false,checkWidthStart=from.line;if(!cm.options.lineWrapping){checkWidthStart=lineNo(visualLine(getLine(doc,from.line)));doc.iter(checkWidthStart,to.line+1,function(line){if(line==display.maxLine){recomputeMaxLength=true;return true}})}if(doc.sel.contains(change.from,change.to)>-1)signalCursorActivity(cm);updateDoc(doc,change,spans,estimateHeight(cm));if(!cm.options.lineWrapping){doc.iter(checkWidthStart,from.line+change.text.length,function(line){var len=lineLength(line);if(len>display.maxLineLength){display.maxLine=line;display.maxLineLength=len;display.maxLineChanged=true;recomputeMaxLength=false}});if(recomputeMaxLength)cm.curOp.updateMaxLine=true}doc.frontier=Math.min(doc.frontier,from.line);startWorker(cm,400);var lendiff=change.text.length-(to.line-from.line)-1;if(from.line==to.line&&change.text.length==1&&!isWholeLineUpdate(cm.doc,change))regLineChange(cm,from.line,"text");else regChange(cm,from.line,to.line+1,lendiff);var changesHandler=hasHandler(cm,"changes"),changeHandler=hasHandler(cm,"change");if(changeHandler||changesHandler){var obj={from:from,to:to,text:change.text,removed:change.removed,origin:change.origin};if(changeHandler)signalLater(cm,"change",cm,obj);if(changesHandler)(cm.curOp.changeObjs||(cm.curOp.changeObjs=[])).push(obj)}cm.display.selForContextMenu=null}function replaceRange(doc,code,from,to,origin){if(!to)to=from;if(cmp(to,from)<0){var tmp=to;to=from;from=tmp}if(typeof code=="string")code=splitLines(code);makeChange(doc,{from:from,to:to,text:code,origin:origin})}function maybeScrollWindow(cm,coords){if(signalDOMEvent(cm,"scrollCursorIntoView"))return;var display=cm.display,box=display.sizer.getBoundingClientRect(),doScroll=null;if(coords.top+box.top<0)doScroll=true;else if(coords.bottom+box.top>(window.innerHeight||document.documentElement.clientHeight))doScroll=false;if(doScroll!=null&&!phantom){var scrollNode=elt("div","",null,"position: absolute; top: "+(coords.top-display.viewOffset-paddingTop(cm.display))+"px; height: "+(coords.bottom-coords.top+scrollerCutOff)+"px; left: "+coords.left+"px; width: 2px;");cm.display.lineSpace.appendChild(scrollNode);scrollNode.scrollIntoView(doScroll);cm.display.lineSpace.removeChild(scrollNode)}}function scrollPosIntoView(cm,pos,end,margin){if(margin==null)margin=0;for(var limit=0;limit<5;limit++){var changed=false,coords=cursorCoords(cm,pos);var endCoords=!end||end==pos?coords:cursorCoords(cm,end);var scrollPos=calculateScrollPos(cm,Math.min(coords.left,endCoords.left),Math.min(coords.top,endCoords.top)-margin,Math.max(coords.left,endCoords.left),Math.max(coords.bottom,endCoords.bottom)+margin);var startTop=cm.doc.scrollTop,startLeft=cm.doc.scrollLeft;if(scrollPos.scrollTop!=null){setScrollTop(cm,scrollPos.scrollTop);if(Math.abs(cm.doc.scrollTop-startTop)>1)changed=true}if(scrollPos.scrollLeft!=null){setScrollLeft(cm,scrollPos.scrollLeft);if(Math.abs(cm.doc.scrollLeft-startLeft)>1)changed=true}if(!changed)return coords}}function scrollIntoView(cm,x1,y1,x2,y2){var scrollPos=calculateScrollPos(cm,x1,y1,x2,y2);if(scrollPos.scrollTop!=null)setScrollTop(cm,scrollPos.scrollTop);if(scrollPos.scrollLeft!=null)setScrollLeft(cm,scrollPos.scrollLeft);
}function calculateScrollPos(cm,x1,y1,x2,y2){var display=cm.display,snapMargin=textHeight(cm.display);if(y1<0)y1=0;var screentop=cm.curOp&&cm.curOp.scrollTop!=null?cm.curOp.scrollTop:display.scroller.scrollTop;var screen=display.scroller.clientHeight-scrollerCutOff,result={};if(y2-y1>screen)y2=y1+screen;var docBottom=cm.doc.height+paddingVert(display);var atTop=y1<snapMargin,atBottom=y2>docBottom-snapMargin;if(y1<screentop){result.scrollTop=atTop?0:y1}else if(y2>screentop+screen){var newTop=Math.min(y1,(atBottom?docBottom:y2)-screen);if(newTop!=screentop)result.scrollTop=newTop}var screenleft=cm.curOp&&cm.curOp.scrollLeft!=null?cm.curOp.scrollLeft:display.scroller.scrollLeft;var screenw=display.scroller.clientWidth-scrollerCutOff-display.gutters.offsetWidth;var tooWide=x2-x1>screenw;if(tooWide)x2=x1+screenw;if(x1<10)result.scrollLeft=0;else if(x1<screenleft)result.scrollLeft=Math.max(0,x1-(tooWide?0:10));else if(x2>screenw+screenleft-3)result.scrollLeft=x2+(tooWide?0:10)-screenw;return result}function addToScrollPos(cm,left,top){if(left!=null||top!=null)resolveScrollToPos(cm);if(left!=null)cm.curOp.scrollLeft=(cm.curOp.scrollLeft==null?cm.doc.scrollLeft:cm.curOp.scrollLeft)+left;if(top!=null)cm.curOp.scrollTop=(cm.curOp.scrollTop==null?cm.doc.scrollTop:cm.curOp.scrollTop)+top}function ensureCursorVisible(cm){resolveScrollToPos(cm);var cur=cm.getCursor(),from=cur,to=cur;if(!cm.options.lineWrapping){from=cur.ch?Pos(cur.line,cur.ch-1):cur;to=Pos(cur.line,cur.ch+1)}cm.curOp.scrollToPos={from:from,to:to,margin:cm.options.cursorScrollMargin,isCursor:true}}function resolveScrollToPos(cm){var range=cm.curOp.scrollToPos;if(range){cm.curOp.scrollToPos=null;var from=estimateCoords(cm,range.from),to=estimateCoords(cm,range.to);var sPos=calculateScrollPos(cm,Math.min(from.left,to.left),Math.min(from.top,to.top)-range.margin,Math.max(from.right,to.right),Math.max(from.bottom,to.bottom)+range.margin);cm.scrollTo(sPos.scrollLeft,sPos.scrollTop)}}function indentLine(cm,n,how,aggressive){var doc=cm.doc,state;if(how==null)how="add";if(how=="smart"){if(!doc.mode.indent)how="prev";else state=getStateBefore(cm,n)}var tabSize=cm.options.tabSize;var line=getLine(doc,n),curSpace=countColumn(line.text,null,tabSize);if(line.stateAfter)line.stateAfter=null;var curSpaceString=line.text.match(/^\s*/)[0],indentation;if(!aggressive&&!/\S/.test(line.text)){indentation=0;how="not"}else if(how=="smart"){indentation=doc.mode.indent(state,line.text.slice(curSpaceString.length),line.text);if(indentation==Pass||indentation>150){if(!aggressive)return;how="prev"}}if(how=="prev"){if(n>doc.first)indentation=countColumn(getLine(doc,n-1).text,null,tabSize);else indentation=0}else if(how=="add"){indentation=curSpace+cm.options.indentUnit}else if(how=="subtract"){indentation=curSpace-cm.options.indentUnit}else if(typeof how=="number"){indentation=curSpace+how}indentation=Math.max(0,indentation);var indentString="",pos=0;if(cm.options.indentWithTabs)for(var i=Math.floor(indentation/tabSize);i;--i){pos+=tabSize;indentString+="	"}if(pos<indentation)indentString+=spaceStr(indentation-pos);if(indentString!=curSpaceString){replaceRange(doc,indentString,Pos(n,0),Pos(n,curSpaceString.length),"+input")}else{for(var i=0;i<doc.sel.ranges.length;i++){var range=doc.sel.ranges[i];if(range.head.line==n&&range.head.ch<curSpaceString.length){var pos=Pos(n,curSpaceString.length);replaceOneSelection(doc,i,new Range(pos,pos));break}}}line.stateAfter=null}function changeLine(doc,handle,changeType,op){var no=handle,line=handle;if(typeof handle=="number")line=getLine(doc,clipLine(doc,handle));else no=lineNo(handle);if(no==null)return null;if(op(line,no)&&doc.cm)regLineChange(doc.cm,no,changeType);return line}function deleteNearSelection(cm,compute){var ranges=cm.doc.sel.ranges,kill=[];for(var i=0;i<ranges.length;i++){var toKill=compute(ranges[i]);while(kill.length&&cmp(toKill.from,lst(kill).to)<=0){var replaced=kill.pop();if(cmp(replaced.from,toKill.from)<0){toKill.from=replaced.from;break}}kill.push(toKill)}runInOp(cm,function(){for(var i=kill.length-1;i>=0;i--)replaceRange(cm.doc,"",kill[i].from,kill[i].to,"+delete");ensureCursorVisible(cm)})}function findPosH(doc,pos,dir,unit,visually){var line=pos.line,ch=pos.ch,origDir=dir;var lineObj=getLine(doc,line);var possible=true;function findNextLine(){var l=line+dir;if(l<doc.first||l>=doc.first+doc.size)return possible=false;line=l;return lineObj=getLine(doc,l)}function moveOnce(boundToLine){var next=(visually?moveVisually:moveLogically)(lineObj,ch,dir,true);if(next==null){if(!boundToLine&&findNextLine()){if(visually)ch=(dir<0?lineRight:lineLeft)(lineObj);else ch=dir<0?lineObj.text.length:0}else return possible=false}else ch=next;return true}if(unit=="char")moveOnce();else if(unit=="column")moveOnce(true);else if(unit=="word"||unit=="group"){var sawType=null,group=unit=="group";var helper=doc.cm&&doc.cm.getHelper(pos,"wordChars");for(var first=true;;first=false){if(dir<0&&!moveOnce(!first))break;var cur=lineObj.text.charAt(ch)||"\n";var type=isWordChar(cur,helper)?"w":group&&cur=="\n"?"n":!group||/\s/.test(cur)?null:"p";if(group&&!first&&!type)type="s";if(sawType&&sawType!=type){if(dir<0){dir=1;moveOnce()}break}if(type)sawType=type;if(dir>0&&!moveOnce(!first))break}}var result=skipAtomic(doc,Pos(line,ch),origDir,true);if(!possible)result.hitSide=true;return result}function findPosV(cm,pos,dir,unit){var doc=cm.doc,x=pos.left,y;if(unit=="page"){var pageSize=Math.min(cm.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);y=pos.top+dir*(pageSize-(dir<0?1.5:.5)*textHeight(cm.display))}else if(unit=="line"){y=dir>0?pos.bottom+3:pos.top-3}for(;;){var target=coordsChar(cm,x,y);if(!target.outside)break;if(dir<0?y<=0:y>=doc.height){target.hitSide=true;break}y+=dir*5}return target}CodeMirror.prototype={constructor:CodeMirror,focus:function(){window.focus();focusInput(this);fastPoll(this)},setOption:function(option,value){var options=this.options,old=options[option];if(options[option]==value&&option!="mode")return;options[option]=value;if(optionHandlers.hasOwnProperty(option))operation(this,optionHandlers[option])(this,value,old)},getOption:function(option){return this.options[option]},getDoc:function(){return this.doc},addKeyMap:function(map,bottom){this.state.keyMaps[bottom?"push":"unshift"](getKeyMap(map))},removeKeyMap:function(map){var maps=this.state.keyMaps;for(var i=0;i<maps.length;++i)if(maps[i]==map||maps[i].name==map){maps.splice(i,1);return true}},addOverlay:methodOp(function(spec,options){var mode=spec.token?spec:CodeMirror.getMode(this.options,spec);if(mode.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:mode,modeSpec:spec,opaque:options&&options.opaque});this.state.modeGen++;regChange(this)}),removeOverlay:methodOp(function(spec){var overlays=this.state.overlays;for(var i=0;i<overlays.length;++i){var cur=overlays[i].modeSpec;if(cur==spec||typeof spec=="string"&&cur.name==spec){overlays.splice(i,1);this.state.modeGen++;regChange(this);return}}}),indentLine:methodOp(function(n,dir,aggressive){if(typeof dir!="string"&&typeof dir!="number"){if(dir==null)dir=this.options.smartIndent?"smart":"prev";else dir=dir?"add":"subtract"}if(isLine(this.doc,n))indentLine(this,n,dir,aggressive)}),indentSelection:methodOp(function(how){var ranges=this.doc.sel.ranges,end=-1;for(var i=0;i<ranges.length;i++){var range=ranges[i];if(!range.empty()){var from=range.from(),to=range.to();var start=Math.max(end,from.line);end=Math.min(this.lastLine(),to.line-(to.ch?0:1))+1;for(var j=start;j<end;++j)indentLine(this,j,how);var newRanges=this.doc.sel.ranges;if(from.ch==0&&ranges.length==newRanges.length&&newRanges[i].from().ch>0)replaceOneSelection(this.doc,i,new Range(from,newRanges[i].to()),sel_dontScroll)}else if(range.head.line>end){indentLine(this,range.head.line,how,true);end=range.head.line;if(i==this.doc.sel.primIndex)ensureCursorVisible(this)}}}),getTokenAt:function(pos,precise){return takeToken(this,pos,precise)},getLineTokens:function(line,precise){return takeToken(this,Pos(line),precise,true)},getTokenTypeAt:function(pos){pos=clipPos(this.doc,pos);var styles=getLineStyles(this,getLine(this.doc,pos.line));var before=0,after=(styles.length-1)/2,ch=pos.ch;var type;if(ch==0)type=styles[2];else for(;;){var mid=before+after>>1;if((mid?styles[mid*2-1]:0)>=ch)after=mid;else if(styles[mid*2+1]<ch)before=mid+1;else{type=styles[mid*2+2];break}}var cut=type?type.indexOf("cm-overlay "):-1;return cut<0?type:cut==0?null:type.slice(0,cut-1)},getModeAt:function(pos){var mode=this.doc.mode;if(!mode.innerMode)return mode;return CodeMirror.innerMode(mode,this.getTokenAt(pos).state).mode},getHelper:function(pos,type){return this.getHelpers(pos,type)[0]},getHelpers:function(pos,type){var found=[];if(!helpers.hasOwnProperty(type))return helpers;var help=helpers[type],mode=this.getModeAt(pos);if(typeof mode[type]=="string"){if(help[mode[type]])found.push(help[mode[type]])}else if(mode[type]){for(var i=0;i<mode[type].length;i++){var val=help[mode[type][i]];if(val)found.push(val)}}else if(mode.helperType&&help[mode.helperType]){found.push(help[mode.helperType])}else if(help[mode.name]){found.push(help[mode.name])}for(var i=0;i<help._global.length;i++){var cur=help._global[i];if(cur.pred(mode,this)&&indexOf(found,cur.val)==-1)found.push(cur.val)}return found},getStateAfter:function(line,precise){var doc=this.doc;line=clipLine(doc,line==null?doc.first+doc.size-1:line);return getStateBefore(this,line+1,precise)},cursorCoords:function(start,mode){var pos,range=this.doc.sel.primary();if(start==null)pos=range.head;else if(typeof start=="object")pos=clipPos(this.doc,start);else pos=start?range.from():range.to();return cursorCoords(this,pos,mode||"page")},charCoords:function(pos,mode){return charCoords(this,clipPos(this.doc,pos),mode||"page")},coordsChar:function(coords,mode){coords=fromCoordSystem(this,coords,mode||"page");return coordsChar(this,coords.left,coords.top)},lineAtHeight:function(height,mode){height=fromCoordSystem(this,{top:height,left:0},mode||"page").top;return lineAtHeight(this.doc,height+this.display.viewOffset)},heightAtLine:function(line,mode){var end=false,last=this.doc.first+this.doc.size-1;if(line<this.doc.first)line=this.doc.first;else if(line>last){line=last;end=true}var lineObj=getLine(this.doc,line);return intoCoordSystem(this,lineObj,{top:0,left:0},mode||"page").top+(end?this.doc.height-heightAtLine(lineObj):0)},defaultTextHeight:function(){return textHeight(this.display)},defaultCharWidth:function(){return charWidth(this.display)},setGutterMarker:methodOp(function(line,gutterID,value){return changeLine(this.doc,line,"gutter",function(line){var markers=line.gutterMarkers||(line.gutterMarkers={});markers[gutterID]=value;if(!value&&isEmpty(markers))line.gutterMarkers=null;return true})}),clearGutter:methodOp(function(gutterID){var cm=this,doc=cm.doc,i=doc.first;doc.iter(function(line){if(line.gutterMarkers&&line.gutterMarkers[gutterID]){line.gutterMarkers[gutterID]=null;regLineChange(cm,i,"gutter");if(isEmpty(line.gutterMarkers))line.gutterMarkers=null}++i})}),addLineWidget:methodOp(function(handle,node,options){return addLineWidget(this,handle,node,options)}),removeLineWidget:function(widget){widget.clear()},lineInfo:function(line){if(typeof line=="number"){if(!isLine(this.doc,line))return null;var n=line;line=getLine(this.doc,line);if(!line)return null}else{var n=lineNo(line);if(n==null)return null}return{line:n,handle:line,text:line.text,gutterMarkers:line.gutterMarkers,textClass:line.textClass,bgClass:line.bgClass,wrapClass:line.wrapClass,widgets:line.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(pos,node,scroll,vert,horiz){var display=this.display;pos=cursorCoords(this,clipPos(this.doc,pos));var top=pos.bottom,left=pos.left;node.style.position="absolute";display.sizer.appendChild(node);if(vert=="over"){top=pos.top}else if(vert=="above"||vert=="near"){var vspace=Math.max(display.wrapper.clientHeight,this.doc.height),hspace=Math.max(display.sizer.clientWidth,display.lineSpace.clientWidth);if((vert=="above"||pos.bottom+node.offsetHeight>vspace)&&pos.top>node.offsetHeight)top=pos.top-node.offsetHeight;else if(pos.bottom+node.offsetHeight<=vspace)top=pos.bottom;if(left+node.offsetWidth>hspace)left=hspace-node.offsetWidth}node.style.top=top+"px";node.style.left=node.style.right="";if(horiz=="right"){left=display.sizer.clientWidth-node.offsetWidth;node.style.right="0px"}else{if(horiz=="left")left=0;else if(horiz=="middle")left=(display.sizer.clientWidth-node.offsetWidth)/2;node.style.left=left+"px"}if(scroll)scrollIntoView(this,left,top,left+node.offsetWidth,top+node.offsetHeight)},triggerOnKeyDown:methodOp(onKeyDown),triggerOnKeyPress:methodOp(onKeyPress),triggerOnKeyUp:onKeyUp,execCommand:function(cmd){if(commands.hasOwnProperty(cmd))return commands[cmd](this)},findPosH:function(from,amount,unit,visually){var dir=1;if(amount<0){dir=-1;amount=-amount}for(var i=0,cur=clipPos(this.doc,from);i<amount;++i){cur=findPosH(this.doc,cur,dir,unit,visually);if(cur.hitSide)break}return cur},moveH:methodOp(function(dir,unit){var cm=this;cm.extendSelectionsBy(function(range){if(cm.display.shift||cm.doc.extend||range.empty())return findPosH(cm.doc,range.head,dir,unit,cm.options.rtlMoveVisually);else return dir<0?range.from():range.to()},sel_move)}),deleteH:methodOp(function(dir,unit){var sel=this.doc.sel,doc=this.doc;if(sel.somethingSelected())doc.replaceSelection("",null,"+delete");else deleteNearSelection(this,function(range){var other=findPosH(doc,range.head,dir,unit,false);return dir<0?{from:other,to:range.head}:{from:range.head,to:other}})}),findPosV:function(from,amount,unit,goalColumn){var dir=1,x=goalColumn;if(amount<0){dir=-1;amount=-amount}for(var i=0,cur=clipPos(this.doc,from);i<amount;++i){var coords=cursorCoords(this,cur,"div");if(x==null)x=coords.left;else coords.left=x;cur=findPosV(this,coords,dir,unit);if(cur.hitSide)break}return cur},moveV:methodOp(function(dir,unit){var cm=this,doc=this.doc,goals=[];var collapse=!cm.display.shift&&!doc.extend&&doc.sel.somethingSelected();doc.extendSelectionsBy(function(range){if(collapse)return dir<0?range.from():range.to();var headPos=cursorCoords(cm,range.head,"div");if(range.goalColumn!=null)headPos.left=range.goalColumn;goals.push(headPos.left);var pos=findPosV(cm,headPos,dir,unit);if(unit=="page"&&range==doc.sel.primary())addToScrollPos(cm,null,charCoords(cm,pos,"div").top-headPos.top);return pos},sel_move);if(goals.length)for(var i=0;i<doc.sel.ranges.length;i++)doc.sel.ranges[i].goalColumn=goals[i]}),findWordAt:function(pos){var doc=this.doc,line=getLine(doc,pos.line).text;var start=pos.ch,end=pos.ch;if(line){var helper=this.getHelper(pos,"wordChars");if((pos.xRel<0||end==line.length)&&start)--start;else++end;var startChar=line.charAt(start);var check=isWordChar(startChar,helper)?function(ch){return isWordChar(ch,helper)}:/\s/.test(startChar)?function(ch){return/\s/.test(ch)}:function(ch){return!/\s/.test(ch)&&!isWordChar(ch)};while(start>0&&check(line.charAt(start-1)))--start;while(end<line.length&&check(line.charAt(end)))++end}return new Range(Pos(pos.line,start),Pos(pos.line,end))},toggleOverwrite:function(value){if(value!=null&&value==this.state.overwrite)return;if(this.state.overwrite=!this.state.overwrite)addClass(this.display.cursorDiv,"CodeMirror-overwrite");else rmClass(this.display.cursorDiv,"CodeMirror-overwrite");signal(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return activeElt()==this.display.input},scrollTo:methodOp(function(x,y){if(x!=null||y!=null)resolveScrollToPos(this);if(x!=null)this.curOp.scrollLeft=x;if(y!=null)this.curOp.scrollTop=y}),getScrollInfo:function(){var scroller=this.display.scroller,co=scrollerCutOff;return{left:scroller.scrollLeft,top:scroller.scrollTop,height:scroller.scrollHeight-co,width:scroller.scrollWidth-co,clientHeight:scroller.clientHeight-co,clientWidth:scroller.clientWidth-co}},scrollIntoView:methodOp(function(range,margin){if(range==null){range={from:this.doc.sel.primary().head,to:null};if(margin==null)margin=this.options.cursorScrollMargin}else if(typeof range=="number"){range={from:Pos(range,0),to:null}}else if(range.from==null){range={from:range,to:null}}if(!range.to)range.to=range.from;range.margin=margin||0;if(range.from.line!=null){resolveScrollToPos(this);this.curOp.scrollToPos=range}else{var sPos=calculateScrollPos(this,Math.min(range.from.left,range.to.left),Math.min(range.from.top,range.to.top)-range.margin,Math.max(range.from.right,range.to.right),Math.max(range.from.bottom,range.to.bottom)+range.margin);this.scrollTo(sPos.scrollLeft,sPos.scrollTop)}}),setSize:methodOp(function(width,height){var cm=this;function interpret(val){return typeof val=="number"||/^\d+$/.test(String(val))?val+"px":val}if(width!=null)cm.display.wrapper.style.width=interpret(width);if(height!=null)cm.display.wrapper.style.height=interpret(height);if(cm.options.lineWrapping)clearLineMeasurementCache(this);var lineNo=cm.display.viewFrom;cm.doc.iter(lineNo,cm.display.viewTo,function(line){if(line.widgets)for(var i=0;i<line.widgets.length;i++)if(line.widgets[i].noHScroll){regLineChange(cm,lineNo,"widget");break}++lineNo});cm.curOp.forceUpdate=true;signal(cm,"refresh",this)}),operation:function(f){return runInOp(this,f)},refresh:methodOp(function(){var oldHeight=this.display.cachedTextHeight;regChange(this);this.curOp.forceUpdate=true;clearCaches(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);updateGutterSpace(this);if(oldHeight==null||Math.abs(oldHeight-textHeight(this.display))>.5)estimateLineHeights(this);signal(this,"refresh",this)}),swapDoc:methodOp(function(doc){var old=this.doc;old.cm=null;attachDoc(this,doc);clearCaches(this);resetInput(this);this.scrollTo(doc.scrollLeft,doc.scrollTop);this.curOp.forceScroll=true;signalLater(this,"swapDoc",this,old);return old}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};eventMixin(CodeMirror);var defaults=CodeMirror.defaults={};var optionHandlers=CodeMirror.optionHandlers={};function option(name,deflt,handle,notOnInit){CodeMirror.defaults[name]=deflt;if(handle)optionHandlers[name]=notOnInit?function(cm,val,old){if(old!=Init)handle(cm,val,old)}:handle}var Init=CodeMirror.Init={toString:function(){return"CodeMirror.Init"}};option("value","",function(cm,val){cm.setValue(val)},true);option("mode",null,function(cm,val){cm.doc.modeOption=val;loadMode(cm)},true);option("indentUnit",2,loadMode,true);option("indentWithTabs",false);option("smartIndent",true);option("tabSize",4,function(cm){resetModeState(cm);clearCaches(cm);regChange(cm)},true);option("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(cm,val){cm.options.specialChars=new RegExp(val.source+(val.test("	")?"":"|	"),"g");cm.refresh()},true);option("specialCharPlaceholder",defaultSpecialCharPlaceholder,function(cm){cm.refresh()},true);option("electricChars",true);option("rtlMoveVisually",!windows);option("wholeLineUpdateBefore",true);option("theme","default",function(cm){themeChanged(cm);guttersChanged(cm)},true);option("keyMap","default",function(cm,val,old){var next=getKeyMap(val);var prev=old!=CodeMirror.Init&&getKeyMap(old);if(prev&&prev.detach)prev.detach(cm,next);if(next.attach)next.attach(cm,prev||null)});option("extraKeys",null);option("lineWrapping",false,wrappingChanged,true);option("gutters",[],function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm)},true);option("fixedGutter",true,function(cm,val){cm.display.gutters.style.left=val?compensateForHScroll(cm.display)+"px":"0";cm.refresh()},true);option("coverGutterNextToScrollbar",false,updateScrollbars,true);option("lineNumbers",false,function(cm){setGuttersForLineNumbers(cm.options);guttersChanged(cm)},true);option("firstLineNumber",1,guttersChanged,true);option("lineNumberFormatter",function(integer){return integer},guttersChanged,true);option("showCursorWhenSelecting",false,updateSelection,true);option("resetSelectionOnContextMenu",true);option("readOnly",false,function(cm,val){if(val=="nocursor"){onBlur(cm);cm.display.input.blur();cm.display.disabled=true}else{cm.display.disabled=false;if(!val)resetInput(cm)}});option("disableInput",false,function(cm,val){if(!val)resetInput(cm)},true);option("dragDrop",true);option("cursorBlinkRate",530);option("cursorScrollMargin",0);option("cursorHeight",1,updateSelection,true);option("singleCursorHeightPerLine",true,updateSelection,true);option("workTime",100);option("workDelay",100);option("flattenSpans",true,resetModeState,true);option("addModeClass",false,resetModeState,true);option("pollInterval",100);option("undoDepth",200,function(cm,val){cm.doc.history.undoDepth=val});option("historyEventDelay",1250);option("viewportMargin",10,function(cm){cm.refresh()},true);option("maxHighlightLength",1e4,resetModeState,true);option("moveInputWithCursor",true,function(cm,val){if(!val)cm.display.inputDiv.style.top=cm.display.inputDiv.style.left=0});option("tabindex",null,function(cm,val){cm.display.input.tabIndex=val||""});option("autofocus",null);var modes=CodeMirror.modes={},mimeModes=CodeMirror.mimeModes={};CodeMirror.defineMode=function(name,mode){if(!CodeMirror.defaults.mode&&name!="null")CodeMirror.defaults.mode=name;if(arguments.length>2)mode.dependencies=Array.prototype.slice.call(arguments,2);modes[name]=mode};CodeMirror.defineMIME=function(mime,spec){mimeModes[mime]=spec};CodeMirror.resolveMode=function(spec){if(typeof spec=="string"&&mimeModes.hasOwnProperty(spec)){spec=mimeModes[spec]}else if(spec&&typeof spec.name=="string"&&mimeModes.hasOwnProperty(spec.name)){var found=mimeModes[spec.name];if(typeof found=="string")found={name:found};spec=createObj(found,spec);spec.name=found.name}else if(typeof spec=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(spec)){return CodeMirror.resolveMode("application/xml")}if(typeof spec=="string")return{name:spec};else return spec||{name:"null"}};CodeMirror.getMode=function(options,spec){var spec=CodeMirror.resolveMode(spec);var mfactory=modes[spec.name];if(!mfactory)return CodeMirror.getMode(options,"text/plain");var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts){if(!exts.hasOwnProperty(prop))continue;if(modeObj.hasOwnProperty(prop))modeObj["_"+prop]=modeObj[prop];modeObj[prop]=exts[prop]}}modeObj.name=spec.name;if(spec.helperType)modeObj.helperType=spec.helperType;if(spec.modeProps)for(var prop in spec.modeProps)modeObj[prop]=spec.modeProps[prop];return modeObj};CodeMirror.defineMode("null",function(){return{token:function(stream){stream.skipToEnd()}}});CodeMirror.defineMIME("text/plain","null");var modeExtensions=CodeMirror.modeExtensions={};CodeMirror.extendMode=function(mode,properties){var exts=modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={};copyObj(properties,exts)};CodeMirror.defineExtension=function(name,func){CodeMirror.prototype[name]=func};CodeMirror.defineDocExtension=function(name,func){Doc.prototype[name]=func};CodeMirror.defineOption=option;var initHooks=[];CodeMirror.defineInitHook=function(f){initHooks.push(f)};var helpers=CodeMirror.helpers={};CodeMirror.registerHelper=function(type,name,value){if(!helpers.hasOwnProperty(type))helpers[type]=CodeMirror[type]={_global:[]};helpers[type][name]=value};CodeMirror.registerGlobalHelper=function(type,name,predicate,value){CodeMirror.registerHelper(type,name,value);helpers[type]._global.push({pred:predicate,val:value})};var copyState=CodeMirror.copyState=function(mode,state){if(state===true)return state;if(mode.copyState)return mode.copyState(state);var nstate={};for(var n in state){var val=state[n];if(val instanceof Array)val=val.concat([]);nstate[n]=val}return nstate};var startState=CodeMirror.startState=function(mode,a1,a2){return mode.startState?mode.startState(a1,a2):true};CodeMirror.innerMode=function(mode,state){while(mode.innerMode){var info=mode.innerMode(state);if(!info||info.mode==mode)break;state=info.state;mode=info.mode}return info||{mode:mode,state:state}};var commands=CodeMirror.commands={selectAll:function(cm){cm.setSelection(Pos(cm.firstLine(),0),Pos(cm.lastLine()),sel_dontScroll)},singleSelection:function(cm){cm.setSelection(cm.getCursor("anchor"),cm.getCursor("head"),sel_dontScroll)},killLine:function(cm){deleteNearSelection(cm,function(range){if(range.empty()){var len=getLine(cm.doc,range.head.line).text.length;if(range.head.ch==len&&range.head.line<cm.lastLine())return{from:range.head,to:Pos(range.head.line+1,0)};else return{from:range.head,to:Pos(range.head.line,len)}}else{return{from:range.from(),to:range.to()}}})},deleteLine:function(cm){deleteNearSelection(cm,function(range){return{from:Pos(range.from().line,0),to:clipPos(cm.doc,Pos(range.to().line+1,0))}})},delLineLeft:function(cm){deleteNearSelection(cm,function(range){return{from:Pos(range.from().line,0),to:range.from()}})},delWrappedLineLeft:function(cm){deleteNearSelection(cm,function(range){var top=cm.charCoords(range.head,"div").top+5;var leftPos=cm.coordsChar({left:0,top:top},"div");return{from:leftPos,to:range.from()}})},delWrappedLineRight:function(cm){deleteNearSelection(cm,function(range){var top=cm.charCoords(range.head,"div").top+5;var rightPos=cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div");return{from:range.from(),to:rightPos}})},undo:function(cm){cm.undo()},redo:function(cm){cm.redo()},undoSelection:function(cm){cm.undoSelection()},redoSelection:function(cm){cm.redoSelection()},goDocStart:function(cm){cm.extendSelection(Pos(cm.firstLine(),0))},goDocEnd:function(cm){cm.extendSelection(Pos(cm.lastLine()))},goLineStart:function(cm){cm.extendSelectionsBy(function(range){return lineStart(cm,range.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(cm){cm.extendSelectionsBy(function(range){return lineStartSmart(cm,range.head)},{origin:"+move",bias:1})},goLineEnd:function(cm){cm.extendSelectionsBy(function(range){return lineEnd(cm,range.head.line)},{origin:"+move",bias:-1})},goLineRight:function(cm){cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5;return cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div")},sel_move)},goLineLeft:function(cm){cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5;return cm.coordsChar({left:0,top:top},"div")},sel_move)},goLineLeftSmart:function(cm){cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5;var pos=cm.coordsChar({left:0,top:top},"div");if(pos.ch<cm.getLine(pos.line).search(/\S/))return lineStartSmart(cm,range.head);return pos},sel_move)},goLineUp:function(cm){cm.moveV(-1,"line")},goLineDown:function(cm){cm.moveV(1,"line")},goPageUp:function(cm){cm.moveV(-1,"page")},goPageDown:function(cm){cm.moveV(1,"page")},goCharLeft:function(cm){cm.moveH(-1,"char")},goCharRight:function(cm){cm.moveH(1,"char")},goColumnLeft:function(cm){cm.moveH(-1,"column")},goColumnRight:function(cm){cm.moveH(1,"column")},goWordLeft:function(cm){cm.moveH(-1,"word")},goGroupRight:function(cm){cm.moveH(1,"group")},goGroupLeft:function(cm){cm.moveH(-1,"group")},goWordRight:function(cm){cm.moveH(1,"word")},delCharBefore:function(cm){cm.deleteH(-1,"char")},delCharAfter:function(cm){cm.deleteH(1,"char")},delWordBefore:function(cm){cm.deleteH(-1,"word")},delWordAfter:function(cm){cm.deleteH(1,"word")},delGroupBefore:function(cm){cm.deleteH(-1,"group")},delGroupAfter:function(cm){cm.deleteH(1,"group")},indentAuto:function(cm){cm.indentSelection("smart")},indentMore:function(cm){cm.indentSelection("add")},indentLess:function(cm){cm.indentSelection("subtract")},insertTab:function(cm){cm.replaceSelection("	")},insertSoftTab:function(cm){var spaces=[],ranges=cm.listSelections(),tabSize=cm.options.tabSize;for(var i=0;i<ranges.length;i++){var pos=ranges[i].from();var col=countColumn(cm.getLine(pos.line),pos.ch,tabSize);spaces.push(new Array(tabSize-col%tabSize+1).join(" "))}cm.replaceSelections(spaces)},defaultTab:function(cm){if(cm.somethingSelected())cm.indentSelection("add");else cm.execCommand("insertTab")},transposeChars:function(cm){runInOp(cm,function(){var ranges=cm.listSelections(),newSel=[];for(var i=0;i<ranges.length;i++){var cur=ranges[i].head,line=getLine(cm.doc,cur.line).text;if(line){if(cur.ch==line.length)cur=new Pos(cur.line,cur.ch-1);if(cur.ch>0){cur=new Pos(cur.line,cur.ch+1);cm.replaceRange(line.charAt(cur.ch-1)+line.charAt(cur.ch-2),Pos(cur.line,cur.ch-2),cur,"+transpose")}else if(cur.line>cm.doc.first){var prev=getLine(cm.doc,cur.line-1).text;if(prev)cm.replaceRange(line.charAt(0)+"\n"+prev.charAt(prev.length-1),Pos(cur.line-1,prev.length-1),Pos(cur.line,1),"+transpose")}}newSel.push(new Range(cur,cur))}cm.setSelections(newSel)})},newlineAndIndent:function(cm){runInOp(cm,function(){var len=cm.listSelections().length;for(var i=0;i<len;i++){var range=cm.listSelections()[i];cm.replaceRange("\n",range.anchor,range.head,"+input");cm.indentLine(range.from().line+1,null,true);ensureCursorVisible(cm)}})},toggleOverwrite:function(cm){cm.toggleOverwrite()}};var keyMap=CodeMirror.keyMap={};keyMap.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};keyMap.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};keyMap.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};keyMap.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};keyMap["default"]=mac?keyMap.macDefault:keyMap.pcDefault;function normalizeKeyName(name){var parts=name.split(/-(?!$)/),name=parts[parts.length-1];var alt,ctrl,shift,cmd;for(var i=0;i<parts.length-1;i++){var mod=parts[i];if(/^(cmd|meta|m)$/i.test(mod))cmd=true;else if(/^a(lt)?$/i.test(mod))alt=true;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=true;else if(/^s(hift)$/i.test(mod))shift=true;else throw new Error("Unrecognized modifier name: "+mod)}if(alt)name="Alt-"+name;if(ctrl)name="Ctrl-"+name;if(cmd)name="Cmd-"+name;
if(shift)name="Shift-"+name;return name}CodeMirror.normalizeKeyMap=function(keymap){var copy={};for(var keyname in keymap)if(keymap.hasOwnProperty(keyname)){var value=keymap[keyname];if(/^(name|fallthrough|(de|at)tach)$/.test(keyname))continue;if(value=="..."){delete keymap[keyname];continue}var keys=map(keyname.split(" "),normalizeKeyName);for(var i=0;i<keys.length;i++){var val,name;if(i==keys.length-1){name=keyname;val=value}else{name=keys.slice(0,i+1).join(" ");val="..."}var prev=copy[name];if(!prev)copy[name]=val;else if(prev!=val)throw new Error("Inconsistent bindings for "+name)}delete keymap[keyname]}for(var prop in copy)keymap[prop]=copy[prop];return keymap};var lookupKey=CodeMirror.lookupKey=function(key,map,handle){map=getKeyMap(map);var found=map.call?map.call(key):map[key];if(found===false)return"nothing";if(found==="...")return"multi";if(found!=null&&handle(found))return"handled";if(map.fallthrough){if(Object.prototype.toString.call(map.fallthrough)!="[object Array]")return lookupKey(key,map.fallthrough,handle);for(var i=0;i<map.fallthrough.length;i++){var result=lookupKey(key,map.fallthrough[i],handle);if(result)return result}}};var isModifierKey=CodeMirror.isModifierKey=function(value){var name=typeof value=="string"?value:keyNames[value.keyCode];return name=="Ctrl"||name=="Alt"||name=="Shift"||name=="Mod"};var keyName=CodeMirror.keyName=function(event,noShift){if(presto&&event.keyCode==34&&event["char"])return false;var base=keyNames[event.keyCode],name=base;if(name==null||event.altGraphKey)return false;if(event.altKey&&base!="Alt")name="Alt-"+name;if((flipCtrlCmd?event.metaKey:event.ctrlKey)&&base!="Ctrl")name="Ctrl-"+name;if((flipCtrlCmd?event.ctrlKey:event.metaKey)&&base!="Cmd")name="Cmd-"+name;if(!noShift&&event.shiftKey&&base!="Shift")name="Shift-"+name;return name};function getKeyMap(val){return typeof val=="string"?keyMap[val]:val}CodeMirror.fromTextArea=function(textarea,options){if(!options)options={};options.value=textarea.value;if(!options.tabindex&&textarea.tabindex)options.tabindex=textarea.tabindex;if(!options.placeholder&&textarea.placeholder)options.placeholder=textarea.placeholder;if(options.autofocus==null){var hasFocus=activeElt();options.autofocus=hasFocus==textarea||textarea.getAttribute("autofocus")!=null&&hasFocus==document.body}function save(){textarea.value=cm.getValue()}if(textarea.form){on(textarea.form,"submit",save);if(!options.leaveSubmitMethodAlone){var realSubmit=textarea.form.submit;try{var wrappedSubmit=textarea.form.submit=function(){save();textarea.form.submit=realSubmit;textarea.form.submit();textarea.form.submit=wrappedSubmit}}catch(e){}}}textarea.style.display="none";var cm=CodeMirror(function(node){textarea.parentNode.insertBefore(node,textarea.nextSibling)},options);cm.save=save;cm.getTextArea=function(){return textarea};cm.toTextArea=function(){cm.toTextArea=isNaN;save();textarea.parentNode.removeChild(cm.getWrapperElement());textarea.style.display="";if(textarea.form){off(textarea.form,"submit",save);if(typeof textarea.form.submit=="function")textarea.form.submit=realSubmit}};cm.cleanup=function(){if(textarea.form){off(textarea.form,"submit",save)}cm.toTextArea();textarea=null;cm=null;CodeMirror.cleanup.apply(this)};return cm};var StringStream=CodeMirror.StringStream=function(string,tabSize){this.pos=this.start=0;this.string=string;this.tabSize=tabSize||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0};StringStream.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(match){var ch=this.string.charAt(this.pos);if(typeof match=="string")var ok=ch==match;else var ok=ch&&(match.test?match.test(ch):match(ch));if(ok){++this.pos;return ch}},eatWhile:function(match){var start=this.pos;while(this.eat(match)){}return this.pos>start},eatSpace:function(){var start=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>start},skipToEnd:function(){this.pos=this.string.length},skipTo:function(ch){var found=this.string.indexOf(ch,this.pos);if(found>-1){this.pos=found;return true}},backUp:function(n){this.pos-=n},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return countColumn(this.string,null,this.tabSize)-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},match:function(pattern,consume,caseInsensitive){if(typeof pattern=="string"){var cased=function(str){return caseInsensitive?str.toLowerCase():str};var substr=this.string.substr(this.pos,pattern.length);if(cased(substr)==cased(pattern)){if(consume!==false)this.pos+=pattern.length;return true}}else{var match=this.string.slice(this.pos).match(pattern);if(match&&match.index>0)return null;if(match&&consume!==false)this.pos+=match[0].length;return match}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(n,inner){this.lineStart+=n;try{return inner()}finally{this.lineStart-=n}}};var TextMarker=CodeMirror.TextMarker=function(doc,type){this.lines=[];this.type=type;this.doc=doc};eventMixin(TextMarker);TextMarker.prototype.clear=function(){if(this.explicitlyCleared)return;var cm=this.doc.cm,withOp=cm&&!cm.curOp;if(withOp)startOperation(cm);if(hasHandler(this,"clear")){var found=this.find();if(found)signalLater(this,"clear",found.from,found.to)}var min=null,max=null;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(cm&&!this.collapsed)regLineChange(cm,lineNo(line),"text");else if(cm){if(span.to!=null)max=lineNo(line);if(span.from!=null)min=lineNo(line)}line.markedSpans=removeMarkedSpan(line.markedSpans,span);if(span.from==null&&this.collapsed&&!lineIsHidden(this.doc,line)&&cm)updateLineHeight(line,textHeight(cm.display))}if(cm&&this.collapsed&&!cm.options.lineWrapping)for(var i=0;i<this.lines.length;++i){var visual=visualLine(this.lines[i]),len=lineLength(visual);if(len>cm.display.maxLineLength){cm.display.maxLine=visual;cm.display.maxLineLength=len;cm.display.maxLineChanged=true}}if(min!=null&&cm&&this.collapsed)regChange(cm,min,max+1);this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(cm)reCheckSelection(cm.doc)}if(cm)signalLater(cm,"markerCleared",cm,this);if(withOp)endOperation(cm);if(this.parent)this.parent.clear()};TextMarker.prototype.find=function(side,lineObj){if(side==null&&this.type=="bookmark")side=1;var from,to;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(span.from!=null){from=Pos(lineObj?line:lineNo(line),span.from);if(side==-1)return from}if(span.to!=null){to=Pos(lineObj?line:lineNo(line),span.to);if(side==1)return to}}return from&&{from:from,to:to}};TextMarker.prototype.changed=function(){var pos=this.find(-1,true),widget=this,cm=this.doc.cm;if(!pos||!cm)return;runInOp(cm,function(){var line=pos.line,lineN=lineNo(pos.line);var view=findViewForLine(cm,lineN);if(view){clearLineMeasurementCacheFor(view);cm.curOp.selectionChanged=cm.curOp.forceUpdate=true}cm.curOp.updateMaxLine=true;if(!lineIsHidden(widget.doc,line)&&widget.height!=null){var oldHeight=widget.height;widget.height=null;var dHeight=widgetHeight(widget)-oldHeight;if(dHeight)updateLineHeight(line,line.height+dHeight)}})};TextMarker.prototype.attachLine=function(line){if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;if(!op.maybeHiddenMarkers||indexOf(op.maybeHiddenMarkers,this)==-1)(op.maybeUnhiddenMarkers||(op.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(line)};TextMarker.prototype.detachLine=function(line){this.lines.splice(indexOf(this.lines,line),1);if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;(op.maybeHiddenMarkers||(op.maybeHiddenMarkers=[])).push(this)}};var nextMarkerId=0;function markText(doc,from,to,options,type){if(options&&options.shared)return markTextShared(doc,from,to,options,type);if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,markText)(doc,from,to,options,type);var marker=new TextMarker(doc,type),diff=cmp(from,to);if(options)copyObj(options,marker,false);if(diff>0||diff==0&&marker.clearWhenEmpty!==false)return marker;if(marker.replacedWith){marker.collapsed=true;marker.widgetNode=elt("span",[marker.replacedWith],"CodeMirror-widget");if(!options.handleMouseEvents)marker.widgetNode.ignoreEvents=true;if(options.insertLeft)marker.widgetNode.insertLeft=true}if(marker.collapsed){if(conflictingCollapsedRange(doc,from.line,from,to,marker)||from.line!=to.line&&conflictingCollapsedRange(doc,to.line,from,to,marker))throw new Error("Inserting collapsed marker partially overlapping an existing one");sawCollapsedSpans=true}if(marker.addToHistory)addChangeToHistory(doc,{from:from,to:to,origin:"markText"},doc.sel,NaN);var curLine=from.line,cm=doc.cm,updateMaxLine;doc.iter(curLine,to.line+1,function(line){if(cm&&marker.collapsed&&!cm.options.lineWrapping&&visualLine(line)==cm.display.maxLine)updateMaxLine=true;if(marker.collapsed&&curLine!=from.line)updateLineHeight(line,0);addMarkedSpan(line,new MarkedSpan(marker,curLine==from.line?from.ch:null,curLine==to.line?to.ch:null));++curLine});if(marker.collapsed)doc.iter(from.line,to.line+1,function(line){if(lineIsHidden(doc,line))updateLineHeight(line,0)});if(marker.clearOnEnter)on(marker,"beforeCursorEnter",function(){marker.clear()});if(marker.readOnly){sawReadOnlySpans=true;if(doc.history.done.length||doc.history.undone.length)doc.clearHistory()}if(marker.collapsed){marker.id=++nextMarkerId;marker.atomic=true}if(cm){if(updateMaxLine)cm.curOp.updateMaxLine=true;if(marker.collapsed)regChange(cm,from.line,to.line+1);else if(marker.className||marker.title||marker.startStyle||marker.endStyle)for(var i=from.line;i<=to.line;i++)regLineChange(cm,i,"text");if(marker.atomic)reCheckSelection(cm.doc);signalLater(cm,"markerAdded",cm,marker)}return marker}var SharedTextMarker=CodeMirror.SharedTextMarker=function(markers,primary){this.markers=markers;this.primary=primary;for(var i=0;i<markers.length;++i)markers[i].parent=this};eventMixin(SharedTextMarker);SharedTextMarker.prototype.clear=function(){if(this.explicitlyCleared)return;this.explicitlyCleared=true;for(var i=0;i<this.markers.length;++i)this.markers[i].clear();signalLater(this,"clear")};SharedTextMarker.prototype.find=function(side,lineObj){return this.primary.find(side,lineObj)};function markTextShared(doc,from,to,options,type){options=copyObj(options);options.shared=false;var markers=[markText(doc,from,to,options,type)],primary=markers[0];var widget=options.widgetNode;linkedDocs(doc,function(doc){if(widget)options.widgetNode=widget.cloneNode(true);markers.push(markText(doc,clipPos(doc,from),clipPos(doc,to),options,type));for(var i=0;i<doc.linked.length;++i)if(doc.linked[i].isParent)return;primary=lst(markers)});return new SharedTextMarker(markers,primary)}function findSharedMarkers(doc){return doc.findMarks(Pos(doc.first,0),doc.clipPos(Pos(doc.lastLine())),function(m){return m.parent})}function copySharedMarkers(doc,markers){for(var i=0;i<markers.length;i++){var marker=markers[i],pos=marker.find();var mFrom=doc.clipPos(pos.from),mTo=doc.clipPos(pos.to);if(cmp(mFrom,mTo)){var subMark=markText(doc,mFrom,mTo,marker.primary,marker.primary.type);marker.markers.push(subMark);subMark.parent=marker}}}function detachSharedMarkers(markers){for(var i=0;i<markers.length;i++){var marker=markers[i],linked=[marker.primary.doc];linkedDocs(marker.primary.doc,function(d){linked.push(d)});for(var j=0;j<marker.markers.length;j++){var subMarker=marker.markers[j];if(indexOf(linked,subMarker.doc)==-1){subMarker.parent=null;marker.markers.splice(j--,1)}}}}function MarkedSpan(marker,from,to){this.marker=marker;this.from=from;this.to=to}function getMarkedSpanFor(spans,marker){if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if(span.marker==marker)return span}}function removeMarkedSpan(spans,span){for(var r,i=0;i<spans.length;++i)if(spans[i]!=span)(r||(r=[])).push(spans[i]);return r}function addMarkedSpan(line,span){line.markedSpans=line.markedSpans?line.markedSpans.concat([span]):[span];span.marker.attachLine(line)}function markedSpansBefore(old,startCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker;var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=startCh:span.from<startCh);if(startsBefore||span.from==startCh&&marker.type=="bookmark"&&(!isInsert||!span.marker.insertLeft)){var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);(nw||(nw=[])).push(new MarkedSpan(marker,span.from,endsAfter?null:span.to))}}return nw}function markedSpansAfter(old,endCh,isInsert){if(old)for(var i=0,nw;i<old.length;++i){var span=old[i],marker=span.marker;var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=endCh:span.to>endCh);if(endsAfter||span.from==endCh&&marker.type=="bookmark"&&(!isInsert||span.marker.insertLeft)){var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=endCh:span.from<endCh);(nw||(nw=[])).push(new MarkedSpan(marker,startsBefore?null:span.from-endCh,span.to==null?null:span.to-endCh))}}return nw}function stretchSpansOverChange(doc,change){var oldFirst=isLine(doc,change.from.line)&&getLine(doc,change.from.line).markedSpans;var oldLast=isLine(doc,change.to.line)&&getLine(doc,change.to.line).markedSpans;if(!oldFirst&&!oldLast)return null;var startCh=change.from.ch,endCh=change.to.ch,isInsert=cmp(change.from,change.to)==0;var first=markedSpansBefore(oldFirst,startCh,isInsert);var last=markedSpansAfter(oldLast,endCh,isInsert);var sameLine=change.text.length==1,offset=lst(change.text).length+(sameLine?startCh:0);if(first){for(var i=0;i<first.length;++i){var span=first[i];if(span.to==null){var found=getMarkedSpanFor(last,span.marker);if(!found)span.to=startCh;else if(sameLine)span.to=found.to==null?null:found.to+offset}}}if(last){for(var i=0;i<last.length;++i){var span=last[i];if(span.to!=null)span.to+=offset;if(span.from==null){var found=getMarkedSpanFor(first,span.marker);if(!found){span.from=offset;if(sameLine)(first||(first=[])).push(span)}}else{span.from+=offset;if(sameLine)(first||(first=[])).push(span)}}}if(first)first=clearEmptySpans(first);if(last&&last!=first)last=clearEmptySpans(last);var newMarkers=[first];if(!sameLine){var gap=change.text.length-2,gapMarkers;if(gap>0&&first)for(var i=0;i<first.length;++i)if(first[i].to==null)(gapMarkers||(gapMarkers=[])).push(new MarkedSpan(first[i].marker,null,null));for(var i=0;i<gap;++i)newMarkers.push(gapMarkers);newMarkers.push(last)}return newMarkers}function clearEmptySpans(spans){for(var i=0;i<spans.length;++i){var span=spans[i];if(span.from!=null&&span.from==span.to&&span.marker.clearWhenEmpty!==false)spans.splice(i--,1)}if(!spans.length)return null;return spans}function mergeOldSpans(doc,change){var old=getOldSpans(doc,change);var stretched=stretchSpansOverChange(doc,change);if(!old)return stretched;if(!stretched)return old;for(var i=0;i<old.length;++i){var oldCur=old[i],stretchCur=stretched[i];if(oldCur&&stretchCur){spans:for(var j=0;j<stretchCur.length;++j){var span=stretchCur[j];for(var k=0;k<oldCur.length;++k)if(oldCur[k].marker==span.marker)continue spans;oldCur.push(span)}}else if(stretchCur){old[i]=stretchCur}}return old}function removeReadOnlyRanges(doc,from,to){var markers=null;doc.iter(from.line,to.line+1,function(line){if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var mark=line.markedSpans[i].marker;if(mark.readOnly&&(!markers||indexOf(markers,mark)==-1))(markers||(markers=[])).push(mark)}});if(!markers)return null;var parts=[{from:from,to:to}];for(var i=0;i<markers.length;++i){var mk=markers[i],m=mk.find(0);for(var j=0;j<parts.length;++j){var p=parts[j];if(cmp(p.to,m.from)<0||cmp(p.from,m.to)>0)continue;var newParts=[j,1],dfrom=cmp(p.from,m.from),dto=cmp(p.to,m.to);if(dfrom<0||!mk.inclusiveLeft&&!dfrom)newParts.push({from:p.from,to:m.from});if(dto>0||!mk.inclusiveRight&&!dto)newParts.push({from:m.to,to:p.to});parts.splice.apply(parts,newParts);j+=newParts.length-1}}return parts}function detachMarkedSpans(line){var spans=line.markedSpans;if(!spans)return;for(var i=0;i<spans.length;++i)spans[i].marker.detachLine(line);line.markedSpans=null}function attachMarkedSpans(line,spans){if(!spans)return;for(var i=0;i<spans.length;++i)spans[i].marker.attachLine(line);line.markedSpans=spans}function extraLeft(marker){return marker.inclusiveLeft?-1:0}function extraRight(marker){return marker.inclusiveRight?1:0}function compareCollapsedMarkers(a,b){var lenDiff=a.lines.length-b.lines.length;if(lenDiff!=0)return lenDiff;var aPos=a.find(),bPos=b.find();var fromCmp=cmp(aPos.from,bPos.from)||extraLeft(a)-extraLeft(b);if(fromCmp)return-fromCmp;var toCmp=cmp(aPos.to,bPos.to)||extraRight(a)-extraRight(b);if(toCmp)return toCmp;return b.id-a.id}function collapsedSpanAtSide(line,start){var sps=sawCollapsedSpans&&line.markedSpans,found;if(sps)for(var sp,i=0;i<sps.length;++i){sp=sps[i];if(sp.marker.collapsed&&(start?sp.from:sp.to)==null&&(!found||compareCollapsedMarkers(found,sp.marker)<0))found=sp.marker}return found}function collapsedSpanAtStart(line){return collapsedSpanAtSide(line,true)}function collapsedSpanAtEnd(line){return collapsedSpanAtSide(line,false)}function conflictingCollapsedRange(doc,lineNo,from,to,marker){var line=getLine(doc,lineNo);var sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var i=0;i<sps.length;++i){var sp=sps[i];if(!sp.marker.collapsed)continue;var found=sp.marker.find(0);var fromCmp=cmp(found.from,from)||extraLeft(sp.marker)-extraLeft(marker);var toCmp=cmp(found.to,to)||extraRight(sp.marker)-extraRight(marker);if(fromCmp>=0&&toCmp<=0||fromCmp<=0&&toCmp>=0)continue;if(fromCmp<=0&&(cmp(found.to,from)>0||sp.marker.inclusiveRight&&marker.inclusiveLeft)||fromCmp>=0&&(cmp(found.from,to)<0||sp.marker.inclusiveLeft&&marker.inclusiveRight))return true}}function visualLine(line){var merged;while(merged=collapsedSpanAtStart(line))line=merged.find(-1,true).line;return line}function visualLineContinued(line){var merged,lines;while(merged=collapsedSpanAtEnd(line)){line=merged.find(1,true).line;(lines||(lines=[])).push(line)}return lines}function visualLineNo(doc,lineN){var line=getLine(doc,lineN),vis=visualLine(line);if(line==vis)return lineN;return lineNo(vis)}function visualLineEndNo(doc,lineN){if(lineN>doc.lastLine())return lineN;var line=getLine(doc,lineN),merged;if(!lineIsHidden(doc,line))return lineN;while(merged=collapsedSpanAtEnd(line))line=merged.find(1,true).line;return lineNo(line)+1}function lineIsHidden(doc,line){var sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp,i=0;i<sps.length;++i){sp=sps[i];if(!sp.marker.collapsed)continue;if(sp.from==null)return true;if(sp.marker.widgetNode)continue;if(sp.from==0&&sp.marker.inclusiveLeft&&lineIsHiddenInner(doc,line,sp))return true}}function lineIsHiddenInner(doc,line,span){if(span.to==null){var end=span.marker.find(1,true);return lineIsHiddenInner(doc,end.line,getMarkedSpanFor(end.line.markedSpans,span.marker))}if(span.marker.inclusiveRight&&span.to==line.text.length)return true;for(var sp,i=0;i<line.markedSpans.length;++i){sp=line.markedSpans[i];if(sp.marker.collapsed&&!sp.marker.widgetNode&&sp.from==span.to&&(sp.to==null||sp.to!=span.from)&&(sp.marker.inclusiveLeft||span.marker.inclusiveRight)&&lineIsHiddenInner(doc,line,sp))return true}}var LineWidget=CodeMirror.LineWidget=function(cm,node,options){if(options)for(var opt in options)if(options.hasOwnProperty(opt))this[opt]=options[opt];this.cm=cm;this.node=node};eventMixin(LineWidget);function adjustScrollWhenAboveVisible(cm,line,diff){if(heightAtLine(line)<(cm.curOp&&cm.curOp.scrollTop||cm.doc.scrollTop))addToScrollPos(cm,null,diff)}LineWidget.prototype.clear=function(){var cm=this.cm,ws=this.line.widgets,line=this.line,no=lineNo(line);if(no==null||!ws)return;for(var i=0;i<ws.length;++i)if(ws[i]==this)ws.splice(i--,1);if(!ws.length)line.widgets=null;var height=widgetHeight(this);runInOp(cm,function(){adjustScrollWhenAboveVisible(cm,line,-height);regLineChange(cm,no,"widget");updateLineHeight(line,Math.max(0,line.height-height))})};LineWidget.prototype.changed=function(){var oldH=this.height,cm=this.cm,line=this.line;this.height=null;var diff=widgetHeight(this)-oldH;if(!diff)return;runInOp(cm,function(){cm.curOp.forceUpdate=true;adjustScrollWhenAboveVisible(cm,line,diff);updateLineHeight(line,line.height+diff)})};function widgetHeight(widget){if(widget.height!=null)return widget.height;if(!contains(document.body,widget.node)){var parentStyle="position: relative;";if(widget.coverGutter)parentStyle+="margin-left: -"+widget.cm.getGutterElement().offsetWidth+"px;";removeChildrenAndAdd(widget.cm.display.measure,elt("div",[widget.node],null,parentStyle))}return widget.height=widget.node.offsetHeight}function addLineWidget(cm,handle,node,options){var widget=new LineWidget(cm,node,options);if(widget.noHScroll)cm.display.alignWidgets=true;changeLine(cm.doc,handle,"widget",function(line){var widgets=line.widgets||(line.widgets=[]);if(widget.insertAt==null)widgets.push(widget);else widgets.splice(Math.min(widgets.length-1,Math.max(0,widget.insertAt)),0,widget);widget.line=line;if(!lineIsHidden(cm.doc,line)){var aboveVisible=heightAtLine(line)<cm.doc.scrollTop;updateLineHeight(line,line.height+widgetHeight(widget));if(aboveVisible)addToScrollPos(cm,null,widget.height);cm.curOp.forceUpdate=true}return true});return widget}var Line=CodeMirror.Line=function(text,markedSpans,estimateHeight){this.text=text;attachMarkedSpans(this,markedSpans);this.height=estimateHeight?estimateHeight(this):1};eventMixin(Line);Line.prototype.lineNo=function(){return lineNo(this)};function updateLine(line,text,markedSpans,estimateHeight){line.text=text;if(line.stateAfter)line.stateAfter=null;if(line.styles)line.styles=null;if(line.order!=null)line.order=null;detachMarkedSpans(line);attachMarkedSpans(line,markedSpans);var estHeight=estimateHeight?estimateHeight(line):1;if(estHeight!=line.height)updateLineHeight(line,estHeight)}function cleanUpLine(line){line.parent=null;detachMarkedSpans(line)}function extractLineClasses(type,output){if(type)for(;;){var lineClass=type.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!lineClass)break;type=type.slice(0,lineClass.index)+type.slice(lineClass.index+lineClass[0].length);var prop=lineClass[1]?"bgClass":"textClass";if(output[prop]==null)output[prop]=lineClass[2];else if(!new RegExp("(?:^|s)"+lineClass[2]+"(?:$|s)").test(output[prop]))output[prop]+=" "+lineClass[2]}return type}function callBlankLine(mode,state){if(mode.blankLine)return mode.blankLine(state);if(!mode.innerMode)return;var inner=CodeMirror.innerMode(mode,state);if(inner.mode.blankLine)return inner.mode.blankLine(inner.state)}function readToken(mode,stream,state,inner){for(var i=0;i<10;i++){if(inner)inner[0]=CodeMirror.innerMode(mode,state).mode;var style=mode.token(stream,state);if(stream.pos>stream.start)return style}throw new Error("Mode "+mode.name+" failed to advance stream.")}function takeToken(cm,pos,precise,asArray){function getObj(copy){return{start:stream.start,end:stream.pos,string:stream.current(),type:style||null,state:copy?copyState(doc.mode,state):state}}var doc=cm.doc,mode=doc.mode,style;pos=clipPos(doc,pos);var line=getLine(doc,pos.line),state=getStateBefore(cm,pos.line,precise);var stream=new StringStream(line.text,cm.options.tabSize),tokens;if(asArray)tokens=[];while((asArray||stream.pos<pos.ch)&&!stream.eol()){stream.start=stream.pos;style=readToken(mode,stream,state);if(asArray)tokens.push(getObj(true))}return asArray?tokens:getObj()}function runMode(cm,text,mode,state,f,lineClasses,forceToEnd){var flattenSpans=mode.flattenSpans;if(flattenSpans==null)flattenSpans=cm.options.flattenSpans;var curStart=0,curStyle=null;var stream=new StringStream(text,cm.options.tabSize),style;var inner=cm.options.addModeClass&&[null];if(text=="")extractLineClasses(callBlankLine(mode,state),lineClasses);while(!stream.eol()){if(stream.pos>cm.options.maxHighlightLength){flattenSpans=false;if(forceToEnd)processLine(cm,text,state,stream.pos);stream.pos=text.length;style=null}else{style=extractLineClasses(readToken(mode,stream,state,inner),lineClasses)}if(inner){var mName=inner[0].name;if(mName)style="m-"+(style?mName+" "+style:mName)}if(!flattenSpans||curStyle!=style){if(curStart<stream.start)f(stream.start,curStyle);curStart=stream.start;curStyle=style}stream.start=stream.pos}while(curStart<stream.pos){var pos=Math.min(stream.pos,curStart+5e4);f(pos,curStyle);curStart=pos}}function highlightLine(cm,line,state,forceToEnd){var st=[cm.state.modeGen],lineClasses={};runMode(cm,line.text,cm.doc.mode,state,function(end,style){st.push(end,style)},lineClasses,forceToEnd);for(var o=0;o<cm.state.overlays.length;++o){var overlay=cm.state.overlays[o],i=1,at=0;runMode(cm,line.text,overlay.mode,true,function(end,style){var start=i;while(at<end){var i_end=st[i];if(i_end>end)st.splice(i,1,end,st[i+1],i_end);i+=2;at=Math.min(end,i_end)}if(!style)return;if(overlay.opaque){st.splice(start,i-start,end,"cm-overlay "+style);i=start+2}else{for(;start<i;start+=2){var cur=st[start+1];st[start+1]=(cur?cur+" ":"")+"cm-overlay "+style}}},lineClasses)}return{styles:st,classes:lineClasses.bgClass||lineClasses.textClass?lineClasses:null}}function getLineStyles(cm,line,updateFrontier){if(!line.styles||line.styles[0]!=cm.state.modeGen){var result=highlightLine(cm,line,line.stateAfter=getStateBefore(cm,lineNo(line)));line.styles=result.styles;if(result.classes)line.styleClasses=result.classes;else if(line.styleClasses)line.styleClasses=null;if(updateFrontier===cm.doc.frontier)cm.doc.frontier++}return line.styles}function processLine(cm,text,state,startAt){var mode=cm.doc.mode;var stream=new StringStream(text,cm.options.tabSize);stream.start=stream.pos=startAt||0;if(text=="")callBlankLine(mode,state);while(!stream.eol()&&stream.pos<=cm.options.maxHighlightLength){readToken(mode,stream,state);stream.start=stream.pos}}var styleToClassCache={},styleToClassCacheWithMode={};function interpretTokenStyle(style,options){if(!style||/^\s*$/.test(style))return null;var cache=options.addModeClass?styleToClassCacheWithMode:styleToClassCache;return cache[style]||(cache[style]=style.replace(/\S+/g,"cm-$&"))}function buildLineContent(cm,lineView){var content=elt("span",null,null,webkit?"padding-right: .1px":null);var builder={pre:elt("pre",[content]),content:content,col:0,pos:0,cm:cm};lineView.measure={};for(var i=0;i<=(lineView.rest?lineView.rest.length:0);i++){var line=i?lineView.rest[i-1]:lineView.line,order;builder.pos=0;builder.addToken=buildToken;if((ie||webkit)&&cm.getOption("lineWrapping"))builder.addToken=buildTokenSplitSpaces(builder.addToken);if(hasBadBidiRects(cm.display.measure)&&(order=getOrder(line)))builder.addToken=buildTokenBadBidi(builder.addToken,order);builder.map=[];var allowFrontierUpdate=lineView!=cm.display.externalMeasured&&lineNo(line);insertLineContent(line,builder,getLineStyles(cm,line,allowFrontierUpdate));if(line.styleClasses){if(line.styleClasses.bgClass)builder.bgClass=joinClasses(line.styleClasses.bgClass,builder.bgClass||"");if(line.styleClasses.textClass)builder.textClass=joinClasses(line.styleClasses.textClass,builder.textClass||"")}if(builder.map.length==0)builder.map.push(0,0,builder.content.appendChild(zeroWidthElement(cm.display.measure)));if(i==0){lineView.measure.map=builder.map;lineView.measure.cache={}}else{(lineView.measure.maps||(lineView.measure.maps=[])).push(builder.map);(lineView.measure.caches||(lineView.measure.caches=[])).push({})}}if(webkit&&/\bcm-tab\b/.test(builder.content.lastChild.className))builder.content.className="cm-tab-wrap-hack";signal(cm,"renderLine",cm,lineView.line,builder.pre);if(builder.pre.className)builder.textClass=joinClasses(builder.pre.className,builder.textClass||"");return builder}function defaultSpecialCharPlaceholder(ch){var token=elt("span","","cm-invalidchar");token.title="\\u"+ch.charCodeAt(0).toString(16);return token}function buildToken(builder,text,style,startStyle,endStyle,title){if(!text)return;var special=builder.cm.options.specialChars,mustWrap=false;if(!special.test(text)){builder.col+=text.length;var content=document.createTextNode(text);builder.map.push(builder.pos,builder.pos+text.length,content);if(ie&&ie_version<9)mustWrap=true;builder.pos+=text.length}else{var content=document.createDocumentFragment(),pos=0;while(true){special.lastIndex=pos;var m=special.exec(text);var skipped=m?m.index-pos:text.length-pos;if(skipped){var txt=document.createTextNode(text.slice(pos,pos+skipped));if(ie&&ie_version<9)content.appendChild(elt("span",[txt]));else content.appendChild(txt);builder.map.push(builder.pos,builder.pos+skipped,txt);builder.col+=skipped;builder.pos+=skipped}if(!m)break;pos+=skipped+1;if(m[0]=="	"){var tabSize=builder.cm.options.tabSize,tabWidth=tabSize-builder.col%tabSize;var txt=content.appendChild(elt("span",spaceStr(tabWidth),"cm-tab"));builder.col+=tabWidth}else{var txt=builder.cm.options.specialCharPlaceholder(m[0]);if(ie&&ie_version<9)content.appendChild(elt("span",[txt]));else content.appendChild(txt);builder.col+=1}builder.map.push(builder.pos,builder.pos+1,txt);builder.pos++}}if(style||startStyle||endStyle||mustWrap){var fullStyle=style||"";if(startStyle)fullStyle+=startStyle;if(endStyle)fullStyle+=endStyle;var token=elt("span",[content],fullStyle);if(title)token.title=title;return builder.content.appendChild(token)}builder.content.appendChild(content)}function buildTokenSplitSpaces(inner){function split(old){var out=" ";for(var i=0;i<old.length-2;++i)out+=i%2?" ":"";out+=" ";return out}return function(builder,text,style,startStyle,endStyle,title){inner(builder,text.replace(/ {3,}/g,split),style,startStyle,endStyle,title)}}function buildTokenBadBidi(inner,order){return function(builder,text,style,startStyle,endStyle,title){style=style?style+" cm-force-border":"cm-force-border";var start=builder.pos,end=start+text.length;for(;;){for(var i=0;i<order.length;i++){var part=order[i];if(part.to>start&&part.from<=start)break}if(part.to>=end)return inner(builder,text,style,startStyle,endStyle,title);inner(builder,text.slice(0,part.to-start),style,startStyle,null,title);startStyle=null;text=text.slice(part.to-start);start=part.to}}}function buildCollapsedSpan(builder,size,marker,ignoreWidget){var widget=!ignoreWidget&&marker.widgetNode;if(widget){builder.map.push(builder.pos,builder.pos+size,widget);builder.content.appendChild(widget)}builder.pos+=size}function insertLineContent(line,builder,styles){var spans=line.markedSpans,allText=line.text,at=0;if(!spans){for(var i=1;i<styles.length;i+=2)builder.addToken(builder,allText.slice(at,at=styles[i]),interpretTokenStyle(styles[i+1],builder.cm.options));return}var len=allText.length,pos=0,i=1,text="",style;var nextChange=0,spanStyle,spanEndStyle,spanStartStyle,title,collapsed;for(;;){if(nextChange==pos){spanStyle=spanEndStyle=spanStartStyle=title="";collapsed=null;nextChange=Infinity;var foundBookmarks=[];for(var j=0;j<spans.length;++j){var sp=spans[j],m=sp.marker;if(sp.from<=pos&&(sp.to==null||sp.to>pos)){if(sp.to!=null&&nextChange>sp.to){nextChange=sp.to;spanEndStyle=""}if(m.className)spanStyle+=" "+m.className;if(m.startStyle&&sp.from==pos)spanStartStyle+=" "+m.startStyle;if(m.endStyle&&sp.to==nextChange)spanEndStyle+=" "+m.endStyle;if(m.title&&!title)title=m.title;if(m.collapsed&&(!collapsed||compareCollapsedMarkers(collapsed.marker,m)<0))collapsed=sp}else if(sp.from>pos&&nextChange>sp.from){nextChange=sp.from}if(m.type=="bookmark"&&sp.from==pos&&m.widgetNode)foundBookmarks.push(m)}if(collapsed&&(collapsed.from||0)==pos){buildCollapsedSpan(builder,(collapsed.to==null?len+1:collapsed.to)-pos,collapsed.marker,collapsed.from==null);
if(collapsed.to==null)return}if(!collapsed&&foundBookmarks.length)for(var j=0;j<foundBookmarks.length;++j)buildCollapsedSpan(builder,0,foundBookmarks[j])}if(pos>=len)break;var upto=Math.min(len,nextChange);while(true){if(text){var end=pos+text.length;if(!collapsed){var tokenText=end>upto?text.slice(0,upto-pos):text;builder.addToken(builder,tokenText,style?style+spanStyle:spanStyle,spanStartStyle,pos+tokenText.length==nextChange?spanEndStyle:"",title)}if(end>=upto){text=text.slice(upto-pos);pos=upto;break}pos=end;spanStartStyle=""}text=allText.slice(at,at=styles[i++]);style=interpretTokenStyle(styles[i++],builder.cm.options)}}}function isWholeLineUpdate(doc,change){return change.from.ch==0&&change.to.ch==0&&lst(change.text)==""&&(!doc.cm||doc.cm.options.wholeLineUpdateBefore)}function updateDoc(doc,change,markedSpans,estimateHeight){function spansFor(n){return markedSpans?markedSpans[n]:null}function update(line,text,spans){updateLine(line,text,spans,estimateHeight);signalLater(line,"change",line,change)}var from=change.from,to=change.to,text=change.text;var firstLine=getLine(doc,from.line),lastLine=getLine(doc,to.line);var lastText=lst(text),lastSpans=spansFor(text.length-1),nlines=to.line-from.line;if(isWholeLineUpdate(doc,change)){for(var i=0,added=[];i<text.length-1;++i)added.push(new Line(text[i],spansFor(i),estimateHeight));update(lastLine,lastLine.text,lastSpans);if(nlines)doc.remove(from.line,nlines);if(added.length)doc.insert(from.line,added)}else if(firstLine==lastLine){if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+lastText+firstLine.text.slice(to.ch),lastSpans)}else{for(var added=[],i=1;i<text.length-1;++i)added.push(new Line(text[i],spansFor(i),estimateHeight));added.push(new Line(lastText+firstLine.text.slice(to.ch),lastSpans,estimateHeight));update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));doc.insert(from.line+1,added)}}else if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+text[0]+lastLine.text.slice(to.ch),spansFor(0));doc.remove(from.line+1,nlines)}else{update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));update(lastLine,lastText+lastLine.text.slice(to.ch),lastSpans);for(var i=1,added=[];i<text.length-1;++i)added.push(new Line(text[i],spansFor(i),estimateHeight));if(nlines>1)doc.remove(from.line+1,nlines-1);doc.insert(from.line+1,added)}signalLater(doc,"change",doc,change)}function LeafChunk(lines){this.lines=lines;this.parent=null;for(var i=0,height=0;i<lines.length;++i){lines[i].parent=this;height+=lines[i].height}this.height=height}LeafChunk.prototype={chunkSize:function(){return this.lines.length},removeInner:function(at,n){for(var i=at,e=at+n;i<e;++i){var line=this.lines[i];this.height-=line.height;cleanUpLine(line);signalLater(line,"delete")}this.lines.splice(at,n)},collapse:function(lines){lines.push.apply(lines,this.lines)},insertInner:function(at,lines,height){this.height+=height;this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0;i<lines.length;++i)lines[i].parent=this},iterN:function(at,n,op){for(var e=at+n;at<e;++at)if(op(this.lines[at]))return true}};function BranchChunk(children){this.children=children;var size=0,height=0;for(var i=0;i<children.length;++i){var ch=children[i];size+=ch.chunkSize();height+=ch.height;ch.parent=this}this.size=size;this.height=height;this.parent=null}BranchChunk.prototype={chunkSize:function(){return this.size},removeInner:function(at,n){this.size-=n;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var rm=Math.min(n,sz-at),oldHeight=child.height;child.removeInner(at,rm);this.height-=oldHeight-child.height;if(sz==rm){this.children.splice(i--,1);child.parent=null}if((n-=rm)==0)break;at=0}else at-=sz}if(this.size-n<25&&(this.children.length>1||!(this.children[0]instanceof LeafChunk))){var lines=[];this.collapse(lines);this.children=[new LeafChunk(lines)];this.children[0].parent=this}},collapse:function(lines){for(var i=0;i<this.children.length;++i)this.children[i].collapse(lines)},insertInner:function(at,lines,height){this.size+=lines.length;this.height+=height;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<=sz){child.insertInner(at,lines,height);if(child.lines&&child.lines.length>50){while(child.lines.length>50){var spilled=child.lines.splice(child.lines.length-25,25);var newleaf=new LeafChunk(spilled);child.height-=newleaf.height;this.children.splice(i+1,0,newleaf);newleaf.parent=this}this.maybeSpill()}break}at-=sz}},maybeSpill:function(){if(this.children.length<=10)return;var me=this;do{var spilled=me.children.splice(me.children.length-5,5);var sibling=new BranchChunk(spilled);if(!me.parent){var copy=new BranchChunk(me.children);copy.parent=me;me.children=[copy,sibling];me=copy}else{me.size-=sibling.size;me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling)}sibling.parent=me.parent}while(me.children.length>10);me.parent.maybeSpill()},iterN:function(at,n,op){for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var used=Math.min(n,sz-at);if(child.iterN(at,used,op))return true;if((n-=used)==0)break;at=0}else at-=sz}}};var nextDocId=0;var Doc=CodeMirror.Doc=function(text,mode,firstLine){if(!(this instanceof Doc))return new Doc(text,mode,firstLine);if(firstLine==null)firstLine=0;BranchChunk.call(this,[new LeafChunk([new Line("",null)])]);this.first=firstLine;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.frontier=firstLine;var start=Pos(firstLine,0);this.sel=simpleSelection(start);this.history=new History(null);this.id=++nextDocId;this.modeOption=mode;if(typeof text=="string")text=splitLines(text);updateDoc(this,{from:start,to:start,text:text});setSelection(this,simpleSelection(start),sel_dontScroll)};Doc.prototype=createObj(BranchChunk.prototype,{constructor:Doc,iter:function(from,to,op){if(op)this.iterN(from-this.first,to-from,op);else this.iterN(this.first,this.first+this.size,from)},insert:function(at,lines){var height=0;for(var i=0;i<lines.length;++i)height+=lines[i].height;this.insertInner(at-this.first,lines,height)},remove:function(at,n){this.removeInner(at-this.first,n)},getValue:function(lineSep){var lines=getLines(this,this.first,this.first+this.size);if(lineSep===false)return lines;return lines.join(lineSep||"\n")},setValue:docMethodOp(function(code){var top=Pos(this.first,0),last=this.first+this.size-1;makeChange(this,{from:top,to:Pos(last,getLine(this,last).text.length),text:splitLines(code),origin:"setValue"},true);setSelection(this,simpleSelection(top))}),replaceRange:function(code,from,to,origin){from=clipPos(this,from);to=to?clipPos(this,to):from;replaceRange(this,code,from,to,origin)},getRange:function(from,to,lineSep){var lines=getBetween(this,clipPos(this,from),clipPos(this,to));if(lineSep===false)return lines;return lines.join(lineSep||"\n")},getLine:function(line){var l=this.getLineHandle(line);return l&&l.text},getLineHandle:function(line){if(isLine(this,line))return getLine(this,line)},getLineNumber:function(line){return lineNo(line)},getLineHandleVisualStart:function(line){if(typeof line=="number")line=getLine(this,line);return visualLine(line)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(pos){return clipPos(this,pos)},getCursor:function(start){var range=this.sel.primary(),pos;if(start==null||start=="head")pos=range.head;else if(start=="anchor")pos=range.anchor;else if(start=="end"||start=="to"||start===false)pos=range.to();else pos=range.from();return pos},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:docMethodOp(function(line,ch,options){setSimpleSelection(this,clipPos(this,typeof line=="number"?Pos(line,ch||0):line),null,options)}),setSelection:docMethodOp(function(anchor,head,options){setSimpleSelection(this,clipPos(this,anchor),clipPos(this,head||anchor),options)}),extendSelection:docMethodOp(function(head,other,options){extendSelection(this,clipPos(this,head),other&&clipPos(this,other),options)}),extendSelections:docMethodOp(function(heads,options){extendSelections(this,clipPosArray(this,heads,options))}),extendSelectionsBy:docMethodOp(function(f,options){extendSelections(this,map(this.sel.ranges,f),options)}),setSelections:docMethodOp(function(ranges,primary,options){if(!ranges.length)return;for(var i=0,out=[];i<ranges.length;i++)out[i]=new Range(clipPos(this,ranges[i].anchor),clipPos(this,ranges[i].head));if(primary==null)primary=Math.min(ranges.length-1,this.sel.primIndex);setSelection(this,normalizeSelection(out,primary),options)}),addSelection:docMethodOp(function(anchor,head,options){var ranges=this.sel.ranges.slice(0);ranges.push(new Range(clipPos(this,anchor),clipPos(this,head||anchor)));setSelection(this,normalizeSelection(ranges,ranges.length-1),options)}),getSelection:function(lineSep){var ranges=this.sel.ranges,lines;for(var i=0;i<ranges.length;i++){var sel=getBetween(this,ranges[i].from(),ranges[i].to());lines=lines?lines.concat(sel):sel}if(lineSep===false)return lines;else return lines.join(lineSep||"\n")},getSelections:function(lineSep){var parts=[],ranges=this.sel.ranges;for(var i=0;i<ranges.length;i++){var sel=getBetween(this,ranges[i].from(),ranges[i].to());if(lineSep!==false)sel=sel.join(lineSep||"\n");parts[i]=sel}return parts},replaceSelection:function(code,collapse,origin){var dup=[];for(var i=0;i<this.sel.ranges.length;i++)dup[i]=code;this.replaceSelections(dup,collapse,origin||"+input")},replaceSelections:docMethodOp(function(code,collapse,origin){var changes=[],sel=this.sel;for(var i=0;i<sel.ranges.length;i++){var range=sel.ranges[i];changes[i]={from:range.from(),to:range.to(),text:splitLines(code[i]),origin:origin}}var newSel=collapse&&collapse!="end"&&computeReplacedSel(this,changes,collapse);for(var i=changes.length-1;i>=0;i--)makeChange(this,changes[i]);if(newSel)setSelectionReplaceHistory(this,newSel);else if(this.cm)ensureCursorVisible(this.cm)}),undo:docMethodOp(function(){makeChangeFromHistory(this,"undo")}),redo:docMethodOp(function(){makeChangeFromHistory(this,"redo")}),undoSelection:docMethodOp(function(){makeChangeFromHistory(this,"undo",true)}),redoSelection:docMethodOp(function(){makeChangeFromHistory(this,"redo",true)}),setExtending:function(val){this.extend=val},getExtending:function(){return this.extend},historySize:function(){var hist=this.history,done=0,undone=0;for(var i=0;i<hist.done.length;i++)if(!hist.done[i].ranges)++done;for(var i=0;i<hist.undone.length;i++)if(!hist.undone[i].ranges)++undone;return{undo:done,redo:undone}},clearHistory:function(){this.history=new History(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(forceSplit){if(forceSplit)this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null;return this.history.generation},isClean:function(gen){return this.history.generation==(gen||this.cleanGeneration)},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)}},setHistory:function(histData){var hist=this.history=new History(this.history.maxGeneration);hist.done=copyHistoryArray(histData.done.slice(0),null,true);hist.undone=copyHistoryArray(histData.undone.slice(0),null,true)},addLineClass:docMethodOp(function(handle,where,cls){return changeLine(this,handle,where=="gutter"?"gutter":"class",function(line){var prop=where=="text"?"textClass":where=="background"?"bgClass":where=="gutter"?"gutterClass":"wrapClass";if(!line[prop])line[prop]=cls;else if(classTest(cls).test(line[prop]))return false;else line[prop]+=" "+cls;return true})}),removeLineClass:docMethodOp(function(handle,where,cls){return changeLine(this,handle,"class",function(line){var prop=where=="text"?"textClass":where=="background"?"bgClass":where=="gutter"?"gutterClass":"wrapClass";var cur=line[prop];if(!cur)return false;else if(cls==null)line[prop]=null;else{var found=cur.match(classTest(cls));if(!found)return false;var end=found.index+found[0].length;line[prop]=cur.slice(0,found.index)+(!found.index||end==cur.length?"":" ")+cur.slice(end)||null}return true})}),markText:function(from,to,options){return markText(this,clipPos(this,from),clipPos(this,to),options,"range")},setBookmark:function(pos,options){var realOpts={replacedWith:options&&(options.nodeType==null?options.widget:options),insertLeft:options&&options.insertLeft,clearWhenEmpty:false,shared:options&&options.shared};pos=clipPos(this,pos);return markText(this,pos,pos,realOpts,"bookmark")},findMarksAt:function(pos){pos=clipPos(this,pos);var markers=[],spans=getLine(this,pos.line).markedSpans;if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if((span.from==null||span.from<=pos.ch)&&(span.to==null||span.to>=pos.ch))markers.push(span.marker.parent||span.marker)}return markers},findMarks:function(from,to,filter){from=clipPos(this,from);to=clipPos(this,to);var found=[],lineNo=from.line;this.iter(from.line,to.line+1,function(line){var spans=line.markedSpans;if(spans)for(var i=0;i<spans.length;i++){var span=spans[i];if(!(lineNo==from.line&&from.ch>span.to||span.from==null&&lineNo!=from.line||lineNo==to.line&&span.from>to.ch)&&(!filter||filter(span.marker)))found.push(span.marker.parent||span.marker)}++lineNo});return found},getAllMarks:function(){var markers=[];this.iter(function(line){var sps=line.markedSpans;if(sps)for(var i=0;i<sps.length;++i)if(sps[i].from!=null)markers.push(sps[i].marker)});return markers},posFromIndex:function(off){var ch,lineNo=this.first;this.iter(function(line){var sz=line.text.length+1;if(sz>off){ch=off;return true}off-=sz;++lineNo});return clipPos(this,Pos(lineNo,ch))},indexFromPos:function(coords){coords=clipPos(this,coords);var index=coords.ch;if(coords.line<this.first||coords.ch<0)return 0;this.iter(this.first,coords.line,function(line){index+=line.text.length+1});return index},copy:function(copyHistory){var doc=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first);doc.scrollTop=this.scrollTop;doc.scrollLeft=this.scrollLeft;doc.sel=this.sel;doc.extend=false;if(copyHistory){doc.history.undoDepth=this.history.undoDepth;doc.setHistory(this.getHistory())}return doc},linkedDoc:function(options){if(!options)options={};var from=this.first,to=this.first+this.size;if(options.from!=null&&options.from>from)from=options.from;if(options.to!=null&&options.to<to)to=options.to;var copy=new Doc(getLines(this,from,to),options.mode||this.modeOption,from);if(options.sharedHist)copy.history=this.history;(this.linked||(this.linked=[])).push({doc:copy,sharedHist:options.sharedHist});copy.linked=[{doc:this,isParent:true,sharedHist:options.sharedHist}];copySharedMarkers(copy,findSharedMarkers(this));return copy},unlinkDoc:function(other){if(other instanceof CodeMirror)other=other.doc;if(this.linked)for(var i=0;i<this.linked.length;++i){var link=this.linked[i];if(link.doc!=other)continue;this.linked.splice(i,1);other.unlinkDoc(this);detachSharedMarkers(findSharedMarkers(this));break}if(other.history==this.history){var splitIds=[other.id];linkedDocs(other,function(doc){splitIds.push(doc.id)},true);other.history=new History(null);other.history.done=copyHistoryArray(this.history.done,splitIds);other.history.undone=copyHistoryArray(this.history.undone,splitIds)}},iterLinkedDocs:function(f){linkedDocs(this,f)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});Doc.prototype.eachLine=Doc.prototype.iter;var dontDelegate="iter insert remove copy getEditor".split(" ");for(var prop in Doc.prototype)if(Doc.prototype.hasOwnProperty(prop)&&indexOf(dontDelegate,prop)<0)CodeMirror.prototype[prop]=function(method){return function(){return method.apply(this.doc,arguments)}}(Doc.prototype[prop]);eventMixin(Doc);function linkedDocs(doc,f,sharedHistOnly){function propagate(doc,skip,sharedHist){if(doc.linked)for(var i=0;i<doc.linked.length;++i){var rel=doc.linked[i];if(rel.doc==skip)continue;var shared=sharedHist&&rel.sharedHist;if(sharedHistOnly&&!shared)continue;f(rel.doc,shared);propagate(rel.doc,doc,shared)}}propagate(doc,null,true)}function attachDoc(cm,doc){if(doc.cm)throw new Error("This document is already in use.");cm.doc=doc;doc.cm=cm;estimateLineHeights(cm);loadMode(cm);if(!cm.options.lineWrapping)findMaxLine(cm);cm.options.mode=doc.modeOption;regChange(cm)}function getLine(doc,n){n-=doc.first;if(n<0||n>=doc.size)throw new Error("There is no line "+(n+doc.first)+" in the document.");for(var chunk=doc;!chunk.lines;){for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(n<sz){chunk=child;break}n-=sz}}return chunk.lines[n]}function getBetween(doc,start,end){var out=[],n=start.line;doc.iter(start.line,end.line+1,function(line){var text=line.text;if(n==end.line)text=text.slice(0,end.ch);if(n==start.line)text=text.slice(start.ch);out.push(text);++n});return out}function getLines(doc,from,to){var out=[];doc.iter(from,to,function(line){out.push(line.text)});return out}function updateLineHeight(line,height){var diff=height-line.height;if(diff)for(var n=line;n;n=n.parent)n.height+=diff}function lineNo(line){if(line.parent==null)return null;var cur=line.parent,no=indexOf(cur.lines,line);for(var chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent){for(var i=0;;++i){if(chunk.children[i]==cur)break;no+=chunk.children[i].chunkSize()}}return no+cur.first}function lineAtHeight(chunk,h){var n=chunk.first;outer:do{for(var i=0;i<chunk.children.length;++i){var child=chunk.children[i],ch=child.height;if(h<ch){chunk=child;continue outer}h-=ch;n+=child.chunkSize()}return n}while(!chunk.lines);for(var i=0;i<chunk.lines.length;++i){var line=chunk.lines[i],lh=line.height;if(h<lh)break;h-=lh}return n+i}function heightAtLine(lineObj){lineObj=visualLine(lineObj);var h=0,chunk=lineObj.parent;for(var i=0;i<chunk.lines.length;++i){var line=chunk.lines[i];if(line==lineObj)break;else h+=line.height}for(var p=chunk.parent;p;chunk=p,p=chunk.parent){for(var i=0;i<p.children.length;++i){var cur=p.children[i];if(cur==chunk)break;else h+=cur.height}}return h}function getOrder(line){var order=line.order;if(order==null)order=line.order=bidiOrdering(line.text);return order}function History(startGen){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=startGen||1}function historyChangeFromChange(doc,change){var histChange={from:copyPos(change.from),to:changeEnd(change),text:getBetween(doc,change.from,change.to)};attachLocalSpans(doc,histChange,change.from.line,change.to.line+1);linkedDocs(doc,function(doc){attachLocalSpans(doc,histChange,change.from.line,change.to.line+1)},true);return histChange}function clearSelectionEvents(array){while(array.length){var last=lst(array);if(last.ranges)array.pop();else break}}function lastChangeEvent(hist,force){if(force){clearSelectionEvents(hist.done);return lst(hist.done)}else if(hist.done.length&&!lst(hist.done).ranges){return lst(hist.done)}else if(hist.done.length>1&&!hist.done[hist.done.length-2].ranges){hist.done.pop();return lst(hist.done)}}function addChangeToHistory(doc,change,selAfter,opId){var hist=doc.history;hist.undone.length=0;var time=+new Date,cur;if((hist.lastOp==opId||hist.lastOrigin==change.origin&&change.origin&&(change.origin.charAt(0)=="+"&&doc.cm&&hist.lastModTime>time-doc.cm.options.historyEventDelay||change.origin.charAt(0)=="*"))&&(cur=lastChangeEvent(hist,hist.lastOp==opId))){var last=lst(cur.changes);if(cmp(change.from,change.to)==0&&cmp(change.from,last.to)==0){last.to=changeEnd(change)}else{cur.changes.push(historyChangeFromChange(doc,change))}}else{var before=lst(hist.done);if(!before||!before.ranges)pushSelectionToHistory(doc.sel,hist.done);cur={changes:[historyChangeFromChange(doc,change)],generation:hist.generation};hist.done.push(cur);while(hist.done.length>hist.undoDepth){hist.done.shift();if(!hist.done[0].ranges)hist.done.shift()}}hist.done.push(selAfter);hist.generation=++hist.maxGeneration;hist.lastModTime=hist.lastSelTime=time;hist.lastOp=hist.lastSelOp=opId;hist.lastOrigin=hist.lastSelOrigin=change.origin;if(!last)signal(doc,"historyAdded")}function selectionEventCanBeMerged(doc,origin,prev,sel){var ch=origin.charAt(0);return ch=="*"||ch=="+"&&prev.ranges.length==sel.ranges.length&&prev.somethingSelected()==sel.somethingSelected()&&new Date-doc.history.lastSelTime<=(doc.cm?doc.cm.options.historyEventDelay:500)}function addSelectionToHistory(doc,sel,opId,options){var hist=doc.history,origin=options&&options.origin;if(opId==hist.lastSelOp||origin&&hist.lastSelOrigin==origin&&(hist.lastModTime==hist.lastSelTime&&hist.lastOrigin==origin||selectionEventCanBeMerged(doc,origin,lst(hist.done),sel)))hist.done[hist.done.length-1]=sel;else pushSelectionToHistory(sel,hist.done);hist.lastSelTime=+new Date;hist.lastSelOrigin=origin;hist.lastSelOp=opId;if(options&&options.clearRedo!==false)clearSelectionEvents(hist.undone)}function pushSelectionToHistory(sel,dest){var top=lst(dest);if(!(top&&top.ranges&&top.equals(sel)))dest.push(sel)}function attachLocalSpans(doc,change,from,to){var existing=change["spans_"+doc.id],n=0;doc.iter(Math.max(doc.first,from),Math.min(doc.first+doc.size,to),function(line){if(line.markedSpans)(existing||(existing=change["spans_"+doc.id]={}))[n]=line.markedSpans;++n})}function removeClearedSpans(spans){if(!spans)return null;for(var i=0,out;i<spans.length;++i){if(spans[i].marker.explicitlyCleared){if(!out)out=spans.slice(0,i)}else if(out)out.push(spans[i])}return!out?spans:out.length?out:null}function getOldSpans(doc,change){var found=change["spans_"+doc.id];if(!found)return null;for(var i=0,nw=[];i<change.text.length;++i)nw.push(removeClearedSpans(found[i]));return nw}function copyHistoryArray(events,newGroup,instantiateSel){for(var i=0,copy=[];i<events.length;++i){var event=events[i];if(event.ranges){copy.push(instantiateSel?Selection.prototype.deepCopy.call(event):event);continue}var changes=event.changes,newChanges=[];copy.push({changes:newChanges});for(var j=0;j<changes.length;++j){var change=changes[j],m;newChanges.push({from:change.from,to:change.to,text:change.text});if(newGroup)for(var prop in change)if(m=prop.match(/^spans_(\d+)$/)){if(indexOf(newGroup,Number(m[1]))>-1){lst(newChanges)[prop]=change[prop];delete change[prop]}}}}return copy}function rebaseHistSelSingle(pos,from,to,diff){if(to<pos.line){pos.line+=diff}else if(from<pos.line){pos.line=from;pos.ch=0}}function rebaseHistArray(array,from,to,diff){for(var i=0;i<array.length;++i){var sub=array[i],ok=true;if(sub.ranges){if(!sub.copied){sub=array[i]=sub.deepCopy();sub.copied=true}for(var j=0;j<sub.ranges.length;j++){rebaseHistSelSingle(sub.ranges[j].anchor,from,to,diff);rebaseHistSelSingle(sub.ranges[j].head,from,to,diff)}continue}for(var j=0;j<sub.changes.length;++j){var cur=sub.changes[j];if(to<cur.from.line){cur.from=Pos(cur.from.line+diff,cur.from.ch);cur.to=Pos(cur.to.line+diff,cur.to.ch)}else if(from<=cur.to.line){ok=false;break}}if(!ok){array.splice(0,i+1);i=0}}}function rebaseHist(hist,change){var from=change.from.line,to=change.to.line,diff=change.text.length-(to-from)-1;rebaseHistArray(hist.done,from,to,diff);rebaseHistArray(hist.undone,from,to,diff)}var e_preventDefault=CodeMirror.e_preventDefault=function(e){if(e.preventDefault)e.preventDefault();else e.returnValue=false};var e_stopPropagation=CodeMirror.e_stopPropagation=function(e){if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true};function e_defaultPrevented(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==false}var e_stop=CodeMirror.e_stop=function(e){e_preventDefault(e);e_stopPropagation(e)};function e_target(e){return e.target||e.srcElement}function e_button(e){var b=e.which;if(b==null){if(e.button&1)b=1;else if(e.button&2)b=3;else if(e.button&4)b=2}if(mac&&e.ctrlKey&&b==1)b=3;return b}var on=CodeMirror.on=function(emitter,type,f){if(emitter.addEventListener)emitter.addEventListener(type,f,false);else if(emitter.attachEvent)emitter.attachEvent("on"+type,f);else{var map=emitter._handlers||(emitter._handlers={});var arr=map[type]||(map[type]=[]);arr.push(f)}};var off=CodeMirror.off=function(emitter,type,f){if(emitter.removeEventListener)emitter.removeEventListener(type,f,false);else if(emitter.detachEvent)emitter.detachEvent("on"+type,f);else{var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;for(var i=0;i<arr.length;++i)if(arr[i]==f){arr.splice(i,1);break}}};var signal=CodeMirror.signal=function(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;var args=Array.prototype.slice.call(arguments,2);for(var i=0;i<arr.length;++i)arr[i].apply(null,args)};var orphanDelayedCallbacks=null;function signalLater(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];if(!arr)return;var args=Array.prototype.slice.call(arguments,2),list;if(operationGroup){list=operationGroup.delayedCallbacks}else if(orphanDelayedCallbacks){list=orphanDelayedCallbacks}else{list=orphanDelayedCallbacks=[];setTimeout(fireOrphanDelayed,0)}function bnd(f){return function(){f.apply(null,args)}}for(var i=0;i<arr.length;++i)list.push(bnd(arr[i]))}function fireOrphanDelayed(){var delayed=orphanDelayedCallbacks;orphanDelayedCallbacks=null;for(var i=0;i<delayed.length;++i)delayed[i]()}function signalDOMEvent(cm,e,override){if(typeof e=="string")e={type:e,preventDefault:function(){this.defaultPrevented=true}};signal(cm,override||e.type,cm,e);return e_defaultPrevented(e)||e.codemirrorIgnore}function signalCursorActivity(cm){var arr=cm._handlers&&cm._handlers.cursorActivity;if(!arr)return;var set=cm.curOp.cursorActivityHandlers||(cm.curOp.cursorActivityHandlers=[]);for(var i=0;i<arr.length;++i)if(indexOf(set,arr[i])==-1)set.push(arr[i])}function hasHandler(emitter,type){var arr=emitter._handlers&&emitter._handlers[type];return arr&&arr.length>0}function eventMixin(ctor){ctor.prototype.on=function(type,f){on(this,type,f)};ctor.prototype.off=function(type,f){off(this,type,f)}}var scrollerCutOff=30;var Pass=CodeMirror.Pass={toString:function(){return"CodeMirror.Pass"}};var sel_dontScroll={scroll:false},sel_mouse={origin:"*mouse"},sel_move={origin:"+move"};function Delayed(){this.id=null}Delayed.prototype.set=function(ms,f){clearTimeout(this.id);this.id=setTimeout(f,ms)};var countColumn=CodeMirror.countColumn=function(string,end,tabSize,startIndex,startValue){if(end==null){end=string.search(/[^\s\u00a0]/);if(end==-1)end=string.length}for(var i=startIndex||0,n=startValue||0;;){var nextTab=string.indexOf("	",i);if(nextTab<0||nextTab>=end)return n+(end-i);n+=nextTab-i;n+=tabSize-n%tabSize;i=nextTab+1}};function findColumn(string,goal,tabSize){for(var pos=0,col=0;;){var nextTab=string.indexOf("	",pos);if(nextTab==-1)nextTab=string.length;var skipped=nextTab-pos;if(nextTab==string.length||col+skipped>=goal)return pos+Math.min(skipped,goal-col);col+=nextTab-pos;col+=tabSize-col%tabSize;pos=nextTab+1;if(col>=goal)return pos}}var spaceStrs=[""];function spaceStr(n){while(spaceStrs.length<=n)spaceStrs.push(lst(spaceStrs)+" ");return spaceStrs[n]}function lst(arr){return arr[arr.length-1]}var selectInput=function(node){node.select()};if(ios)selectInput=function(node){node.selectionStart=0;node.selectionEnd=node.value.length};else if(ie)selectInput=function(node){try{node.select()}catch(_e){}};function indexOf(array,elt){for(var i=0;i<array.length;++i)if(array[i]==elt)return i;return-1}if([].indexOf)indexOf=function(array,elt){return array.indexOf(elt)};function map(array,f){var out=[];for(var i=0;i<array.length;i++)out[i]=f(array[i],i);return out}if([].map)map=function(array,f){return array.map(f)};function createObj(base,props){var inst;if(Object.create){inst=Object.create(base)}else{var ctor=function(){};ctor.prototype=base;inst=new ctor}if(props)copyObj(props,inst);return inst}function copyObj(obj,target,overwrite){if(!target)target={};for(var prop in obj)if(obj.hasOwnProperty(prop)&&(overwrite!==false||!target.hasOwnProperty(prop)))target[prop]=obj[prop];return target}function bind(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}}var nonASCIISingleCaseWordChar=/[\u00df\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var isWordCharBasic=CodeMirror.isWordChar=function(ch){return/\w/.test(ch)||ch>""&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch))};function isWordChar(ch,helper){if(!helper)return isWordCharBasic(ch);if(helper.source.indexOf("\\w")>-1&&isWordCharBasic(ch))return true;return helper.test(ch)}function isEmpty(obj){for(var n in obj)if(obj.hasOwnProperty(n)&&obj[n])return false;return true}var extendingChars=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function isExtendingChar(ch){return ch.charCodeAt(0)>=768&&extendingChars.test(ch)}function elt(tag,content,className,style){var e=document.createElement(tag);if(className)e.className=className;if(style)e.style.cssText=style;if(typeof content=="string")e.appendChild(document.createTextNode(content));else if(content)for(var i=0;i<content.length;++i)e.appendChild(content[i]);return e}var range;if(document.createRange)range=function(node,start,end){var r=document.createRange();r.setEnd(node,end);r.setStart(node,start);return r};else range=function(node,start,end){var r=document.body.createTextRange();try{r.moveToElementText(node.parentNode)}catch(e){return r}r.collapse(true);r.moveEnd("character",end);r.moveStart("character",start);return r};function removeChildren(e){for(var count=e.childNodes.length;count>0;--count)e.removeChild(e.firstChild);return e}function removeChildrenAndAdd(parent,e){return removeChildren(parent).appendChild(e)}function contains(parent,child){if(parent.contains)return parent.contains(child);while(child=child.parentNode)if(child==parent)return true}function activeElt(){return document.activeElement;
}if(ie&&ie_version<11)activeElt=function(){try{return document.activeElement}catch(e){return document.body}};function classTest(cls){return new RegExp("(^|\\s)"+cls+"(?:$|\\s)\\s*")}var rmClass=CodeMirror.rmClass=function(node,cls){var current=node.className;var match=classTest(cls).exec(current);if(match){var after=current.slice(match.index+match[0].length);node.className=current.slice(0,match.index)+(after?match[1]+after:"")}};var addClass=CodeMirror.addClass=function(node,cls){var current=node.className;if(!classTest(cls).test(current))node.className+=(current?" ":"")+cls};function joinClasses(a,b){var as=a.split(" ");for(var i=0;i<as.length;i++)if(as[i]&&!classTest(as[i]).test(b))b+=" "+as[i];return b}function forEachCodeMirror(f){if(!document.body.getElementsByClassName)return;var byClass=document.body.getElementsByClassName("CodeMirror");for(var i=0;i<byClass.length;i++){var cm=byClass[i].CodeMirror;if(cm)f(cm)}}var globalsRegistered=false;function ensureGlobalHandlers(){if(globalsRegistered)return;registerGlobalHandlers();globalsRegistered=true}function registerGlobalHandlers(){var resizeTimer;on(window,"resize",function(){if(resizeTimer==null)resizeTimer=setTimeout(function(){resizeTimer=null;knownScrollbarWidth=null;forEachCodeMirror(onResize)},100)});on(window,"blur",function(){forEachCodeMirror(onBlur)})}var dragAndDrop=function(){if(ie&&ie_version<9)return false;var div=elt("div");return"draggable"in div||"dragDrop"in div}();var knownScrollbarWidth;function scrollbarWidth(measure){if(knownScrollbarWidth!=null)return knownScrollbarWidth;var test=elt("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");removeChildrenAndAdd(measure,test);if(test.offsetWidth)knownScrollbarWidth=test.offsetHeight-test.clientHeight;return knownScrollbarWidth||0}var zwspSupported;function zeroWidthElement(measure){if(zwspSupported==null){var test=elt("span","");removeChildrenAndAdd(measure,elt("span",[test,document.createTextNode("x")]));if(measure.firstChild.offsetHeight!=0)zwspSupported=test.offsetWidth<=1&&test.offsetHeight>2&&!(ie&&ie_version<8)}if(zwspSupported)return elt("span","");else return elt("span","",null,"display: inline-block; width: 1px; margin-right: -1px")}var badBidiRects;function hasBadBidiRects(measure){if(badBidiRects!=null)return badBidiRects;var txt=removeChildrenAndAdd(measure,document.createTextNode("AA"));var r0=range(txt,0,1).getBoundingClientRect();if(!r0||r0.left==r0.right)return false;var r1=range(txt,1,2).getBoundingClientRect();return badBidiRects=r1.right-r0.right<3}var splitLines=CodeMirror.splitLines="\n\nb".split(/\n/).length!=3?function(string){var pos=0,result=[],l=string.length;while(pos<=l){var nl=string.indexOf("\n",pos);if(nl==-1)nl=string.length;var line=string.slice(pos,string.charAt(nl-1)=="\r"?nl-1:nl);var rt=line.indexOf("\r");if(rt!=-1){result.push(line.slice(0,rt));pos+=rt+1}else{result.push(line);pos=nl+1}}return result}:function(string){return string.split(/\r\n?|\n/)};var hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd}catch(e){return false}}:function(te){try{var range=te.ownerDocument.selection.createRange()}catch(e){}if(!range||range.parentElement()!=te)return false;return range.compareEndPoints("StartToEnd",range)!=0};var hasCopyEvent=function(){var e=elt("div");if("oncopy"in e)return true;e.setAttribute("oncopy","return;");return typeof e.oncopy=="function"}();var badZoomedRects=null;function hasBadZoomedRects(measure){if(badZoomedRects!=null)return badZoomedRects;var node=removeChildrenAndAdd(measure,elt("span","x"));var normal=node.getBoundingClientRect();var fromRange=range(node,0,1).getBoundingClientRect();return badZoomedRects=Math.abs(normal.left-fromRange.left)>1}var keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};CodeMirror.keyNames=keyNames;(function(){for(var i=0;i<10;i++)keyNames[i+48]=keyNames[i+96]=String(i);for(var i=65;i<=90;i++)keyNames[i]=String.fromCharCode(i);for(var i=1;i<=12;i++)keyNames[i+111]=keyNames[i+63235]="F"+i})();function iterateBidiSections(order,from,to,f){if(!order)return f(from,to,"ltr");var found=false;for(var i=0;i<order.length;++i){var part=order[i];if(part.from<to&&part.to>from||from==to&&part.to==from){f(Math.max(part.from,from),Math.min(part.to,to),part.level==1?"rtl":"ltr");found=true}}if(!found)f(from,to,"ltr")}function bidiLeft(part){return part.level%2?part.to:part.from}function bidiRight(part){return part.level%2?part.from:part.to}function lineLeft(line){var order=getOrder(line);return order?bidiLeft(order[0]):0}function lineRight(line){var order=getOrder(line);if(!order)return line.text.length;return bidiRight(lst(order))}function lineStart(cm,lineN){var line=getLine(cm.doc,lineN);var visual=visualLine(line);if(visual!=line)lineN=lineNo(visual);var order=getOrder(visual);var ch=!order?0:order[0].level%2?lineRight(visual):lineLeft(visual);return Pos(lineN,ch)}function lineEnd(cm,lineN){var merged,line=getLine(cm.doc,lineN);while(merged=collapsedSpanAtEnd(line)){line=merged.find(1,true).line;lineN=null}var order=getOrder(line);var ch=!order?line.text.length:order[0].level%2?lineLeft(line):lineRight(line);return Pos(lineN==null?lineNo(line):lineN,ch)}function lineStartSmart(cm,pos){var start=lineStart(cm,pos.line);var line=getLine(cm.doc,start.line);var order=getOrder(line);if(!order||order[0].level==0){var firstNonWS=Math.max(0,line.text.search(/\S/));var inWS=pos.line==start.line&&pos.ch<=firstNonWS&&pos.ch;return Pos(start.line,inWS?0:firstNonWS)}return start}function compareBidiLevel(order,a,b){var linedir=order[0].level;if(a==linedir)return true;if(b==linedir)return false;return a<b}var bidiOther;function getBidiPartAt(order,pos){bidiOther=null;for(var i=0,found;i<order.length;++i){var cur=order[i];if(cur.from<pos&&cur.to>pos)return i;if(cur.from==pos||cur.to==pos){if(found==null){found=i}else if(compareBidiLevel(order,cur.level,order[found].level)){if(cur.from!=cur.to)bidiOther=found;return i}else{if(cur.from!=cur.to)bidiOther=i;return found}}}return found}function moveInLine(line,pos,dir,byUnit){if(!byUnit)return pos+dir;do pos+=dir;while(pos>0&&isExtendingChar(line.text.charAt(pos)));return pos}function moveVisually(line,start,dir,byUnit){var bidi=getOrder(line);if(!bidi)return moveLogically(line,start,dir,byUnit);var pos=getBidiPartAt(bidi,start),part=bidi[pos];var target=moveInLine(line,start,part.level%2?-dir:dir,byUnit);for(;;){if(target>part.from&&target<part.to)return target;if(target==part.from||target==part.to){if(getBidiPartAt(bidi,target)==pos)return target;part=bidi[pos+=dir];return dir>0==part.level%2?part.to:part.from}else{part=bidi[pos+=dir];if(!part)return null;if(dir>0==part.level%2)target=moveInLine(line,part.to,-1,byUnit);else target=moveInLine(line,part.from,1,byUnit)}}}function moveLogically(line,start,dir,byUnit){var target=start+dir;if(byUnit)while(target>0&&isExtendingChar(line.text.charAt(target)))target+=dir;return target<0||target>line.text.length?null:target}var bidiOrdering=function(){var lowTypes="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var arabicTypes="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";function charType(code){if(code<=247)return lowTypes.charAt(code);else if(1424<=code&&code<=1524)return"R";else if(1536<=code&&code<=1773)return arabicTypes.charAt(code-1536);else if(1774<=code&&code<=2220)return"r";else if(8192<=code&&code<=8203)return"w";else if(code==8204)return"b";else return"L"}var bidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var isNeutral=/[stwN]/,isStrong=/[LRr]/,countsAsLeft=/[Lb1n]/,countsAsNum=/[1n]/;var outerType="L";function BidiSpan(level,from,to){this.level=level;this.from=from;this.to=to}return function(str){if(!bidiRE.test(str))return false;var len=str.length,types=[];for(var i=0,type;i<len;++i)types.push(type=charType(str.charCodeAt(i)));for(var i=0,prev=outerType;i<len;++i){var type=types[i];if(type=="m")types[i]=prev;else prev=type}for(var i=0,cur=outerType;i<len;++i){var type=types[i];if(type=="1"&&cur=="r")types[i]="n";else if(isStrong.test(type)){cur=type;if(type=="r")types[i]="R"}}for(var i=1,prev=types[0];i<len-1;++i){var type=types[i];if(type=="+"&&prev=="1"&&types[i+1]=="1")types[i]="1";else if(type==","&&prev==types[i+1]&&(prev=="1"||prev=="n"))types[i]=prev;prev=type}for(var i=0;i<len;++i){var type=types[i];if(type==",")types[i]="N";else if(type=="%"){for(var end=i+1;end<len&&types[end]=="%";++end){}var replace=i&&types[i-1]=="!"||end<len&&types[end]=="1"?"1":"N";for(var j=i;j<end;++j)types[j]=replace;i=end-1}}for(var i=0,cur=outerType;i<len;++i){var type=types[i];if(cur=="L"&&type=="1")types[i]="L";else if(isStrong.test(type))cur=type}for(var i=0;i<len;++i){if(isNeutral.test(types[i])){for(var end=i+1;end<len&&isNeutral.test(types[end]);++end){}var before=(i?types[i-1]:outerType)=="L";var after=(end<len?types[end]:outerType)=="L";var replace=before||after?"L":"R";for(var j=i;j<end;++j)types[j]=replace;i=end-1}}var order=[],m;for(var i=0;i<len;){if(countsAsLeft.test(types[i])){var start=i;for(++i;i<len&&countsAsLeft.test(types[i]);++i){}order.push(new BidiSpan(0,start,i))}else{var pos=i,at=order.length;for(++i;i<len&&types[i]!="L";++i){}for(var j=pos;j<i;){if(countsAsNum.test(types[j])){if(pos<j)order.splice(at,0,new BidiSpan(1,pos,j));var nstart=j;for(++j;j<i&&countsAsNum.test(types[j]);++j){}order.splice(at,0,new BidiSpan(2,nstart,j));pos=j}else++j}if(pos<i)order.splice(at,0,new BidiSpan(1,pos,i))}}if(order[0].level==1&&(m=str.match(/^\s+/))){order[0].from=m[0].length;order.unshift(new BidiSpan(0,0,m[0].length))}if(lst(order).level==1&&(m=str.match(/\s+$/))){lst(order).to-=m[0].length;order.push(new BidiSpan(0,len-m[0].length,len))}if(order[0].level!=lst(order).level)order.push(new BidiSpan(order[0].level,len,len));return order}}();CodeMirror.cleanup=function(){var d=this.display;var view=this.display.view;for(var i=0,j=view.length;i<j;i++){view[i].lineNumber=null;view[i].gutter=null;view[i].line.parent=null;view[i].line=null;view[i].measure=null;view[i].node=null;view[i].text=null;view[i].parent=null}measureText=null;d.wrapper=null;d.doc=null;d.input=null;d.maxLine=null;d.inputDiv=null;d.scrollbarH=null;d.scrollbarV=null;d.scrollbarFiller=null;d.gutterFiller=null;d.lineDiv=null;d.selectionDiv=null;d.cursorDiv=null;d.measure=null;d.lineMeasure=null;d.lineSpace=null;d.mover=null;d.sizer=null;d.heightForcer=null;d.gutters=null;d.lineGutter=null;d.scroller=null;d.wrapper=null;this.display=null;this.doc=null;this.state=null;d=view=null};CodeMirror.version="4.8.0";return CodeMirror});(function(){CodeMirror.switchSlackMode=function(editor,mode){var type_map={php:["php","application/x-httpd-php"],sql:["sql","text/x-sql"],mysql:["sql","text/x-mysql"],html:["htmlmixed","text/html"],javascript:["javascript","text/javascript"],markdown:["markdown","text/x-markdown"],c:["clike","text/x-csrc"],cpp:["clike","text/x-c++src"],csharp:["clike","text/x-csharp"],vb:["vb","text/x-vb"],vbscript:["vbscript","text/vbscript"],java:["clike","text/x-java"],css:["css","text/css"],perl:["perl","text/x-perl"],python:["python","text/x-python"],ruby:["ruby","text/x-ruby"],erlang:["erlang","text/x-erlang"],diff:["diff","text/x-diff"],xml:["xml","text/xml"],coffeescript:["coffeescript","text/x-coffeescript"],clojure:["clojure","text/x-clojure"],scheme:["scheme","text/x-scheme"],haskell:["haskell","text/x-haskell"],scala:["clike","text/x-scala"],shell:["shell","text/x-sh"],go:["go","text/x-go"],groovy:["groovy","text/x-groovy"],yaml:["yaml","text/x-yaml"],lua:["lua","text/x-lua"],matlab:["octave","text/x-octave"],r:["r","text/x-rsrc"],puppet:["puppet","text/x-puppet"],smalltalk:["smalltalk","text/x-stsrc"],latex:["stex","text/x-stex"],objc:["clike","text/x-objectivec"]};if(type_map[mode]){editor.setOption("mode",type_map[mode][1]);CodeMirror.autoLoadMode(editor,type_map[mode][0])}else{editor.setOption("mode",null)}};function codemirror_map(file){switch(file){case"apl":return cdn_url+"/62b3/js/libs/codemirror/apl.js";case"asterisk":return cdn_url+"/aec9/js/libs/codemirror/asterisk.js";case"clike":return cdn_url+"/a13a/js/libs/codemirror/clike.js";case"clojure":return cdn_url+"/b6a7/js/libs/codemirror/clojure.js";case"cobol":return cdn_url+"/e457/js/libs/codemirror/cobol.js";case"coffeescript":return cdn_url+"/e077/js/libs/codemirror/coffeescript.js";case"commonlisp":return cdn_url+"/c712/js/libs/codemirror/commonlisp.js";case"css":return cdn_url+"/def2/js/libs/codemirror/css.js";case"cypher":return cdn_url+"/aa98/js/libs/codemirror/cypher.js";case"d":return cdn_url+"/1cda/js/libs/codemirror/d.js";case"diff":return cdn_url+"/5f39/js/libs/codemirror/diff.js";case"django":return cdn_url+"/25cc/js/libs/codemirror/django.js";case"dockerfile":return cdn_url+"/8fd3/js/libs/codemirror/dockerfile.js";case"dtd":return cdn_url+"/aadf/js/libs/codemirror/dtd.js";case"dylan":return cdn_url+"/81de/js/libs/codemirror/dylan.js";case"ecl":return cdn_url+"/6bf4/js/libs/codemirror/ecl.js";case"eiffel":return cdn_url+"/f7a8/js/libs/codemirror/eiffel.js";case"erlang":return cdn_url+"/9e1a/js/libs/codemirror/erlang.js";case"fortran":return cdn_url+"/4cd8/js/libs/codemirror/fortran.js";case"gas":return cdn_url+"/fb60/js/libs/codemirror/gas.js";case"gfm":return cdn_url+"/55ab/js/libs/codemirror/gfm.js";case"gherkin":return cdn_url+"/1731/js/libs/codemirror/gherkin.js";case"go":return cdn_url+"/81a5/js/libs/codemirror/go.js";case"groovy":return cdn_url+"/aeb7/js/libs/codemirror/groovy.js";case"haml":return cdn_url+"/2ab9/js/libs/codemirror/haml.js";case"haskell":return cdn_url+"/4890/js/libs/codemirror/haskell.js";case"haxe":return cdn_url+"/c205/js/libs/codemirror/haxe.js";case"htmlembedded":return cdn_url+"/82ef/js/libs/codemirror/htmlembedded.js";case"htmlmixed":return cdn_url+"/9ddc/js/libs/codemirror/htmlmixed.js";case"http":return cdn_url+"/b911/js/libs/codemirror/http.js";case"idl":return cdn_url+"/2678/js/libs/codemirror/idl.js";case"jade":return cdn_url+"/c50e/js/libs/codemirror/jade.js";case"javascript":return cdn_url+"/fe22/js/libs/codemirror/javascript.js";case"jinja2":return cdn_url+"/d7c1/js/libs/codemirror/jinja2.js";case"julia":return cdn_url+"/abd0/js/libs/codemirror/julia.js";case"kotlin":return cdn_url+"/95b4/js/libs/codemirror/kotlin.js";case"livescript":return cdn_url+"/57ed/js/libs/codemirror/livescript.js";case"lua":return cdn_url+"/d291/js/libs/codemirror/lua.js";case"markdown":return cdn_url+"/aba4/js/libs/codemirror/markdown.js";case"mirc":return cdn_url+"/bdf0/js/libs/codemirror/mirc.js";case"mllike":return cdn_url+"/de4e/js/libs/codemirror/mllike.js";case"modelica":return cdn_url+"/08a91/js/libs/codemirror/modelica.js";case"nginx":return cdn_url+"/171c/js/libs/codemirror/nginx.js";case"ntriples":return cdn_url+"/3946/js/libs/codemirror/ntriples.js";case"octave":return cdn_url+"/cf67/js/libs/codemirror/octave.js";case"pascal":return cdn_url+"/df9e/js/libs/codemirror/pascal.js";case"pegjs":return cdn_url+"/2d1d/js/libs/codemirror/pegjs.js";case"perl":return cdn_url+"/ddc2/js/libs/codemirror/perl.js";case"php":return cdn_url+"/2da3/js/libs/codemirror/php.js";case"pig":return cdn_url+"/d4bd/js/libs/codemirror/pig.js";case"properties":return cdn_url+"/b5e4/js/libs/codemirror/properties.js";case"puppet":return cdn_url+"/4445/js/libs/codemirror/puppet.js";case"python":return cdn_url+"/7e01/js/libs/codemirror/python.js";case"q":return cdn_url+"/6912/js/libs/codemirror/q.js";case"r":return cdn_url+"/f25f/js/libs/codemirror/r.js";case"rpm":return cdn_url+"/33de/js/libs/codemirror/rpm.js";case"rst":return cdn_url+"/4792/js/libs/codemirror/rst.js";case"ruby":return cdn_url+"/558f/js/libs/codemirror/ruby.js";case"rust":return cdn_url+"/b945/js/libs/codemirror/rust.js";case"sass":return cdn_url+"/b9c0/js/libs/codemirror/sass.js";case"scheme":return cdn_url+"/8e42/js/libs/codemirror/scheme.js";case"shell":return cdn_url+"/7484/js/libs/codemirror/shell.js";case"sieve":return cdn_url+"/774e/js/libs/codemirror/sieve.js";case"slim":return cdn_url+"/9647/js/libs/codemirror/slim.js";case"smalltalk":return cdn_url+"/0918/js/libs/codemirror/smalltalk.js";case"smarty":return cdn_url+"/548a/js/libs/codemirror/smarty.js";case"smartymixed":return cdn_url+"/40d8/js/libs/codemirror/smartymixed.js";case"solr":return cdn_url+"/c6f4/js/libs/codemirror/solr.js";case"sparql":return cdn_url+"/a1c7/js/libs/codemirror/sparql.js";case"sql":return cdn_url+"/6660/js/libs/codemirror/sql.js";case"stex":return cdn_url+"/b178/js/libs/codemirror/stex.js";case"tcl":return cdn_url+"/98d9/js/libs/codemirror/tcl.js";case"textile":return cdn_url+"/5755/js/libs/codemirror/textile.js";case"tiddlywiki":return cdn_url+"/5f7e/js/libs/codemirror/tiddlywiki.js";case"tiki":return cdn_url+"/6876/js/libs/codemirror/tiki.js";case"toml":return cdn_url+"/4596/js/libs/codemirror/toml.js";case"tornado":return cdn_url+"/cd62/js/libs/codemirror/tornado.js";case"turtle":return cdn_url+"/9538/js/libs/codemirror/turtle.js";case"vb":return cdn_url+"/c2b2/js/libs/codemirror/vb.js";case"vbscript":return cdn_url+"/6553/js/libs/codemirror/vbscript.js";case"velocity":return cdn_url+"/cc3e/js/libs/codemirror/velocity.js";case"verilog":return cdn_url+"/d38a/js/libs/codemirror/verilog.js";case"xml":return cdn_url+"/b474f/js/libs/codemirror/xml.js";case"xquery":return cdn_url+"/ef72/js/libs/codemirror/xquery.js";case"yaml":return cdn_url+"/3f7c/js/libs/codemirror/yaml.js";case"z80":return cdn_url+"/48d4/js/libs/codemirror/z80.js"}return null}var loading={};function splitCallback(cont,n){var countDown=n;return function(){if(--countDown==0)cont()}}function ensureDeps(mode,cont){var deps=CodeMirror.modes[mode].dependencies;if(!deps)return cont();var missing=[];for(var i=0;i<deps.length;++i){if(!CodeMirror.modes.hasOwnProperty(deps[i]))missing.push(deps[i])}if(!missing.length)return cont();var split=splitCallback(cont,missing.length);for(var i=0;i<missing.length;++i)CodeMirror.requireMode(missing[i],split)}CodeMirror.requireMode=function(mode,cont){if(typeof mode!="string")mode=mode.name;if(CodeMirror.modes.hasOwnProperty(mode))return ensureDeps(mode,cont);if(loading.hasOwnProperty(mode))return loading[mode].push(cont);var script=document.createElement("script");script.src=codemirror_map(mode);var others=document.getElementsByTagName("script")[0];others.parentNode.insertBefore(script,others);var list=loading[mode]=[cont];var count=0,poll=setInterval(function(){if(++count>100)return clearInterval(poll);if(CodeMirror.modes.hasOwnProperty(mode)){clearInterval(poll);loading[mode]=null;ensureDeps(mode,function(){for(var i=0;i<list.length;++i)list[i]()})}},200)};CodeMirror.autoLoadMode=function(instance,mode){if(!CodeMirror.modes.hasOwnProperty(mode))CodeMirror.requireMode(mode,function(){instance.setOption("mode",instance.getOption("mode"))})}})();(function($hx_exports){"use strict";var EReg=function(r,opt){opt=opt.split("u").join("");this.r=new RegExp(r,opt)};EReg.__name__=true;EReg.prototype={match:function(s){if(this.r.global)this.r.lastIndex=0;this.r.m=this.r.exec(s);this.r.s=s;return this.r.m!=null},matched:function(n){if(this.r.m!=null&&n>=0&&n<this.r.m.length)return this.r.m[n];else throw"EReg::matched"},matchedPos:function(){if(this.r.m==null)throw"No string matched";return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(s,pos,len){if(len==null)len=-1;if(this.r.global){this.r.lastIndex=pos;this.r.m=this.r.exec(len<0?s:HxOverrides.substr(s,0,pos+len));var b=this.r.m!=null;if(b)this.r.s=s;return b}else{var b1=this.match(len<0?HxOverrides.substr(s,pos,null):HxOverrides.substr(s,pos,len));if(b1){this.r.s=s;this.r.m.index+=pos}return b1}},replace:function(s,by){return s.replace(this.r,by)},map:function(s,f){var offset=0;var buf=new StringBuf;do{if(offset>=s.length)break;else if(!this.matchSub(s,offset)){buf.add(HxOverrides.substr(s,offset,null));break}var p=this.matchedPos();buf.add(HxOverrides.substr(s,offset,p.pos-offset));buf.add(f(this));if(p.len==0){buf.add(HxOverrides.substr(s,p.pos,1));offset=p.pos+1}else offset=p.pos+p.len}while(this.r.global);if(!this.r.global&&offset>0&&offset<s.length)buf.add(HxOverrides.substr(s,offset,null));return buf.b}};var HxOverrides=function(){};HxOverrides.__name__=true;HxOverrides.cca=function(s,index){var x=s.charCodeAt(index);if(x!=x)return undefined;return x};HxOverrides.substr=function(s,pos,len){if(pos!=null&&pos!=0&&len!=null&&len<0)return"";if(len==null)len=s.length;if(pos<0){pos=s.length+pos;if(pos<0)pos=0}else if(len<0)len=s.length+len-pos;return s.substr(pos,len)};Math.__name__=true;var Std=function(){};Std.__name__=true;Std.string=function(s){return js.Boot.__string_rec(s,"")};var StringBuf=function(){this.b=""};StringBuf.__name__=true;StringBuf.prototype={add:function(x){this.b+=Std.string(x)}};var StringTools=function(){};StringTools.__name__=true;StringTools.isSpace=function(s,pos){var c=HxOverrides.cca(s,pos);return c>8&&c<14||c==32};StringTools.ltrim=function(s){var l=s.length;var r=0;while(r<l&&StringTools.isSpace(s,r))r++;if(r>0)return HxOverrides.substr(s,r,l-r);else return s};StringTools.rtrim=function(s){var l=s.length;var r=0;while(r<l&&StringTools.isSpace(s,l-r-1))r++;if(r>0)return HxOverrides.substr(s,0,l-r);else return s};StringTools.trim=function(s){return StringTools.ltrim(StringTools.rtrim(s))};StringTools.replace=function(s,sub,by){return s.split(sub).join(by)};var TSF=$hx_exports.TSF=function(){};TSF.__name__=true;TSF.main=function(){var baseA=TSF.placeholder_base.split("");baseA.sort(function(a,b){return Math.round(5-Math.random()*10)});TSF.placeholder_base=baseA.join("");console.log(TSF.test())};TSF.getTokensArray=function(str,mode){var new_txt=TSF.getTokensString(str,mode);var start_pos=0;var A=[];var before;new EReg("<(.*?)>","g").map(new_txt,function(r){var m=r.matched(0);var pos=r.matchedPos();if(pos.pos!=start_pos){before=HxOverrides.substr(new_txt,start_pos,pos.pos-start_pos);A.push(before)}A.push(m);start_pos=pos.pos+pos.len;return m});var last_str=HxOverrides.substr(new_txt,start_pos,null);if(last_str!="")A.push(last_str);if(A.join("")!=new_txt){console.log("---------------------------------------------------------------");console.log("new_txt:"+new_txt);console.log("A.join: "+A.join(""));console.log("A:      "+Std.string(A));console.log("---------------------------------------------------------------")}return A};TSF.getTokensString=function(str,mode){if(mode=="EDIT"||mode=="GROWL"||mode=="NOMRKDWN"||mode=="NORMAL")TSF.mode=mode;else return"UNRECOGNIZED MODE:"+mode;var new_txt=StringTools.trim(str);if(new_txt.length==0)return"";var markup_placeholder_map=[];var emoji_placeholder_map=[];new_txt=TSF.doMarkup(new_txt,markup_placeholder_map,emoji_placeholder_map);if(TSF.mode=="GROWL"||TSF.mode=="EDIT"){}else if(TSF.mode=="NORMAL"||TSF.mode=="NOMRKDWN"){new_txt=new EReg("<","g").replace(new_txt,"&lt;");new_txt=new EReg(">","g").replace(new_txt,"&gt;");var special_placeholder_map=[];if(TSF.mode!="NOMRKDWN")new_txt=TSF.doSpecials(new_txt,special_placeholder_map);new_txt=TSF.doEmoji(new_txt,emoji_placeholder_map);new_txt=new EReg("(\\W|^)(#[A-Fa-f0-9]{6})(\\b)","g").map(new_txt,function(r){var m=r.matched(0);var s1=r.matched(1);var s2=r.matched(2);var s3=r.matched(3);return s1+s2+"<HEX:BLOCK "+s2+">"+s3});new_txt=TSF.swapOutPlaceholders(special_placeholder_map,new_txt);special_placeholder_map=null;new_txt=new EReg("<QUOTE:END>\n","g").replace(new_txt,TSF.QUOTE_END);new_txt=new EReg("<PRE:END>\n","g").replace(new_txt,TSF.PRE_END);new_txt=new EReg("<CODE:START> ","g").replace(new_txt,TSF.CODE_START+TSF.SPACE_HARD);new_txt=new EReg(" <CODE:END>","g").replace(new_txt,TSF.SPACE_HARD+TSF.CODE_END);new_txt=new EReg("&nbsp;&nbsp;","g").replace(new_txt," "+TSF.LINE_BREAK);new_txt=new EReg("\n\r\n\r","g").replace(new_txt,TSF.PARA_BREAK);new_txt=new EReg("\n\r\n","g").replace(new_txt,TSF.PARA_BREAK);new_txt=new EReg("\n\n","g").replace(new_txt,TSF.PARA_BREAK);new_txt=new EReg("\n","g").replace(new_txt,TSF.LINE_BREAK);new_txt=new EReg("	","g").replace(new_txt,TSF.SPACE_HARD+TSF.SPACE_HARD+TSF.SPACE_HARD+TSF.SPACE_HARD);new_txt=new EReg("  ","g").replace(new_txt," "+TSF.SPACE_HARD);new_txt=new EReg("^ ","g").replace(new_txt,TSF.SPACE_HARD)}new_txt=TSF.swapOutPlaceholders(markup_placeholder_map,new_txt);markup_placeholder_map=null;new_txt=TSF.swapOutPlaceholders(emoji_placeholder_map,new_txt);emoji_placeholder_map=null;return new_txt};TSF.test=function(){TSF.setUpTests();var ret=TSF.runTests();return ret};TSF.doEmoji=function(str,map){str=new EReg(":[a-zA-Z0-9-_+]+:(:skin-tone-[2-6]:)?","g").map(str,function(r){var m=r.matched(0);return TSF.placeholdStr(map,"<EMOJI:COLONS "+m+">")});return str};TSF.doMarkup=function(str,map,emoji_map){str=new EReg("<(.*?)>","g").map(str,function(r){var m=r.matched(0);var s1=r.matched(1);var prefix=HxOverrides.substr(s1,0,1);if(prefix=="#")return TSF.placeholdStr(map,m);if(prefix=="@")return TSF.placeholdStr(map,m);if(prefix=="!")return TSF.placeholdStr(map,m);if(prefix=="%")return TSF.placeholdStr(map,m);var a=s1.split("|");var url=a.shift();url=new EReg('"',"g").replace(url,"&quot;");var label=a.join("|");if(label=="")label=url;label=StringTools.trim(label);if(url.indexOf("<")==0){var safe=s1;safe=new EReg("<","g").replace(safe,"&lt;");safe=new EReg(">","g").replace(safe,"&gt;");safe="&lt;"+safe+"&gt;";return TSF.placeholdStr(map,safe)}label=new EReg("<","g").replace(label,"&lt;");label=new EReg(">","g").replace(label,"&gt;");if(TSF.mode=="GROWL"){if(label==url){var display_url;if(url.indexOf("//")>-1)display_url=url.split("//")[1];else display_url=url;display_url=StringTools.trim(display_url);display_url=display_url.substring(0,30);display_url=StringTools.trim(display_url);return display_url+"..."}return"&lt;"+label+"&gt;"}else if(TSF.mode=="EDIT")return label;else if(TSF.mode=="NORMAL"||TSF.mode=="NOMRKDWN"){if(TSF.mode!="NOMRKDWN"&&label!=url)label=TSF.doSpecials(label,map);label=TSF.doEmoji(label,emoji_map)}return TSF.placeholdStr(map,"<LINK:START "+url+">"+label+TSF.LINK_END)});return str};TSF.doSpecials=function(str,map){str=TSF.pre_rx.map(str,function(r){var m=r.matched(0);var s1=r.matched(1);var s2=r.matched(2);if(s2==null||s2=="")return m;if(HxOverrides.substr(s2,0,1)=="\n")s2=HxOverrides.substr(s2,1,null);s2=TSF.encodeForPre(s2);return s1+TSF.PRE_START+TSF.placeholdStr(map,s2)+TSF.PRE_END});str=TSF.code_rx.map(str,function(r1){var m1=r1.matched(0);var s11=r1.matched(1);var s21=r1.matched(2);if(s21==""||s21==null||HxOverrides.substr(s21,0,1)=="`"||HxOverrides.substr(s21,s21.length-1,1)=="`"||new EReg("<PRE:START>","g").match(s21)&&new EReg("<PRE:END>","g").match(s21))return m1;return s11+TSF.CODE_START+TSF.placeholdStr(map,s21)+TSF.CODE_END});str=TSF.i_rx.map(str,function(r2){var m2=r2.matched(0);var s12=r2.matched(1);var s22=r2.matched(2);if(s22==""||s22==null||!new EReg("[^_*`~]","").match(s22)||HxOverrides.substr(s22,0,1)=="_"||HxOverrides.substr(s22,s22.length-1,1)=="_")return m2;return s12+TSF.I_START+TSF.doSpecials(s22,map)+TSF.I_END});str=TSF.bold_rx.map(str,function(r3){var m3=r3.matched(0);var s13=r3.matched(1);var s23=r3.matched(2);if(s23==""||s23==null||!new EReg("[^_*`~]","").match(s23)||HxOverrides.substr(s23,0,1)=="*"||HxOverrides.substr(s23,s23.length-1,1)=="*"||HxOverrides.substr(s23,0,1)==" "&&HxOverrides.substr(s23,s23.length-1,1)==" ")return m3;return s13+TSF.B_START+TSF.doSpecials(s23,map)+TSF.B_END});str=TSF.strike_rx.map(str,function(r4){var m4=r4.matched(0);var s14=r4.matched(1);var s24=r4.matched(2);if(s24==""||s24==null||!new EReg("[^_*`~]","").match(s24)||HxOverrides.substr(s24,0,1)=="~"||HxOverrides.substr(s24,s24.length-1,1)=="~"||HxOverrides.substr(s24,0,1)==" "&&HxOverrides.substr(s24,s24.length-1,1)==" ")return m4;return s14+TSF.STRIKE_START+TSF.doSpecials(s24,map)+TSF.STRIKE_END});str=TSF.long_quote_rx.map(str,function(r5){var m5=r5.matched(0);var s15=r5.matched(1);var s25=r5.matched(2);if(m5=="&gt;&gt;&gt;")return"&gt;&gt;&gt;";s25=new EReg("^([\\s]*)(&gt;)*","").map(s25,function(r6){var mb=r6.matched(0);var s2b=r6.matched(2);if(s2b!=""&&s2b!=null)return mb;return""});return TSF.QUOTE_START+TSF.LONGQUOTE_PREFIX+s25+TSF.QUOTE_END});str=TSF.quote_rx.map(str,function(r7){var m6=r7.matched(0);var s16=r7.matched(1);var s26=r7.matched(2);if(m6=="&gt;")return m6;s26=new EReg("\n&gt;","g").replace(s26,"\n"+TSF.QUOTE_PREFIX);return TSF.QUOTE_START+TSF.QUOTE_PREFIX+s26+TSF.QUOTE_END});return str};TSF.placeholdStr=function(map,str){if(str==null||str=="")return"";var nl;if(str.indexOf("\n")==0)nl="\n";else nl="";var placeholder=nl+TSF.placeholder_base+TSF.placeholder_cnt++ +"-";map.push({str:str,placeholder:placeholder});return placeholder};TSF.swapOutPlaceholders=function(map,str){var i=map.length;while(--i>=0){var item=map[i];str=StringTools.replace(str,item.placeholder,new EReg("\\$","g").replace(item.str,"$"+"$"))}return str};TSF.encodeForPre=function(txt){if(txt==null)txt="";else txt=txt;txt=new EReg("<","g").replace(txt,"&lt;");txt=new EReg(">","g").replace(txt,"&gt;");txt=new EReg("\n","g").replace(txt,TSF.LINE_BREAK);return txt};TSF.runTests=function(){var ret="";var passed_ret="";var failed_ret="";var expected;var result;var result_joined;var passed=0;var failed=0;var test;var last=TSF.tests.length;ret+="running "+last+" of "+TSF.tests.length+" tests"+"\n\n\n";var _g=0;while(_g<last){var i=_g++;test=TSF.tests[i];expected=test.tokens.join("");result=TSF.getTokensString(test.text,"NORMAL");result_joined=TSF.getTokensArray(test.text,"NORMAL").join("");if(expected==result&&result_joined==result){passed++;passed_ret+="---------------------------------------------------- #"+(i+1)+" PASS"+"\n";passed_ret+="test.text:     "+test.text+"\n";passed_ret+="expected:      "+expected+"\n";passed_ret+="result:        "+result+"\n";passed_ret+="result_joined: "+result_joined+"\n"}else{failed++;failed_ret+="------------------------------------------------------------------------------ #"+(i+1)+" FAIL"+"\n";failed_ret+="test.text:     "+test.text+"\n";failed_ret+="expected:      "+expected+"\n";failed_ret+="result:        "+result+"\n";failed_ret+="result_joined: "+result_joined+"\n"}}ret+=failed_ret+"\n\n"+("ran "+last+" of "+TSF.tests.length+" tests. passed:"+passed+" failed:"+failed+"")+"\n";return ret};TSF.setUpTests=function(){TSF.tests=[{text:"#cc0000",tokens:["#cc0000","<HEX:BLOCK #cc0000>"]},{text:"#cc0000 #ff0000",tokens:["#cc0000","<HEX:BLOCK #cc0000>"," #ff0000","<HEX:BLOCK #ff0000>"]},{text:"#cc00000",tokens:["#cc00000"]},{text:"#cc000",tokens:["#cc000"]},{text:"#cx0000",tokens:["#cx0000"]},{text:"<@U1111|name>",tokens:["<@U1111|name>"]},{text:"<!everyone>",tokens:["<!everyone>"]},{text:"<! _sd_ >",tokens:["<! _sd_ >"]},{text:"<#C0000|channel-0>",tokens:["<#C0000|channel-0>"]},{text:"*<#C0001|channel-1>*",tokens:["<B:START>","<#C0001|channel-1>","<B:END>"]},{text:"<#C0002| _channel-2_ >",tokens:["<#C0002| _channel-2_ >"]},{text:"&gt;_&lt;",tokens:["&gt;_&lt;"]},{text:"&gt;.&lt;",tokens:["&gt;.&lt;"]},{text:"&gt;.&gt;",tokens:["&gt;.&gt;"]},{text:"&gt;-(",tokens:["&gt;-("]},{text:"&gt;:(",tokens:["&gt;:("]},{text:"&gt;:)",tokens:["&gt;:)"]},{text:"&gt;:]",tokens:["&gt;:]"]},{text:"&gt;:[",tokens:["&gt;:["]},{text:"&gt;-{",tokens:["&gt;-{"]},{
text:"&gt;{",tokens:["&gt;{"]},{text:"&gt;{",tokens:["&gt;{"]},{text:"&gt;_{",tokens:["&gt;_{"]},{text:"&gt;-\\",tokens:["&gt;-\\"]},{text:"&gt;-/",tokens:["&gt;-/"]},{text:"&gt;-|",tokens:["&gt;-|"]},{text:"&gt;-|\n&gt;quote",tokens:["&gt;-|","<QUOTE:START>","<QUOTE:PREFIX>","quote","<QUOTE:END>"]},{text:"&gt;|",tokens:["<QUOTE:START>","<QUOTE:PREFIX>","|","<QUOTE:END>"]},{text:"hi!\n&gt;.&lt;",tokens:["hi!","<LINE:BREAK>","&gt;.&lt;"]},{text:"hi &gt;.&lt;",tokens:["hi &gt;.&lt;"]},{text:"&gt;quote\nstuff\n&gt;quote",tokens:["<QUOTE:START>","<QUOTE:PREFIX>","quote","<QUOTE:END>","stuff","<QUOTE:START>","<QUOTE:PREFIX>","quote","<QUOTE:END>"]},{text:"&gt;quote\n\n&gt;quote",tokens:["<QUOTE:START>","<QUOTE:PREFIX>","quote","<QUOTE:END>","<QUOTE:START>","<QUOTE:PREFIX>","quote","<QUOTE:END>"]},{text:"&gt;quote",tokens:["<QUOTE:START>","<QUOTE:PREFIX>","quote","<QUOTE:END>"]},{text:"&gt; quote\n&gt; quote",tokens:["<QUOTE:START>","<QUOTE:PREFIX>"," quote","<LINE:BREAK>","<QUOTE:PREFIX>"," quote","<QUOTE:END>"]},{text:"&gt; quote",tokens:["<QUOTE:START>","<QUOTE:PREFIX>"," quote","<QUOTE:END>"]},{text:"` ```m``` `",tokens:["` ","<PRE:START>","m","<PRE:END>"," `"]},{text:"` `",tokens:["` `"]},{text:"`	`",tokens:["`","<SPACE:HARD>","<SPACE:HARD>","<SPACE:HARD>","<SPACE:HARD>","`"]},{text:"`  `",tokens:["` ","<SPACE:HARD>","`"]},{text:"`          `",tokens:["` ","<SPACE:HARD>"," ","<SPACE:HARD>"," ","<SPACE:HARD>"," ","<SPACE:HARD>"," ","<SPACE:HARD>","`"]},{text:"`a`=`b`",tokens:["<CODE:START>","a","<CODE:END>","=","<CODE:START>","b","<CODE:END>"]},{text:"`a`  `b`",tokens:["<CODE:START>","a","<CODE:END>"," ","<SPACE:HARD>","<CODE:START>","b","<CODE:END>"]},{text:"`a` `b`",tokens:["<CODE:START>","a","<CODE:END>"," ","<CODE:START>","b","<CODE:END>"]},{text:"e `b`",tokens:["e ","<CODE:START>","b","<CODE:END>"]},{text:"`ab` `cd`",tokens:["<CODE:START>","ab","<CODE:END>"," ","<CODE:START>","cd","<CODE:END>"]},{text:"d`ab` `cd`",tokens:["d`ab` ","<CODE:START>","cd","<CODE:END>"]},{text:"`ab` f `cd`",tokens:["<CODE:START>","ab","<CODE:END>"," f ","<CODE:START>","cd","<CODE:END>"]},{text:"`a` f `cd`",tokens:["<CODE:START>","a","<CODE:END>"," f ","<CODE:START>","cd","<CODE:END>"]},{text:"`ab` f `d`",tokens:["<CODE:START>","ab","<CODE:END>"," f ","<CODE:START>","d","<CODE:END>"]},{text:"` code `",tokens:["<CODE:START>","<SPACE:HARD>","code","<SPACE:HARD>","<CODE:END>"]},{text:"`code `",tokens:["<CODE:START>","code","<SPACE:HARD>","<CODE:END>"]},{text:"` code`",tokens:["<CODE:START>","<SPACE:HARD>","code","<CODE:END>"]},{text:"`code code`",tokens:["<CODE:START>","code code","<CODE:END>"]},{text:"`code`",tokens:["<CODE:START>","code","<CODE:END>"]},{text:"*a* *b*",tokens:["<B:START>","a","<B:END>"," ","<B:START>","b","<B:END>"]},{text:"*ab* *cd*",tokens:["<B:START>","ab","<B:END>"," ","<B:START>","cd","<B:END>"]},{text:"*ab* f *cd*",tokens:["<B:START>","ab","<B:END>"," f ","<B:START>","cd","<B:END>"]},{text:"*a* f *cd*",tokens:["<B:START>","a","<B:END>"," f ","<B:START>","cd","<B:END>"]},{text:"*ab* f *d*",tokens:["<B:START>","ab","<B:END>"," f ","<B:START>","d","<B:END>"]},{text:"* bold *",tokens:["* bold *"]},{text:"*bold *",tokens:["<B:START>","bold ","<B:END>"]},{text:"* bold*",tokens:["<B:START>"," bold","<B:END>"]},{text:"*bold bold*",tokens:["<B:START>","bold bold","<B:END>"]},{text:"*bold*",tokens:["<B:START>","bold","<B:END>"]},{text:"~a~ ~b~",tokens:["<STRIKE:START>","a","<STRIKE:END>"," ","<STRIKE:START>","b","<STRIKE:END>"]},{text:"~ab~ ~cd~",tokens:["<STRIKE:START>","ab","<STRIKE:END>"," ","<STRIKE:START>","cd","<STRIKE:END>"]},{text:"~ab~ f ~cd~",tokens:["<STRIKE:START>","ab","<STRIKE:END>"," f ","<STRIKE:START>","cd","<STRIKE:END>"]},{text:"~a~ f ~cd~",tokens:["<STRIKE:START>","a","<STRIKE:END>"," f ","<STRIKE:START>","cd","<STRIKE:END>"]},{text:"~ab~ f ~d~",tokens:["<STRIKE:START>","ab","<STRIKE:END>"," f ","<STRIKE:START>","d","<STRIKE:END>"]},{text:"~ strike ~",tokens:["~ strike ~"]},{text:"~strike ~",tokens:["<STRIKE:START>","strike ","<STRIKE:END>"]},{text:"~ strike~",tokens:["<STRIKE:START>"," strike","<STRIKE:END>"]},{text:"~strike strike~",tokens:["<STRIKE:START>","strike strike","<STRIKE:END>"]},{text:"~strike~",tokens:["<STRIKE:START>","strike","<STRIKE:END>"]},{text:"SELECT * FROM `messages` WHERE `team_id` =2151868190 AND `channel_id`=2151942943 AND `timestamp` =1387513920000040",tokens:["SELECT * FROM ","<CODE:START>","messages","<CODE:END>"," WHERE ","<CODE:START>","team_id","<CODE:END>"," =2151868190 AND ","<CODE:START>","channel_id","<CODE:END>","=2151942943 AND ","<CODE:START>","timestamp","<CODE:END>"," =1387513920000040"]},{text:"`:apple:`",tokens:["<CODE:START>",":apple:","<CODE:END>"]},{text:"`*:*` *:*",tokens:["<CODE:START>","*:*","<CODE:END>"," ","<B:START>",":","<B:END>"]},{text:"`*:*` (q=*:*)",tokens:["<CODE:START>","*:*","<CODE:END>"," (q=","<B:START>",":","<B:END>",")"]},{text:"``````",tokens:["``````"]},{text:"```<http://example.com>```",tokens:["<PRE:START>","<LINK:START http://example.com>","http://example.com","<LINK:END>","<PRE:END>"]},{text:"```<http://example.com|example>```",tokens:["<PRE:START>","<LINK:START http://example.com>","example","<LINK:END>","<PRE:END>"]},{text:"```<http://example.com|example.com>```",tokens:["<PRE:START>","<LINK:START http://example.com>","example.com","<LINK:END>","<PRE:END>"]},{text:"````_*ddd*_````",tokens:["<PRE:START>","`_*ddd*_`","<PRE:END>"]},{text:"```_*`ddd`*_```",tokens:["<PRE:START>","_*`ddd`*_","<PRE:END>"]},{text:"*``` `ddd` ```*",tokens:["<B:START>","<PRE:START>"," `ddd` ","<PRE:END>","<B:END>"]},{text:"`_*ddd*_`",tokens:["<CODE:START>","_*ddd*_","<CODE:END>"]},{text:"`_**_`",tokens:["<CODE:START>","_**_","<CODE:END>"]},{text:"_**_",tokens:["_**_"]},{text:"_**d_",tokens:["<I:START>","**d","<I:END>"]},{text:"*-*",tokens:["<B:START>","-","<B:END>"]},{text:"~-~",tokens:["<STRIKE:START>","-","<STRIKE:END>"]},{text:"*_*",tokens:["*_*"]},{text:"*__*",tokens:["*__*"]},{text:"*_____*",tokens:["*_____*"]},{text:"*`____*",tokens:["*`____*"]},{text:"_*ddd*_",tokens:["<I:START>","<B:START>","ddd","<B:END>","<I:END>"]},{text:"*_ddd_*",tokens:["<B:START>","<I:START>","ddd","<I:END>","<B:END>"]},{text:"~*ddd*~",tokens:["<STRIKE:START>","<B:START>","ddd","<B:END>","<STRIKE:END>"]},{text:"*~ddd~*",tokens:["<B:START>","<STRIKE:START>","ddd","<STRIKE:END>","<B:END>"]},{text:"_~ddd~_",tokens:["<I:START>","<STRIKE:START>","ddd","<STRIKE:END>","<I:END>"]},{text:"~_ddd_~",tokens:["<STRIKE:START>","<I:START>","ddd","<I:END>","<STRIKE:END>"]},{text:"_huh_huh_",tokens:["<I:START>","huh_huh","<I:END>"]},{text:"_ italic _",tokens:["<I:START>"," italic ","<I:END>"]},{text:"_italic _",tokens:["<I:START>","italic ","<I:END>"]},{text:"_ italic_",tokens:["<I:START>"," italic","<I:END>"]},{text:"_italic italic_",tokens:["<I:START>","italic italic","<I:END>"]},{text:"_italic_",tokens:["<I:START>","italic","<I:END>"]},{text:"<@U0000> *this and that*",tokens:["<@U0000>"," ","<B:START>","this and that","<B:END>"]},{text:"<https://tinyspeck.com/f_g| *this and that*> *this and that*",tokens:["<LINK:START https://tinyspeck.com/f_g>","<B:START>","this and that","<B:END>","<LINK:END>"," ","<B:START>","this and that","<B:END>"]},{text:"<https://tinyspeck.com/f_g| *this and that*>*this and that*",tokens:["<LINK:START https://tinyspeck.com/f_g>","<B:START>","this and that","<B:END>","<LINK:END>","<B:START>","this and that","<B:END>"]},{text:"<https://tinyspeck.com/f_g| _this and that_> _this and that_",tokens:["<LINK:START https://tinyspeck.com/f_g>","<I:START>","this and that","<I:END>","<LINK:END>"," ","<I:START>","this and that","<I:END>"]},{text:"<https://tinyspeck.com/f_g| this and that_> _this and that_",tokens:["<LINK:START https://tinyspeck.com/f_g>","this and that_","<LINK:END>"," ","<I:START>","this and that","<I:END>"]},{text:"<https://tinyspeck.com/f_g|_this and that> _this and that_",tokens:["<LINK:START https://tinyspeck.com/f_g>","_this and that","<LINK:END>"," ","<I:START>","this and that","<I:END>"]},{text:"<https://tinyspeck.com/f_g| _this and that> _this and that_",tokens:["<LINK:START https://tinyspeck.com/f_g>","_this and that","<LINK:END>"," ","<I:START>","this and that","<I:END>"]},{text:"_this and that_ *this and that* _this and that_",tokens:["<I:START>","this and that","<I:END>"," ","<B:START>","this and that","<B:END>"," ","<I:START>","this and that","<I:END>"]},{text:"_this and that_ <https://tinyspeck.com/f_g| _this and that_>",tokens:["<I:START>","this and that","<I:END>"," ","<LINK:START https://tinyspeck.com/f_g>","<I:START>","this and that","<I:END>","<LINK:END>"]},{text:"_this and that_ <https://tinyspeck.com/f_g|_this and that_>",tokens:["<I:START>","this and that","<I:END>"," ","<LINK:START https://tinyspeck.com/f_g>","<I:START>","this and that","<I:END>","<LINK:END>"]},{text:"<https://tinyspeck.com/f_g| this and that> _this and that_",tokens:["<LINK:START https://tinyspeck.com/f_g>","this and that","<LINK:END>"," ","<I:START>","this and that","<I:END>"]},{text:"<https://tinyspeck.com/f_g| this and that> *this and that*",tokens:["<LINK:START https://tinyspeck.com/f_g>","this and that","<LINK:END>"," ","<B:START>","this and that","<B:END>"]},{text:"<https://tinyspeck.com/f_g| _this and that_>\n_this and that_",tokens:["<LINK:START https://tinyspeck.com/f_g>","<I:START>","this and that","<I:END>","<LINK:END>","<LINE:BREAK>","<I:START>","this and that","<I:END>"]},{text:"<https://tinyspeck.com/f_g|:grinning:>",tokens:["<LINK:START https://tinyspeck.com/f_g>","<EMOJI:COLONS :grinning:>","<LINK:END>"]},{text:"__",tokens:["__"]},{text:"___",tokens:["___"]},{text:"____",tokens:["____"]},{text:"_____",tokens:["_____"]},{text:"_ _",tokens:["_ _"]},{text:"_	_",tokens:["_","<SPACE:HARD>","<SPACE:HARD>","<SPACE:HARD>","<SPACE:HARD>","_"]},{text:"_  _",tokens:["_ ","<SPACE:HARD>","_"]},{text:"_          _",tokens:["_ ","<SPACE:HARD>"," ","<SPACE:HARD>"," ","<SPACE:HARD>"," ","<SPACE:HARD>"," ","<SPACE:HARD>","_"]},{text:"_i_",tokens:["<I:START>","i","<I:END>"]},{text:"_italic_",tokens:["<I:START>","italic","<I:END>"]},{text:"_italic_ _italic_ _italic_",tokens:["<I:START>","italic","<I:END>"," ","<I:START>","italic","<I:END>"," ","<I:START>","italic","<I:END>"]},{text:"_italic_",tokens:["<I:START>","italic","<I:END>",""]},{text:":_italic_:",tokens:["<EMOJI:COLONS :_italic_:>"]},{text:"_:italic:_",tokens:["<I:START>","<EMOJI:COLONS :italic:>","<I:END>"]},{text:"_:tangerine:_",tokens:["<I:START>","<EMOJI:COLONS :tangerine:>","<I:END>"]},{text:"_italic__",tokens:["_italic__"]},{text:"__italic_",tokens:["__italic_"]},{text:"__italic__",tokens:["__italic__"]},{text:"tangerine _italic_",tokens:["tangerine ","<I:START>","italic","<I:END>"]},{text:":tangerine: _italic_",tokens:["<EMOJI:COLONS :tangerine:>"," ","<I:START>","italic","<I:END>"]},{text:":tangerine:_italic_",tokens:["<EMOJI:COLONS :tangerine:>","<I:START>","italic","<I:END>"]},{text:"perform_complicated_task",tokens:["perform_complicated_task"]},{text:"`d``",tokens:["<CODE:START>","d","<CODE:END>","`"]},{text:"`d`s",tokens:["<CODE:START>","d","<CODE:END>","s"]},{text:"``d`",tokens:["``d`"]},{text:"``",tokens:["``"]},{text:"**",tokens:["**"]},{text:"***",tokens:["***"]},{text:"*****",tokens:["*****"]},{text:"~~",tokens:["~~"]},{text:"~~~",tokens:["~~~"]},{text:"~~~~~",tokens:["~~~~~"]},{text:"*b*",tokens:["<B:START>","b","<B:END>"]},{text:"*bold*",tokens:["<B:START>","bold","<B:END>"]},{text:"*bold*",tokens:["<B:START>","bold","<B:END>",""]},{text:"**bold**",tokens:["**bold**"]},{text:"~strike~",tokens:["<STRIKE:START>","strike","<STRIKE:END>"]},{text:"~strike~",tokens:["<STRIKE:START>","strike","<STRIKE:END>"]},{text:"~strike~",tokens:["<STRIKE:START>","strike","<STRIKE:END>",""]},{text:"~~strike~~",tokens:["~~strike~~"]},{text:":_custom_:",tokens:["<EMOJI:COLONS :_custom_:>"]},{text:":apple: *bold*",tokens:["<EMOJI:COLONS :apple:>"," ","<B:START>","bold","<B:END>"]},{text:":apple:*bold*",tokens:["<EMOJI:COLONS :apple:>","<B:START>","bold","<B:END>"]},{text:"* apple\n* banana",tokens:["* apple","<LINE:BREAK>","* banana"]},{text:":apple: ~strike~",tokens:["<EMOJI:COLONS :apple:>"," ","<STRIKE:START>","strike","<STRIKE:END>"]},{text:":apple:~strike~",tokens:["<EMOJI:COLONS :apple:>","<STRIKE:START>","strike","<STRIKE:END>"]},{text:"* *",tokens:["* *"]},{text:"*	*",tokens:["*","<SPACE:HARD>","<SPACE:HARD>","<SPACE:HARD>","<SPACE:HARD>","*"]},{text:"*  *",tokens:["* ","<SPACE:HARD>","*"]},{text:"*          *",tokens:["* ","<SPACE:HARD>"," ","<SPACE:HARD>"," ","<SPACE:HARD>"," ","<SPACE:HARD>"," ","<SPACE:HARD>","*"]},{text:"`code`",tokens:["<CODE:START>","code","<CODE:END>"]},{text:"`code`",tokens:["<CODE:START>","code","<CODE:END>",""]},{text:"```pre```",tokens:["<PRE:START>","pre","<PRE:END>"]},{text:"```pre1```\n```pre2```",tokens:["<PRE:START>","pre1","<PRE:END>","<PRE:START>","pre2","<PRE:END>"]},{text:" test ```pre```",tokens:["test ","<PRE:START>","pre","<PRE:END>"]},{text:" test\n```pre```",tokens:["test","<LINE:BREAK>","<PRE:START>","pre","<PRE:END>"]},{text:" test\n```pre\n```",tokens:["test","<LINE:BREAK>","<PRE:START>","pre","<LINE:BREAK>","<PRE:END>"]},{text:"<https://twitter.com/SlackHQ|@SlackHQ> Hmmm, :leftwards_arrow_with_hook: no longer works in the Mac app to add a new line in the current comment",tokens:["<LINK:START https://twitter.com/SlackHQ>","@SlackHQ","<LINK:END>"," Hmmm, ","<EMOJI:COLONS :leftwards_arrow_with_hook:>"," no longer works in the Mac app to add a new line in the current comment"]},{text:"<%B001>",tokens:["<%B001>"]},{text:"<%B001|bosster>",tokens:["<%B001|bosster>"]},{text:":apple::skin-tone-1:",tokens:["<EMOJI:COLONS :apple:>","<EMOJI:COLONS :skin-tone-1:>"]},{text:":apple::skin-tone-2:",tokens:["<EMOJI:COLONS :apple::skin-tone-2:>"]}];var highlight_words=["test_highlight_word","testhighlightword","@ericc","ericc","<@U0000"];var word;var word_esc;var _g1=0;var _g=highlight_words.length;while(_g1<_g){var i=_g1++;word=highlight_words[i];word_esc=new EReg("<","g").replace(word,"&lt;");word_esc=new EReg(">","g").replace(word_esc,"&gt;");TSF.tests.push({text:word,tokens:[word_esc]});TSF.tests.push({text:"*"+word+"*",tokens:["<B:START>",word_esc,"<B:END>"]});TSF.tests.push({text:"~"+word+"~",tokens:["<STRIKE:START>",word_esc,"<STRIKE:END>"]});TSF.tests.push({text:"_"+word+"_",tokens:["<I:START>",word_esc,"<I:END>"]});TSF.tests.push({text:"`"+word+"`",tokens:["<CODE:START>",word_esc,"<CODE:END>"]});TSF.tests.push({text:"```"+word+"```",tokens:["<PRE:START>",word_esc,"<PRE:END>"]})}var punc;var punc1;var punc2;var before_punc='?.,-!;:{(^[%$#+"';var _g11=0;var _g2=before_punc.length;while(_g11<_g2){var i1=_g11++;punc=before_punc.charAt(i1);TSF.tests.push({text:punc+"*punc*",tokens:[punc,"<B:START>","punc","<B:END>"]});TSF.tests.push({text:punc+"~punc~",tokens:[punc,"<STRIKE:START>","punc","<STRIKE:END>"]});TSF.tests.push({text:punc+"_punc_",tokens:[punc,"<I:START>","punc","<I:END>"]});TSF.tests.push({text:punc+"`punc`",tokens:[punc,"<CODE:START>","punc","<CODE:END>"]});TSF.tests.push({text:punc+"```punc```",tokens:[punc,"<PRE:START>","punc","<PRE:END>"]})}var after_punc='?.,-!;:})^]%$#+"';var _g12=0;var _g3=after_punc.length;while(_g12<_g3){var i2=_g12++;punc=after_punc.charAt(i2);TSF.tests.push({text:"*punc*"+punc,tokens:["<B:START>","punc","<B:END>",punc]});TSF.tests.push({text:"~punc~"+punc,tokens:["<STRIKE:START>","punc","<STRIKE:END>",punc]});TSF.tests.push({text:"_punc_"+punc,tokens:["<I:START>","punc","<I:END>",punc]});TSF.tests.push({text:"`punc`"+punc,tokens:["<CODE:START>","punc","<CODE:END>",punc]});TSF.tests.push({text:"```punc```"+punc,tokens:["<PRE:START>","punc","<PRE:END>",punc]})}var before_and_after_punc_start='{(["';var before_and_after_punc_end='})]"';var _g13=0;var _g4=before_and_after_punc_start.length;while(_g13<_g4){var i3=_g13++;punc1=before_and_after_punc_start.charAt(i3);punc2=before_and_after_punc_end.charAt(i3);TSF.tests.push({text:punc1+"*punc*"+punc2,tokens:[punc1,"<B:START>","punc","<B:END>",punc2]});TSF.tests.push({text:punc1+"~punc~"+punc2,tokens:[punc1,"<STRIKE:START>","punc","<STRIKE:END>",punc2]});TSF.tests.push({text:punc1+"_punc_"+punc2,tokens:[punc1,"<I:START>","punc","<I:END>",punc2]});TSF.tests.push({text:punc1+"`punc`"+punc2,tokens:[punc1,"<CODE:START>","punc","<CODE:END>",punc2]});TSF.tests.push({text:punc1+"```punc```"+punc2,tokens:[punc1,"<PRE:START>","punc","<PRE:END>",punc2]})}};var js={};js.Boot=function(){};js.Boot.__name__=true;js.Boot.__string_rec=function(o,s){if(o==null)return"null";if(s.length>=5)return"<...>";var t=typeof o;if(t=="function"&&(o.__name__||o.__ename__))t="object";switch(t){case"object":if(o instanceof Array){if(o.__enum__){if(o.length==2)return o[0];var str=o[0]+"(";s+="	";var _g1=2;var _g=o.length;while(_g1<_g){var i=_g1++;if(i!=2)str+=","+js.Boot.__string_rec(o[i],s);else str+=js.Boot.__string_rec(o[i],s)}return str+")"}var l=o.length;var i1;var str1="[";s+="	";var _g2=0;while(_g2<l){var i2=_g2++;str1+=(i2>0?",":"")+js.Boot.__string_rec(o[i2],s)}str1+="]";return str1}var tostr;try{tostr=o.toString}catch(e){return"???"}if(tostr!=null&&tostr!=Object.toString){var s2=o.toString();if(s2!="[object Object]")return s2}var k=null;var str2="{\n";s+="	";var hasp=o.hasOwnProperty!=null;for(var k in o){if(hasp&&!o.hasOwnProperty(k)){continue}if(k=="prototype"||k=="__class__"||k=="__super__"||k=="__interfaces__"||k=="__properties__"){continue}if(str2.length!=2)str2+=", \n";str2+=s+k+" : "+js.Boot.__string_rec(o[k],s)}s=s.substring(1);str2+="\n"+s+"}";return str2;case"function":return"<function>";case"string":return o;default:return String(o)}};Math.NaN=Number.NaN;Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY;Math.isFinite=function(i){return isFinite(i)};Math.isNaN=function(i1){return isNaN(i1)};String.__name__=true;Array.__name__=true;TSF.B_START="<B:START>";TSF.B_END="<B:END>";TSF.PRE_START="<PRE:START>";TSF.PRE_END="<PRE:END>";TSF.CODE_START="<CODE:START>";TSF.CODE_END="<CODE:END>";TSF.I_START="<I:START>";TSF.I_END="<I:END>";TSF.STRIKE_START="<STRIKE:START>";TSF.STRIKE_END="<STRIKE:END>";TSF.QUOTE_START="<QUOTE:START>";TSF.QUOTE_PREFIX="<QUOTE:PREFIX>";TSF.LONGQUOTE_PREFIX="<LONGQUOTE:PREFIX>";TSF.QUOTE_END="<QUOTE:END>";TSF.LINK_START="<LINK:START $>";TSF.LINK_END="<LINK:END>";TSF.LINE_BREAK="<LINE:BREAK>";TSF.PARA_BREAK="<PARA:BREAK>";TSF.SPACE_HARD="<SPACE:HARD>";TSF.EMOJI_COLONS="<EMOJI:COLONS $>";TSF.HEX_BLOCK="<HEX:BLOCK $>";TSF.bold_rx=new EReg('(^|\\s|[\\?\\.,\\-!\\^;:{(\\[%$#+=\\u2000-\\u206F\\u2E00-\\u2E7F"])\\*(.*?\\S *)?\\*(?=$|\\s|[\\?\\.,\\-!\\^;:})\\]%${\\[<#+=\\u2000-\\u206F\\u2E00-\\u2E7F"\\uE022])',"g");TSF.pre_rx=new EReg('(^|\\s|[_*\\?\\.,\\-!\\^;:{(\\[%$#+=\\u2000-\\u206F\\u2E00-\\u2E7F"])```([\\s\\S]*?)?```(?=$|\\s|[_*\\?\\.,\\-!\\^;:})\\]%$#+=\\u2000-\\u206F\\u2E00-\\u2E7F"])',"g");TSF.i_rx=new EReg('(?!:.+:)(^|\\s|[\\?\\.,\\-!\\^;:{(\\[%$#+=\\u2000-\\u206F\\u2E00-\\u2E7F"])_(.*?\\S *)?_(?=$|\\s|[\\?\\.,\\-!\\^;:})\\]%${\\[<#+=\\u2000-\\u206F\\u2E00-\\u2E7F"\\uE022])',"g");TSF.strike_rx=new EReg('(^|\\s|[\\?\\.,\\-!\\^;:{(\\[%$#+=\\u2000-\\u206F\\u2E00-\\u2E7F"])~(.*?\\S *)?~(?=$|\\s|[\\?\\.,\\-!\\^;:})\\]%${\\[<#+=\\u2000-\\u206F\\u2E00-\\u2E7F"\\uE022])',"g");TSF.code_rx=new EReg('(^|\\s|[\\?\\.,\\-!\\^;:{(\\[%$#+=\\u2000-\\u206F\\u2E00-\\u2E7F"])`(.*?\\S *)?`',"g");TSF.quote_rx=new EReg("(^|\n)&gt;(?![\\W_](?:&lt;|&gt;|[\\|/\\\\\\[\\]{}\\(\\)Dpb](?=\\s|$)))(([^\n]*)(\n&gt;[^\n]*)*)","ug");TSF.long_quote_rx=new EReg("(^|\n)&gt;&gt;&gt;([\\s\\S]*$)","");TSF.placeholder_cnt=0;TSF.placeholder_base="-";TSF.main()})(typeof window!="undefined"?window:exports);(function(root,factory){if(typeof exports=="object")module.exports=factory();else if(typeof define=="function"&&define.amd)define(factory);else root.Spinner=factory()})(this,function(){"use strict";var prefixes=["webkit","Moz","ms","O"],animations={},useCssAnimations;function createEl(tag,prop){var el=document.createElement(tag||"div"),n;for(n in prop)el[n]=prop[n];return el}function ins(parent){for(var i=1,n=arguments.length;i<n;i++)parent.appendChild(arguments[i]);return parent}var sheet=function(){var el=createEl("style",{type:"text/css"});ins(document.getElementsByTagName("head")[0],el);return el.sheet||el.styleSheet}();function addAnimation(alpha,trail,i,lines){var name=["opacity",trail,~~(alpha*100),i,lines].join("-"),start=.01+i/lines*100,z=Math.max(1-(1-alpha)/trail*(100-start),alpha),prefix=useCssAnimations.substring(0,useCssAnimations.indexOf("Animation")).toLowerCase(),pre=prefix&&"-"+prefix+"-"||"";if(!animations[name]){sheet.insertRule("@"+pre+"keyframes "+name+"{"+"0%{opacity:"+z+"}"+start+"%{opacity:"+alpha+"}"+(start+.01)+"%{opacity:1}"+(start+trail)%100+"%{opacity:"+alpha+"}"+"100%{opacity:"+z+"}"+"}",sheet.cssRules.length);animations[name]=1}return name}function vendor(el,prop){var s=el.style,pp,i;prop=prop.charAt(0).toUpperCase()+prop.slice(1);for(i=0;i<prefixes.length;i++){pp=prefixes[i]+prop;if(s[pp]!==undefined)return pp}if(s[prop]!==undefined)return prop}function css(el,prop){for(var n in prop)el.style[vendor(el,n)||n]=prop[n];return el}function merge(obj){for(var i=1;i<arguments.length;i++){var def=arguments[i];for(var n in def)if(obj[n]===undefined)obj[n]=def[n]}return obj}function pos(el){var o={x:el.offsetLeft,y:el.offsetTop};while(el=el.offsetParent)o.x+=el.offsetLeft,o.y+=el.offsetTop;return o}function getColor(color,idx){return typeof color=="string"?color:color[idx%color.length]}var defaults={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:1/4,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};function Spinner(o){if(typeof this=="undefined")return new Spinner(o);this.opts=merge(o||{},Spinner.defaults,defaults)}Spinner.defaults={};merge(Spinner.prototype,{spin:function(target){this.stop();var self=this,o=self.opts,el=self.el=css(createEl(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex}),mid=o.radius+o.length+o.width,ep,tp;if(target){target.insertBefore(el,target.firstChild||null);tp=pos(target);ep=pos(el);css(el,{left:(o.left=="auto"?tp.x-ep.x+(target.offsetWidth>>1):parseInt(o.left,10)+mid)+"px",top:(o.top=="auto"?tp.y-ep.y+(target.offsetHeight>>1):parseInt(o.top,10)+mid)+"px"})}el.setAttribute("role","progressbar");self.lines(el,self.opts);if(!useCssAnimations){var i=0,start=(o.lines-1)*(1-o.direction)/2,alpha,fps=o.fps,f=fps/o.speed,ostep=(1-o.opacity)/(f*o.trail/100),astep=f/o.lines;(function anim(){i++;for(var j=0;j<o.lines;j++){alpha=Math.max(1-(i+(o.lines-j)*astep)%f*ostep,o.opacity);self.opacity(el,j*o.direction+start,alpha,o)}self.timeout=self.el&&setTimeout(anim,~~(1e3/fps))})()}return self},stop:function(){var el=this.el;if(el){clearTimeout(this.timeout);if(el.parentNode)el.parentNode.removeChild(el);this.el=undefined}return this},lines:function(el,o){var i=0,start=(o.lines-1)*(1-o.direction)/2,seg;function fill(color,shadow){return css(createEl(),{position:"absolute",width:o.length+o.width+"px",height:o.width+"px",background:color,boxShadow:shadow,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*i+o.rotate)+"deg) translate("+o.radius+"px"+",0)",borderRadius:(o.corners*o.width>>1)+"px"})}for(;i<o.lines;i++){seg=css(createEl(),{position:"absolute",top:1+~(o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:useCssAnimations&&addAnimation(o.opacity,o.trail,start+i*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"});if(o.shadow)ins(seg,css(fill("#000","0 0 4px "+"#000"),{top:2+"px"}));ins(el,ins(seg,fill(getColor(o.color,i),"0 0 1px rgba(0,0,0,.1)")))}return el},opacity:function(el,i,val){if(i<el.childNodes.length)el.childNodes[i].style.opacity=val}});function initVML(){function vml(tag,attr){return createEl("<"+tag+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',attr)}sheet.addRule(".spin-vml","behavior:url(#default#VML)");Spinner.prototype.lines=function(el,o){var r=o.length+o.width,s=2*r;function grp(){return css(vml("group",{coordsize:s+" "+s,coordorigin:-r+" "+-r}),{width:s,height:s})}var margin=-(o.width+o.length)*2+"px",g=css(grp(),{position:"absolute",top:margin,left:margin}),i;function seg(i,dx,filter){ins(g,ins(css(grp(),{rotation:360/o.lines*i+"deg",left:~~dx}),ins(css(vml("roundrect",{arcsize:o.corners}),{width:r,height:o.width,left:o.radius,top:-o.width>>1,filter:filter}),vml("fill",{color:getColor(o.color,i),opacity:o.opacity}),vml("stroke",{opacity:0}))))}if(o.shadow)for(i=1;i<=o.lines;i++)seg(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=o.lines;i++)seg(i);return ins(el,g)};Spinner.prototype.opacity=function(el,i,val,o){var c=el.firstChild;o=o.shadow&&o.lines||0;if(c&&i+o<c.childNodes.length){c=c.childNodes[i+o];c=c&&c.firstChild;c=c&&c.firstChild;if(c)c.opacity=val}}}var probe=css(createEl("group"),{behavior:"url(#default#VML)"});if(!vendor(probe,"transform")&&probe.adj)initVML();else useCssAnimations=vendor(probe,"animation");return Spinner});(function($){function CircleProgress(config){this.init(config)}CircleProgress.prototype={value:0,size:100,startAngle:-Math.PI,thickness:"auto",fill:{gradient:["#3aeabb","#fdd250"]},emptyFill:"rgba(0, 0, 0, .1)",animation:{duration:1200,easing:"circleProgressEasing"},animationStartValue:0,reverse:false,lineCap:"butt",constructor:CircleProgress,el:null,canvas:null,ctx:null,radius:0,arcFill:null,lastFrameValue:0,init:function(config){$.extend(this,config);this.radius=this.size/2;this.initWidget();this.initFill();this.draw()},initWidget:function(){var canvas=this.canvas=this.canvas||$("<canvas>").prependTo(this.el)[0];canvas.width=this.size;canvas.height=this.size;this.ctx=canvas.getContext("2d")},initFill:function(){var self=this,fill=this.fill,ctx=this.ctx,size=this.size;if(!fill)throw Error("The fill is not specified!");if(fill.color)this.arcFill=fill.color;if(fill.gradient){var gr=fill.gradient;if(gr.length==1){this.arcFill=gr[0]}else if(gr.length>1){var ga=fill.gradientAngle||0,gd=fill.gradientDirection||[size/2*(1-Math.cos(ga)),size/2*(1+Math.sin(ga)),size/2*(1+Math.cos(ga)),size/2*(1-Math.sin(ga))];var lg=ctx.createLinearGradient.apply(ctx,gd);for(var i=0;i<gr.length;i++){var color=gr[i],pos=i/(gr.length-1);if($.isArray(color)){pos=color[1];color=color[0]}lg.addColorStop(pos,color)}this.arcFill=lg}}if(fill.image){var img;if(fill.image instanceof Image){img=fill.image}else{img=new Image;img.src=fill.image}if(img.complete)setImageFill();else img.onload=setImageFill}function setImageFill(){var bg=$("<canvas>")[0];bg.width=self.size;bg.height=self.size;bg.getContext("2d").drawImage(img,0,0,size,size);self.arcFill=self.ctx.createPattern(bg,"no-repeat");self.drawFrame(self.lastFrameValue)}},draw:function(){if(this.animation)this.drawAnimated(this.value);else this.drawFrame(this.value)},drawFrame:function(v){this.lastFrameValue=v;this.ctx.clearRect(0,0,this.size,this.size);this.drawEmptyArc(v);this.drawArc(v)},drawArc:function(v){var ctx=this.ctx,r=this.radius,t=this.getThickness(),a=this.startAngle;ctx.save();ctx.beginPath();if(!this.reverse){ctx.arc(r,r,r-t/2,a,a+Math.PI*2*v)}else{ctx.arc(r,r,r-t/2,a-Math.PI*2*v,a)}ctx.lineWidth=t;ctx.lineCap=this.lineCap;ctx.strokeStyle=this.arcFill;ctx.stroke();ctx.restore()},drawEmptyArc:function(v){var ctx=this.ctx,r=this.radius,t=this.getThickness(),a=this.startAngle;if(v<1){ctx.save();ctx.beginPath();if(v<=0){ctx.arc(r,r,r-t/2,0,Math.PI*2)}else{if(!this.reverse){ctx.arc(r,r,r-t/2,a+Math.PI*2*v,a)}else{ctx.arc(r,r,r-t/2,a,a-Math.PI*2*v)}}ctx.lineWidth=t;ctx.strokeStyle=this.emptyFill;ctx.stroke();ctx.restore()}},drawAnimated:function(v){var self=this,el=this.el;el.trigger("circle-animation-start");$(this.canvas).stop(true,true).css({animationProgress:0}).animate({animationProgress:1},$.extend({},this.animation,{step:function(animationProgress){var stepValue=self.animationStartValue*(1-animationProgress)+v*animationProgress;self.drawFrame(stepValue);el.trigger("circle-animation-progress",[animationProgress,stepValue])},complete:function(){el.trigger("circle-animation-end")}}))},getThickness:function(){return $.isNumeric(this.thickness)?this.thickness:this.size/14}};$.circleProgress={defaults:CircleProgress.prototype};$.easing.circleProgressEasing=function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t+b;return c/2*((t-=2)*t*t+2)+b};$.fn.circleProgress=function(config){var dataName="circle-progress";if(config=="widget"){var data=this.data(dataName);return data&&data.canvas}return this.each(function(){var el=$(this),instance=el.data(dataName),cfg=$.isPlainObject(config)?config:{};if(instance){instance.init(cfg)}else{cfg.el=el;instance=new CircleProgress(cfg);el.data(dataName,instance)}})}})(jQuery);(function(root,factory){if(typeof exports==="object"){module.exports=factory()}else if(typeof define==="function"&&define.amd){define(["spin"],factory)}else{root.Ladda=factory(root.Spinner)}})(this,function(Spinner){"use strict";var ALL_INSTANCES=[];var is_winssb=/atomshell/i.test(navigator.userAgent);function create(button){if(typeof button==="undefined"){console.warn("Ladda button target must be defined.");return}if(!button.querySelector(".ladda-label")){button.innerHTML='<span class="ladda-label">'+button.innerHTML+"</span>"}var spinner=createSpinner(button);var spinnerWrapper=document.createElement("span");spinnerWrapper.className="ladda-spinner";button.appendChild(spinnerWrapper);var timer;var instance={start:function(){button.setAttribute("disabled","");if(!is_winssb)button.setAttribute("data-loading","");clearTimeout(timer);if(!is_winssb)spinner.spin(spinnerWrapper);this.setProgress(0);return this},startAfter:function(delay){clearTimeout(timer);timer=setTimeout(function(){instance.start()},delay);return this},stop:function(){button.removeAttribute("disabled");button.removeAttribute("data-loading");clearTimeout(timer);timer=setTimeout(function(){spinner.stop()},1e3);return this},toggle:function(){if(this.isLoading()){this.stop()}else{this.start()}return this},setProgress:function(progress){if(is_winssb)return;progress=Math.max(Math.min(progress,1),0);var progressElement=button.querySelector(".ladda-progress");if(progress===0&&progressElement&&progressElement.parentNode){progressElement.parentNode.removeChild(progressElement)}else{if(!progressElement){progressElement=document.createElement("div");progressElement.className="ladda-progress";button.appendChild(progressElement)}progressElement.style.width=(progress||0)*button.offsetWidth+"px"}},enable:function(){this.stop();return this},disable:function(){this.stop();button.setAttribute("disabled","");return this},isLoading:function(){return button.hasAttribute("data-loading")}};ALL_INSTANCES.push(instance);return instance}function getAncestorOfTagType(elem,type){while(elem.parentNode&&elem.tagName!==type){elem=elem.parentNode}return elem}function getRequiredFields(elem){var requirables=["input","textarea"];var inputs=[];for(var i=0;i<requirables.length;i++){var name_els=elem.getElementsByTagName(requirables[i]);for(var j=0;j<name_els.length;j++){if(name_els[j].hasAttribute("required")){inputs.push(name_els[j])}}}return inputs}function bind(target,options){options=options||{};var targets=[];if(typeof target==="string"){targets=toArray(document.querySelectorAll(target))}else if(typeof target==="object"&&typeof target.nodeName==="string"){targets=[target]}for(var i=0,len=targets.length;i<len;i++){(function(){var element=targets[i];if(typeof element.addEventListener==="function"){var instance=create(element);var timeout=-1;element.addEventListener("click",function(event){var valid=true;var form=getAncestorOfTagType(element,"FORM");var requireds=getRequiredFields(form);if(form&&form.checkValidity){valid=form.checkValidity()}else{for(var i=0;i<requireds.length;i++){if(requireds[i].value.replace(/^\s+|\s+$/g,"")===""){valid=false}}}if(valid){instance.startAfter(1);if(typeof options.timeout==="number"){clearTimeout(timeout);timeout=setTimeout(instance.stop,options.timeout);
}if(typeof options.callback==="function"){options.callback.apply(null,[instance])}}},false)}})()}}function stopAll(){for(var i=0,len=ALL_INSTANCES.length;i<len;i++){ALL_INSTANCES[i].stop()}}function createSpinner(button){var height=button.offsetHeight,spinnerColor;if(height>32){height*=.8}if(button.hasAttribute("data-spinner-size")){height=parseInt(button.getAttribute("data-spinner-size"),10)}if(button.hasAttribute("data-spinner-color")){spinnerColor=button.getAttribute("data-spinner-color")}var lines=12,radius=height*.2,length=radius*.6,width=radius<7?2:3;return new Spinner({color:spinnerColor||"#fff",lines:lines,radius:radius,length:length,width:width,zIndex:"auto",top:"auto",left:"auto",className:""})}function toArray(nodes){var a=[];for(var i=0;i<nodes.length;i++){a.push(nodes[i])}return a}return{bind:bind,create:create,stopAll:stopAll}});(function($){var converter={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};var settings={duration:"fast",direction:"both",offset:null,px_offset:0};var rootrx=/^(?:html)$/i;var borders=function(domElement,styles){styles=styles||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(domElement,null):domElement.currentStyle);var px=document.defaultView&&document.defaultView.getComputedStyle?true:false;var b={top:parseFloat(px?styles.borderTopWidth:$.css(domElement,"borderTopWidth"))||0,left:parseFloat(px?styles.borderLeftWidth:$.css(domElement,"borderLeftWidth"))||0,bottom:parseFloat(px?styles.borderBottomWidth:$.css(domElement,"borderBottomWidth"))||0,right:parseFloat(px?styles.borderRightWidth:$.css(domElement,"borderRightWidth"))||0};return{top:b.top,left:b.left,bottom:b.bottom,right:b.right,vertical:b.top+b.bottom,horizontal:b.left+b.right}};var dimensions=function($element){var win=$(window);var isRoot=rootrx.test($element[0].nodeName);return{border:isRoot?{top:0,left:0,bottom:0,right:0}:borders($element[0]),scroll:{top:(isRoot?win:$element).scrollTop(),left:(isRoot?win:$element).scrollLeft()},scrollbar:{right:isRoot?0:$element.innerWidth()-$element[0].clientWidth,bottom:isRoot?0:$element.innerHeight()-$element[0].clientHeight},rect:dimensions_rect($element)}};var dimensions_rect=function($element){var isRoot=rootrx.test($element[0].nodeName);if(!$element.___dimensions_rect)$element.___dimensions_rect={};var rect=$element.___dimensions_rect;if(isRoot){rect.top=0,rect.left=0,rect.bottom=$element[0].clientHeight,rect.right=$element[0].clientWidth}else{var r=$element[0].getBoundingClientRect();rect.top=r.top,rect.left=r.left,rect.bottom=r.bottom,rect.right=r.right}rect.height=rect.bottom-rect.top;rect.width=rect.right-rect.left;return rect};$.fn.extend({dimensions:function(){var el=this.eq(0);return dimensions(el)}});$.fn.extend({dimensions_rect:function(){var el=this.eq(0);return dimensions_rect(el)}});$.fn.extend({scrollintoview:function(options){var log=window.log_scrollintoview;options=$.extend({},settings,options);options.direction=converter[typeof options.direction==="string"&&options.direction.toLowerCase()]||converter.both;var dirStr="";if(options.direction.x===true)dirStr="horizontal";if(options.direction.y===true)dirStr=dirStr?"both":"vertical";var el=this.eq(0);var scroller=el.closest(".monkey_scroller");if(!scroller.length){scroller=el.closest(":scrollable("+dirStr+")")}var px_offset=options.px_offset;if(scroller.length>0){scroller=scroller.eq(0);var dim={e:dimensions(el),s:dimensions(scroller)};var rel={top:dim.e.rect.top-(dim.s.rect.top+dim.s.border.top),bottom:dim.s.rect.bottom-dim.s.border.bottom-dim.s.scrollbar.bottom-dim.e.rect.bottom,left:dim.e.rect.left-(dim.s.rect.left+dim.s.border.left),right:dim.s.rect.right-dim.s.border.right-dim.s.scrollbar.right-dim.e.rect.right};if(log&&TS){TS.info("scroller id:"+scroller.attr("id")+" scrollTop():"+scroller.scrollTop());TS.info("dim: "+JSON.stringify(dim,null,"  "));TS.info("rel: "+JSON.stringify(rel))}var animOptions={};if(options.direction.y===true){var vertical_offset=options.offset=="center"||options.offset=="center_vertical"?(dim.s.rect.height-dim.e.rect.height)/2:0;if(rel.top<0){if(log&&TS){TS.warn("case rel.top < 0")}if(options.offset=="bottom"){vertical_offset=dim.s.rect.height-dim.e.rect.height}animOptions.scrollTop=dim.s.scroll.top+rel.top-vertical_offset-px_offset}else if(rel.top>0&&rel.bottom<0){if(log&&TS){TS.warn("case rel.top > 0 && rel.bottom < 0")}if(options.offset=="top"){vertical_offset=dim.s.rect.height-dim.e.rect.height}animOptions.scrollTop=dim.s.scroll.top+Math.min(rel.top,-rel.bottom)+vertical_offset-px_offset}else{if(log&&TS){TS.warn("case WTF")}}}if(options.direction.x===true){if(rel.left<0){animOptions.scrollLeft=dim.s.scroll.left+rel.left}else if(rel.left>0&&rel.right<0){animOptions.scrollLeft=dim.s.scroll.left+Math.min(rel.left,-rel.right)}}if(!$.isEmptyObject(animOptions)){if(rootrx.test(scroller[0].nodeName)){scroller=$("html,body")}if(log&&TS){TS.info("dest:"+animOptions.scrollTop)}scroller.stop().animate(animOptions,{progress:function(a,p,c){if(log&&TS)TS.info(100*p+"% "+scroller.scrollTop())},duration:options.duration}).eq(0).queue(function(next){$.isFunction(options.complete)&&options.complete.call(scroller[0]);next()})}else{$.isFunction(options.complete)&&options.complete.call(scroller[0])}}return this}});var scrollValue={auto:true,scroll:true,visible:false,hidden:false};$.extend($.expr[":"],{scrollable:function(element,index,meta,stack){var direction=converter[typeof meta[3]==="string"&&meta[3].toLowerCase()]||converter.both;var styles=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(element,null):element.currentStyle;var overflow={x:scrollValue[styles.overflowX.toLowerCase()]||false,y:scrollValue[styles.overflowY.toLowerCase()]||false,isRoot:rootrx.test(element.nodeName)};if(!overflow.x&&!overflow.y&&!overflow.isRoot){return false}var size={height:{scroll:element.scrollHeight,client:element.clientHeight},width:{scroll:element.scrollWidth,client:element.clientWidth},scrollableX:function(){return(overflow.x||overflow.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(overflow.y||overflow.isRoot)&&this.height.scroll>this.height.client}};return direction.y&&size.scrollableY()||direction.x&&size.scrollableX()}})})(jQuery);(function($){$.transit={version:"0.9.9",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:true,useTransitionEnd:false};var div=document.createElement("div");var support={};function getVendorPropertyName(prop){if(prop in div.style)return prop;var prefixes=["Moz","Webkit","O","ms"];var prop_=prop.charAt(0).toUpperCase()+prop.substr(1);if(prop in div.style){return prop}for(var i=0;i<prefixes.length;++i){var vendorProp=prefixes[i]+prop_;if(vendorProp in div.style){return vendorProp}}}function checkTransform3dSupport(){div.style[support.transform]="";div.style[support.transform]="rotateY(90deg)";return div.style[support.transform]!==""}var isChrome=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;support.transition=getVendorPropertyName("transition");support.transitionDelay=getVendorPropertyName("transitionDelay");support.transform=getVendorPropertyName("transform");support.transformOrigin=getVendorPropertyName("transformOrigin");support.transform3d=checkTransform3dSupport();var eventNames={transition:"transitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"};var transitionEnd=support.transitionEnd=eventNames[support.transition]||null;for(var key in support){if(support.hasOwnProperty(key)&&typeof $.support[key]==="undefined"){$.support[key]=support[key]}}div=null;$.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"};$.cssHooks["transit:transform"]={get:function(elem){return $(elem).data("transform")||new Transform},set:function(elem,v){var value=v;if(!(value instanceof Transform)){value=new Transform(value)}if(support.transform==="WebkitTransform"&&!isChrome){elem.style[support.transform]=value.toString(true)}else{elem.style[support.transform]=value.toString()}$(elem).data("transform",value)}};$.cssHooks.transform={set:$.cssHooks["transit:transform"].set};if($.fn.jquery<"1.8"){$.cssHooks.transformOrigin={get:function(elem){return elem.style[support.transformOrigin]},set:function(elem,value){elem.style[support.transformOrigin]=value}};$.cssHooks.transition={get:function(elem){return elem.style[support.transition]},set:function(elem,value){elem.style[support.transition]=value}}}registerCssHook("scale");registerCssHook("translate");registerCssHook("rotate");registerCssHook("rotateX");registerCssHook("rotateY");registerCssHook("rotate3d");registerCssHook("perspective");registerCssHook("skewX");registerCssHook("skewY");registerCssHook("x",true);registerCssHook("y",true);function Transform(str){if(typeof str==="string"){this.parse(str)}return this}Transform.prototype={setFromString:function(prop,val){var args=typeof val==="string"?val.split(","):val.constructor===Array?val:[val];args.unshift(prop);Transform.prototype.set.apply(this,args)},set:function(prop){var args=Array.prototype.slice.apply(arguments,[1]);if(this.setter[prop]){this.setter[prop].apply(this,args)}else{this[prop]=args.join(",")}},get:function(prop){if(this.getter[prop]){return this.getter[prop].apply(this)}else{return this[prop]||0}},setter:{rotate:function(theta){this.rotate=unit(theta,"deg")},rotateX:function(theta){this.rotateX=unit(theta,"deg")},rotateY:function(theta){this.rotateY=unit(theta,"deg")},scale:function(x,y){if(y===undefined){y=x}this.scale=x+","+y},skewX:function(x){this.skewX=unit(x,"deg")},skewY:function(y){this.skewY=unit(y,"deg")},perspective:function(dist){this.perspective=unit(dist,"px")},x:function(x){this.set("translate",x,null)},y:function(y){this.set("translate",null,y)},translate:function(x,y){if(this._translateX===undefined){this._translateX=0}if(this._translateY===undefined){this._translateY=0}if(x!==null&&x!==undefined){this._translateX=unit(x,"px")}if(y!==null&&y!==undefined){this._translateY=unit(y,"px")}this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var s=(this.scale||"1,1").split(",");if(s[0]){s[0]=parseFloat(s[0])}if(s[1]){s[1]=parseFloat(s[1])}return s[0]===s[1]?s[0]:s},rotate3d:function(){var s=(this.rotate3d||"0,0,0,0deg").split(",");for(var i=0;i<=3;++i){if(s[i]){s[i]=parseFloat(s[i])}}if(s[3]){s[3]=unit(s[3],"deg")}return s}},parse:function(str){var self=this;str.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(x,prop,val){self.setFromString(prop,val)})},toString:function(use3d){var re=[];for(var i in this){if(this.hasOwnProperty(i)){if(!support.transform3d&&(i==="rotateX"||i==="rotateY"||i==="perspective"||i==="transformOrigin")){continue}if(i[0]!=="_"){if(use3d&&i==="scale"){re.push(i+"3d("+this[i]+",1)")}else if(use3d&&i==="translate"){re.push(i+"3d("+this[i]+",0)")}else{re.push(i+"("+this[i]+")")}}}}return re.join(" ")}};function callOrQueue(self,queue,fn){if(queue===true){self.queue(fn)}else if(queue){self.queue(queue,fn)}else{fn()}}function getProperties(props){var re=[];$.each(props,function(key){key=$.camelCase(key);key=$.transit.propertyMap[key]||$.cssProps[key]||key;key=uncamel(key);if($.inArray(key,re)===-1){re.push(key)}});return re}function getTransition(properties,duration,easing,delay){var props=getProperties(properties);if($.cssEase[easing]){easing=$.cssEase[easing]}var attribs=""+toMS(duration)+" "+easing;if(parseInt(delay,10)>0){attribs+=" "+toMS(delay)}var transitions=[];$.each(props,function(i,name){transitions.push(name+" "+attribs)});return transitions.join(", ")}$.fn.transition=$.fn.transit=function(properties,duration,easing,callback){var self=this;var delay=0;var queue=true;var theseProperties=jQuery.extend(true,{},properties);if(typeof duration==="function"){callback=duration;duration=undefined}if(typeof duration==="object"){easing=duration.easing;delay=duration.delay||0;queue=duration.queue||true;callback=duration.complete;duration=duration.duration}if(typeof easing==="function"){callback=easing;easing=undefined}if(typeof theseProperties.easing!=="undefined"){easing=theseProperties.easing;delete theseProperties.easing}if(typeof theseProperties.duration!=="undefined"){duration=theseProperties.duration;delete theseProperties.duration}if(typeof theseProperties.complete!=="undefined"){callback=theseProperties.complete;delete theseProperties.complete}if(typeof theseProperties.queue!=="undefined"){queue=theseProperties.queue;delete theseProperties.queue}if(typeof theseProperties.delay!=="undefined"){delay=theseProperties.delay;delete theseProperties.delay}if(typeof duration==="undefined"){duration=$.fx.speeds._default}if(typeof easing==="undefined"){easing=$.cssEase._default}duration=toMS(duration);var transitionValue=getTransition(theseProperties,duration,easing,delay);var work=$.transit.enabled&&support.transition;var i=work?parseInt(duration,10)+parseInt(delay,10):0;if(i===0){var fn=function(next){self.css(theseProperties);if(callback){callback.apply(self)}if(next){next()}};callOrQueue(self,queue,fn);return self}var oldTransitions={};var run=function(nextCall){var bound=false;var cb=function(){if(bound){self.unbind(transitionEnd,cb)}if(i>0){self.each(function(){this.style[support.transition]=oldTransitions[this]||null})}if(typeof callback==="function"){callback.apply(self)}if(typeof nextCall==="function"){nextCall()}};if(i>0&&transitionEnd&&$.transit.useTransitionEnd){bound=true;self.bind(transitionEnd,cb)}else{window.setTimeout(cb,i)}self.each(function(){if(i>0){this.style[support.transition]=transitionValue}$(this).css(properties)})};var deferredRun=function(next){this.offsetWidth;run(next)};callOrQueue(self,queue,deferredRun);return this};function registerCssHook(prop,isPixels){if(!isPixels){$.cssNumber[prop]=true}$.transit.propertyMap[prop]=support.transform;$.cssHooks[prop]={get:function(elem){var t=$(elem).css("transit:transform");return t.get(prop)},set:function(elem,value){var t=$(elem).css("transit:transform");t.setFromString(prop,value);$(elem).css({"transit:transform":t})}}}function uncamel(str){return str.replace(/([A-Z])/g,function(letter){return"-"+letter.toLowerCase()})}function unit(i,units){if(typeof i==="string"&&!i.match(/^[\-0-9\.]+$/)){return i}else{return""+i+units}}function toMS(duration){var i=duration;if(typeof i==="string"&&!i.match(/^[\-0-9\.]+/)){i=$.fx.speeds[i]||$.fx.speeds._default}return unit(i,"ms")}$.transit.getTransitionValue=getTransition})(jQuery);(function($){var min_handle_height=70;var min_scrollbar_width=17;var native_bar_w;var getNativeBarWidth=function(){if(window.chrome)return min_scrollbar_width;var div=$('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"></div>').appendTo("body");var innerDiv=$('<div style="height:100px;"></div>').appendTo(div);var w1=innerDiv.innerWidth();div.css("overflow-y","auto");var w2=innerDiv.innerWidth();div.remove();return Math.max(w1-w2,min_scrollbar_width)};$.fn.extend({monkeyScroll:function(options){options=options||{};return this.each(function(index,elem){var $elem=$(elem);if($elem.data("monkeyScroll")){return}$elem.addClass("monkey_scroller");var triggered_by_resize=false;var wrapper_id=elem.id?"monkey_scroll_wrapper_for_"+elem.id:"";var debug_class=options.debug?"debug":"";var $hider=$elem.wrap('<div class="monkey_scroll_hider '+debug_class+'" />').parent();var $wrapper=$hider.wrap('<div id="'+wrapper_id+'" class="monkey_scroll_wrapper '+debug_class+'" />').parent();var $bar=$wrapper.prepend('<div class="monkey_scroll_bar '+debug_class+'" />').children(".monkey_scroll_bar");var $handle=$bar.prepend(['<div class="monkey_scroll_handle '+debug_class+'">','	<div class="monkey_scroll_handle_inner '+debug_class+'"></div>',"</div>"].join("")).children(".monkey_scroll_handle");var $handle_inner=$handle.find(".monkey_scroll_handle_inner");var needed_w=Math.max($bar.width(),$handle.width());var bar_margin_top=parseInt($bar.css("margin-top"));var bar_margin_bottom=parseInt($bar.css("margin-bottom"));$handle.css("left",-(($handle.width()-$bar.width())/2));var getDesiredBarHeight=function(){var val=Math.max(Math.min(min_handle_height,$elem[0].clientHeight),$elem[0].clientHeight-(bar_margin_top+bar_margin_bottom));return val};var hideW=function(){native_bar_w=native_bar_w||getNativeBarWidth();return Math.max(needed_w,native_bar_w)};var _current_bar_color="";var setBarColor=function(current_ratio){var colors=options.bar_colors;var largest_ratio,ratio;var color="";if(!colors)return;for(ratio in colors){if(colors.hasOwnProperty(ratio)){if(ratio<=current_ratio&&(!largest_ratio||ratio>largest_ratio)){largest_ratio=ratio}}}if(largest_ratio){color=colors[largest_ratio]}if(color!==_current_bar_color){$handle_inner.css("background",color);_current_bar_color=color}};var getState=function(){var data=$elem.data("monkeyScroll");if(!data){destroy();return null}var ch=$elem[0].clientHeight;var sh=$elem[0].scrollHeight;var st=$elem[0].scrollTop;var w=$elem.width();var diff=sh-ch;var ratio=diff?st/diff:1;var perc_visible=ch/sh;data.state_ob.st=st;data.state_ob.sh=sh;data.state_ob.ch=ch;data.state_ob.w=w;data.state_ob.ratio=ratio;data.state_ob.perc_visible=perc_visible;return data.state_ob};var updateBar=function(){var state=getState($elem);if(!state){return}var needs_scroll=state.perc_visible<1;$hider.css("margin-right",needs_scroll?hideW():"");if(!needs_scroll){if(options.always_show){$handle.addClass("hidden")}else{if($elem.css("overflow-y")!="scroll"){$hider.css("width","100%")}$bar.addClass("hidden");return}}else{if(options.always_show){$handle.removeClass("hidden")}}$bar.removeClass("hidden");var bh=getDesiredBarHeight();$bar.css("height",bh);$handle.css("height",Math.max(min_handle_height,bh*state.perc_visible));var range=bh-$handle.height();$handle.css("top",range*state.ratio);setBarColor(state.ratio)};var update=function(){var start=Date.now();var gutter_width=5;$hider.css("width","");$hider.css("margin-right","");$elem.css("width","");$elem.width($elem.width());var hider_width=$elem.innerWidth()-hideW();if(options.no_gutter){hider_width+=gutter_width}$hider.width(hider_width);if(options.bar_on_left){if("bar_on_left_y"in options){$bar.css("margin-left",options.bar_on_left_y)}else{$bar.css("margin-left",(hideW()-$bar.width())/2)}}else{var margin_left=$hider.width()+(hideW()-$bar.width())/2;if(options.no_gutter){margin_left-=gutter_width}$bar.css("margin-left",margin_left)}updateBar();TS.log(389,"update for "+$elem.attr("id")+" took "+(Date.now()-start)+"ms")};$elem.data("monkeyScroll",{bar:$bar,handle:$handle,state_ob:{},updateFunc:maybeUpdate});var onElemScroll=function(e){if($elem.data("disable-scroll"))return;updateBar()};var onBarMousedown=function(e){e.preventDefault();var getNewScrollTop=function(y){var hh=$handle.height();var perc_y=(y-hh/2)/($bar.height()-hh);var range=$elem[0].scrollHeight-$elem[0].clientHeight;return range*perc_y};var $el=$(e.target);var y=e.pageY-$el.offset().top;if($el.hasClass("monkey_scroll_bar")){$elem.animate({scrollTop:getNewScrollTop(y)},200);return}var handle_offset=y;var onMousemove=function(e){var y=e.pageY-$bar.offset().top+$handle.height()/2-handle_offset;$elem.scrollTop(getNewScrollTop(y))};var unbindMousemove=function(){$("html").unbind("mousemove.monkeyScroll",onMousemove);$("html").unbind("mouseup.monkeyScroll",unbindMousemove)};unbindMousemove();$("html").bind("mousemove.monkeyScroll",onMousemove);$("html").bind("mouseup.monkeyScroll",unbindMousemove)};$bar.bind("mousedown",onBarMousedown);$elem.bind("scroll",onElemScroll);var resize_monkey_throttled=function(){native_bar_w=null;$elem.css("width","");maybeUpdate()};var resizeCallback=function(e){triggered_by_resize=true;TS.utility.throttle.method(resize_monkey_throttled,"resize_monkey",150)};$(window).bind("resize.monkey",resizeCallback);var mouseup_assigned;var fixDragToRevealOverFlow=function(){if(mouseup_assigned)return;mouseup_assigned=true;$("html").bind("mouseup.monkeyScrollOverflowfixer",fixDragToRevealOverFlowWorker)};var fixDragToRevealOverFlowWorker=function(){$hider.scrollLeft(0);mouseup_assigned=false;$("html").unbind("mouseup.monkeyScrollOverflowfixer",arguments.callee)};$hider.bind("scroll",fixDragToRevealOverFlow);update();var was_state;function maybeUpdate(force){if($elem.data("disable-scroll"))return;function maybeUpdateRAF(){var new_state=getState();if(!new_state){return}if(force||!was_state||new_state.sh!=was_state.sh||new_state.ch!=was_state.ch||new_state.w!=was_state.w){update();if(!was_state)was_state={};was_state.st=new_state.st;was_state.sh=new_state.sh;was_state.ch=new_state.ch;was_state.w=new_state.w;was_state.ratio=new_state.ratio;was_state.perc_visible=new_state.perc_visible}}if(window.bowser&&(bowser.msie||triggered_by_resize&&TS.model.is_mac&&(bowser.safari||TS.model.is_our_app))){maybeUpdateRAF()}else{TS.utility.queueRAF(maybeUpdateRAF)}triggered_by_resize=false}var interv;if(options.update_on_interval){interv=setInterval(maybeUpdate,200)}var destroy=function(){$(window).unbind("resize.monkey",resizeCallback);$("html").unbind("mouseup.monkeyScrollOverflowfixer",fixDragToRevealOverFlowWorker);if(interv)clearInterval(interv);$elem.removeData("monkeyScroll")};$elem.bind("remove",function(){destroy()})})}})})(jQuery);(function($){$.fn.setCursorPosition=function(pos){this.each(function(index,elem){if(elem.setSelectionRange){elem.setSelectionRange(pos,pos)}else if(elem.createTextRange){var range=elem.createTextRange();range.collapse(true);range.moveEnd("character",pos);range.moveStart("character",pos);range.select()}});return this};$.fn.getCursorPosition=function(){var input=this.get(0);if(!input)return;if("selectionStart"in input){return input.selectionStart}else if(document.selection){input.focus();var sel=document.selection.createRange();var selLen=document.selection.createRange().text.length;sel.moveStart("character",-input.value.length);return sel.text.length-selLen}};$.fn.getCursorRange=function(){var input=this.get(0);if(!input)return;if("selectionStart"in input){return{s:input.selectionStart,l:input.selectionEnd-input.selectionStart}}else if(document.selection){}};jQuery.fn.highlight=function(duration,class_name,onComplete,delay){delay=delay==undefined?2e3:delay;$(this).each(function(){var el=$(this);var el_position_changed=false;if(el.data("highlighted"))return;el.data("highlighted",true);if(el.css("position")=="static"){el.css("position","relative");el_position_changed=true}$('<div class="'+class_name+'" />').width(el.outerWidth()).height(el.outerHeight()).css({position:"absolute",left:0,top:0,"background-color":"#FFF3B8",opacity:".6","z-index":"1030","pointer-events":"none"}).appendTo(el).delay(delay).fadeOut(duration).queue(function(){$(this).remove();el.data("highlighted",false);if(el_position_changed){el.css("position","static")}if(onComplete)onComplete()})})},jQuery.fn.highlightText=function(duration,class_name,onComplete,delay){delay=delay==undefined?2e3:delay;$(this).each(function(){var el=$(this);var el_original_bg=$(this).css("background-color");if(el.data("highlighted"))return;el.data("highlighted",true);el.css({"background-color":"#FFF3B8",transition:"background-color 0.25s"}).delay(delay).queue(function(){el.css({"background-color":el_original_bg});el.data("highlighted",false);if(onComplete)onComplete()})})},jQuery.fn.hideWithRememberedScrollTop=function(){$(this).each(function(){var el=$(this);if(el.hasClass("hidden"))return;el.data("remembered_scrolltop",el.scrollTop());var scrollers=el.find(":scrollable()");scrollers.each(function(index,desc){var $desc=$(desc);$desc.data("remembered_scrolltop",$desc.scrollTop())});el.addClass("hidden")})};jQuery.fn.unhideWithRememberedScrollTop=function(){$(this).each(function(){var el=$(this);if(!el.hasClass("hidden"))return;el.removeClass("hidden");var remembered_scrolltop=el.data("remembered_scrolltop");if(remembered_scrolltop!=undefined){el.scrollTop(remembered_scrolltop)}var scrollers=el.find(":scrollable()");if(scrollers){scrollers.each(function(index,desc){var $desc=$(desc);remembered_scrolltop=$desc.data("remembered_scrolltop");if(remembered_scrolltop!=undefined){$desc.scrollTop(remembered_scrolltop)}})}})}})(jQuery);(function($){if(!$){return}$.fn.headroom=function(option){return this.each(function(){var $this=$(this),data=$this.data("headroom"),options=typeof option==="object"&&option;options=$.extend(true,{},Headroom.options,options);if(!data){data=new Headroom(this,options);data.init();$this.data("headroom",data)}if(typeof option==="string"){data[option]()}})};$("[data-headroom]").each(function(){var $this=$(this);$this.headroom($this.data())})})(window.Zepto||window.jQuery);(function($){$.event.special.textchange={setup:function(data,namespaces){$(this).data("textchange_lastvalue",this.contentEditable==="true"?$(this).html():$(this).val());$(this).bind("keyup.textchange",$.event.special.textchange.handler);$(this).bind("cut.textchange paste.textchange input.textchange",$.event.special.textchange.delayedHandler)},teardown:function(namespaces){$(this).unbind(".textchange")},handler:function(event){$.event.special.textchange.triggerIfChanged($(this))},delayedHandler:function(event){var element=$(this);if(!$.event.special.textchange.timer){$.event.special.textchange.timer=setTimeout(function(){$.event.special.textchange.timer=null;$.event.special.textchange.triggerIfChanged(element)},250)}},triggerIfChanged:function(element){var current=element[0].contentEditable==="true"?element.html():element.val();if(current!==element.data("textchange_lastvalue")){element.trigger("textchange",[element.data("textchange_lastvalue")]);element.data("textchange_lastvalue",current)}},timer:null};$.event.special.hastext={setup:function(data,namespaces){$(this).bind("textchange",$.event.special.hastext.handler)},teardown:function(namespaces){$(this).unbind("textchange",$.event.special.hastext.handler)},handler:function(event,textchange_lastvalue){if(textchange_lastvalue===""&&textchange_lastvalue!==$(this).val()){$(this).trigger("hastext")}}};$.event.special.notext={setup:function(data,namespaces){$(this).bind("textchange",$.event.special.notext.handler)},teardown:function(namespaces){$(this).unbind("textchange",$.event.special.notext.handler)},handler:function(event,textchange_lastvalue){if($(this).val()===""&&$(this).val()!==textchange_lastvalue){$(this).trigger("notext")}}}})(jQuery);(function($){$.fn.autogrow=function(options){return this.filter("textarea").each(function(){var self=this;var $self=$(self);var minHeight=$self.height();var noFlickerPad=$self.hasClass("autogrow-short")?0:parseInt($self.css("lineHeight"))||0;var shadow=$("<div></div>").css({position:"absolute",top:-1e4,left:-1e4,width:$self.width(),fontSize:$self.css("fontSize"),fontFamily:$self.css("fontFamily"),fontWeight:$self.css("fontWeight"),lineHeight:$self.css("lineHeight"),resize:"none","word-wrap":"break-word"}).appendTo(document.body);var update=function(event){var times=function(string,number){for(var i=0,r="";i<number;i++)r+=string;return r};var val=self.value.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&/g,"&amp;").replace(/\n$/,"<br/>&nbsp;").replace(/\n/g,"<br/>").replace(/ {2,}/g,function(space){return times("&nbsp;",space.length-1)+" "});if(event&&event.data&&event.data.event==="keydown"&&event.keyCode===13){val+="<br />"}var was_h=$self.height();shadow.css("width",$self.width());shadow.html(val+(noFlickerPad===0?"...":""));$self.height(Math.max(shadow.height()+noFlickerPad,minHeight));var cp=$self.getCursorPosition();var tl=$self.val().length;if(tl-cp<10){if($self.length&&document.activeElement==$self[0]){var parent_scroller=$self.closest(".flex_content_scroller");var parent_modal=$self.closest(".modal");if(parent_scroller.length){var $el_to_keep_in_view=$self;if($self.data("el-id-to-keep-in-view")){$el_to_keep_in_view=$("#"+$self.data("el-id-to-keep-in-view"));if(!$el_to_keep_in_view.length)$el_to_keep_in_view=$self}if(!TS.client.ui.isElInView($el_to_keep_in_view,-50,parent_scroller.dimensions_rect())){$el_to_keep_in_view.scrollintoview({offset:"bottom",px_offset:-50,duration:200})}if($self.height()!=was_h){if(parent_scroller.data("monkeyScroll")){parent_scroller.data("monkeyScroll").updateFunc()}}}else if(parent_modal.length==-1){$self.scrollintoview({offset:"bottom",px_offset:-50,duration:200})}}}};$self.change(update).keyup(update).keydown({event:"keydown"},update);$(window).on("resize",update);$self.one("remove",function(){$(window).off("resize",update)});update()})}})(jQuery);(function($){$.event.special.destroyed={remove:function(o){if(o.handler){o.handler()}}}})(jQuery);$.fn.draghover=function(options){return this.each(function(){var collection=$(),self=$(this);self.on("dragenter",function(e){if(collection.size()===0)self.trigger("draghoverstart",e);collection=collection.add(e.target)});self.on("dragleave drop",function(e){setTimeout(function(){collection=collection.not(e.target);if(collection.size()===0)self.trigger("draghoverend")},1)})})};(function($){var defaults={className:"autosizejs",id:"autosizejs",append:"\n",callback:false,resizeDelay:200,placeholder:true},copy='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',typographyStyles=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],mirrored,mirror=$(copy).data("autosize",true)[0];mirror.style.lineHeight="99px";if($(mirror).css("lineHeight")==="99px"){typographyStyles.push("lineHeight")}mirror.style.lineHeight="";$.fn.autosize=function(options){if(!this.length){return this}options=$.extend({},defaults,options||{});if(mirror.parentNode!==document.body){$(document.body).append(mirror)}return this.each(function(){var ta=this,$ta=$(ta),maxHeight,minHeight,boxOffset=0,callback=$.isFunction(options.callback),originalStyles={height:ta.style.height,overflow:ta.style.overflow,overflowY:ta.style.overflowY,wordWrap:ta.style.wordWrap,resize:ta.style.resize},width=$ta.width(),taResize=$ta.css("resize");if($ta.data("autosize")){return}$ta.data("autosize",true);if($ta.css("box-sizing")==="border-box"||$ta.css("-moz-box-sizing")==="border-box"||$ta.css("-webkit-box-sizing")==="border-box"){boxOffset=$ta.outerHeight()-$ta.height()}boxOffset-=typeof options.boxOffset!=="undefined"?options.boxOffset:0;minHeight=Math.max(parseInt($ta.css("minHeight"),10)-boxOffset||0,$ta.height());
$ta.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word"});if(taResize==="vertical"){$ta.css("resize","none")}else if(taResize==="both"){$ta.css("resize","horizontal")}function setWidth(){var width;var style=window.getComputedStyle?window.getComputedStyle(ta,null):false;if(style){width=ta.getBoundingClientRect().width;if(width===0||typeof width!=="number"){width=parseInt(style.width,10)}$.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(i,val){width-=parseInt(style[val],10)})}else{width=$ta.width()}mirror.style.width=Math.max(width,0)+"px"}function initMirror(){var styles={};mirrored=ta;mirror.className=options.className;mirror.id=options.id;maxHeight=parseInt($ta.css("maxHeight"),10);$.each(typographyStyles,function(i,val){styles[val]=$ta.css(val)});$(mirror).css(styles).attr("wrap",$ta.attr("wrap"));setWidth();if(window.chrome){var width=ta.style.width;ta.style.width="0px";var ignore=ta.offsetWidth;ta.style.width=width}}function adjust(){var height,original;if(mirrored!==ta){initMirror()}else{setWidth()}if(!ta.value&&options.placeholder){mirror.value=($ta.attr("placeholder")||"")+options.append}else{mirror.value=ta.value+options.append}mirror.style.overflowY=ta.style.overflowY;original=parseInt(ta.style.height,10);mirror.scrollTop=9e4;height=mirror.scrollTop;if(maxHeight&&height>maxHeight){ta.style.overflowY="scroll";height=maxHeight}else{ta.style.overflowY="hidden";if(height<minHeight){height=minHeight}}height=parseInt(height,10);if(original!==height){ta.style.height=height+"px";if(callback){options.callback.call(ta,original,height)}}}function resize_throttled(){var newWidth=$ta.width();if(newWidth!==width){width=newWidth;adjust()}}function resize(){TS.utility.throttle.method(resize_throttled,"autosize_resize",options.resizeDelay)}if("onpropertychange"in ta){if("oninput"in ta){$ta.on("input keyup",adjust)}else{$ta.on("propertychange.autosize",function(){if(event.propertyName==="value"){adjust()}})}}else{$ta.on("input",adjust)}if(options.resizeDelay!==false){$(window).on("resize.autosize",resize)}$ta.on("autosize.resize",adjust);$ta.on("autosize-resize",adjust);$ta.on("autosize.resizeIncludeStyle",function(){mirrored=null;adjust()});$ta.on("autosize.destroy",function(){mirrored=null;$(window).off("resize",resize);$ta.off("autosize").off(".autosize").css(originalStyles).removeData("autosize")});adjust()})}})(window.jQuery||window.$);(function($){var dragging,placeholders=$();$.fn.sortable=function(options){var method=String(options);options=$.extend({connectWith:false},options);return this.each(function(){if(/^(enable|disable|destroy)$/.test(method)){var items=$(this).children($(this).data("items")).attr("draggable",method=="enable");if(method=="destroy"){items.add(this).removeData("connectWith items").off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s")}return}var isHandle,index,items=$(this).children(options.items);var placeholder=$("<"+(/^(ul|ol)$/i.test(this.tagName)?"li":"div")+' class="sortable-placeholder">');items.find(options.handle).mousedown(function(){isHandle=true}).mouseup(function(){isHandle=false});$(this).data("items",options.items);placeholders=placeholders.add(placeholder);if(options.connectWith){$(options.connectWith).add(this).data("connectWith",options.connectWith)}items.attr("draggable","true").on("dragstart.h5s",function(e){if(options.handle&&!isHandle){return false}isHandle=false;var dt=e.originalEvent.dataTransfer;dt.effectAllowed="move";dt.setData("Text","dummy");index=(dragging=$(this)).addClass("sortable-dragging").index()}).on("dragend.h5s",function(){if(!dragging){return}dragging.removeClass("sortable-dragging").show();placeholders.detach();if(index!=dragging.index()){dragging.parent().trigger("sortupdate",{item:dragging})}dragging=null}).not("a[href], img").on("selectstart.h5s",function(){this.dragDrop&&this.dragDrop();return false}).end().add([this,placeholder]).on("dragover.h5s dragenter.h5s drop.h5s",function(e){if(!items.is(dragging)&&options.connectWith!==$(dragging).parent().data("connectWith")){return true}if(e.type=="drop"){e.stopPropagation();placeholders.filter(":visible").after(dragging);dragging.trigger("dragend.h5s");return false}e.preventDefault();e.originalEvent.dataTransfer.dropEffect="move";if(items.is(this)){if(options.forcePlaceholderSize&&dragging.is(":visible")){placeholder.height(dragging.outerHeight())}dragging.hide();$(this)[placeholder.index()<$(this).index()?"after":"before"](placeholder);placeholders.not(placeholder).detach()}else if(!placeholders.is(this)&&!$(this).children(options.items).length){placeholders.detach();$(this).append(placeholder)}return false})})}})(jQuery);(function($){function buildCmdsHistory(input){var data=input.data("TS-tabComplete");var cmds=data.cmds=[];var hist=TS.model.input_history;var cmd;for(var i=0;i<hist.length;i++){cmd=hist[i];if(cmd.indexOf("/")==0){cmds.push(cmd)}}return cmds}function completeOnCommands(txt,input,e){if(TS.model.input_history.length==0){return false}var data=input.data("TS-tabComplete");var cmds=data.cmds||buildCmdsHistory(input);var temp_matches;if(data.cmd_matches){temp_matches=data.cmd_matches;if(e.shiftKey){data.cmd_matches_index--;if(data.cmd_matches_index<0){data.cmd_matches_index=data.cmd_matches.length-1}}else{data.cmd_matches_index++;if(data.cmd_matches_index>=data.cmd_matches.length){data.cmd_matches_index=0}}}else{temp_matches=[];data.cmd_matches_index=0;var cmd;for(var i=0;i<cmds.length;i++){cmd=cmds[i];if(txt&&cmd.toLowerCase().indexOf(txt.toLowerCase())!=0)continue;temp_matches.push(cmd)}if(!temp_matches.length){return false}if(temp_matches.length>1){data.cmd_matches=temp_matches}}var match=temp_matches[data.cmd_matches_index];if(data.onComplete){data.onComplete(match)}input.setCursorPosition(input.val().length);return true}function completeOnChannels(txt,input,e){var data=input.data("TS-tabComplete");var cp=input.getCursorPosition();if(cp==0){return false}var before=txt.substr(0,cp);var beforeA=before.split(" ");var word_before=beforeA[beforeA.length-1].toLowerCase();var prefix="";if(!word_before&&!data.channel_matches){return false}if(word_before){var good=false;if(word_before.indexOf("#")==0)good=true;if(data.channel_prefix){if(word_before.indexOf(data.channel_prefix+"#")==0)good=true;if(word_before.indexOf(data.channel_prefix)==0)good=true}if(!good)return false}var temp_matches;var match;if(!word_before){temp_matches=data.channel_matches;if(e.shiftKey){data.channel_matches_index--;if(data.channel_matches_index<0){data.channel_matches_index=data.channel_matches.length-1}}else{data.channel_matches_index++;if(data.channel_matches_index>=data.channel_matches.length){data.channel_matches_index=0}}match=temp_matches[data.channel_matches_index];var name_chunk=beforeA[beforeA.length-2];if(data.channel_prefix&&name_chunk.toLowerCase().indexOf(data.channel_prefix.toLowerCase())==0){prefix=data.channel_prefix}beforeA[beforeA.length-2]=prefix+"#"+match}else{temp_matches=[];var channels=TS.channels.getChannelsForUser();var channel;var name;var search_str=word_before.replace("#","");if(data.channel_prefix&&word_before.toLowerCase().indexOf(data.channel_prefix.toLowerCase())==0){search_str=search_str.substr(data.channel_prefix.length);prefix=data.channel_prefix}for(var i=0;i<channels.length;i++){channel=channels[i];if(channel.is_archived)continue;name=channel._name_lc;if(name.indexOf(search_str)==0||("#"+name).indexOf(search_str)==0){temp_matches.push(channel.name)}}if(!temp_matches.length){return false}reset(input,"subsequent name match press");data.channel_matches_index=0;if(temp_matches.length>1){data.channel_matches=temp_matches}match=temp_matches[data.channel_matches_index];beforeA[beforeA.length-1]=prefix+"#"+match+" "}var new_before=beforeA.join(" ");var new_cp=new_before.length;var new_txt=txt.replace(before,new_before);if(data.onComplete){data.onComplete(new_txt)}input.setCursorPosition(new_cp);return true}function completeOnMembers(txt,input,e){var data=input.data("TS-tabComplete");var cp=input.getCursorPosition();if(cp==0){return false}var before=txt.substr(0,cp);var beforeA=before.split(" ");var word_before=beforeA[beforeA.length-1].toLowerCase();var prefix="";if(!word_before&&!data.member_matches){return false}var colon="";var at="";var temp_matches;var match;if(!word_before){temp_matches=data.member_matches;if(e.shiftKey){data.member_matches_index--;if(data.member_matches_index<0){data.member_matches_index=data.member_matches.length-1}}else{data.member_matches_index++;if(data.member_matches_index>=data.member_matches.length){data.member_matches_index=0}}match=temp_matches[data.member_matches_index];var name_chunk=beforeA[beforeA.length-2];if(data.member_prefix&&name_chunk.toLowerCase().indexOf(data.member_prefix.toLowerCase())==0){prefix=data.member_prefix}if(beforeA.length-2==0&&data.member_colon)colon=":";if(name_chunk.indexOf("@")>-1)at="@";beforeA[beforeA.length-2]=prefix+at+match+colon}else{temp_matches=[];var members=[];var members_for_user=data.include_self?TS.members.getActiveMembersWithSelfAndSlackbot():TS.members.getActiveMembersWithSlackbotAndNotSelf();for(var i=0;i<members_for_user.length;i++){if(members_for_user[i].deleted)continue;members.push(members_for_user[i])}var member;var name;var search_str=word_before;if(data.member_prefix&&word_before.toLowerCase().indexOf(data.member_prefix.toLowerCase())==0){search_str=search_str.substr(data.member_prefix.length);prefix=data.member_prefix}for(var i=0;i<members.length;i++){member=members[i];name=member._name_lc;if(name.indexOf(search_str)==0||("@"+name).indexOf(search_str)==0){temp_matches.push(member.name)}}if(data.complete_member_specials){if("@everyone".indexOf(search_str)==0){temp_matches.push("everyone")}if("@channel".indexOf(search_str)==0){temp_matches.push("channel")}if("@group".indexOf(search_str)==0){temp_matches.push("group")}}if(!temp_matches.length){return false}reset(input,"subsequent name match press");data.member_matches_index=0;if(temp_matches.length>1){data.member_matches=temp_matches}match=temp_matches[data.member_matches_index];if(beforeA.length-1==0&&data.member_colon)colon=":";if(beforeA[beforeA.length-1].indexOf("@")>-1)at="@";beforeA[beforeA.length-1]=prefix+at+match+colon+" "}var new_before=beforeA.join(" ");var new_cp=new_before.length;var new_txt=txt.replace(before,new_before);if(data.onComplete){data.onComplete(new_txt)}input.setCursorPosition(new_cp);return true}function completeOnEmoji(txt,input,e){var data=input.data("TS-tabComplete");var cp=input.getCursorPosition();if(cp==0){return false}var before=txt.substr(0,cp);var beforeA=before.split(" ");var word_before=beforeA[beforeA.length-1].toLowerCase();if(!word_before&&!data.emoji_matches){return false}if(word_before&&word_before.indexOf(":")!=0){return false}var temp_emoji_matches;var match;if(!word_before){temp_emoji_matches=data.emoji_matches;if(e.shiftKey){data.emoji_matches_index--;if(data.emoji_matches_index<0){data.emoji_matches_index=data.emoji_matches.length-1}}else{data.emoji_matches_index++;if(data.emoji_matches_index>=data.emoji_matches.length){data.emoji_matches_index=0}}match=temp_emoji_matches[data.emoji_matches_index];var name_chunk=beforeA[beforeA.length-2];beforeA[beforeA.length-2]=":"+match+":"}else{temp_emoji_matches=[];var emoji_names=TS.model.emoji_names;var name;var search_str=word_before.replace(":","");var rx=new RegExp("(^)"+TS.utility.regexpEscape(search_str,1e3),"i");for(var i=0;i<emoji_names.length;i++){name=emoji_names[i];if(!search_str||name.match(search_str)){temp_emoji_matches.push(name)}}if(!temp_emoji_matches.length){return false}reset(input,"subsequent emoji match press");data.emoji_matches_index=0;if(temp_emoji_matches.length>1){data.emoji_matches=temp_emoji_matches}match=temp_emoji_matches[data.emoji_matches_index];beforeA[beforeA.length-1]=":"+match+":"+" "}var new_before=beforeA.join(" ");var new_cp=new_before.length;var new_txt=txt.replace(before,new_before);if(data.onComplete){data.onComplete(new_txt)}input.setCursorPosition(new_cp);return true}function reset(input,why){var data=input.data("TS-tabComplete");data.cmds=null;data.cmd_matches=null;data.cmd_matches_index=-1;data.member_matches=null;data.member_matches_index=-1;data.emoji_matches=null;data.emoji_matches_index=-1;data.channel_matches=null;data.channel_matches_index=-1}function go(input,e){var data=input.data("TS-tabComplete");var txt=input.val();if(data.complete_emoji&&completeOnEmoji(txt,input,e)){}else if(data.complete_channels&&completeOnChannels(txt,input,e)){}else if(data.complete_members&&completeOnMembers(txt,input,e)){}else if(data.complete_cmds&&(!txt||txt.indexOf("/")==0)&&completeOnCommands(txt,input,e)){}}var methods={init:function(options){var settings=$.extend({complete_member_specials:false,complete_members:true,member_prefix:"",member_colon:true,complete_cmds:false,complete_emoji:false,complete_channels:false,channel_prefix:"",include_self:false},options);return this.each(function(){var $this=$(this);if($this.data("TS-tabComplete")){return}$this.data("TS-tabComplete",{cmds:null,cmd_matches:null,cmd_matches_index:-1,member_matches:null,member_matches_index:-1,complete_member_specials:settings.complete_member_specials,complete_members:settings.complete_members,member_prefix:settings.member_prefix,member_colon:settings.member_colon,complete_cmds:settings.complete_cmds,complete_emoji:settings.complete_emoji,complete_channels:settings.complete_channels,channel_prefix:settings.channel_prefix,include_self:settings.include_self,onComplete:settings.onComplete});$this.bind("focus",function(e){$this.TS_tabComplete("resetMatches","focus")})})},resetMatches:function(why){return this.each(function(){reset($(this),why)})},onTabKey:function(e){e.preventDefault();return this.each(function(){go($(this),e)})}};$.fn.TS_tabComplete=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method==="object"||!method){return methods.init.apply(this,arguments)}else{$.error("Method "+method+" does not exist on jQuery.tooltip")}}})(jQuery);(function($){var do_log=false;var MATCHES_SET="MATCHES_SET";var MATCH_CHANGED="MATCH_CHANGED";function cycle(i,max){if(i>max)return 0;if(i<0)return max;return i}function buildCmdsHistory(input){var data=input.data("TS-tabComplete");var cmds=data.cmds=[];var hist=TS.model.input_history;var cmd;for(var i=0;i<hist.length;i++){cmd=hist[i];if(cmd.indexOf("/")==0){cmds.push(cmd)}}return cmds}function completeOnCommands(txt,input,e){if(TS.model.input_history.length==0){return false}var data=input.data("TS-tabComplete");var cmds=data.cmds||buildCmdsHistory(input);var temp_matches;if(data.cmd_matches){temp_matches=data.cmd_matches;if(e&&e.shiftKey){data.cmd_matches_index--;if(data.cmd_matches_index<0){data.cmd_matches_index=data.cmd_matches.length-1}}else{data.cmd_matches_index++;if(data.cmd_matches_index>=data.cmd_matches.length){data.cmd_matches_index=0}}}else{temp_matches=[];data.cmd_matches_index=0;var cmd;for(var i=0;i<cmds.length;i++){cmd=cmds[i];if(txt&&cmd.toLowerCase().indexOf(txt.toLowerCase())!=0)continue;temp_matches.push(cmd)}if(!temp_matches.length){return false}if(temp_matches.length>1){data.cmd_matches=temp_matches}}if(!e)return true;var match=temp_matches[data.cmd_matches_index];if(data.onComplete){data.onComplete(match)}input.focus().setCursorPosition(1e6);return true}function completeOnCommandsNew(txt,input,e){var data=input.data("TS-tabComplete");var cp=input.getCursorPosition();if(cp==0){}if(txt.indexOf("/")!=0){return false}var all_after_str=txt.substr(cp);var lines_beforeA=txt.substr(0,cp).split("\n");var before=lines_beforeA.pop();var beforeA=before.split(" ");var word_before=beforeA[beforeA.length-1].toLowerCase();var cmd_handlers=TS.cmd_handlers;var chosen_cmd="";if(!word_before&&!data.cmd_matches){return false}if(beforeA.length>1&&beforeA[0]in cmd_handlers){}if(word_before&&word_before.indexOf("/")!=0){return false}var temp_cmd_matches;var match;if(e&&e.chosen_index!=undefined){temp_cmd_matches=data.cmd_matches;data.cmd_matches_index=cycle(e.chosen_index,data.cmd_matches.length-1);match=temp_cmd_matches[data.cmd_matches_index]}else if(chosen_cmd){TS.dir(0,e);data.matched_on=chosen_cmd;data.cmd_matches_index=0;data.cmd_matches=[chosen_cmd];return MATCHES_SET}else if(!word_before){temp_cmd_matches=data.cmd_matches;if(e&&e.shiftKey){data.cmd_matches_index--;if(data.cmd_matches_index<0){data.cmd_matches_index=data.cmd_matches.length-1}}else{data.cmd_matches_index++;if(data.cmd_matches_index>=data.cmd_matches.length){data.cmd_matches_index=0}}match=temp_cmd_matches[data.cmd_matches_index]}else{temp_cmd_matches=[];var ob;var search_str=word_before;var rx=new RegExp(TS.utility.regexpEscape(search_str,1e3),"i");var model_ob=TS.shared.getActiveModelOb();for(var k in cmd_handlers){ob=cmd_handlers[k];if(typeof ob.autocomplete==="function"&&!ob.autocomplete()||ob.autocomplete===false||ob.alias_of)continue;if(k=="/archive"||k=="/unarchive"){if(TS.model.active_group_id&&TS.model.user.is_restricted)continue;if(TS.model.active_channel_id&&!TS.members.canUserArchiveChannels())continue;if(TS.model.active_im_id)continue;if(TS.model.active_mpim_id)continue}else if(k=="/kick"||k=="/remove"){if(model_ob.is_archived)continue;if(TS.model.active_group_id&&!TS.members.canUserKickFromGroups())continue;if(TS.model.active_channel_id&&!TS.members.canUserKickFromChannels())continue;if(TS.model.active_im_id)continue;if(TS.model.active_mpim_id)continue}else if(k=="/join"){if(TS.model.user.is_restricted)continue}else if(k=="/feed"){if(TS.model.user.is_restricted)continue}else if(k=="/invite"){if(TS.model.user.is_ultra_restricted)continue}else if(k=="/invite_people"){if(!TS.model.user.is_admin)continue}else if(k=="/topic"||k=="/purpose"){if(TS.model.active_im_id)continue;if(TS.model.active_mpim_id)continue;if(TS.model.user.is_restricted)continue;if(model_ob.is_general&&!TS.members.canUserPostInGeneral())continue}else if(k=="/leave"){if(TS.model.active_group_id)continue}if(ob.type==="custom"||ob.type==="service"){if(!TS.members.canUserUseSlashCommands())continue}name=k;if(!search_str||name.match(rx)){temp_cmd_matches.push(name)}else if(ob.aliases){for(var i=0;i<ob.aliases.length;i++){if(ob.aliases[i].match(rx)){temp_cmd_matches.push(name);break}}}}if(!temp_cmd_matches.length){return false}temp_cmd_matches.sort(function compare(a,b){var a_srt=a.toLowerCase();var b_srt=b.toLowerCase();if(a_srt<b_srt)return-1;if(a_srt>b_srt)return 1;return 0});data.cmd_matches_index=0;if(temp_cmd_matches.length>0){data.cmd_matches=temp_cmd_matches}match=temp_cmd_matches[data.cmd_matches_index]}data.matched_on=word_before;if(!word_before){beforeA[beforeA.length-2]=match}else{beforeA[beforeA.length-1]=match+" "}if(!e)return MATCHES_SET;var new_before=beforeA.join(" ");var new_cp=new_before.length;var new_txt=txt.replace(before,new_before);if(lines_beforeA.length){new_cp+=lines_beforeA.join("\n").length+1;new_txt=lines_beforeA.join("\n")+"\n"+new_before+all_after_str}if(data.onComplete){data.onComplete(new_txt)}input.focus().setCursorPosition(new_cp);data.selected_index=data.cmd_matches_index;return MATCH_CHANGED}function completeOnChannels(txt,input,e){var data=input.data("TS-tabComplete");var cp=input.getCursorPosition();if(cp==0){return false}var all_after_str=txt.substr(cp);var lines_beforeA=txt.substr(0,cp).split("\n");var before=lines_beforeA.pop();var beforeA=before.split(" ");var word_before=beforeA[beforeA.length-1].toLowerCase();var prefix="";if(!word_before&&!data.channel_matches){return false}if(word_before){var good=false;if(word_before.indexOf("#")==0)good=true;if(data.channel_prefix){if(word_before.indexOf(data.channel_prefix+"#")==0)good=true;if(word_before.indexOf(data.channel_prefix)==0)good=true}if(!good)return false}var temp_matches;var match;if(e&&e.chosen_index!=undefined){temp_matches=data.channel_matches;data.channel_matches_index=cycle(e.chosen_index,data.channel_matches.length-1);match=temp_matches[data.channel_matches_index]}else if(!word_before){temp_matches=data.channel_matches;if(e&&e.shiftKey){data.channel_matches_index--;if(data.channel_matches_index<0){data.channel_matches_index=data.channel_matches.length-1}}else{data.channel_matches_index++;if(data.channel_matches_index>=data.channel_matches.length){data.channel_matches_index=0}}match=temp_matches[data.channel_matches_index]}else{temp_matches=[];var channels=TS.channels.getChannelsForUser();var channel;var name;var search_str=word_before.replace("#","");if(data.channel_prefix&&word_before.toLowerCase().indexOf(data.channel_prefix.toLowerCase())==0){search_str=search_str.substr(data.channel_prefix.length);prefix=data.channel_prefix}for(var i=0;i<channels.length;i++){channel=channels[i];if(channel.is_archived)continue;name=channel._name_lc;if(name.indexOf(search_str)==0||("#"+name).indexOf(search_str)==0){temp_matches.push(channel.name)}}if(!temp_matches.length){return false}data.channel_matches_index=0;if(temp_matches.length>0){data.channel_matches=temp_matches}match=temp_matches[data.channel_matches_index]}data.matched_on=word_before;if(!word_before){var name_chunk=beforeA[beforeA.length-2];if(data.channel_prefix&&name_chunk.toLowerCase().indexOf(data.channel_prefix.toLowerCase())==0){prefix=data.channel_prefix}beforeA[beforeA.length-2]=prefix+"#"+match}else{beforeA[beforeA.length-1]=prefix+"#"+match+" "}if(!e)return MATCHES_SET;var new_before=beforeA.join(" ");var new_cp=new_before.length;var new_txt=txt.replace(before,new_before);if(lines_beforeA.length){new_cp+=lines_beforeA.join("\n").length+1;new_txt=lines_beforeA.join("\n")+"\n"+new_before+all_after_str}if(data.onComplete){data.onComplete(new_txt)}input.focus().setCursorPosition(new_cp);data.selected_index=data.channel_matches_index;return MATCH_CHANGED}function completeOnMembers(txt,input,e){var data=input.data("TS-tabComplete");var cp=input.getCursorPosition();if(cp==0){return false}var all_after_str=txt.substr(cp);var lines_beforeA=txt.substr(0,cp).split("\n");var before=lines_beforeA.pop();var beforeA=before.split(" ");var word_before=beforeA[beforeA.length-1].toLowerCase();var prefix="";if(!word_before&&!data.member_matches){return false}var colon="";var at="";var temp_matches;var match;if(e&&e.chosen_index!=undefined){temp_matches=data.member_matches;data.member_matches_index=cycle(e.chosen_index,data.member_matches.length-1);match=temp_matches[data.member_matches_index]}else if(!word_before){temp_matches=data.member_matches;if(e&&e.shiftKey){data.member_matches_index--;if(data.member_matches_index<0){data.member_matches_index=data.member_matches.length-1}}else{data.member_matches_index++;if(data.member_matches_index>=data.member_matches.length){data.member_matches_index=0}}match=temp_matches[data.member_matches_index]}else{temp_matches=[];var temp_name_matches=[];var temp_first_name_matches=[];var temp_last_name_matches=[];var temp_real_name_matches=[];var members=[];var i,j;var members_for_user=data.include_self?TS.members.getActiveMembersWithSelfAndSlackbot():TS.members.getActiveMembersWithSlackbotAndNotSelf();for(i=0;i<members_for_user.length;i++){if(members_for_user[i].deleted)continue;members.push(members_for_user[i])}var member;var name;var name_colon;var at_name;var at_name_colon;var first_name;var last_name;var at_first_name;var at_last_name;var real_name_normalized;var search_str=word_before;var model_ob=TS.shared.getActiveModelOb();if(data.member_prefix&&word_before.toLowerCase().indexOf(data.member_prefix.toLowerCase())==0){search_str=search_str.substr(data.member_prefix.length);prefix=data.member_prefix}var real_name_regex=new RegExp("\\b"+TS.utility.regexpEscape(search_str.replace(/^@/,""),1e3),"i");for(i=0;i<members.length;i++){member=members[i];name=member._name_lc;name_colon=name+":";at_name="@"+name;at_name_colon="@"+name+":";first_name=member.profile.first_name?member._first_nam_lc:"";last_name=member.profile.last_name?member._last_name_lc:"";at_first_name="@"+first_name;at_last_name="@"+last_name;real_name_normalized=member.profile.real_name_normalized?member.profile.real_name_normalized:"";if(name.indexOf(search_str)==0){temp_name_matches.push(member)}else if(name_colon.indexOf(search_str)==0){temp_name_matches.push(member)}else if(at_name.indexOf(search_str)==0){temp_name_matches.push(member)}else if(at_name_colon.indexOf(search_str)==0){temp_name_matches.push(member)}else if(first_name&&first_name.indexOf(search_str)==0){temp_first_name_matches.push(member)}else if(last_name&&last_name.indexOf(search_str)==0){temp_last_name_matches.push(member)}else if(first_name&&at_first_name.indexOf(search_str)==0){temp_first_name_matches.push(member)}else if(last_name&&at_last_name.indexOf(search_str)==0){temp_last_name_matches.push(member)}else if(real_name_normalized&&real_name_regex.test(real_name_normalized)){temp_real_name_matches.push(member)}}temp_name_matches.sort(function compare(a,b){var a_srt=a._name_lc;var b_srt=b._name_lc;if(a_srt<b_srt)return-1;if(a_srt>b_srt)return 1;return 0});temp_first_name_matches.sort(function compare(a,b){var a_srt=a._first_nam_lc;var b_srt=b._first_nam_lc;if(a_srt<b_srt)return-1;if(a_srt>b_srt)return 1;return 0});temp_last_name_matches.sort(function compare(a,b){var a_srt=a._last_name_lc;var b_srt=b._last_name_lc;if(a_srt<b_srt)return-1;if(a_srt>b_srt)return 1;return 0});temp_real_name_matches.sort(function compare(a,b){var a_srt=a._real_name_normalized_lc;var b_srt=b._real_name_normalized_lc;if(a_srt<b_srt)return-1;if(a_srt>b_srt)return 1;return 0});temp_name_matches=temp_name_matches.concat(temp_first_name_matches).concat(temp_last_name_matches).concat(temp_real_name_matches);if(TS.boot_data.feature_subteams&&data.complete_user_groups&&search_str.length>1&&search_str.charAt(0)==="@"){var temp_user_group_matches=[];var user_groups=TS.model.user_groups;var user_group;var display_name;var display_name_colon;var at_display_name;var at_display_name_colon;var handle;var handle_colon;var at_handle;var at_handle_colon;var real_name_regex=new RegExp("\\b"+TS.utility.regexpEscape(search_str.replace(/^@/,""),1e3),"i");for(i=0;i<user_groups.length;i++){user_group=user_groups[i];if(user_group.date_delete||!user_group.handle)continue;display_name=user_group.name;display_name_colon=display_name+":";at_display_name="@"+display_name;at_display_name_colon="@"+display_name+":";handle=user_group.handle;handle_colon=handle+":";at_handle="@"+handle;at_handle_colon="@"+handle+":";if(display_name.indexOf(search_str)==0||display_name_colon.indexOf(search_str)==0||at_display_name.indexOf(search_str)==0||at_display_name_colon.indexOf(search_str)==0||handle.indexOf(search_str)==0||handle_colon.indexOf(search_str)==0||at_handle.indexOf(search_str)==0||at_handle_colon.indexOf(search_str)==0){temp_user_group_matches.push(user_group)}}temp_user_group_matches.sort(function compare(a,b){var a_srt=a.name;var b_srt=b.name;if(a_srt<b_srt)return-1;if(a_srt>b_srt)return 1;return 0});temp_name_matches=temp_name_matches.concat(temp_user_group_matches)}var do_sort_by_membership=data.sort_by_membership&&model_ob&&!model_ob.is_im;if(do_sort_by_membership){var A=[];for(i=0;i<temp_name_matches.length;i++){member=temp_name_matches[i];if(TS.boot_data.feature_subteams&&member.is_subteam){var sort_by=3e6+i;TS.user_groups.getMembersInCorG(member.id,model_ob.id,function(members_in_channel){if(members_in_channel.length===member.user_count)sort_by=3e4+i});A.push({sort_by:sort_by,name:member.handle})}else if(member.is_bot||member.is_slackbot){A.push({sort_by:(model_ob.members.indexOf(member.id)==-1?2e6:2e4)+i,name:member.name})}else{A.push({sort_by:(model_ob.members.indexOf(member.id)==-1?1e6:1e4)+i,name:member.name})}}if(data.complete_member_specials){if(model_ob&&model_ob.is_general&&TS.members.canUserAtEveryone()){if("@everyone".indexOf(search_str)==0||"@all".indexOf(search_str)==0){A.push({sort_by:"@everyone"==search_str||"@all"==search_str?1:2e6,name:"everyone"})}}if(TS.members.canUserAtChannelOrAtGroup()&&model_ob&&(model_ob.is_channel||model_ob.is_group&&TS.boot_data.feature_private_channels)&&(!model_ob.is_general||TS.members.canUserAtEveryone())){if("@channel".indexOf(search_str)==0){A.push({sort_by:5e5,name:"channel"})}if("@here".indexOf(search_str)==0){A.push({sort_by:5e5,name:"here"})}}else if(TS.members.canUserAtChannelOrAtGroup()&&model_ob&&model_ob.is_group&&!TS.boot_data.feature_private_channels){if("@group".indexOf(search_str)==0){A.push({sort_by:5e5,name:"group"})}if("@here".indexOf(search_str)==0){A.push({sort_by:5e5,name:"here"})}}}A.sort(function compare(a,b){if(a.sort_by<b.sort_by)return-1;if(a.sort_by>b.sort_by)return 1;return 0});for(i=0;i<A.length;i++){temp_matches.push(A[i].name)}}else{var humans,bots,user_groups;humans=[];bots=[];user_groups=[];for(i=0;i<temp_name_matches.length;i++){member=temp_name_matches[i];if(TS.boot_data.feature_subteams&&member.is_subteam){user_groups.push(member.handle)}else if(member.is_bot||member.is_slackbot){bots.push(member.name)}else{humans.push(member.name)}}temp_matches=humans.concat(user_groups).concat(bots);if(data.complete_member_specials){if(model_ob&&model_ob.is_general&&!TS.model.user.is_restricted){if("@everyone".indexOf(search_str)==0||"@all".indexOf(search_str)==0){if("@everyone"==search_str||"@all"==search_str){temp_matches.unshift("everyone")}else{temp_matches.push("everyone")}}}if(model_ob&&model_ob.is_channel){if("@channel".indexOf(search_str)==0){if("@channel"==search_str){temp_matches.unshift("channel")}else{temp_matches.push("channel")}}}else if(model_ob&&model_ob.is_group){if("@group".indexOf(search_str)==0){if("@group"==search_str){temp_matches.unshift("group")}else{temp_matches.push("group")}}}}}if(!temp_matches.length){return false}data.member_matches_index=0;if(temp_matches.length>0){data.member_matches=temp_matches}match=temp_matches[data.member_matches_index]}data.matched_on=word_before;if(!word_before){var name_chunk=beforeA[beforeA.length-2];if(data.member_prefix&&name_chunk.toLowerCase().indexOf(data.member_prefix.toLowerCase())==0){prefix=data.member_prefix}if(beforeA.length-2==0&&data.member_colon)colon=":";if(name_chunk&&(name_chunk.indexOf("@")>-1||TS.model.team.prefs.require_at_for_mention))at="@";beforeA[beforeA.length-2]=prefix+at+match+colon}else{if(beforeA.length-1==0&&data.member_colon)colon=":";if(beforeA[beforeA.length-1].indexOf("@")>-1||TS.model.team.prefs.require_at_for_mention)at="@";beforeA[beforeA.length-1]=prefix+at+match+colon+" "}if(!e)return MATCHES_SET;var new_before=beforeA.join(" ");var new_cp=new_before.length;var new_txt=txt.replace(before,new_before);if(lines_beforeA.length){new_cp+=lines_beforeA.join("\n").length+1;new_txt=lines_beforeA.join("\n")+"\n"+new_before+all_after_str}if(data.onComplete){data.onComplete(new_txt)}input.focus().setCursorPosition(new_cp);data.selected_index=data.member_matches_index;return MATCH_CHANGED}function completeOnEmoji(txt,input,e){var data=input.data("TS-tabComplete");var cp=input.getCursorPosition();if(cp==0){return false}var all_after_str=txt.substr(cp);var lines_beforeA=txt.substr(0,cp).split("\n");var before=lines_beforeA.pop();var beforeA=before.split(" ");var word_before=beforeA[beforeA.length-1].toLowerCase();if(!word_before&&!data.emoji_matches){return false}var prefix="";if(word_before){var good=false;if(word_before.indexOf(":")==0){good=true}else if(word_before.indexOf("+:")==0){prefix="+";good=true}else if(word_before.indexOf("-:")==0){prefix="-";good=true}if(!good)return false}else if(beforeA.length>1){var prev_word=beforeA[beforeA.length-2].toLowerCase();if(prev_word.indexOf("+:")==0){prefix="+"}else if(prev_word.indexOf("-:")==0){prefix="-"}}var temp_emoji_matches;var match;if(e&&e.chosen_index!=undefined){temp_emoji_matches=data.emoji_matches;data.emoji_matches_index=cycle(e.chosen_index,data.emoji_matches.length-1);match=temp_emoji_matches[data.emoji_matches_index]}else if(!word_before){temp_emoji_matches=data.emoji_matches;if(e&&e.shiftKey){data.emoji_matches_index--;if(data.emoji_matches_index<0){
data.emoji_matches_index=data.emoji_matches.length-1}}else{data.emoji_matches_index++;if(data.emoji_matches_index>=data.emoji_matches.length){data.emoji_matches_index=0}}match=temp_emoji_matches[data.emoji_matches_index]}else{temp_emoji_matches=[];var emoji_names=TS.model.emoji_names;var name;var search_str=word_before.replace(/\+:/,"").replace(/\-:/,"").replace(/:/g,"");var rx=new RegExp("(^)"+TS.utility.regexpEscape(search_str,1e3),"i");for(var i=0;i<emoji_names.length;i++){name=emoji_names[i];if(!search_str||name.match(rx)){temp_emoji_matches.push(name)}}if(!temp_emoji_matches.length){return false}data.emoji_matches_index=0;if(temp_emoji_matches.length>0){data.emoji_matches=temp_emoji_matches}match=temp_emoji_matches[data.emoji_matches_index]}data.matched_on=word_before;if(!word_before){beforeA[beforeA.length-2]=prefix+":"+match+":"}else{beforeA[beforeA.length-1]=prefix+":"+match+":"+" "}if(!e)return MATCHES_SET;var new_before=beforeA.join(" ");var new_cp=new_before.length;var new_txt=txt.replace(before,new_before);if(lines_beforeA.length){new_cp+=lines_beforeA.join("\n").length+1;new_txt=lines_beforeA.join("\n")+"\n"+new_before+all_after_str}if(data.onComplete){data.onComplete(new_txt)}input.focus().setCursorPosition(new_cp);data.selected_index=data.emoji_matches_index;return MATCH_CHANGED}function reset(input,why){if(do_log)TS.warn("reset "+why);var data=input.data("TS-tabComplete");var current=getCurrent(data);data.cmds=null;data.cmd_matches=null;data.cmd_matches_index=-1;data.member_matches=null;data.member_matches_index=-1;data.emoji_matches=null;data.emoji_matches_index=-1;data.channel_matches=null;data.channel_matches_index=-1;data.matched_on="";data.work_on_textchange=true;data.selected_index=-1;data.ui_showing=false;if(current)input.trigger("reset",{w:current+" "+why})}function getCurrent(data){var current="";if(data.cmd_matches)current="cmds";if(data.member_matches)current="members";if(data.emoji_matches)current="emoji";if(data.channel_matches)current="channels";return current}function work(input,e,do_cmds){var data=input.data("TS-tabComplete");var txt=input.val();var current=getCurrent(data);var max_default_match_cnt=50;var ret=false;var event_data={hide_ui:false,delay_ui:false,shown_callback:function(){data.ui_showing=true}};data.ui_showing=false;if(TS.model.prefs.enter_is_special_in_tbt&&TS.utility.isCursorWithinTBTs(input)){event_data.hide_ui=true}if(data.complete_emoji){ret=completeOnEmoji(txt,input,e);if(do_log)TS.info("completeOnEmoji:"+ret);event_data.current_matches=data.emoji_matches||[];event_data.w="emoji";event_data.matched_on=data.matched_on;if(ret==MATCHES_SET){if(do_log)TS.info("trigger MATCHES_SET matched_on:"+data.matched_on+" emoji_matches: "+data.emoji_matches);if(data.matched_on.length<3){event_data.hide_ui=true}if(event_data.current_matches.length===1&&":"+event_data.current_matches[0]+":"==event_data.matched_on){event_data.hide_ui=true}if(!event_data.hide_ui){if(TS.model.prefs.tab_ui_return_selects)data.selected_index=data.emoji_matches_index}event_data.i=data.selected_index;input.trigger("matches_set",event_data);return}else if(ret==MATCH_CHANGED){if(do_log)TS.info("trigger MATCH_CHANGED "+data.emoji_matches_index);event_data.i=data.emoji_matches_index;input.trigger("match_changed",event_data);return}else{if(current=="emoji"){reset(input,"not acting")}else{}}}if(data.complete_channels){ret=completeOnChannels(txt,input,e);if(do_log)TS.info("completeOnChannels:"+ret);event_data.current_matches=data.channel_matches||[];event_data.w="channels";event_data.matched_on=data.matched_on;if(ret==MATCHES_SET){if(do_log)TS.info("trigger MATCHES_SET matched_on:"+data.matched_on+" channel_matches: "+data.channel_matches);if(!data.matched_on){event_data.hide_ui=true}if(event_data.current_matches.length>max_default_match_cnt){event_data.hide_ui=true}if(event_data.current_matches.length===1&&("#"+event_data.current_matches[0]==event_data.matched_on||event_data.current_matches[0]==event_data.matched_on)){event_data.hide_ui=true}if(!event_data.hide_ui){if(TS.model.prefs.tab_ui_return_selects)data.selected_index=data.channel_matches_index}event_data.i=data.selected_index;input.trigger("matches_set",event_data);return}else if(ret==MATCH_CHANGED){if(do_log)TS.info("trigger MATCH_CHANGED "+data.channel_matches_index);event_data.i=data.channel_matches_index;input.trigger("match_changed",event_data);return}else{if(current=="channels"){reset(input,"not acting")}else{}}}if(data.complete_cmds){ret=completeOnCommandsNew(txt,input,e);if(do_log)TS.info("completeOnCommandsNew:"+ret);event_data.current_matches=data.cmd_matches||[];event_data.w="cmds";event_data.matched_on=data.matched_on;if(ret==MATCHES_SET){if(do_log)TS.info("trigger MATCHES_SET matched_on:"+data.matched_on+" cmd_matches: "+data.cmd_matches);if(data.matched_on.length<1){event_data.hide_ui=true}if(!event_data.hide_ui){if(TS.model.prefs.tab_ui_return_selects)data.selected_index=data.cmd_matches_index}event_data.i=data.selected_index;input.trigger("matches_set",event_data);return}else if(ret==MATCH_CHANGED){if(do_log)TS.info("trigger MATCH_CHANGED "+data.cmd_matches_index);event_data.i=data.cmd_matches_index;input.trigger("match_changed",event_data);return}else{if(current=="cmds"){reset(input,"not acting")}else{}}}if(data.complete_members){ret=completeOnMembers(txt,input,e);if(do_log)TS.info("completeOnMembers:"+ret);event_data.current_matches=data.member_matches||[];event_data.w="members";event_data.matched_on=data.matched_on;event_data.sort_by_membership=data.sort_by_membership;if(data.matched_on&&data.matched_on.indexOf("@")!=0&&(!e||e.which!=TS.utility.keymap.tab)){event_data.delay_ui=true}if(ret==MATCHES_SET){if(do_log)TS.info("trigger MATCHES_SET matched_on:"+data.matched_on+" member_matches:"+data.member_matches);if(data.matched_on.indexOf("@")!=0&&(data.matched_on.length<3||data.member_prefix_required||TS.model.prefs.require_at)){event_data.hide_ui=true}if(data.matched_on=="the"||data.matched_on=="and"){event_data.hide_ui=true}if(event_data.current_matches.length>max_default_match_cnt){event_data.hide_ui=true}if(event_data.current_matches.length===1&&("@"+event_data.current_matches[0]==event_data.matched_on||event_data.current_matches[0]==event_data.matched_on)){event_data.hide_ui=true}if(!event_data.hide_ui){if(TS.model.prefs.tab_ui_return_selects)data.selected_index=data.member_matches_index}event_data.i=data.selected_index;input.trigger("matches_set",event_data);return}else if(ret==MATCH_CHANGED){if(do_log)TS.info("trigger MATCH_CHANGED "+data.member_matches_index);event_data.i=data.member_matches_index;input.trigger("match_changed",event_data);return}else{if(current=="members"){reset(input,"not acting")}else{}}}if(do_cmds&&data.complete_cmds&&(!txt||txt.indexOf("/")==0)&&completeOnCommands(txt,input,e)){return}}function choose(input,i,no_reset){if(do_log)TS.warn("choose calling work with fake e i:"+i);var data=input.data("TS-tabComplete");data.work_on_textchange=false;work(input,{chosen_index:i});data.work_on_textchange=true;if(no_reset)return;setTimeout(function(){reset(input,"choose "+i)},1)}var methods={reset:function(why){var $this=$(this);reset($this,"method called: "+why)},choose:function(i,no_reset){var $this=$(this);choose($this,i,no_reset)},suspend:function(){var $this=$(this);var data=$this.data("TS-tabComplete");data.suspended=true;reset($this,"suspended")},unsuspend:function(){var data=$(this).data("TS-tabComplete");data.suspended=false},changeoption:function(which,val){var data=$(this).data("TS-tabComplete");data[which]=val},init:function(options){var settings=$.extend({complete_member_specials:false,complete_members:true,member_prefix:"",member_colon:true,complete_cmds:false,complete_emoji:false,complete_channels:false,channel_prefix:"",no_tab_out:false,member_prefix_required:false,include_self:false,sort_by_membership:false},options);return this.each(function(){var $this=$(this);if($this.data("TS-tabComplete")){return}if(options.ui_initer){options.ui_initer($this)}$this.data("TS-tabComplete",{channel_prefix:settings.channel_prefix,cmd_matches_index:-1,cmd_matches:null,cmds:null,complete_channels:settings.complete_channels,complete_cmds:settings.complete_cmds,complete_emoji:settings.complete_emoji,complete_member_specials:settings.complete_member_specials,complete_members:settings.complete_members,complete_user_groups:settings.complete_user_groups,member_colon:settings.member_colon,member_matches_index:-1,member_matches:null,member_prefix:settings.member_prefix,onComplete:settings.onComplete,selected_index:-1,work_on_textchange:true,matched_on:"",suspended:options.suspended===true,member_prefix_required:settings.member_prefix_required,include_self:settings.include_self,sort_by_membership:settings.sort_by_membership});$this.bind("textchange",function(e){var data=$this.data("TS-tabComplete");if(data.suspended)return;if(data.work_on_textchange){if(do_log)TS.warn('textchange calling work no e text:"'+$(this).val()+'"');work($this,null)}});$this.bind("paste",function(e){var data=$this.data("TS-tabComplete");reset($this,"paste");data.work_on_textchange=false;var tim=setTimeout(function(){data.work_on_textchange=true},50);$this.bind("textchange.after_paste",function(e){clearTimeout(tim);data.work_on_textchange=true;$this.unbind("textchange.after_paste")})});$this.bind("keydown",function(e){var data=$this.data("TS-tabComplete");if(data.suspended)return;var current=getCurrent(data);var keymap=TS.utility.keymap;if(do_log)TS.info("keydown:"+e.which+' text:"'+$(this).val()+'" current:'+current+" ---------------------------------------------------------------");if(e.which==keymap.tab&&!(e.metaKey||e.ctrlKey)){data.work_on_textchange=false;if(do_log)TS.warn("keydown calling work WITH e");work($this,e,true);if(current||settings.no_tab_out)e.preventDefault()}else if(e.which==keymap.space){if(current!="cmds"){reset($this,"space")}}if(!data.ui_showing)return;if(e.which==keymap.down&&current){e.preventDefault();choose($this,data.selected_index+1,true)}else if(e.which==keymap.up&&current){e.preventDefault();e.shiftKey=true;choose($this,data.selected_index-1,true)}else if(e.which==keymap.right&&current=="emoji"&&data.emoji_matches.length>1){e.preventDefault();choose($this,data.selected_index+1,true)}else if(e.which==keymap.left&&current=="emoji"&&data.emoji_matches.length>1){e.preventDefault();e.shiftKey=true;choose($this,data.selected_index-1,true)}else if(e.which==keymap.enter&&!TS.model.prefs.tab_ui_return_selects){reset($this,"enter")}else if(e.which==keymap.enter&&data.selected_index!=-1){if(current=="cmds"){choose($this,data.selected_index)}else{choose($this,data.selected_index)}}else if(e.which==keymap.enter||e.which==keymap.tab){var matches;if(current=="members")matches=data.member_matches;if(current=="channels")matches=data.channel_matches;if(current=="emoji")matches=data.emoji_matches;if(current=="cmds")matches=data.cmd_matches;if(matches&&matches.length==1){choose($this,0)}}else if(e.which==keymap.esc||e.which==keymap.alt||e.which==keymap.ctrl||e.which==keymap.cmd_ff||e.which==keymap.cmd_other||e.which==keymap.left||e.which==keymap.right||e.which==keymap.end||e.which==keymap.home){reset($this,e.which)}});$this.bind("keyup",function(e){var data=$this.data("TS-tabComplete");if(data.suspended)return;data.work_on_textchange=true})})}};$.fn.TS_tabComplete2=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method==="object"||!method){return methods.init.apply(this,arguments)}else{$.error("Method "+method+" does not exist on jQuery.tooltip")}}})(jQuery);function printStackTrace(options){options=options||{guess:true};var ex=options.e||null,guess=!!options.guess;var p=new printStackTrace.implementation,result=p.run(ex);return guess?p.guessAnonymousFunctions(result):result}if(typeof module!=="undefined"&&module.exports){module.exports=printStackTrace}printStackTrace.implementation=function(){};printStackTrace.implementation.prototype={run:function(ex,mode){ex=ex||this.createException();mode=mode||this.mode(ex);if(mode==="other"){return this.other(arguments.callee)}else{return this[mode](ex)}},createException:function(){try{this.undef()}catch(e){return e}},mode:function(e){if(e["arguments"]&&e.stack){return"chrome"}else if(e.stack&&e.sourceURL){return"safari"}else if(e.stack&&e.number){return"ie"}else if(typeof e.message==="string"&&typeof window!=="undefined"&&window.opera){if(!e.stacktrace){return"opera9"}if(e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length){return"opera9"}if(!e.stack){return"opera10a"}if(e.stacktrace.indexOf("called from line")<0){return"opera10b"}return"opera11"}else if(e.stack){return"firefox"}return"other"},instrumentFunction:function(context,functionName,callback){context=context||window;var original=context[functionName];context[functionName]=function instrumented(){callback.call(this,printStackTrace().slice(4));return context[functionName]._instrumented.apply(this,arguments)};context[functionName]._instrumented=original},deinstrumentFunction:function(context,functionName){if(context[functionName].constructor===Function&&context[functionName]._instrumented&&context[functionName]._instrumented.constructor===Function){context[functionName]=context[functionName]._instrumented}},chrome:function(e){var stack=(e.stack+"\n").replace(/^\S[^\(]+?[\n$]/gm,"").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}()@$1$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}()@$1").split("\n");stack.pop();return stack},safari:function(e){return e.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},ie:function(e){var lineRE=/^.*at (\w+) \(([^\)]+)\)$/gm;return e.stack.replace(/at Anonymous function /gm,"{anonymous}()@").replace(/^(?=\w+Error\:).*$\n/m,"").replace(lineRE,"$1@$2").split("\n")},firefox:function(e){return e.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^[\(@]/gm,"{anonymous}()@").split("\n")},opera11:function(e){var ANON="{anonymous}",lineRE=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/;var lines=e.stacktrace.split("\n"),result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){var location=match[4]+":"+match[1]+":"+match[2];var fnName=match[3]||"global code";fnName=fnName.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,ANON);result.push(fnName+"@"+location+" -- "+lines[i+1].replace(/^\s+/,""))}}return result},opera10b:function(e){var lineRE=/^(.*)@(.+):(\d+)$/;var lines=e.stacktrace.split("\n"),result=[];for(var i=0,len=lines.length;i<len;i++){var match=lineRE.exec(lines[i]);if(match){var fnName=match[1]?match[1]+"()":"global code";result.push(fnName+"@"+match[2]+":"+match[3])}}return result},opera10a:function(e){var ANON="{anonymous}",lineRE=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;var lines=e.stacktrace.split("\n"),result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){var fnName=match[3]||ANON;result.push(fnName+"()@"+match[2]+":"+match[1]+" -- "+lines[i+1].replace(/^\s+/,""))}}return result},opera9:function(e){var ANON="{anonymous}",lineRE=/Line (\d+).*script (?:in )?(\S+)/i;var lines=e.message.split("\n"),result=[];for(var i=2,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){result.push(ANON+"()@"+match[2]+":"+match[1]+" -- "+lines[i+1].replace(/^\s+/,""))}}return result},other:function(curr){var ANON="{anonymous}",fnRE=/function\s*([\w\-$]+)?\s*\(/i,stack=[],fn,args,maxStackSize=10;while(curr&&curr["arguments"]&&stack.length<maxStackSize){fn=fnRE.test(curr.toString())?RegExp.$1||ANON:ANON;args=Array.prototype.slice.call(curr["arguments"]||[]);stack[stack.length]=fn+"("+this.stringifyArguments(args)+")";curr=curr.caller}return stack},stringifyArguments:function(args){var result=[];var slice=Array.prototype.slice;for(var i=0;i<args.length;++i){var arg=args[i];if(arg===undefined){result[i]="undefined"}else if(arg===null){result[i]="null"}else if(arg.constructor){if(arg.constructor===Array){if(arg.length<3){result[i]="["+this.stringifyArguments(arg)+"]"}else{result[i]="["+this.stringifyArguments(slice.call(arg,0,1))+"..."+this.stringifyArguments(slice.call(arg,-1))+"]"}}else if(arg.constructor===Object){result[i]="#object"}else if(arg.constructor===Function){result[i]="#function"}else if(arg.constructor===String){result[i]='"'+arg+'"'}else if(arg.constructor===Number){result[i]=arg}}}return result.join(",")},sourceCache:{},ajax:function(url){var req=this.createXMLHTTPObject();if(req){try{req.open("GET",url,false);req.send(null);return req.responseText}catch(e){}}return""},createXMLHTTPObject:function(){var xmlhttp,XMLHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];for(var i=0;i<XMLHttpFactories.length;i++){try{xmlhttp=XMLHttpFactories[i]();this.createXMLHTTPObject=XMLHttpFactories[i];return xmlhttp}catch(e){}}},isSameDomain:function(url){return typeof location!=="undefined"&&url.indexOf(location.hostname)!==-1},getSource:function(url){if(!(url in this.sourceCache)){this.sourceCache[url]=this.ajax(url).split("\n")}return this.sourceCache[url]},guessAnonymousFunctions:function(stack){for(var i=0;i<stack.length;++i){var reStack=/\{anonymous\}\(.*\)@(.*)/,reRef=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,frame=stack[i],ref=reStack.exec(frame);if(ref){var m=reRef.exec(ref[1]);if(m){var file=m[1],lineno=m[2],charno=m[3]||0;if(file&&this.isSameDomain(file)&&lineno){var functionName=this.guessAnonymousFunction(file,lineno,charno);stack[i]=frame.replace("{anonymous}",functionName)}}}}return stack},guessAnonymousFunction:function(url,lineNo,charNo){var ret;try{ret=this.findFunctionName(this.getSource(url),lineNo)}catch(e){ret="getSource failed with url: "+url+", exception: "+e.toString()}return ret},findFunctionName:function(source,lineNo){var reFunctionDeclaration=/function\s+([^(]*?)\s*\(([^)]*)\)/;var reFunctionExpression=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/;var reFunctionEvaluation=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/;var code="",line,maxLines=Math.min(lineNo,20),m,commentPos;for(var i=0;i<maxLines;++i){line=source[lineNo-i-1];commentPos=line.indexOf("//");if(commentPos>=0){line=line.substr(0,commentPos)}if(line){code=line+code;m=reFunctionExpression.exec(code);if(m&&m[1]){return m[1]}m=reFunctionDeclaration.exec(code);if(m&&m[1]){return m[1]}m=reFunctionEvaluation.exec(code);if(m&&m[1]){return m[1]}}}return"(?)"}};(function(context,undefined){"use strict";function truncate(string,maxLength,options){if(string)string=string.replace(/\@/g,"&#64;");var EMPTY_OBJECT={},EMPTY_STRING="",DEFAULT_TRUNCATE_SYMBOL="...",EXCLUDE_TAGS=["img","br"],items=[],total=0,content=EMPTY_STRING,KEY_VALUE_REGEX='([\\w|-]+\\s*=\\s*"[^"]*"\\s*)*',IS_CLOSE_REGEX="\\s*\\/?\\s*",CLOSE_REGEX="\\s*\\/\\s*",SELF_CLOSE_REGEX=new RegExp("<\\/?\\w+\\s*"+KEY_VALUE_REGEX+CLOSE_REGEX+">"),HTML_TAG_REGEX=new RegExp("<\\/?\\w+\\s*"+KEY_VALUE_REGEX+IS_CLOSE_REGEX+">"),URL_REGEX=/(((ftp|https?):\/\/)[\-\w@:%_\+.~#?,&\/\/=]+)|((mailto:)?[_.\w\-]+@([\w][\w\-]+\.)+[a-zA-Z]{2,3})/g,IMAGE_TAG_REGEX=new RegExp("<img\\s*"+KEY_VALUE_REGEX+IS_CLOSE_REGEX+">"),matches=true,result,index,tail,tag,selfClose;function _removeImageTag(string){var match=IMAGE_TAG_REGEX.exec(string),index,len;if(!match){return string}index=match.index;len=match[0].length;return string.substring(0,index)+string.substring(index+len)}function _dumpCloseTag(tags){var html="";tags.reverse().forEach(function(tag,index){if(-1===EXCLUDE_TAGS.indexOf(tag)){html+="</"+tag+">"}});return html}function _getTag(string){var tail=string.indexOf(" ");if(-1===tail){tail=string.indexOf(">");if(-1===tail){throw new Error("HTML tag is not well-formed : "+string)}}return string.substring(1,tail)}options=options||EMPTY_OBJECT;options.ellipsis=undefined!==options.ellipsis?options.ellipsis:DEFAULT_TRUNCATE_SYMBOL;while(matches){matches=HTML_TAG_REGEX.exec(string);if(!matches){if(total>=maxLength){break}matches=URL_REGEX.exec(string);if(!matches||matches.index>=maxLength){content+=string.substring(0,maxLength-total);break}while(matches){result=matches[0];index=matches.index;content+=string.substring(0,index+result.length-total);string=string.substring(index+result.length);matches=URL_REGEX.exec(string)}break}result=matches[0];index=matches.index;if(total+index>maxLength){content+=string.substring(0,maxLength-total);break}else{total+=index;content+=string.substring(0,index)}if("/"===result[1]){items.pop()}else{selfClose=SELF_CLOSE_REGEX.exec(result);if(!selfClose){tag=_getTag(result);items.push(tag)}}if(selfClose){content+=selfClose[0]}else{content+=result}string=string.substring(index+result.length)}if(string.length>maxLength&&options.ellipsis){content+=options.ellipsis}content+=_dumpCloseTag(items);if(!options.keepImageTag){content=_removeImageTag(content)}return content}if("undefined"!==typeof module&&module.exports){module.exports=truncate}else{context.truncate=truncate}})(this);var swfobject=function(){var UNDEF="undefined",OBJECT="object",SHOCKWAVE_FLASH="Shockwave Flash",SHOCKWAVE_FLASH_AX="ShockwaveFlash.ShockwaveFlash",FLASH_MIME_TYPE="application/x-shockwave-flash",EXPRESS_INSTALL_ID="SWFObjectExprInst",ON_READY_STATE_CHANGE="onreadystatechange",win=window,doc=document,nav=navigator,plugin=false,domLoadFnArr=[main],regObjArr=[],objIdArr=[],listenersArr=[],storedAltContent,storedAltContentId,storedCallbackFn,storedCallbackObj,isDomLoaded=false,isExpressInstallActive=false,dynamicStylesheet,dynamicStylesheetMedia,autoHideShow=true,ua=function(){var w3cdom=typeof doc.getElementById!=UNDEF&&typeof doc.getElementsByTagName!=UNDEF&&typeof doc.createElement!=UNDEF,u=nav.userAgent.toLowerCase(),p=nav.platform.toLowerCase(),windows=p?/win/.test(p):/win/.test(u),mac=p?/mac/.test(p):/mac/.test(u),webkit=/webkit/.test(u)?parseFloat(u.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,ie=!+"1",playerVersion=[0,0,0],d=null;if(typeof nav.plugins!=UNDEF&&typeof nav.plugins[SHOCKWAVE_FLASH]==OBJECT){d=nav.plugins[SHOCKWAVE_FLASH].description;if(d&&!(typeof nav.mimeTypes!=UNDEF&&nav.mimeTypes[FLASH_MIME_TYPE]&&!nav.mimeTypes[FLASH_MIME_TYPE].enabledPlugin)){plugin=true;ie=false;d=d.replace(/^.*\s+(\S+\s+\S+$)/,"$1");playerVersion[0]=parseInt(d.replace(/^(.*)\..*$/,"$1"),10);playerVersion[1]=parseInt(d.replace(/^.*\.(.*)\s.*$/,"$1"),10);playerVersion[2]=/[a-zA-Z]/.test(d)?parseInt(d.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else if(typeof win.ActiveXObject!=UNDEF){try{var a=new ActiveXObject(SHOCKWAVE_FLASH_AX);if(a){d=a.GetVariable("$version");if(d){ie=true;d=d.split(" ")[1].split(",");playerVersion=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)]}}}catch(e){}}return{w3:w3cdom,pv:playerVersion,wk:webkit,ie:ie,win:windows,mac:mac}}(),onDomLoad=function(){if(!ua.w3){return}if(typeof doc.readyState!=UNDEF&&doc.readyState=="complete"||typeof doc.readyState==UNDEF&&(doc.getElementsByTagName("body")[0]||doc.body)){callDomLoadFunctions()}if(!isDomLoaded){if(typeof doc.addEventListener!=UNDEF){doc.addEventListener("DOMContentLoaded",callDomLoadFunctions,false)}if(ua.ie&&ua.win){doc.attachEvent(ON_READY_STATE_CHANGE,function(){if(doc.readyState=="complete"){doc.detachEvent(ON_READY_STATE_CHANGE,arguments.callee);callDomLoadFunctions()}});if(win==top){(function(){if(isDomLoaded){return}try{doc.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}callDomLoadFunctions()})()}}if(ua.wk){(function(){if(isDomLoaded){return}if(!/loaded|complete/.test(doc.readyState)){setTimeout(arguments.callee,0);return}callDomLoadFunctions()})()}addLoadEvent(callDomLoadFunctions)}}();function callDomLoadFunctions(){if(isDomLoaded){return}try{var t=doc.getElementsByTagName("body")[0].appendChild(createElement("span"));t.parentNode.removeChild(t)}catch(e){return}isDomLoaded=true;var dl=domLoadFnArr.length;for(var i=0;i<dl;i++){domLoadFnArr[i]()}}function addDomLoadEvent(fn){if(isDomLoaded){fn()}else{domLoadFnArr[domLoadFnArr.length]=fn}}function addLoadEvent(fn){if(typeof win.addEventListener!=UNDEF){win.addEventListener("load",fn,false)}else if(typeof doc.addEventListener!=UNDEF){doc.addEventListener("load",fn,false)}else if(typeof win.attachEvent!=UNDEF){addListener(win,"onload",fn)}else if(typeof win.onload=="function"){var fnOld=win.onload;win.onload=function(){fnOld();fn()}}else{win.onload=fn}}function main(){if(plugin){testPlayerVersion()}else{matchVersions()}}function testPlayerVersion(){var b=doc.getElementsByTagName("body")[0];var o=createElement(OBJECT);o.setAttribute("type",FLASH_MIME_TYPE);o.setAttribute("style","visibility:hidden;position:absolute;top:-500px;left:-500px");var t=b.appendChild(o);if(t){var counter=0;(function(){if(typeof t.GetVariable!=UNDEF){var d=t.GetVariable("$version");if(d){d=d.split(" ")[1].split(",");ua.pv=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)]}}else if(counter<10){counter++;setTimeout(arguments.callee,10);return}b.removeChild(o);t=null;matchVersions()})()}else{matchVersions()}}function matchVersions(){var rl=regObjArr.length;if(rl>0){for(var i=0;i<rl;i++){var id=regObjArr[i].id;var cb=regObjArr[i].callbackFn;var cbObj={success:false,id:id};if(ua.pv[0]>0){var obj=getElementById(id);if(obj){if(hasPlayerVersion(regObjArr[i].swfVersion)&&!(ua.wk&&ua.wk<312)){setVisibility(id,true);if(cb){cbObj.success=true;cbObj.ref=getObjectById(id);cb(cbObj)}}else if(regObjArr[i].expressInstall&&canExpressInstall()){var att={};att.data=regObjArr[i].expressInstall;att.width=obj.getAttribute("width")||"0";att.height=obj.getAttribute("height")||"0";if(obj.getAttribute("class")){att.styleclass=obj.getAttribute("class")}if(obj.getAttribute("align")){att.align=obj.getAttribute("align")}var par={};var p=obj.getElementsByTagName("param");var pl=p.length;for(var j=0;j<pl;j++){if(p[j].getAttribute("name").toLowerCase()!="movie"){par[p[j].getAttribute("name")]=p[j].getAttribute("value")}}showExpressInstall(att,par,id,cb)}else{displayAltContent(obj);if(cb){cb(cbObj)}}}}else{setVisibility(id,true);if(cb){var o=getObjectById(id);if(o&&typeof o.SetVariable!=UNDEF){cbObj.success=true;cbObj.ref=o}cb(cbObj)}}}}}function getObjectById(objectIdStr){var r=null;var o=getElementById(objectIdStr);if(o&&o.nodeName=="OBJECT"){if(typeof o.SetVariable!=UNDEF){r=o}else{var n=o.getElementsByTagName(OBJECT)[0];if(n){r=n}}}return r}function canExpressInstall(){return!isExpressInstallActive&&hasPlayerVersion("6.0.65")&&(ua.win||ua.mac)&&!(ua.wk&&ua.wk<312)}function showExpressInstall(att,par,replaceElemIdStr,callbackFn){isExpressInstallActive=true;storedCallbackFn=callbackFn||null;storedCallbackObj={success:false,id:replaceElemIdStr};var obj=getElementById(replaceElemIdStr);if(obj){if(obj.nodeName=="OBJECT"){storedAltContent=abstractAltContent(obj);storedAltContentId=null}else{storedAltContent=obj;storedAltContentId=replaceElemIdStr}att.id=EXPRESS_INSTALL_ID;if(typeof att.width==UNDEF||!/%$/.test(att.width)&&parseInt(att.width,10)<310){att.width="310"}if(typeof att.height==UNDEF||!/%$/.test(att.height)&&parseInt(att.height,10)<137){att.height="137"}doc.title=doc.title.slice(0,47)+" - Flash Player Installation";var pt=ua.ie&&ua.win?"ActiveX":"PlugIn",fv="MMredirectURL="+win.location.toString().replace(/&/g,"%26")+"&MMplayerType="+pt+"&MMdoctitle="+doc.title;if(typeof par.flashvars!=UNDEF){par.flashvars+="&"+fv}else{par.flashvars=fv}if(ua.ie&&ua.win&&obj.readyState!=4){var newObj=createElement("div");replaceElemIdStr+="SWFObjectNew";newObj.setAttribute("id",replaceElemIdStr);obj.parentNode.insertBefore(newObj,obj);obj.style.display="none";(function(){if(obj.readyState==4){obj.parentNode.removeChild(obj)}else{setTimeout(arguments.callee,10)}})()}createSWF(att,par,replaceElemIdStr)}}function displayAltContent(obj){if(ua.ie&&ua.win&&obj.readyState!=4){var el=createElement("div");obj.parentNode.insertBefore(el,obj);el.parentNode.replaceChild(abstractAltContent(obj),el);obj.style.display="none";(function(){if(obj.readyState==4){obj.parentNode.removeChild(obj)}else{setTimeout(arguments.callee,10)}})()}else{obj.parentNode.replaceChild(abstractAltContent(obj),obj)}}function abstractAltContent(obj){var ac=createElement("div");if(ua.win&&ua.ie){ac.innerHTML=obj.innerHTML}else{var nestedObj=obj.getElementsByTagName(OBJECT)[0];if(nestedObj){var c=nestedObj.childNodes;if(c){var cl=c.length;for(var i=0;i<cl;i++){if(!(c[i].nodeType==1&&c[i].nodeName=="PARAM")&&!(c[i].nodeType==8)){ac.appendChild(c[i].cloneNode(true))}}}}}return ac}function createSWF(attObj,parObj,id){var r,el=getElementById(id);if(ua.wk&&ua.wk<312){return r}if(el){if(typeof attObj.id==UNDEF){attObj.id=id}if(ua.ie&&ua.win){var att="";for(var i in attObj){if(attObj[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){parObj.movie=attObj[i]}else if(i.toLowerCase()=="styleclass"){att+=' class="'+attObj[i]+'"'}else if(i.toLowerCase()!="classid"){att+=" "+i+'="'+attObj[i]+'"'}}}var par="";for(var j in parObj){if(parObj[j]!=Object.prototype[j]){par+='<param name="'+j+'" value="'+parObj[j]+'" />'}}el.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+att+">"+par+"</object>";objIdArr[objIdArr.length]=attObj.id;r=getElementById(attObj.id)}else{var o=createElement(OBJECT);o.setAttribute("type",FLASH_MIME_TYPE);for(var m in attObj){if(attObj[m]!=Object.prototype[m]){if(m.toLowerCase()=="styleclass"){o.setAttribute("class",attObj[m])}else if(m.toLowerCase()!="classid"){o.setAttribute(m,attObj[m])}}}for(var n in parObj){if(parObj[n]!=Object.prototype[n]&&n.toLowerCase()!="movie"){createObjParam(o,n,parObj[n])}}el.parentNode.replaceChild(o,el);r=o}}return r}function createObjParam(el,pName,pValue){var p=createElement("param");p.setAttribute("name",pName);p.setAttribute("value",pValue);el.appendChild(p)}function removeSWF(id){var obj=getElementById(id);if(obj&&obj.nodeName=="OBJECT"){if(ua.ie&&ua.win){obj.style.display="none";(function(){if(obj.readyState==4){removeObjectInIE(id)}else{setTimeout(arguments.callee,10)}})()}else{obj.parentNode.removeChild(obj)}}}function removeObjectInIE(id){var obj=getElementById(id);if(obj){for(var i in obj){if(typeof obj[i]=="function"){obj[i]=null}}obj.parentNode.removeChild(obj)}}function getElementById(id){var el=null;try{el=doc.getElementById(id)}catch(e){}return el}function createElement(el){return doc.createElement(el)}function addListener(target,eventType,fn){target.attachEvent(eventType,fn);listenersArr[listenersArr.length]=[target,eventType,fn]}function hasPlayerVersion(rv){var pv=ua.pv,v=rv.split(".");v[0]=parseInt(v[0],10);v[1]=parseInt(v[1],10)||0;v[2]=parseInt(v[2],10)||0;return pv[0]>v[0]||pv[0]==v[0]&&pv[1]>v[1]||pv[0]==v[0]&&pv[1]==v[1]&&pv[2]>=v[2]?true:false}function createCSS(sel,decl,media,newStyle){if(ua.ie&&ua.mac){return}var h=doc.getElementsByTagName("head")[0];if(!h){return}var m=media&&typeof media=="string"?media:"screen";if(newStyle){dynamicStylesheet=null;dynamicStylesheetMedia=null}if(!dynamicStylesheet||dynamicStylesheetMedia!=m){var s=createElement("style");s.setAttribute("type","text/css");s.setAttribute("media",m);dynamicStylesheet=h.appendChild(s);if(ua.ie&&ua.win&&typeof doc.styleSheets!=UNDEF&&doc.styleSheets.length>0){dynamicStylesheet=doc.styleSheets[doc.styleSheets.length-1]}dynamicStylesheetMedia=m}if(ua.ie&&ua.win){if(dynamicStylesheet&&typeof dynamicStylesheet.addRule==OBJECT){dynamicStylesheet.addRule(sel,decl)}}else{if(dynamicStylesheet&&typeof doc.createTextNode!=UNDEF){dynamicStylesheet.appendChild(doc.createTextNode(sel+" {"+decl+"}"))}}}function setVisibility(id,isVisible){if(!autoHideShow){return}var v=isVisible?"visible":"hidden";if(isDomLoaded&&getElementById(id)){getElementById(id).style.visibility=v}else{createCSS("#"+id,"visibility:"+v)}}function urlEncodeIfNecessary(s){
var regex=/[\\\"<>\.;]/;var hasBadChars=regex.exec(s)!=null;return hasBadChars&&typeof encodeURIComponent!=UNDEF?encodeURIComponent(s):s}var cleanup=function(){if(ua.ie&&ua.win){window.attachEvent("onunload",function(){var ll=listenersArr.length;for(var i=0;i<ll;i++){listenersArr[i][0].detachEvent(listenersArr[i][1],listenersArr[i][2])}var il=objIdArr.length;for(var j=0;j<il;j++){removeSWF(objIdArr[j])}for(var k in ua){ua[k]=null}ua=null;for(var l in swfobject){swfobject[l]=null}swfobject=null})}}();return{registerObject:function(objectIdStr,swfVersionStr,xiSwfUrlStr,callbackFn){if(ua.w3&&objectIdStr&&swfVersionStr){var regObj={};regObj.id=objectIdStr;regObj.swfVersion=swfVersionStr;regObj.expressInstall=xiSwfUrlStr;regObj.callbackFn=callbackFn;regObjArr[regObjArr.length]=regObj;setVisibility(objectIdStr,false)}else if(callbackFn){callbackFn({success:false,id:objectIdStr})}},getObjectById:function(objectIdStr){if(ua.w3){return getObjectById(objectIdStr)}},embedSWF:function(swfUrlStr,replaceElemIdStr,widthStr,heightStr,swfVersionStr,xiSwfUrlStr,flashvarsObj,parObj,attObj,callbackFn){var callbackObj={success:false,id:replaceElemIdStr};if(ua.w3&&!(ua.wk&&ua.wk<312)&&swfUrlStr&&replaceElemIdStr&&widthStr&&heightStr&&swfVersionStr){setVisibility(replaceElemIdStr,false);addDomLoadEvent(function(){widthStr+="";heightStr+="";var att={};if(attObj&&typeof attObj===OBJECT){for(var i in attObj){att[i]=attObj[i]}}att.data=swfUrlStr;att.width=widthStr;att.height=heightStr;var par={};if(parObj&&typeof parObj===OBJECT){for(var j in parObj){par[j]=parObj[j]}}if(flashvarsObj&&typeof flashvarsObj===OBJECT){for(var k in flashvarsObj){if(typeof par.flashvars!=UNDEF){par.flashvars+="&"+k+"="+flashvarsObj[k]}else{par.flashvars=k+"="+flashvarsObj[k]}}}if(hasPlayerVersion(swfVersionStr)){var obj=createSWF(att,par,replaceElemIdStr);if(att.id==replaceElemIdStr){setVisibility(replaceElemIdStr,true)}callbackObj.success=true;callbackObj.ref=obj}else if(xiSwfUrlStr&&canExpressInstall()){att.data=xiSwfUrlStr;showExpressInstall(att,par,replaceElemIdStr,callbackFn);return}else{setVisibility(replaceElemIdStr,true)}if(callbackFn){callbackFn(callbackObj)}})}else if(callbackFn){callbackFn(callbackObj)}},switchOffAutoHideShow:function(){autoHideShow=false},ua:ua,getFlashPlayerVersion:function(){return{major:ua.pv[0],minor:ua.pv[1],release:ua.pv[2]}},hasFlashPlayerVersion:hasPlayerVersion,createSWF:function(attObj,parObj,replaceElemIdStr){if(ua.w3){return createSWF(attObj,parObj,replaceElemIdStr)}else{return undefined}},showExpressInstall:function(att,par,replaceElemIdStr,callbackFn){if(ua.w3&&canExpressInstall()){showExpressInstall(att,par,replaceElemIdStr,callbackFn)}},removeSWF:function(objElemIdStr){if(ua.w3){removeSWF(objElemIdStr)}},createCSS:function(selStr,declStr,mediaStr,newStyleBoolean){if(ua.w3){createCSS(selStr,declStr,mediaStr,newStyleBoolean)}},addDomLoadEvent:addDomLoadEvent,addLoadEvent:addLoadEvent,getQueryParamValue:function(param){var q=doc.location.search||doc.location.hash;if(q){if(/\?/.test(q)){q=q.split("?")[1]}if(param==null){return urlEncodeIfNecessary(q)}var pairs=q.split("&");for(var i=0;i<pairs.length;i++){if(pairs[i].substring(0,pairs[i].indexOf("="))==param){return urlEncodeIfNecessary(pairs[i].substring(pairs[i].indexOf("=")+1))}}}return""},expressInstallCallback:function(){if(isExpressInstallActive){var obj=getElementById(EXPRESS_INSTALL_ID);if(obj&&storedAltContent){obj.parentNode.replaceChild(storedAltContent,obj);if(storedAltContentId){setVisibility(storedAltContentId,true);if(ua.ie&&ua.win){storedAltContent.style.display="block"}}if(storedCallbackFn){storedCallbackFn(storedCallbackObj)}}isExpressInstallActive=false}}}}();(function(){var qs_args=function(){var args={};var pairs;var qs=window.location.search.substring(1);pairs=qs.split("&");for(var i=0;i<pairs.length;i++){var p=pairs[i].indexOf("=");if(p!=-1){var name=pairs[i].substring(0,p);var value=pairs[i].substring(p+1);args[name]=unescape(value)}}return args}();if(qs_args.flash=="1"||qs_args.flash_debug=="1"||qs_args.flash_debug_fail=="1")window.WEB_SOCKET_FORCE_FLASH=true;if(qs_args.flash_debug=="1")window.WEB_SOCKET_DEBUG_FLASH=true;var useFlashForWebSockets=function(){window.WEB_SOCKET_USING_FLASH=true;var logger;if(window.WEB_SOCKET_LOGGER){logger=WEB_SOCKET_LOGGER}else if(window.console&&window.console.log&&window.console.error){logger=window.console}else{logger={log:function(){},error:function(){},warn:function(){},info:function(){}}}if(window.WEB_SOCKET_FORCE_FLASH){logger.warn("FORCED TO USE FLASH SOCKET")}else{logger.warn("USING FLASH SOCKET FOR LACK OF WS SUPPORT")}if(swfobject.getFlashPlayerVersion().major<10||qs_args.flash_debug_fail=="1"){logger.error("Flash Player >= 10.0.0 is required.");window.WEB_SOCKET_USING_FLASH_BUT_NO_FLASH=true;if(!window.WEB_SOCKET_FORCE_FLASH)return}if(location.protocol=="file:"){logger.error("WARNING: web-socket-js doesn't work in file:///... URL "+"unless you set Flash Security Settings properly. "+"Open the page via Web server i.e. http://...")}window.WebSocket=function(url,protocols,proxyHost,proxyPort,headers){var self=this;self.__id=WebSocket.__nextId++;WebSocket.__instances[self.__id]=self;self.readyState=WebSocket.CONNECTING;self.bufferedAmount=0;self.__events={};if(!protocols){protocols=[]}else if(typeof protocols=="string"){protocols=[protocols]}self.__createTask=setTimeout(function(){WebSocket.__addTask(function(){self.__createTask=null;WebSocket.__flash.create(self.__id,url,protocols,proxyHost||null,proxyPort||0,headers||null)})},0)};WebSocket.prototype.send=function(data){if(this.readyState==WebSocket.CONNECTING){throw"INVALID_STATE_ERR: Web Socket connection has not been established"}var result=WebSocket.__flash.send(this.__id,encodeURIComponent(data));if(result<0){return true}else{this.bufferedAmount+=result;return false}};WebSocket.prototype.close=function(){if(this.__createTask){clearTimeout(this.__createTask);this.__createTask=null;this.readyState=WebSocket.CLOSED;return}if(this.readyState==WebSocket.CLOSED||this.readyState==WebSocket.CLOSING){return}this.readyState=WebSocket.CLOSING;WebSocket.__flash.close(this.__id)};WebSocket.prototype.addEventListener=function(type,listener,useCapture){if(!(type in this.__events)){this.__events[type]=[]}this.__events[type].push(listener)};WebSocket.prototype.removeEventListener=function(type,listener,useCapture){if(!(type in this.__events))return;var events=this.__events[type];for(var i=events.length-1;i>=0;--i){if(events[i]===listener){events.splice(i,1);break}}};WebSocket.prototype.dispatchEvent=function(event){var events=this.__events[event.type]||[];for(var i=0;i<events.length;++i){events[i](event)}var handler=this["on"+event.type];if(handler)handler.apply(this,[event])};WebSocket.prototype.__handleEvent=function(flashEvent){if("readyState"in flashEvent){this.readyState=flashEvent.readyState}if("protocol"in flashEvent){this.protocol=flashEvent.protocol}var jsEvent;if(flashEvent.type=="open"||flashEvent.type=="error"){jsEvent=this.__createSimpleEvent(flashEvent.type)}else if(flashEvent.type=="close"){jsEvent=this.__createSimpleEvent("close");jsEvent.wasClean=flashEvent.wasClean?true:false;jsEvent.code=flashEvent.code;jsEvent.reason=flashEvent.reason}else if(flashEvent.type=="message"){var data=decodeURIComponent(flashEvent.message);jsEvent=this.__createMessageEvent("message",data)}else{throw"unknown event type: "+flashEvent.type}this.dispatchEvent(jsEvent)};WebSocket.prototype.__createSimpleEvent=function(type){if(document.createEvent&&window.Event){var event=document.createEvent("Event");event.initEvent(type,false,false);return event}else{return{type:type,bubbles:false,cancelable:false}}};WebSocket.prototype.__createMessageEvent=function(type,data){if(document.createEvent&&window.MessageEvent&&!window.opera){var event=document.createEvent("MessageEvent");event.initMessageEvent("message",false,false,data,null,null,window,null);return event}else{return{type:type,data:data,bubbles:false,cancelable:false}}};WebSocket.CONNECTING=0;WebSocket.OPEN=1;WebSocket.CLOSING=2;WebSocket.CLOSED=3;WebSocket.__isFlashImplementation=true;WebSocket.__initialized=false;WebSocket.__flash=null;WebSocket.__instances={};WebSocket.__tasks=[];WebSocket.__nextId=0;WebSocket.loadFlashPolicyFile=function(url){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(url)})};WebSocket.__initialize=function(){if(window.WEB_SOCKET_USING_FLASH_BUT_NO_FLASH)return;if(WebSocket.__initialized)return;WebSocket.__initialized=true;if(WebSocket.__swfLocation){window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation}if(!window.WEB_SOCKET_SWF_LOCATION){logger.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");return}if(!window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR&&!WEB_SOCKET_SWF_LOCATION.match(/(^|\/)WebSocketMainInsecure\.swf(\?.*)?$/)&&WEB_SOCKET_SWF_LOCATION.match(/^\w+:\/\/([^\/]+)/)){var swfHost=RegExp.$1;if(location.host!=swfHost){logger.error("[WebSocket] You must host HTML and WebSocketMain.swf in the same host "+"('"+location.host+"' != '"+swfHost+"'). "+"See also 'How to host HTML file and SWF file in different domains' section "+"in README.md. If you use WebSocketMainInsecure.swf, you can suppress this message "+"by WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR = true;")}}var container=document.createElement("div");container.id="webSocketContainer";container.style.position="absolute";if(WebSocket.__isFlashLite()){container.style.left="0px";container.style.top="0px"}else{container.style.left="-100px";container.style.top="-100px"}var holder=document.createElement("div");holder.id="webSocketFlash";container.appendChild(holder);document.body.appendChild(container);swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:true,swliveconnect:true,allowScriptAccess:"always"},null,function(e){if(!e.success){logger.error("[WebSocket] swfobject.embedSWF failed")}})};WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash");WebSocket.__flash.setCallerUrl(location.href);WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG_FLASH);for(var i=0;i<WebSocket.__tasks.length;++i){WebSocket.__tasks[i]()}WebSocket.__tasks=[]},0)};WebSocket.__onFlashEvent=function(){setTimeout(function(){try{var events=WebSocket.__flash.receiveEvents();for(var i=0;i<events.length;++i){WebSocket.__instances[events[i].webSocketId].__handleEvent(events[i])}}catch(e){logger.error(e)}},0);return true};WebSocket.__log=function(message){logger.log(decodeURIComponent(message))};WebSocket.__error=function(message){logger.error(decodeURIComponent(message))};WebSocket.__addTask=function(task){if(WebSocket.__flash){task()}else{WebSocket.__tasks.push(task)}};WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes){return false}var mimeType=window.navigator.mimeTypes["application/x-shockwave-flash"];if(!mimeType||!mimeType.enabledPlugin||!mimeType.enabledPlugin.filename){return false}return mimeType.enabledPlugin.filename.match(/flashlite/i)?true:false};if(!window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION){swfobject.addDomLoadEvent(function(){WebSocket.__initialize()})}nullOutUseFlashForWebSockets()};var nullOutUseFlashForWebSockets=function(){useFlashForWebSockets=function(){if(console&&console.log)console.log("useFlashForWebSockets called, but already using flash, so ignoring")}};window.fallBackToFlashWebSockets=function(){window.WEB_SOCKET_FORCE_FLASH=true;useFlashForWebSockets()};if(window.WEB_SOCKET_FORCE_FLASH){}else if(window.WebSocket){return}else if(window.MozWebSocket){window.WebSocket=MozWebSocket;return}useFlashForWebSockets()})();(function($,undefined){"use strict";var BLANK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";$.fn.imagesLoaded=function(callback){var $this=this,deferred=$.isFunction($.Deferred)?$.Deferred():0,hasNotify=$.isFunction(deferred.notify),$images=$this.find("img").add($this.filter("img")),loaded=[],proper=[],broken=[];if($.isPlainObject(callback)){$.each(callback,function(key,value){if(key==="callback"){callback=value}else if(deferred){deferred[key](value)}})}function doneLoading(){var $proper=$(proper),$broken=$(broken);if(deferred){if(broken.length){deferred.reject($images,$proper,$broken)}else{deferred.resolve($images)}}if($.isFunction(callback)){callback.call($this,$images,$proper,$broken)}}function imgLoadedHandler(event){imgLoaded(event.target,event.type==="error")}function imgLoaded(img,isBroken){if(img.src===BLANK||$.inArray(img,loaded)!==-1){return}loaded.push(img);if(isBroken){broken.push(img)}else{proper.push(img)}$.data(img,"imagesLoaded",{isBroken:isBroken,src:img.src});if(hasNotify){deferred.notifyWith($(img),[isBroken,$images,$(proper),$(broken)])}if($images.length===loaded.length){setTimeout(doneLoading);$images.unbind(".imagesLoaded",imgLoadedHandler)}}if(!$images.length){doneLoading()}else{$images.bind("load.imagesLoaded error.imagesLoaded",imgLoadedHandler).each(function(i,el){var src=el.src;var cached=$.data(el,"imagesLoaded");if(cached&&cached.src===src){imgLoaded(el,cached.isBroken);return}if(el.complete&&el.naturalWidth!==undefined){imgLoaded(el,el.naturalWidth===0||el.naturalHeight===0);return}if(el.readyState||el.complete){el.src=BLANK;el.src=src}})}return deferred?deferred.promise($this):$this}})(jQuery);(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{factory(jQuery)}})(function($){var widget_uuid=0,widget_slice=Array.prototype.slice;$.cleanData=function(orig){return function(elems){var events,elem,i;for(i=0;(elem=elems[i])!=null;i++){try{events=$._data(elem,"events");if(events&&events.remove){$(elem).triggerHandler("remove")}}catch(e){}}orig(elems)}}($.cleanData);$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget}$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element)}if(arguments.length){this._createWidget(options,element)}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base;basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return}proxiedPrototype[prop]=function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue}}()});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix||name:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)});delete existingConstructor._childConstructors}else{base._childConstructors.push(constructor)}$.widget.bridge(name,constructor);return constructor};$.widget.extend=function(target){var input=widget_slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value)}else{target[key]=value}}}}return target};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=widget_slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(options==="instance"){returnValue=instance;return false}if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'")}if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance")}methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false}})}else{this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{});if(instance._init){instance._init()}}else{$.data(this,fullName,new object(options,this))}})}return returnValue}};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=widget_uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy()}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options)}if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]]}key=parts.pop();if(arguments.length===1){return curOption[key]===undefined?null:curOption[key]}curOption[key]=value}else{if(arguments.length===1){return this.options[key]===undefined?null:this.options[key]}options[key]=value}}this._setOptions(options);return this},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key])}return this},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled",!!value);if(value){this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}}return this},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false}if(!handlers){handlers=element;element=this.element;delegateElement=this.widget()}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element)}$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return}return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++}var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy)}else{element.bind(eventName,handlerProxy)}})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;element.unbind(eventName).undelegate(eventName)},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover")},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus")},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop]}}}this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented())}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options}}var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options}}hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay)}if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options)}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback)}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0])}next()})}}});var widget=$.widget});(function(){$.widget("TS.tab_complete_ui",{_$el:null,_$input:null,_$scroller:null,_$parent_scroller:null,_current_matches:[],_is_showing:false,_was_just_hidden:false,_last_shown_matches:null,_show_delay_tim:0,_show_delay_ms:500,_lazy_load:null,_scroll_raf:null,_currently_keyboard_highlighted:true,_date_start:new Date,_create:function(){this._$input=this.element;var id=this.options.id;this._$el=$('<div id="'+id+'" class="tab_complete_ui hidden inactive"> 				<div id="'+id+'_header" class="tab_complete_ui_header"> 					<span class="header_label"></span> 					<span class="header_help"><strong>tab</strong>&nbsp; or &nbsp;<strong>&uarr;</strong> <strong>&darr;</strong>&nbsp; to navigate <strong class="left_margin"></strong>&nbsp; to select <strong class="left_margin">esc</strong>&nbsp; to dismiss</span> 				</div> 			</div>');if(this.options.narrow)this._$el.addClass("narrow");this._$scroller=$('<div id="'+id+'_scroller" class="tab_complete_ui_scroller"></div>');this._$el.append(this._$scroller);$("body").append(this._$el);var debug=TS.qs_args["debug_scroll"]=="1";this._$scroller.monkeyScroll({debug:debug});this._$el.bind("click",this._onElClick.bind(this));this._$el.bind("mousemove",this._onElMouseMove.bind(this));this._$el.on("mouseenter",".tab_complete_ui_item",this._onItemMouseEnter.bind(this));this._$input.bind("matches_set",this._onInputMatchesSet.bind(this));this._$input.bind("match_changed",this._onInputMatchChanged.bind(this));this._$input.bind("reset",this._onInputReset.bind(this));this._$input.bind("keydown",this._onInputKeyDown.bind(this))},_destroy:function(){this._$el.remove();$("html").unbind("mousedown.tabcomplete");if(this._$parent_scroller)this._$parent_scroller.unbind("scroll.tab_complete_ui")},_show_threshold:1e3,_show_slow:null,_show:function(event_data){this._currently_keyboard_highlighted=true;var start=new Date;event_data.shown_callback();var $el=this._$el;var $scroller=this._$scroller;var current_matches=event_data.current_matches.join("");if(this._last_shown_matches!==current_matches){this._last_shown_matches=current_matches;this._buildAndInsertHTML(event_data)}if(!this._is_showing){$el.removeClass("inactive").removeClass("hidden");$scroller.trigger("resize-immediate")}this._is_showing=true;$("html").unbind("mousedown.tabcomplete").bind("mousedown.tabcomplete",this._onMouseDown.bind(this));this._positionUI();var time=new Date-start;if(event_data&&event_data.w&&time>this._show_threshold&&!this._show_slow){if(event_data.w==="emoji"){TS.logError({message:"emoji took "+time+"ms for "+event_data.current_matches.length+" items (theshold is "+this._show_threshold+"ms). localStorage = "+(TS.model.prefs.ls_disabled?0:1)},"tab_complete_ui._show() with emoji exceeded slow threshold")}else if(event_data.w==="members"){TS.logError({message:"members took "+time+"ms for "+event_data.current_matches.length+" items (theshold is "+this._show_threshold+"ms). Member images: "+(!TS.model.mac_ssb_version||event_data.current_matches.length<100?"included.":"excluded.")+" App open for "+((new Date-this._date_start)/1e3/60).toFixed(2)+" min."},"tab_complete_ui._show() with members exceeded slow threshold")}this._show_slow=true}if(this.options.scroll_with_element){if(this._$parent_scroller)this._$parent_scroller.unbind("scroll.tab_complete_ui");this._$parent_scroller=this._$input.parents(":scrollable(vertical):first");this._$parent_scroller.bind("scroll.tab_complete_ui",this._onScroll.bind(this))}},_hide:function(){var $el=this._$el;this._is_showing=false;$el.addClass("inactive");$el.addClass("hidden");this._last_shown_matches=null;if(this._$parent_scroller)this._$parent_scroller.unbind("scroll.tab_complete_ui");this._was_just_hidden=true;setTimeout(function(){this._was_just_hidden=false}.bind(this),0)},_onInputKeyDown:function(e){this._currently_keyboard_highlighted=true},_onElClick:function(e){var $input=this._$input;var $clicked=$(e.target).closest(".tab_complete_ui_item");if(!$clicked.length)return;$input.TS_tabComplete2("choose",$clicked.data("index"))},_onElMouseMove:function(e){this._currently_keyboard_highlighted=false},_onItemMouseEnter:function(e){if(this._currently_keyboard_highlighted)return;var $input=this._$input;var $item=$(e.target).closest(".tab_complete_ui_item");var dont_submit=true;$input.TS_tabComplete2("choose",$item.data("index"),dont_submit)},_onInputMatchesSet:function(e,event_data){clearTimeout(this._show_delay_tim);var $el=this._$el;var $scroller=this._$scroller;this._current_matches=event_data.current_matches;if(event_data.hide_ui){this._hide()}else{var go=function(){this._show(event_data);$scroller.scrollTop(0);if(event_data.i!=-1){$el.find('.tab_complete_ui_item[data-index="'+event_data.i+'"]:not(.just_one)').addClass("active").scrollintoview({duration:10})}}.bind(this);if(event_data.delay_ui){this._show_delay_tim=setTimeout(go,this._show_delay_ms);$scroller.scrollTop(0);if(event_data.i!=-1){$el.find('.tab_complete_ui_item[data-index="'+event_data.i+'"]:not(.just_one)').addClass("active").scrollintoview({duration:10})}this._positionUI()}else{go()}}},_onInputMatchChanged:function(e,event_data){clearTimeout(this._show_delay_tim);var $el=this._$el;if(!this._current_matches){this._onInputMatchesSet(e,event_data);return}this._show(event_data);$el.find(".tab_complete_ui_item").removeClass("active");$el.find('.tab_complete_ui_item[data-index="'+event_data.i+'"]').addClass("active").scrollintoview({duration:10})},_onInputReset:function(e,event_data){clearTimeout(this._show_delay_tim);$("html").unbind("mousedown.tabcomplete");this._hide();this._current_matches=null},_onMouseDown:function(e){var $el=this._$el;var $input=this._$input;if($(e.target).closest($el).length===0&&$(e.target).closest($input).length===0){$input.TS_tabComplete2("reset","mousedown")}},_onScroll:function(e){TS.utility.cancelRAF(this._scroll_raf);this._scroll_raf=TS.utility.rAF(this._positionUI.bind(this))},_positionUI:function(){if(!this._$el||!this._$el.length)return;var $el=this._$el;var $input=this._$input;var offset=$input.offset();var $y_positioner=$input.data("$tab_complete_ui_y_positioner");if($y_positioner){var y_offset=$y_positioner.offset();offset.top=y_offset.top;offset.bottom=y_offset.bottom}var current_width=$input.width();var min_width=this.options.min_width||500;var padding=20;var new_width;var window_fit_width=$(window).width()-offset.left-padding;if(window_fit_width>0&&(window_fit_width<current_width||min_width>window_fit_width)){new_width=current_width=window_fit_width}else{new_width=Math.max(min_width,current_width)}$el.css({width:new_width});if(offset.top<488){this._$scroller.css("max-height",Math.max(100,offset.top-32))}else{this._$scroller.css("max-height","")}var x=offset.left;var y=offset.top-$el.outerHeight();$el.css({top:y,left:x});this._$scroller.data("monkeyScroll").updateFunc()},positionUI:function(){this._positionUI()},isShowing:function(){return this._is_showing},wasJustHidden:function(){return this._was_just_hidden},_buildItemsHTML:function(event_data){var html=[];var current_matches=this._current_matches;var ul_class="type_"+event_data.w;html.push('<ul class="'+ul_class+'">');var just_one=false&&current_matches.length==1;var output_cmds_to_console=false;var all_cmds={};for(var i=0;i<current_matches.length;i++){if(event_data.w=="emoji"){html.push('<li class="tab_complete_ui_item" data-index="'+i+'">'+this._buildEmojiHTML(current_matches[i])+"</li>")}else if(event_data.w=="channels"){html.push('<li class="tab_complete_ui_item" data-index="'+i+'">'+this._buildChannelHTML(current_matches[i])+"</li>")}else if(event_data.w=="cmds"){html.push('<li class="tab_complete_ui_item '+(just_one?"just_one":"")+'" data-index="'+i+'">'+this._buildCmdHTML(current_matches[i],just_one)+"</li>");if(output_cmds_to_console){var ob=TS.utility.clone(TS.cmd_handlers[current_matches[i]]);if(ob){all_cmds[current_matches[i]]=ob;for(var k in ob){if(!ob[k]||k=="autocomplete"){delete ob[k]}}}}}else{html.push(this._buildMemberHTML(current_matches,i,event_data.sort_by_membership))}}if(output_cmds_to_console)TS.warn(JSON.stringify(all_cmds,null,"	"));html.push("</ul>");html=html.join("");if(event_data.w=="emoji"){html=TS.emoji.graphicReplace(html)}return html},_buildMemberHTML:function(matches,i,sort_by_membership){var match=matches[i];var html;var needs_hr=false;if(match=="everyone"||match=="channel"||match=="group"||match=="here"){needs_hr=sort_by_membership&&i>0&&TS.members.getMemberByName(matches[i-1]);html='<span class="broadcast">@'+match+"</span>";switch(match){case"everyone":html+=' <span class="broadcast_info">Notify everyone on your team.</span>';break;case"channel":html+=' <span class="broadcast_info">Notify everyone in this channel.</span>';break;case"group":html+=' <span class="broadcast_info">Notify everyone in this group.</span>';break;case"here":var ob_type=TS.shared.getActiveModelOb().is_channel?"channel":TS.templates.builders.groupCopy();html+=' <span class="broadcast_info">Notify every online desktop-using member in this '+ob_type+".</span>";
break;default:break}}else if(TS.boot_data.feature_subteams&&TS.user_groups.getUserGroupsByHandle(match)){var user_group=TS.user_groups.getUserGroupsByHandle(match);if(user_group){var not_in_channel;var ob_type;var model_ob=TS.shared.getActiveModelOb();var members_in_channel_known;if(model_ob){ob_type=model_ob.is_channel?"channel":TS.templates.builders.groupCopy()}TS.user_groups.getMembersInCorG(user_group.id,model_ob.id,function(members_in_channel){members_in_channel_known=true;user_group=TS.user_groups.getUserGroupsById(user_group.id);not_in_channel=user_group.user_count-members_in_channel.length});var description=user_group.description||user_group.name+" user group";html='<span class="broadcast">@'+TS.utility.htmlEntities(match)+"</span>";html+=' <span class="realname">'+user_group.user_count;html+=user_group.user_count==1?" member":" members";if(members_in_channel_known){html+=not_in_channel?" ("+not_in_channel+" not in "+ob_type+")":""}html+=' <span class="bullet"></span> ';html+=TS.utility.htmlEntities(description);html+="</span>"}}else{html='<span class="username">'+match+"</span>";var member=TS.members.getMemberByName(match);if(!member){html="@"+html}else{var model_ob=!this.options.no_model_ob&&TS.shared.getActiveModelOb();var is_member=model_ob&&!model_ob.is_im&&(model_ob.members.indexOf(member.id)>-1||member.is_slackbot);if(sort_by_membership&&i>0&&!is_member&&!model_ob.is_im){var prev_member=TS.members.getMemberByName(matches[i-1]);if(!prev_member||prev_member.is_slackbot||model_ob.members.indexOf(prev_member.id)>-1){needs_hr=true}}if(matches.length<100){html=TS.templates.builders.makeMemberImage(member.id,24,true)+" "+html}if(member.presence){html+=TS.templates.makeMemberPresenceIcon(member)}html+=' <span class="realname">'+TS.utility.htmlEntities(member.profile.real_name)+"</span>";if(model_ob&&!member.is_slackbot&&!model_ob.is_im){var what="channel";if(model_ob.is_group)what="group";if(!is_member){html+=' <span class="not_in_channel">(not in '+what+")</span>"}}}}html='<li class="tab_complete_ui_item" data-index="'+i+'">'+html+"</li>";if(needs_hr){html='<hr class="small_top_margin small_bottom_margin" />'+html}return html},_buildChannelHTML:function(match){var html='<span class="channelname"><span class="hash">#</span>'+match+"</span>";return html},_buildCmdHTML:function(match,just_one){var ob=TS.cmd_handlers[match];var html;if(ob){var aliases_txt="";if(ob.aliases){aliases_txt=" (or "+ob.aliases.join(", ")+")"}var args_txt="";if(ob.usage){args_txt=" "+ob.usage;args_txt=args_txt.replace(/</g,'<span class="argname argoptional"%%%% &lt;');args_txt=args_txt.replace(/\>/g,"&gt;</span>");args_txt=args_txt.replace(/\%\%\%\%/g,">");args_txt=args_txt.replace(/\[/g,'<span class="argname"> [');args_txt=args_txt.replace(/\]/g,"]</span>")}else if(ob.args){var arg;for(var i=0;i<ob.args.length;i++){arg=ob.args[i];if(arg.optional){args_txt+=' <span class="argname argoptional"> ['+arg.name+"]</span>"}else{args_txt+=' <span class="argname"> '+arg.name+"</span>"}}}var type_txt="";var override_txt="";if(ob.type=="client"&&ob.override){override_txt=" override"}if(ob.type=="service"||ob.type=="custom"){type_txt="["+ob.type+override_txt+"]"}html='<div class="cmd-left-td"><span class="cmdname">'+TS.utility.htmlEntities(match)+"</span>"+aliases_txt+args_txt+'</div><div class="cmd-right-td"><span class="cmddesc"><span class="cmdtype">'+type_txt+"</span> "+TS.utility.htmlEntities(ob.desc)+"</span></div>"}else{html='<div class="cmd-left-td"><span class="cmdname">'+match+"</span></div>"}if(just_one){}return html},_buildEmojiHTML:function(match){var include_emoji_text=!TS.model.prefs.emoji_autocomplete_big;var html=":"+match+": ";if(include_emoji_text)html=":"+match+": "+"&#58;"+match+"&#58";return html},_buildHeaderHTML:function(event_data){var html="";if(event_data.w=="members"){html="People"}else if(event_data.w=="cmds"){html="Commands"}else{html=TS.utility.capitalize(event_data.w)}if(event_data.matched_on&&event_data.matched_on!="@"&&event_data.matched_on!="#"){html+=" matching <strong>"+TS.utility.htmlEntities(event_data.matched_on)+"</strong>"}return html},_buildAndInsertHTML:function(event_data){var $scroller=this._$scroller;this._$el.find(".header_label").html(this._buildHeaderHTML(event_data));$scroller.html(this._buildItemsHTML(event_data));if(this._lazyload&&this._lazyload.detachEvents){this._lazyload.detachEvents()}this._lazyload=$scroller.find("img.lazy").lazyload({container:this._$scroller})}})})();(function(){"use strict";$.widget("TS.longListView",{_dirty:false,_$container:null,_$scrollable:null,_scrollable_height:null,_scrollable_width:null,_scrollable_offset:null,_list_height:null,_scroll_top:null,_visible_items_map:null,_item_heights:null,_free_elements:null,_free_dividers:null,_buffer_size:_DEFAULT_BUFFER_SIZE,_scrolling:false,_use_sticky:false,_preserve_dom_order:false,_create:function(){this._use_sticky=TS.model.supports_sticky_position;if(this.options.pin_dividers&&!this._use_sticky){this.options.pin_dividers=false}this._debouncedResize=TS.utility.throttleFunc(this._resize.bind(this),500,true);this._debouncedStoppedScrolling=TS.utility.throttleFunc(this._stoppedScrolling.bind(this),150,true);this._debouncedDoneInertialScrolling=TS.utility.throttleFunc(this._doneInertialScrolling.bind(this),150,true);this._dirty=false;this._visible_items_map={};this._free_elements=[];this._free_dividers=[];this._preserve_dom_order=this.options.preserve_dom_order;this._$container=this.element;this._$container.addClass("not_scrolling");if(this.options.scrollable){this._$scrollable=$(this.options.scrollable)}else{this._$scrollable=this._$container}this._calculateSizing();this._$list_wrapper=$('<div class="list_items">').css({position:"relative"}).appendTo(this._$container);this._buffer_size=this.options.buffer_size||_DEFAULT_BUFFER_SIZE;this._initForData();this._animation=TS.utility.startAnimation(this._renderUI.bind(this));this._boundOnScroll=this._onScroll.bind(this);this._$scrollable.on("scroll",this._boundOnScroll);this._debouncedResizeWrapper=function(){this._debouncedResize()}.bind(this),$(window).on("resize",this._debouncedResizeWrapper);this._initInertialScrollFix()},_destroy:function(){this._$scrollable.off("scroll",this._boundOnScroll);$(window).off("resize",this._debouncedResizeWrapper);this._animation.stop()},setItems:function(items){this.options.items=items;this._initForData()},_initForData:function(){this._dirty=true;this._item_heights=[];var acc=0;var since_last_divider=0;var item;var approx_height;var sticky_dividers=this.options.pin_dividers&&this._use_sticky;for(var i=0;i<this.options.items.length;i++){item=this.options.items[i];if(item.is_divider){approx_height=this.options.approx_divider_height||this.options.approx_item_height}else{approx_height=this.options.approx_item_height}this._item_heights.push({index:i,top:acc,margin_top:item.is_divider&&sticky_dividers?since_last_divider:null,height:approx_height,approx:true});if(item.is_divider&&sticky_dividers){since_last_divider=0}else{since_last_divider+=approx_height}acc+=approx_height}this._$list_wrapper.css("height",acc);var current_range=Object.keys(this._visible_items_map);current_range.forEach(function(i){this._recycle(i)},this);var element;var h_map;if(sticky_dividers){for(i=0;i<this.options.items.length;i++){item=this.options.items[i];if(item.is_divider){element=this._renderItem(i);this._visible_items_map[i]=element;h_map=this._item_heights[i];element.$el.css("margin-top",h_map.margin_top+"px");element.top=h_map.margin_top}}}},_animation:null,_renderUI:function(){if(!this._dirty)return;var sticky_dividers=this.options.pin_dividers&&this._use_sticky;var top=this._scroll_top-this._scrollable_offset;var bottom=this._scroll_top+this._scrollable_height-this._scrollable_offset;var first=null,last=null;var h_index,h_map;for(h_index=0;h_index<this._item_heights.length;h_index++){h_map=this._item_heights[h_index];if(first===null){if(h_map.top<=top&&h_map.top+h_map.height>top)first=h_index}if(last===null){if(h_map.top<=bottom&&h_map.top+h_map.height>bottom)last=h_index}if(first!==null&&last!==null)break}if(first===null)first=0;if(last===null)last=this.options.items.length-1;first=Math.max(0,first-this._buffer_size);last=Math.min(this.options.items.length-1,last+this._buffer_size);var pinned_divider_index=null;if(this.options.pin_dividers&&!this._use_sticky){for(h_index=0;h_index<this._item_heights.length;h_index++){h_map=this._item_heights[h_index];if(h_map.top>=top)break;if(this.options.items[h_index].is_divider)pinned_divider_index=h_index}}var current_range=Object.keys(this._visible_items_map);current_range.forEach(function(i){i=parseInt(i,10);if((i<first||i>last)&&i!==pinned_divider_index){if(sticky_dividers&&this._visible_items_map[i].is_divider)return;if(this._visible_items_map[i].$el.data("no-remove"))return;this._recycle(i)}},this);current_range=Object.keys(this._visible_items_map);var element;var newly_inserted=[];for(var i=first;i<=last;i++){if(current_range.indexOf(i.toString())!==-1)continue;element=this._renderItem(i);this._visible_items_map[i]=element;newly_inserted.push(i);_log("rendered item "+i)}current_range=Object.keys(this._visible_items_map);if(pinned_divider_index!==null&&current_range.indexOf(pinned_divider_index.toString())===-1&&pinned_divider_index<first){element=this._renderItem(pinned_divider_index);this._visible_items_map[pinned_divider_index]=element;newly_inserted.unshift(pinned_divider_index);current_range=Object.keys(this._visible_items_map)}if(this._preserve_dom_order){newly_inserted.forEach(function(inx){var element=this._visible_items_map[inx];var prev=this._visible_items_map[inx-1];if(prev){prev.$el.after(element.$el)}else{element.$el.prependTo(this._$list_wrapper)}},this)}if(pinned_divider_index!==null){current_range.forEach(function(inx){if(parseInt(inx,10)===pinned_divider_index){this._visible_items_map[inx].is_pinned=true;this._visible_items_map[inx].$el.css("z-index",_PINNED_Z_INDEX)}else if(this._visible_items_map[inx].is_pinned){this._visible_items_map[inx].is_pinned=false;this._visible_items_map[inx].$el.css("z-index",_DIVIDER_Z_INDEX)}},this)}newly_inserted.forEach(function(inx){var element=this._visible_items_map[inx];var h_map=this._item_heights[inx];if(!h_map.approx)return;var h=this.options.approx_item_height;if(element.is_divider&&this.options.approx_divider_height)h=this.options.approx_divider_height;if(element.is_divider&&$.isFunction(this.options.calcDividerHeight)){h=this.options.calcDividerHeight(element.$el,this.options.items[inx],element.data)}else if($.isFunction(this.options.calcItemHeight)){h=this.options.calcItemHeight(element.$el,this.options.items[inx],element.data)}var diff=h-h_map.height;h_map.height=h;h_map.approx=false;if(diff===0)return;var reached_sticky_divider=false;for(var i=inx+1;i<this.options.items.length;i++){h_map=this._item_heights[i];if(sticky_dividers&&this.options.items[i].is_divider){if(!reached_sticky_divider){reached_sticky_divider=true;h_map.margin_top+=diff}}h_map.top+=diff}},this);current_range.forEach(function(inx){var element=this._visible_items_map[inx];var $el=element.$el;var h_map=this._item_heights[inx];if(element.is_divider&&sticky_dividers){if(element.top!==h_map.margin_top){$el.css("margin-top",h_map.margin_top+"px");element.top=h_map.margin_top}}else if(element.is_pinned){_setTopPosition($el,top);element.top=top}else if(element.top!==h_map.top){_setTopPosition($el,h_map.top);element.top=h_map.top}},this);var last_row_h_map=this._item_heights[this._item_heights.length-1];if(last_row_h_map!==undefined){var total_height=last_row_h_map.height+last_row_h_map.top;if(total_height!==this._list_height){this._$list_wrapper.css("height",total_height);this._list_height=total_height}}this._free_elements.forEach(function(el){el.$el.addClass("hidden");if(this._preserve_dom_order)el.$el.appendTo(this._$list_wrapper)},this);this._free_dividers.forEach(function(el){el.$el.addClass("hidden");if(this._preserve_dom_order)el.$el.appendTo(this._$list_wrapper)},this);this._dirty=false},itemUpdated:function(item){var inx=this.options.items.indexOf(item);if(inx===-1)return;this.itemUpdatedByIndex(inx)},itemUpdatedById:function(id){for(var i=0;i<this.options.items.length;i++){if(this.options.items[i].id===id)return this.itemUpdatedByIndex(i)}},itemUpdatedByIndex:function(inx){var visible_item=this._visible_items_map[inx];if(visible_item)this._recycle(inx);var item=this.options.items[inx];if(item&&item.id){this._free_elements.forEach(function(free_el){if(free_el.id===item.id)free_el.id=null})}this._dirty=true},_onScroll:function(){this._scroll_top=this._$scrollable.scrollTop();this._dirty=true;if(this._scrolling){this._debouncedStoppedScrolling()}else{this._scrolling=true;TS.utility.rAF(function(){this._$container.removeClass("not_scrolling")}.bind(this));this._debouncedStoppedScrolling()}},_debouncedStoppedScrolling:null,_stoppedScrolling:function(){this._$container.addClass("not_scrolling");this._scrolling=false},_recycle:function(index){_log("Recyling item "+index);var element=this._visible_items_map[index];var sticky_dividers=this.options.pin_dividers&&this._use_sticky;element.in_use=false;element.inx=-1;if(element.is_divider){if(sticky_dividers){element.$el.remove()}else{element.is_pinned=false;element.$el.css("z-index",_DIVIDER_Z_INDEX);this._free_dividers.push(element)}}else{this._free_elements.push(element)}delete this._visible_items_map[index]},_renderItem:function(i){var item=this.options.items[i];var element;if(item.is_divider){element=this._takeDivider()}else{element=this._takeElement(item)}element.in_use=true;element.$el.removeClass("hidden");element.inx=i;if(item.is_divider){this.options.renderDivider(element.$el,item,element.data)}else{var was_id=element.id;element.id=item.id;if(!element.id||was_id!==element.id){this.options.renderItem(element.$el,item,element.data)}}element.$el.data("order-index",i);return element},_takeElement:function(item){if(this._free_elements.length>0){if(item&&item.id){for(var i=0;i<this._free_elements.length;i++){if(this._free_elements[i].id===item.id){var element=this._free_elements[i];this._free_elements.splice(i,1);return element}}}return this._free_elements.pop()}_log("No free elements; building extra.");return this._makeElement()},_takeDivider:function(){if(this._free_dividers.length>0)return this._free_dividers.pop();_log("No free dividers; building extra.");var make_divider=true;return this._makeElement(make_divider)},_makeElement:function(make_divider){var data={};var $el;if(make_divider){$el=this.options.makeDivider(data);$el.css("z-index",_DIVIDER_Z_INDEX)}else{$el=$(this.options.makeElement(data))}$el.attr("data-long-list-item","1");if(make_divider&&this.options.pin_dividers&&this._use_sticky){$el.css({position:"-webkit-sticky",top:"0"})}else{$el.css({position:"absolute",top:"0"})}$el.addClass("hidden");$el.appendTo(this._$list_wrapper);return{inx:-1,id:null,$el:$el,in_use:false,data:data,top:0,is_divider:!!make_divider,is_pinned:false}},_debouncedResize:null,_resize:function(){var changed=this._calculateSizing();if(!changed)return;for(var i=0;i<this._item_heights.length;i++){this._item_heights[i].approx=true}var current_range=Object.keys(this._visible_items_map);var sticky_dividers=this.options.pin_dividers&&this._use_sticky;current_range.forEach(function(i){if(!(sticky_dividers&&this.options.items[i].is_divider))this._recycle(i)},this);this._dirty=true},resizeImmediately:function(){this._resize()},_calculateSizing:function(){var new_height=this._$scrollable.height();var new_width=this._$scrollable.width();if(new_height!==this._scrollable_height||new_width!==this._scrollable_width){this._scrollable_height=new_height;this._scrollable_width=new_width}else{return false}this._scroll_top=this._$scrollable.scrollTop();if(this._$scrollable[0]===this._$container[0]){this._scrollable_offset=0;return true}var scrollable_offset=this._$scrollable.offset();var container_offset=this._$container.offset();if(scrollable_offset&&container_offset){this._scrollable_offset=container_offset.top-(scrollable_offset.top-this._scroll_top)}return true},scrollToTop:function(immediately){var pos=0;if(immediately){this._scrollImmediately(pos)}else{this._$scrollable.scrollTop(pos)}},scrollToEnd:function(immediately){if(this._list_height<this._scrollable_height)return;var pos=this._list_height-this._scrollable_height;if(immediately){this._scrollImmediately(pos)}else{this._$scrollable.scrollTop(pos)}},_scrollImmediately:function(pos){this._$scrollable.scrollTop(pos);this._scroll_top=pos;this._dirty=true;this._renderUI()},_inertialScrollStart:null,_initInertialScrollFix:function(){this._$list_wrapper.on("mousewheel",function(e){var $item=$(e.target).closest("[data-long-list-item]");if($item.length&&this._inertialScrollStart!==$item[0]){if(this._inertialScrollStart)$(this._inertialScrollStart).data("no-remove",false);$item.data("no-remove",true);this._inertialScrollStart=$item[0]}});this._debouncedDoneInertialScrolling()},_debouncedDoneInertialScrolling:null,_doneInertialScrolling:function(){if(this._inertialScrollStart){$(this._inertialScrollStart).data("no-remove",false);this._inertialScrollStart=null}},renderUI:function(){this._renderUI()},setScrollTop:function(top){this._scroll_top=top;this._dirty=true}});var _DEFAULT_BUFFER_SIZE=3;var _PINNED_Z_INDEX=1;var _DIVIDER_Z_INDEX=2;var _log=function(txt){TS.log(2001,"long_list_view.js: "+txt)};var _setTopPosition=function($el,top){var el=$el[0];if(!el)return;var transform_prop;var transform_val="translateY("+top+"px)";if(el.style.transform!==undefined){transform_prop="transform"}else if(el.style.webkitTransform!==undefined){transform_prop="webkitTransform"}else if(el.style.mozTransform!==undefined){transform_prop="mozTransform"}if(transform_prop){el.style[transform_prop]=transform_val}else{el.style.top=top+"px"}}})();!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.Promise=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof _dereq_=="function"&&_dereq_;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof _dereq_=="function"&&_dereq_;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){var SomePromiseArray=Promise._SomePromiseArray;function any(promises){var ret=new SomePromiseArray(promises);var promise=ret.promise();ret.setHowMany(1);ret.setUnwrap();ret.init();return promise}Promise.any=function(promises){return any(promises)};Promise.prototype.any=function(){return any(this)}}},{}],2:[function(_dereq_,module,exports){"use strict";var firstLineError;try{throw new Error}catch(e){firstLineError=e}var schedule=_dereq_("./schedule.js");var Queue=_dereq_("./queue.js");var util=_dereq_("./util.js");function Async(){this._isTickUsed=false;this._lateQueue=new Queue(16);this._normalQueue=new Queue(16);this._trampolineEnabled=true;var self=this;this.drainQueues=function(){self._drainQueues()};this._schedule=schedule.isStatic?schedule(this.drainQueues):schedule}Async.prototype.disableTrampolineIfNecessary=function(){if(util.hasDevTools){this._trampolineEnabled=false}};Async.prototype.enableTrampoline=function(){if(!this._trampolineEnabled){this._trampolineEnabled=true;this._schedule=function(fn){setTimeout(fn,0)}}};Async.prototype.haveItemsQueued=function(){return this._normalQueue.length()>0};Async.prototype.throwLater=function(fn,arg){if(arguments.length===1){arg=fn;fn=function(){throw arg}}var domain=this._getDomain();if(domain!==undefined)fn=domain.bind(fn);if(typeof setTimeout!=="undefined"){setTimeout(function(){fn(arg)},0)}else try{this._schedule(function(){fn(arg)})}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}};Async.prototype._getDomain=function(){};if(!true){if(util.isNode){var EventsModule=_dereq_("events");var domainGetter=function(){var domain=process.domain;if(domain===null)return undefined;return domain};if(EventsModule.usingDomains){Async.prototype._getDomain=domainGetter}else{var descriptor=Object.getOwnPropertyDescriptor(EventsModule,"usingDomains");if(descriptor){if(!descriptor.configurable){process.on("domainsActivated",function(){Async.prototype._getDomain=domainGetter})}else{var usingDomains=false;Object.defineProperty(EventsModule,"usingDomains",{configurable:false,enumerable:true,get:function(){return usingDomains},set:function(value){if(usingDomains||!value)return;usingDomains=true;Async.prototype._getDomain=domainGetter;util.toFastProperties(process);process.emit("domainsActivated")}})}}}}}function AsyncInvokeLater(fn,receiver,arg){var domain=this._getDomain();if(domain!==undefined)fn=domain.bind(fn);this._lateQueue.push(fn,receiver,arg);this._queueTick()}function AsyncInvoke(fn,receiver,arg){var domain=this._getDomain();if(domain!==undefined)fn=domain.bind(fn);this._normalQueue.push(fn,receiver,arg);this._queueTick()}function AsyncSettlePromises(promise){var domain=this._getDomain();if(domain!==undefined){var fn=domain.bind(promise._settlePromises);this._normalQueue.push(fn,promise,undefined)}else{this._normalQueue._pushOne(promise)}this._queueTick()}if(!util.hasDevTools){Async.prototype.invokeLater=AsyncInvokeLater;Async.prototype.invoke=AsyncInvoke;Async.prototype.settlePromises=AsyncSettlePromises}else{if(schedule.isStatic){schedule=function(fn){setTimeout(fn,0)}}Async.prototype.invokeLater=function(fn,receiver,arg){if(this._trampolineEnabled){AsyncInvokeLater.call(this,fn,receiver,arg)}else{this._schedule(function(){setTimeout(function(){fn.call(receiver,arg)},100)})}};Async.prototype.invoke=function(fn,receiver,arg){if(this._trampolineEnabled){AsyncInvoke.call(this,fn,receiver,arg)}else{this._schedule(function(){fn.call(receiver,arg)})}};Async.prototype.settlePromises=function(promise){if(this._trampolineEnabled){AsyncSettlePromises.call(this,promise)}else{this._schedule(function(){promise._settlePromises()})}}}Async.prototype.invokeFirst=function(fn,receiver,arg){var domain=this._getDomain();if(domain!==undefined)fn=domain.bind(fn);this._normalQueue.unshift(fn,receiver,arg);this._queueTick()};Async.prototype._drainQueue=function(queue){while(queue.length()>0){var fn=queue.shift();if(typeof fn!=="function"){fn._settlePromises();continue}var receiver=queue.shift();var arg=queue.shift();fn.call(receiver,arg)}};Async.prototype._drainQueues=function(){this._drainQueue(this._normalQueue);this._reset();this._drainQueue(this._lateQueue)};Async.prototype._queueTick=function(){if(!this._isTickUsed){this._isTickUsed=true;this._schedule(this.drainQueues)}};Async.prototype._reset=function(){this._isTickUsed=false};module.exports=new Async;module.exports.firstLineError=firstLineError},{"./queue.js":28,"./schedule.js":31,"./util.js":38,events:39}],3:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise){var rejectThis=function(_,e){this._reject(e)};var targetRejected=function(e,context){context.promiseRejectionQueued=true;context.bindingPromise._then(rejectThis,rejectThis,null,this,e)};var bindingResolved=function(thisArg,context){this._setBoundTo(thisArg);if(this._isPending()){this._resolveCallback(context.target)}};var bindingRejected=function(e,context){if(!context.promiseRejectionQueued)this._reject(e)};Promise.prototype.bind=function(thisArg){var maybePromise=tryConvertToPromise(thisArg);var ret=new Promise(INTERNAL);ret._propagateFrom(this,1);var target=this._target();if(maybePromise instanceof Promise){var context={promiseRejectionQueued:false,promise:ret,target:target,bindingPromise:maybePromise};target._then(INTERNAL,targetRejected,ret._progress,ret,context);maybePromise._then(bindingResolved,bindingRejected,ret._progress,ret,context)}else{ret._setBoundTo(thisArg);ret._resolveCallback(target)}return ret};Promise.prototype._setBoundTo=function(obj){if(obj!==undefined){this._bitField=this._bitField|131072;this._boundTo=obj}else{this._bitField=this._bitField&~131072}};Promise.prototype._isBound=function(){return(this._bitField&131072)===131072};Promise.bind=function(thisArg,value){var maybePromise=tryConvertToPromise(thisArg);var ret=new Promise(INTERNAL);if(maybePromise instanceof Promise){maybePromise._then(function(thisArg){ret._setBoundTo(thisArg);ret._resolveCallback(value)},ret._reject,ret._progress,ret,null)}else{ret._setBoundTo(thisArg);ret._resolveCallback(value)}return ret}}},{}],4:[function(_dereq_,module,exports){"use strict";var old;if(typeof Promise!=="undefined")old=Promise;function noConflict(){try{if(Promise===bluebird)Promise=old}catch(e){}return bluebird}var bluebird=_dereq_("./promise.js")();bluebird.noConflict=noConflict;module.exports=bluebird},{"./promise.js":23}],5:[function(_dereq_,module,exports){"use strict";var cr=Object.create;if(cr){var callerCache=cr(null);var getterCache=cr(null);callerCache[" size"]=getterCache[" size"]=0}module.exports=function(Promise){var util=_dereq_("./util.js");var canEvaluate=util.canEvaluate;var isIdentifier=util.isIdentifier;var getMethodCaller;var getGetter;if(!true){var makeMethodCaller=function(methodName){return new Function("ensureMethod","                                    \n        return function(obj) {                                               \n            'use strict'                                                     \n            var len = this.length;                                           \n            ensureMethod(obj, 'methodName');                                 \n            switch(len) {                                                    \n                case 1: return obj.methodName(this[0]);                      \n                case 2: return obj.methodName(this[0], this[1]);             \n                case 3: return obj.methodName(this[0], this[1], this[2]);    \n                case 0: return obj.methodName();                             \n                default:                                                     \n                    return obj.methodName.apply(obj, this);                  \n            }                                                                \n        };                                                                   \n        ".replace(/methodName/g,methodName))(ensureMethod)};var makeGetter=function(propertyName){return new Function("obj","                                             \n        'use strict';                                                        \n        return obj.propertyName;                                             \n        ".replace("propertyName",propertyName))};var getCompiled=function(name,compiler,cache){var ret=cache[name];if(typeof ret!=="function"){if(!isIdentifier(name)){return null}ret=compiler(name);cache[name]=ret;cache[" size"]++;if(cache[" size"]>512){var keys=Object.keys(cache);for(var i=0;i<256;++i)delete cache[keys[i]];cache[" size"]=keys.length-256}}return ret};getMethodCaller=function(name){return getCompiled(name,makeMethodCaller,callerCache)};getGetter=function(name){return getCompiled(name,makeGetter,getterCache)}}function ensureMethod(obj,methodName){var fn;if(obj!=null)fn=obj[methodName];if(typeof fn!=="function"){var message="Object "+util.classString(obj)+" has no method '"+util.toString(methodName)+"'";throw new Promise.TypeError(message)}return fn}function caller(obj){var methodName=this.pop();var fn=ensureMethod(obj,methodName);return fn.apply(obj,this)}Promise.prototype.call=function(methodName){var $_len=arguments.length;var args=new Array($_len-1);for(var $_i=1;$_i<$_len;++$_i){args[$_i-1]=arguments[$_i]}if(!true){if(canEvaluate){var maybeCaller=getMethodCaller(methodName);if(maybeCaller!==null){return this._then(maybeCaller,undefined,undefined,args,undefined)}}}args.push(methodName);return this._then(caller,undefined,undefined,args,undefined)};function namedGetter(obj){return obj[this]}function indexedGetter(obj){var index=+this;if(index<0)index=Math.max(0,index+obj.length);return obj[index]}Promise.prototype.get=function(propertyName){var isIndex=typeof propertyName==="number";var getter;if(!isIndex){if(canEvaluate){var maybeGetter=getGetter(propertyName);getter=maybeGetter!==null?maybeGetter:namedGetter}else{getter=namedGetter}}else{getter=indexedGetter}return this._then(getter,undefined,undefined,propertyName,undefined)}}},{"./util.js":38}],6:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){var errors=_dereq_("./errors.js");var async=_dereq_("./async.js");var CancellationError=errors.CancellationError;Promise.prototype._cancel=function(reason){if(!this.isCancellable())return this;var parent;var promiseToReject=this;while((parent=promiseToReject._cancellationParent)!==undefined&&parent.isCancellable()){promiseToReject=parent}this._unsetCancellable();promiseToReject._target()._rejectCallback(reason,false,true)};Promise.prototype.cancel=function(reason){if(!this.isCancellable())return this;if(reason===undefined)reason=new CancellationError;async.invokeLater(this._cancel,this,reason);return this};Promise.prototype.cancellable=function(){if(this._cancellable())return this;async.enableTrampoline();this._setCancellable();this._cancellationParent=undefined;return this};Promise.prototype.uncancellable=function(){var ret=this.then();ret._unsetCancellable();return ret};Promise.prototype.fork=function(didFulfill,didReject,didProgress){var ret=this._then(didFulfill,didReject,didProgress,undefined,undefined);ret._setCancellable();ret._cancellationParent=undefined;return ret}}},{"./async.js":2,"./errors.js":13}],7:[function(_dereq_,module,exports){"use strict";module.exports=function(){var async=_dereq_("./async.js");var util=_dereq_("./util.js");var bluebirdFramePattern=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/;var stackFramePattern=null;var formatStack=null;var indentStackFrames=false;var warn;function CapturedTrace(parent){this._parent=parent;var length=this._length=1+(parent===undefined?0:parent._length);captureStackTrace(this,CapturedTrace);if(length>32)this.uncycle()}util.inherits(CapturedTrace,Error);CapturedTrace.prototype.uncycle=function(){var length=this._length;if(length<2)return;var nodes=[];var stackToIndex={};for(var i=0,node=this;node!==undefined;++i){nodes.push(node);node=node._parent}length=this._length=i;for(var i=length-1;i>=0;--i){var stack=nodes[i].stack;if(stackToIndex[stack]===undefined){stackToIndex[stack]=i}}for(var i=0;i<length;++i){var currentStack=nodes[i].stack;var index=stackToIndex[currentStack];if(index!==undefined&&index!==i){if(index>0){nodes[index-1]._parent=undefined;nodes[index-1]._length=1}nodes[i]._parent=undefined;nodes[i]._length=1;var cycleEdgeNode=i>0?nodes[i-1]:this;if(index<length-1){cycleEdgeNode._parent=nodes[index+1];cycleEdgeNode._parent.uncycle();cycleEdgeNode._length=cycleEdgeNode._parent._length+1}else{cycleEdgeNode._parent=undefined;cycleEdgeNode._length=1}var currentChildLength=cycleEdgeNode._length+1;for(var j=i-2;j>=0;--j){nodes[j]._length=currentChildLength;currentChildLength++}return}}};CapturedTrace.prototype.parent=function(){return this._parent};CapturedTrace.prototype.hasParent=function(){return this._parent!==undefined};CapturedTrace.prototype.attachExtraTrace=function(error){if(error.__stackCleaned__)return;this.uncycle();var parsed=CapturedTrace.parseStackAndMessage(error);var message=parsed.message;var stacks=[parsed.stack];var trace=this;while(trace!==undefined){stacks.push(cleanStack(trace.stack.split("\n")));trace=trace._parent}removeCommonRoots(stacks);removeDuplicateOrEmptyJumps(stacks);util.notEnumerableProp(error,"stack",reconstructStack(message,stacks));
util.notEnumerableProp(error,"__stackCleaned__",true)};function reconstructStack(message,stacks){for(var i=0;i<stacks.length-1;++i){stacks[i].push("From previous event:");stacks[i]=stacks[i].join("\n")}if(i<stacks.length){stacks[i]=stacks[i].join("\n")}return message+"\n"+stacks.join("\n")}function removeDuplicateOrEmptyJumps(stacks){for(var i=0;i<stacks.length;++i){if(stacks[i].length===0||i+1<stacks.length&&stacks[i][0]===stacks[i+1][0]){stacks.splice(i,1);i--}}}function removeCommonRoots(stacks){var current=stacks[0];for(var i=1;i<stacks.length;++i){var prev=stacks[i];var currentLastIndex=current.length-1;var currentLastLine=current[currentLastIndex];var commonRootMeetPoint=-1;for(var j=prev.length-1;j>=0;--j){if(prev[j]===currentLastLine){commonRootMeetPoint=j;break}}for(var j=commonRootMeetPoint;j>=0;--j){var line=prev[j];if(current[currentLastIndex]===line){current.pop();currentLastIndex--}else{break}}current=prev}}function cleanStack(stack){var ret=[];for(var i=0;i<stack.length;++i){var line=stack[i];var isTraceLine=stackFramePattern.test(line)||"    (No stack trace)"===line;var isInternalFrame=isTraceLine&&shouldIgnore(line);if(isTraceLine&&!isInternalFrame){if(indentStackFrames&&line.charAt(0)!==" "){line="    "+line}ret.push(line)}}return ret}function stackFramesAsArray(error){var stack=error.stack.replace(/\s+$/g,"").split("\n");for(var i=0;i<stack.length;++i){var line=stack[i];if("    (No stack trace)"===line||stackFramePattern.test(line)){break}}if(i>0){stack=stack.slice(i)}return stack}CapturedTrace.parseStackAndMessage=function(error){var stack=error.stack;var message=error.toString();stack=typeof stack==="string"&&stack.length>0?stackFramesAsArray(error):["    (No stack trace)"];return{message:message,stack:cleanStack(stack)}};CapturedTrace.formatAndLogError=function(error,title){if(typeof console!=="undefined"){var message;if(typeof error==="object"||typeof error==="function"){var stack=error.stack;message=title+formatStack(stack,error)}else{message=title+String(error)}if(typeof warn==="function"){warn(message)}else if(typeof console.log==="function"||typeof console.log==="object"){console.log(message)}}};CapturedTrace.unhandledRejection=function(reason){CapturedTrace.formatAndLogError(reason,"^--- With additional stack trace: ")};CapturedTrace.isSupported=function(){return typeof captureStackTrace==="function"};CapturedTrace.fireRejectionEvent=function(name,localHandler,reason,promise){var localEventFired=false;try{if(typeof localHandler==="function"){localEventFired=true;if(name==="rejectionHandled"){localHandler(promise)}else{localHandler(reason,promise)}}}catch(e){async.throwLater(e)}var globalEventFired=false;try{globalEventFired=fireGlobalEvent(name,reason,promise)}catch(e){globalEventFired=true;async.throwLater(e)}var domEventFired=false;if(fireDomEvent){try{domEventFired=fireDomEvent(name.toLowerCase(),{reason:reason,promise:promise})}catch(e){domEventFired=true;async.throwLater(e)}}if(!globalEventFired&&!localEventFired&&!domEventFired&&name==="unhandledRejection"){CapturedTrace.formatAndLogError(reason,"Unhandled rejection ")}};function formatNonError(obj){var str;if(typeof obj==="function"){str="[function "+(obj.name||"anonymous")+"]"}else{str=obj.toString();var ruselessToString=/\[object [a-zA-Z0-9$_]+\]/;if(ruselessToString.test(str)){try{var newStr=JSON.stringify(obj);str=newStr}catch(e){}}if(str.length===0){str="(empty array)"}}return"(<"+snip(str)+">, no stack trace)"}function snip(str){var maxChars=41;if(str.length<maxChars){return str}return str.substr(0,maxChars-3)+"..."}var shouldIgnore=function(){return false};var parseLineInfoRegex=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function parseLineInfo(line){var matches=line.match(parseLineInfoRegex);if(matches){return{fileName:matches[1],line:parseInt(matches[2],10)}}}CapturedTrace.setBounds=function(firstLineError,lastLineError){if(!CapturedTrace.isSupported())return;var firstStackLines=firstLineError.stack.split("\n");var lastStackLines=lastLineError.stack.split("\n");var firstIndex=-1;var lastIndex=-1;var firstFileName;var lastFileName;for(var i=0;i<firstStackLines.length;++i){var result=parseLineInfo(firstStackLines[i]);if(result){firstFileName=result.fileName;firstIndex=result.line;break}}for(var i=0;i<lastStackLines.length;++i){var result=parseLineInfo(lastStackLines[i]);if(result){lastFileName=result.fileName;lastIndex=result.line;break}}if(firstIndex<0||lastIndex<0||!firstFileName||!lastFileName||firstFileName!==lastFileName||firstIndex>=lastIndex){return}shouldIgnore=function(line){if(bluebirdFramePattern.test(line))return true;var info=parseLineInfo(line);if(info){if(info.fileName===firstFileName&&(firstIndex<=info.line&&info.line<=lastIndex)){return true}}return false}};var captureStackTrace=function stackDetection(){var v8stackFramePattern=/^\s*at\s*/;var v8stackFormatter=function(stack,error){if(typeof stack==="string")return stack;if(error.name!==undefined&&error.message!==undefined){return error.toString()}return formatNonError(error)};if(typeof Error.stackTraceLimit==="number"&&typeof Error.captureStackTrace==="function"){Error.stackTraceLimit=Error.stackTraceLimit+6;stackFramePattern=v8stackFramePattern;formatStack=v8stackFormatter;var captureStackTrace=Error.captureStackTrace;shouldIgnore=function(line){return bluebirdFramePattern.test(line)};return function(receiver,ignoreUntil){Error.stackTraceLimit=Error.stackTraceLimit+6;captureStackTrace(receiver,ignoreUntil);Error.stackTraceLimit=Error.stackTraceLimit-6}}var err=new Error;if(typeof err.stack==="string"&&err.stack.split("\n")[0].indexOf("stackDetection@")>=0){stackFramePattern=/@/;formatStack=v8stackFormatter;indentStackFrames=true;return function captureStackTrace(o){o.stack=(new Error).stack}}var hasStackAfterThrow;try{throw new Error}catch(e){hasStackAfterThrow="stack"in e}if(!("stack"in err)&&hasStackAfterThrow){stackFramePattern=v8stackFramePattern;formatStack=v8stackFormatter;return function captureStackTrace(o){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(e){o.stack=e.stack}Error.stackTraceLimit=Error.stackTraceLimit-6}}formatStack=function(stack,error){if(typeof stack==="string")return stack;if((typeof error==="object"||typeof error==="function")&&error.name!==undefined&&error.message!==undefined){return error.toString()}return formatNonError(error)};return null}([]);var fireDomEvent;var fireGlobalEvent=function(){if(util.isNode){return function(name,reason,promise){if(name==="rejectionHandled"){return process.emit(name,promise)}else{return process.emit(name,reason,promise)}}}else{var customEventWorks=false;var anyEventWorks=true;try{var ev=new self.CustomEvent("test");customEventWorks=ev instanceof CustomEvent}catch(e){}if(!customEventWorks){try{var event=document.createEvent("CustomEvent");event.initCustomEvent("testingtheevent",false,true,{});self.dispatchEvent(event)}catch(e){anyEventWorks=false}}if(anyEventWorks){fireDomEvent=function(type,detail){var event;if(customEventWorks){event=new self.CustomEvent(type,{detail:detail,bubbles:false,cancelable:true})}else if(self.dispatchEvent){event=document.createEvent("CustomEvent");event.initCustomEvent(type,false,true,detail)}return event?!self.dispatchEvent(event):false}}var toWindowMethodNameMap={};toWindowMethodNameMap["unhandledRejection"]=("on"+"unhandledRejection").toLowerCase();toWindowMethodNameMap["rejectionHandled"]=("on"+"rejectionHandled").toLowerCase();return function(name,reason,promise){var methodName=toWindowMethodNameMap[name];var method=self[methodName];if(!method)return false;if(name==="rejectionHandled"){method.call(self,promise)}else{method.call(self,reason,promise)}return true}}}();if(typeof console!=="undefined"&&typeof console.warn!=="undefined"){warn=function(message){console.warn(message)};if(util.isNode&&process.stderr.isTTY){warn=function(message){process.stderr.write("[31m"+message+"[39m\n")}}else if(!util.isNode&&typeof(new Error).stack==="string"){warn=function(message){console.warn("%c"+message,"color: red")}}}return CapturedTrace}},{"./async.js":2,"./util.js":38}],8:[function(_dereq_,module,exports){"use strict";module.exports=function(NEXT_FILTER){var util=_dereq_("./util.js");var errors=_dereq_("./errors.js");var tryCatch=util.tryCatch;var errorObj=util.errorObj;var keys=_dereq_("./es5.js").keys;var TypeError=errors.TypeError;function CatchFilter(instances,callback,promise){this._instances=instances;this._callback=callback;this._promise=promise}function safePredicate(predicate,e){var safeObject={};var retfilter=tryCatch(predicate).call(safeObject,e);if(retfilter===errorObj)return retfilter;var safeKeys=keys(safeObject);if(safeKeys.length){errorObj.e=new TypeError("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n");return errorObj}return retfilter}CatchFilter.prototype.doFilter=function(e){var cb=this._callback;var promise=this._promise;var boundTo=promise._boundTo;for(var i=0,len=this._instances.length;i<len;++i){var item=this._instances[i];var itemIsErrorType=item===Error||item!=null&&item.prototype instanceof Error;if(itemIsErrorType&&e instanceof item){var ret=tryCatch(cb).call(boundTo,e);if(ret===errorObj){NEXT_FILTER.e=ret.e;return NEXT_FILTER}return ret}else if(typeof item==="function"&&!itemIsErrorType){var shouldHandle=safePredicate(item,e);if(shouldHandle===errorObj){e=errorObj.e;break}else if(shouldHandle){var ret=tryCatch(cb).call(boundTo,e);if(ret===errorObj){NEXT_FILTER.e=ret.e;return NEXT_FILTER}return ret}}}NEXT_FILTER.e=e;return NEXT_FILTER};return CatchFilter}},{"./errors.js":13,"./es5.js":14,"./util.js":38}],9:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,CapturedTrace,isDebugging){var contextStack=[];function Context(){this._trace=new CapturedTrace(peekContext())}Context.prototype._pushContext=function(){if(!isDebugging())return;if(this._trace!==undefined){contextStack.push(this._trace)}};Context.prototype._popContext=function(){if(!isDebugging())return;if(this._trace!==undefined){contextStack.pop()}};function createContext(){if(isDebugging())return new Context}function peekContext(){var lastIndex=contextStack.length-1;if(lastIndex>=0){return contextStack[lastIndex]}return undefined}Promise.prototype._peekContext=peekContext;Promise.prototype._pushContext=Context.prototype._pushContext;Promise.prototype._popContext=Context.prototype._popContext;return createContext}},{}],10:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,CapturedTrace){var async=_dereq_("./async.js");var Warning=_dereq_("./errors.js").Warning;var util=_dereq_("./util.js");var canAttachTrace=util.canAttachTrace;var unhandledRejectionHandled;var possiblyUnhandledRejection;var debugging=false||util.isNode&&(!!process.env["BLUEBIRD_DEBUG"]||process.env["NODE_ENV"]==="development");if(debugging){async.disableTrampolineIfNecessary()}Promise.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled();this._bitField=this._bitField|16777216};Promise.prototype._ensurePossibleRejectionHandled=function(){if((this._bitField&16777216)!==0)return;this._setRejectionIsUnhandled();async.invokeLater(this._notifyUnhandledRejection,this,undefined)};Promise.prototype._notifyUnhandledRejectionIsHandled=function(){CapturedTrace.fireRejectionEvent("rejectionHandled",unhandledRejectionHandled,undefined,this)};Promise.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var reason=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified();CapturedTrace.fireRejectionEvent("unhandledRejection",possiblyUnhandledRejection,reason,this)}};Promise.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=this._bitField|524288};Promise.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&~524288};Promise.prototype._isUnhandledRejectionNotified=function(){return(this._bitField&524288)>0};Promise.prototype._setRejectionIsUnhandled=function(){this._bitField=this._bitField|2097152};Promise.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&~2097152;if(this._isUnhandledRejectionNotified()){this._unsetUnhandledRejectionIsNotified();this._notifyUnhandledRejectionIsHandled()}};Promise.prototype._isRejectionUnhandled=function(){return(this._bitField&2097152)>0};Promise.prototype._setCarriedStackTrace=function(capturedTrace){this._bitField=this._bitField|1048576;this._fulfillmentHandler0=capturedTrace};Promise.prototype._isCarryingStackTrace=function(){return(this._bitField&1048576)>0};Promise.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:undefined};Promise.prototype._captureStackTrace=function(){if(debugging){this._trace=new CapturedTrace(this._peekContext())}return this};Promise.prototype._attachExtraTrace=function(error,ignoreSelf){if(debugging&&canAttachTrace(error)){var trace=this._trace;if(trace!==undefined){if(ignoreSelf)trace=trace._parent}if(trace!==undefined){trace.attachExtraTrace(error)}else if(!error.__stackCleaned__){var parsed=CapturedTrace.parseStackAndMessage(error);util.notEnumerableProp(error,"stack",parsed.message+"\n"+parsed.stack.join("\n"));util.notEnumerableProp(error,"__stackCleaned__",true)}}};Promise.prototype._warn=function(message){var warning=new Warning(message);var ctx=this._peekContext();if(ctx){ctx.attachExtraTrace(warning)}else{var parsed=CapturedTrace.parseStackAndMessage(warning);warning.stack=parsed.message+"\n"+parsed.stack.join("\n")}CapturedTrace.formatAndLogError(warning,"")};Promise.onPossiblyUnhandledRejection=function(fn){possiblyUnhandledRejection=typeof fn==="function"?fn:undefined};Promise.onUnhandledRejectionHandled=function(fn){unhandledRejectionHandled=typeof fn==="function"?fn:undefined};Promise.longStackTraces=function(){if(async.haveItemsQueued()&&debugging===false){throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n")}debugging=CapturedTrace.isSupported();if(debugging){async.disableTrampolineIfNecessary()}};Promise.hasLongStackTraces=function(){return debugging&&CapturedTrace.isSupported()};if(!CapturedTrace.isSupported()){Promise.longStackTraces=function(){};debugging=false}return function(){return debugging}}},{"./async.js":2,"./errors.js":13,"./util.js":38}],11:[function(_dereq_,module,exports){"use strict";var util=_dereq_("./util.js");var isPrimitive=util.isPrimitive;var wrapsPrimitiveReceiver=util.wrapsPrimitiveReceiver;module.exports=function(Promise){var returner=function(){return this};var thrower=function(){throw this};var returnUndefined=function(){};var throwUndefined=function(){throw undefined};var wrapper=function(value,action){if(action===1){return function(){throw value}}else if(action===2){return function(){return value}}};Promise.prototype["return"]=Promise.prototype.thenReturn=function(value){if(value===undefined)return this.then(returnUndefined);if(wrapsPrimitiveReceiver&&isPrimitive(value)){return this._then(wrapper(value,2),undefined,undefined,undefined,undefined)}return this._then(returner,undefined,undefined,value,undefined)};Promise.prototype["throw"]=Promise.prototype.thenThrow=function(reason){if(reason===undefined)return this.then(throwUndefined);if(wrapsPrimitiveReceiver&&isPrimitive(reason)){return this._then(wrapper(reason,1),undefined,undefined,undefined,undefined)}return this._then(thrower,undefined,undefined,reason,undefined)}}},{"./util.js":38}],12:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){var PromiseReduce=Promise.reduce;Promise.prototype.each=function(fn){return PromiseReduce(this,fn,null,INTERNAL)};Promise.each=function(promises,fn){return PromiseReduce(promises,fn,null,INTERNAL)}}},{}],13:[function(_dereq_,module,exports){"use strict";var es5=_dereq_("./es5.js");var Objectfreeze=es5.freeze;var util=_dereq_("./util.js");var inherits=util.inherits;var notEnumerableProp=util.notEnumerableProp;function subError(nameProperty,defaultMessage){function SubError(message){if(!(this instanceof SubError))return new SubError(message);notEnumerableProp(this,"message",typeof message==="string"?message:defaultMessage);notEnumerableProp(this,"name",nameProperty);if(Error.captureStackTrace){Error.captureStackTrace(this,this.constructor)}else{Error.call(this)}}inherits(SubError,Error);return SubError}var _TypeError,_RangeError;var Warning=subError("Warning","warning");var CancellationError=subError("CancellationError","cancellation error");var TimeoutError=subError("TimeoutError","timeout error");var AggregateError=subError("AggregateError","aggregate error");try{_TypeError=TypeError;_RangeError=RangeError}catch(e){_TypeError=subError("TypeError","type error");_RangeError=subError("RangeError","range error")}var methods=("join pop push shift unshift slice filter forEach some "+"every map indexOf lastIndexOf reduce reduceRight sort reverse").split(" ");for(var i=0;i<methods.length;++i){if(typeof Array.prototype[methods[i]]==="function"){AggregateError.prototype[methods[i]]=Array.prototype[methods[i]]}}es5.defineProperty(AggregateError.prototype,"length",{value:0,configurable:false,writable:true,enumerable:true});AggregateError.prototype["isOperational"]=true;var level=0;AggregateError.prototype.toString=function(){var indent=Array(level*4+1).join(" ");var ret="\n"+indent+"AggregateError of:"+"\n";level++;indent=Array(level*4+1).join(" ");for(var i=0;i<this.length;++i){var str=this[i]===this?"[Circular AggregateError]":this[i]+"";var lines=str.split("\n");for(var j=0;j<lines.length;++j){lines[j]=indent+lines[j]}str=lines.join("\n");ret+=str+"\n"}level--;return ret};function OperationalError(message){if(!(this instanceof OperationalError))return new OperationalError(message);notEnumerableProp(this,"name","OperationalError");notEnumerableProp(this,"message",message);this.cause=message;this["isOperational"]=true;if(message instanceof Error){notEnumerableProp(this,"message",message.message);notEnumerableProp(this,"stack",message.stack)}else if(Error.captureStackTrace){Error.captureStackTrace(this,this.constructor)}}inherits(OperationalError,Error);var errorTypes=Error["__BluebirdErrorTypes__"];if(!errorTypes){errorTypes=Objectfreeze({CancellationError:CancellationError,TimeoutError:TimeoutError,OperationalError:OperationalError,RejectionError:OperationalError,AggregateError:AggregateError});notEnumerableProp(Error,"__BluebirdErrorTypes__",errorTypes)}module.exports={Error:Error,TypeError:_TypeError,RangeError:_RangeError,CancellationError:errorTypes.CancellationError,OperationalError:errorTypes.OperationalError,TimeoutError:errorTypes.TimeoutError,AggregateError:errorTypes.AggregateError,Warning:Warning}},{"./es5.js":14,"./util.js":38}],14:[function(_dereq_,module,exports){var isES5=function(){"use strict";return this===undefined}();if(isES5){module.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:isES5,propertyIsWritable:function(obj,prop){var descriptor=Object.getOwnPropertyDescriptor(obj,prop);return!!(!descriptor||descriptor.writable||descriptor.set)}}}else{var has={}.hasOwnProperty;var str={}.toString;var proto={}.constructor.prototype;var ObjectKeys=function(o){var ret=[];for(var key in o){if(has.call(o,key)){ret.push(key)}}return ret};var ObjectGetDescriptor=function(o,key){return{value:o[key]}};var ObjectDefineProperty=function(o,key,desc){o[key]=desc.value;return o};var ObjectFreeze=function(obj){return obj};var ObjectGetPrototypeOf=function(obj){try{return Object(obj).constructor.prototype}catch(e){return proto}};var ArrayIsArray=function(obj){try{return str.call(obj)==="[object Array]"}catch(e){return false}};module.exports={isArray:ArrayIsArray,keys:ObjectKeys,names:ObjectKeys,defineProperty:ObjectDefineProperty,getDescriptor:ObjectGetDescriptor,freeze:ObjectFreeze,getPrototypeOf:ObjectGetPrototypeOf,isES5:isES5,propertyIsWritable:function(){return true}}}},{}],15:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){var PromiseMap=Promise.map;Promise.prototype.filter=function(fn,options){return PromiseMap(this,fn,options,INTERNAL)};Promise.filter=function(promises,fn,options){return PromiseMap(promises,fn,options,INTERNAL)}}},{}],16:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,NEXT_FILTER,tryConvertToPromise){var util=_dereq_("./util.js");var wrapsPrimitiveReceiver=util.wrapsPrimitiveReceiver;var isPrimitive=util.isPrimitive;var thrower=util.thrower;function returnThis(){return this}function throwThis(){throw this}function return$(r){return function(){return r}}function throw$(r){return function(){throw r}}function promisedFinally(ret,reasonOrValue,isFulfilled){var then;if(wrapsPrimitiveReceiver&&isPrimitive(reasonOrValue)){then=isFulfilled?return$(reasonOrValue):throw$(reasonOrValue)}else{then=isFulfilled?returnThis:throwThis}return ret._then(then,thrower,undefined,reasonOrValue,undefined)}function finallyHandler(reasonOrValue){var promise=this.promise;var handler=this.handler;var ret=promise._isBound()?handler.call(promise._boundTo):handler();if(ret!==undefined){var maybePromise=tryConvertToPromise(ret,promise);if(maybePromise instanceof Promise){maybePromise=maybePromise._target();return promisedFinally(maybePromise,reasonOrValue,promise.isFulfilled())}}if(promise.isRejected()){NEXT_FILTER.e=reasonOrValue;return NEXT_FILTER}else{return reasonOrValue}}function tapHandler(value){var promise=this.promise;var handler=this.handler;var ret=promise._isBound()?handler.call(promise._boundTo,value):handler(value);if(ret!==undefined){var maybePromise=tryConvertToPromise(ret,promise);if(maybePromise instanceof Promise){maybePromise=maybePromise._target();return promisedFinally(maybePromise,value,true)}}return value}Promise.prototype._passThroughHandler=function(handler,isFinally){if(typeof handler!=="function")return this.then();var promiseAndHandler={promise:this,handler:handler};return this._then(isFinally?finallyHandler:tapHandler,isFinally?finallyHandler:undefined,undefined,promiseAndHandler,undefined)};Promise.prototype.lastly=Promise.prototype["finally"]=function(handler){return this._passThroughHandler(handler,true)};Promise.prototype.tap=function(handler){return this._passThroughHandler(handler,false)}}},{"./util.js":38}],17:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,apiRejection,INTERNAL,tryConvertToPromise){var errors=_dereq_("./errors.js");var TypeError=errors.TypeError;var util=_dereq_("./util.js");var errorObj=util.errorObj;var tryCatch=util.tryCatch;var yieldHandlers=[];function promiseFromYieldHandler(value,yieldHandlers,traceParent){for(var i=0;i<yieldHandlers.length;++i){traceParent._pushContext();var result=tryCatch(yieldHandlers[i])(value);traceParent._popContext();if(result===errorObj){traceParent._pushContext();var ret=Promise.reject(errorObj.e);traceParent._popContext();return ret}var maybePromise=tryConvertToPromise(result,traceParent);if(maybePromise instanceof Promise)return maybePromise}return null}function PromiseSpawn(generatorFunction,receiver,yieldHandler,stack){var promise=this._promise=new Promise(INTERNAL);promise._captureStackTrace();this._stack=stack;this._generatorFunction=generatorFunction;this._receiver=receiver;this._generator=undefined;this._yieldHandlers=typeof yieldHandler==="function"?[yieldHandler].concat(yieldHandlers):yieldHandlers}PromiseSpawn.prototype.promise=function(){return this._promise};PromiseSpawn.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver);this._receiver=this._generatorFunction=undefined;this._next(undefined)};PromiseSpawn.prototype._continue=function(result){if(result===errorObj){return this._promise._rejectCallback(result.e,false,true)}var value=result.value;if(result.done===true){this._promise._resolveCallback(value)}else{var maybePromise=tryConvertToPromise(value,this._promise);if(!(maybePromise instanceof Promise)){maybePromise=promiseFromYieldHandler(maybePromise,this._yieldHandlers,this._promise);if(maybePromise===null){this._throw(new TypeError("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n".replace("%s",value)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));return}}maybePromise._then(this._next,this._throw,undefined,this,null)}};PromiseSpawn.prototype._throw=function(reason){this._promise._attachExtraTrace(reason);this._promise._pushContext();var result=tryCatch(this._generator["throw"]).call(this._generator,reason);this._promise._popContext();this._continue(result)};PromiseSpawn.prototype._next=function(value){this._promise._pushContext();var result=tryCatch(this._generator.next).call(this._generator,value);this._promise._popContext();this._continue(result)};Promise.coroutine=function(generatorFunction,options){if(typeof generatorFunction!=="function"){throw new TypeError("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n")}var yieldHandler=Object(options).yieldHandler;var PromiseSpawn$=PromiseSpawn;var stack=(new Error).stack;return function(){var generator=generatorFunction.apply(this,arguments);var spawn=new PromiseSpawn$(undefined,undefined,yieldHandler,stack);spawn._generator=generator;spawn._next(undefined);return spawn.promise()}};Promise.coroutine.addYieldHandler=function(fn){if(typeof fn!=="function")throw new TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");yieldHandlers.push(fn)};Promise.spawn=function(generatorFunction){if(typeof generatorFunction!=="function"){return apiRejection("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n")}var spawn=new PromiseSpawn(generatorFunction,this);var ret=spawn.promise();spawn._run(Promise.spawn);return ret}}},{"./errors.js":13,"./util.js":38}],18:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,tryConvertToPromise,INTERNAL){var util=_dereq_("./util.js");var canEvaluate=util.canEvaluate;var tryCatch=util.tryCatch;var errorObj=util.errorObj;var reject;if(!true){if(canEvaluate){var thenCallback=function(i){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,i))};var caller=function(count){var values=[];for(var i=1;i<=count;++i)values.push("holder.p"+i);return new Function("holder","                                      \n            'use strict';                                                    \n            var callback = holder.fn;                                        \n            return callback(values);                                         \n            ".replace(/values/g,values.join(", ")))};var thenCallbacks=[];var callers=[undefined];for(var i=1;i<=5;++i){thenCallbacks.push(thenCallback(i));callers.push(caller(i))}var Holder=function(total,fn){this.p1=this.p2=this.p3=this.p4=this.p5=null;this.fn=fn;this.total=total;this.now=0};Holder.prototype.callers=callers;Holder.prototype.checkFulfillment=function(promise){var now=this.now;now++;var total=this.total;if(now>=total){var handler=this.callers[total];promise._pushContext();var ret=tryCatch(handler)(this);promise._popContext();if(ret===errorObj){promise._rejectCallback(ret.e,false,true)}else{promise._resolveCallback(ret)}}else{this.now=now}};var reject=function(reason){this._reject(reason)}}}Promise.join=function(){var last=arguments.length-1;var fn;if(last>0&&typeof arguments[last]==="function"){fn=arguments[last];if(!true){if(last<6&&canEvaluate){var ret=new Promise(INTERNAL);ret._captureStackTrace();var holder=new Holder(last,fn);var callbacks=thenCallbacks;for(var i=0;i<last;++i){var maybePromise=tryConvertToPromise(arguments[i],ret);if(maybePromise instanceof Promise){maybePromise=maybePromise._target();if(maybePromise._isPending()){maybePromise._then(callbacks[i],reject,undefined,ret,holder)}else if(maybePromise._isFulfilled()){callbacks[i].call(ret,maybePromise._value(),holder)}else{ret._reject(maybePromise._reason())}}else{callbacks[i].call(ret,maybePromise,holder)}}return ret}}}var $_len=arguments.length;var args=new Array($_len);for(var $_i=0;$_i<$_len;++$_i){args[$_i]=arguments[$_i]}if(fn)args.pop();var ret=new PromiseArray(args).promise();return fn!==undefined?ret.spread(fn):ret}}},{"./util.js":38}],19:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL){var async=_dereq_("./async.js");var util=_dereq_("./util.js");var tryCatch=util.tryCatch;var errorObj=util.errorObj;var PENDING={};var EMPTY_ARRAY=[];function MappingPromiseArray(promises,fn,limit,_filter){this.constructor$(promises);this._promise._captureStackTrace();this._callback=fn;this._preservedValues=_filter===INTERNAL?new Array(this.length()):null;this._limit=limit;this._inFlight=0;this._queue=limit>=1?[]:EMPTY_ARRAY;async.invoke(init,this,undefined)}util.inherits(MappingPromiseArray,PromiseArray);function init(){this._init$(undefined,-2)}MappingPromiseArray.prototype._init=function(){};MappingPromiseArray.prototype._promiseFulfilled=function(value,index){var values=this._values;var length=this.length();var preservedValues=this._preservedValues;var limit=this._limit;if(values[index]===PENDING){values[index]=value;if(limit>=1){this._inFlight--;this._drainQueue();if(this._isResolved())return}}else{if(limit>=1&&this._inFlight>=limit){values[index]=value;this._queue.push(index);return}if(preservedValues!==null)preservedValues[index]=value;var callback=this._callback;var receiver=this._promise._boundTo;this._promise._pushContext();var ret=tryCatch(callback).call(receiver,value,index,length);this._promise._popContext();if(ret===errorObj)return this._reject(ret.e);var maybePromise=tryConvertToPromise(ret,this._promise);if(maybePromise instanceof Promise){maybePromise=maybePromise._target();if(maybePromise._isPending()){if(limit>=1)this._inFlight++;values[index]=PENDING;return maybePromise._proxyPromiseArray(this,index)}else if(maybePromise._isFulfilled()){ret=maybePromise._value()}else{return this._reject(maybePromise._reason())}}values[index]=ret}var totalResolved=++this._totalResolved;if(totalResolved>=length){if(preservedValues!==null){this._filter(values,preservedValues)}else{this._resolve(values)}}};MappingPromiseArray.prototype._drainQueue=function(){var queue=this._queue;var limit=this._limit;var values=this._values;while(queue.length>0&&this._inFlight<limit){if(this._isResolved())return;var index=queue.pop();this._promiseFulfilled(values[index],index)}};MappingPromiseArray.prototype._filter=function(booleans,values){var len=values.length;var ret=new Array(len);var j=0;for(var i=0;i<len;++i){if(booleans[i])ret[j++]=values[i]}ret.length=j;this._resolve(ret)};MappingPromiseArray.prototype.preservedValues=function(){return this._preservedValues};function map(promises,fn,options,_filter){var limit=typeof options==="object"&&options!==null?options.concurrency:0;limit=typeof limit==="number"&&isFinite(limit)&&limit>=1?limit:0;return new MappingPromiseArray(promises,fn,limit,_filter)}Promise.prototype.map=function(fn,options){if(typeof fn!=="function")return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return map(this,fn,options,null).promise()};Promise.map=function(promises,fn,options,_filter){if(typeof fn!=="function")return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return map(promises,fn,options,_filter).promise()}}},{"./async.js":2,"./util.js":38}],20:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise,apiRejection){
var util=_dereq_("./util.js");var tryCatch=util.tryCatch;Promise.method=function(fn){if(typeof fn!=="function"){throw new Promise.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n")}return function(){var ret=new Promise(INTERNAL);ret._captureStackTrace();ret._pushContext();var value=tryCatch(fn).apply(this,arguments);ret._popContext();ret._resolveFromSyncValue(value);return ret}};Promise.attempt=Promise["try"]=function(fn,args,ctx){if(typeof fn!=="function"){return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n")}var ret=new Promise(INTERNAL);ret._captureStackTrace();ret._pushContext();var value=util.isArray(args)?tryCatch(fn).apply(ctx,args):tryCatch(fn).call(ctx,args);ret._popContext();ret._resolveFromSyncValue(value);return ret};Promise.prototype._resolveFromSyncValue=function(value){if(value===util.errorObj){this._rejectCallback(value.e,false,true)}else{this._resolveCallback(value,true)}}}},{"./util.js":38}],21:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){var util=_dereq_("./util.js");var async=_dereq_("./async.js");var tryCatch=util.tryCatch;var errorObj=util.errorObj;function spreadAdapter(val,nodeback){var promise=this;if(!util.isArray(val))return successAdapter.call(promise,val,nodeback);var ret=tryCatch(nodeback).apply(promise._boundTo,[null].concat(val));if(ret===errorObj){async.throwLater(ret.e)}}function successAdapter(val,nodeback){var promise=this;var receiver=promise._boundTo;var ret=val===undefined?tryCatch(nodeback).call(receiver,null):tryCatch(nodeback).call(receiver,null,val);if(ret===errorObj){async.throwLater(ret.e)}}function errorAdapter(reason,nodeback){var promise=this;if(!reason){var target=promise._target();var newReason=target._getCarriedStackTrace();newReason.cause=reason;reason=newReason}var ret=tryCatch(nodeback).call(promise._boundTo,reason);if(ret===errorObj){async.throwLater(ret.e)}}Promise.prototype.asCallback=Promise.prototype.nodeify=function(nodeback,options){if(typeof nodeback=="function"){var adapter=successAdapter;if(options!==undefined&&Object(options).spread){adapter=spreadAdapter}this._then(adapter,errorAdapter,undefined,this,nodeback)}return this}}},{"./async.js":2,"./util.js":38}],22:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray){var util=_dereq_("./util.js");var async=_dereq_("./async.js");var tryCatch=util.tryCatch;var errorObj=util.errorObj;Promise.prototype.progressed=function(handler){return this._then(undefined,undefined,handler,undefined,undefined)};Promise.prototype._progress=function(progressValue){if(this._isFollowingOrFulfilledOrRejected())return;this._target()._progressUnchecked(progressValue)};Promise.prototype._progressHandlerAt=function(index){return index===0?this._progressHandler0:this[(index<<2)+index-5+2]};Promise.prototype._doProgressWith=function(progression){var progressValue=progression.value;var handler=progression.handler;var promise=progression.promise;var receiver=progression.receiver;var ret=tryCatch(handler).call(receiver,progressValue);if(ret===errorObj){if(ret.e!=null&&ret.e.name!=="StopProgressPropagation"){var trace=util.canAttachTrace(ret.e)?ret.e:new Error(util.toString(ret.e));promise._attachExtraTrace(trace);promise._progress(ret.e)}}else if(ret instanceof Promise){ret._then(promise._progress,null,null,promise,undefined)}else{promise._progress(ret)}};Promise.prototype._progressUnchecked=function(progressValue){var len=this._length();var progress=this._progress;for(var i=0;i<len;i++){var handler=this._progressHandlerAt(i);var promise=this._promiseAt(i);if(!(promise instanceof Promise)){var receiver=this._receiverAt(i);if(typeof handler==="function"){handler.call(receiver,progressValue,promise)}else if(receiver instanceof PromiseArray&&!receiver._isResolved()){receiver._promiseProgressed(progressValue,promise)}continue}if(typeof handler==="function"){async.invoke(this._doProgressWith,this,{handler:handler,promise:promise,receiver:this._receiverAt(i),value:progressValue})}else{async.invoke(progress,promise,progressValue)}}}}},{"./async.js":2,"./util.js":38}],23:[function(_dereq_,module,exports){"use strict";module.exports=function(){var makeSelfResolutionError=function(){return new TypeError("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")};var reflect=function(){return new Promise.PromiseInspection(this._target())};var apiRejection=function(msg){return Promise.reject(new TypeError(msg))};var util=_dereq_("./util.js");var async=_dereq_("./async.js");var errors=_dereq_("./errors.js");var TypeError=Promise.TypeError=errors.TypeError;Promise.RangeError=errors.RangeError;Promise.CancellationError=errors.CancellationError;Promise.TimeoutError=errors.TimeoutError;Promise.OperationalError=errors.OperationalError;Promise.RejectionError=errors.OperationalError;Promise.AggregateError=errors.AggregateError;var INTERNAL=function(){};var APPLY={};var NEXT_FILTER={e:null};var tryConvertToPromise=_dereq_("./thenables.js")(Promise,INTERNAL);var PromiseArray=_dereq_("./promise_array.js")(Promise,INTERNAL,tryConvertToPromise,apiRejection);var CapturedTrace=_dereq_("./captured_trace.js")();var isDebugging=_dereq_("./debuggability.js")(Promise,CapturedTrace);var createContext=_dereq_("./context.js")(Promise,CapturedTrace,isDebugging);var CatchFilter=_dereq_("./catch_filter.js")(NEXT_FILTER);var PromiseResolver=_dereq_("./promise_resolver.js");var nodebackForPromise=PromiseResolver._nodebackForPromise;var errorObj=util.errorObj;var tryCatch=util.tryCatch;function Promise(resolver){if(typeof resolver!=="function"){throw new TypeError("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n")}if(this.constructor!==Promise){throw new TypeError("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n")}this._bitField=0;this._fulfillmentHandler0=undefined;this._rejectionHandler0=undefined;this._progressHandler0=undefined;this._promise0=undefined;this._receiver0=undefined;this._settledValue=undefined;if(resolver!==INTERNAL)this._resolveFromResolver(resolver)}Promise.prototype.toString=function(){return"[object Promise]"};Promise.prototype.caught=Promise.prototype["catch"]=function(fn){var len=arguments.length;if(len>1){var catchInstances=new Array(len-1),j=0,i;for(i=0;i<len-1;++i){var item=arguments[i];if(typeof item==="function"){catchInstances[j++]=item}else{return Promise.reject(new TypeError("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"))}}catchInstances.length=j;fn=arguments[i];var catchFilter=new CatchFilter(catchInstances,fn,this);return this._then(undefined,catchFilter.doFilter,undefined,catchFilter,undefined)}return this._then(undefined,fn,undefined,undefined,undefined)};Promise.prototype.reflect=function(){return this._then(reflect,reflect,undefined,this,undefined)};Promise.prototype.then=function(didFulfill,didReject,didProgress){if(isDebugging()&&arguments.length>0&&typeof didFulfill!=="function"&&typeof didReject!=="function"){var msg=".then() only accepts functions but was passed: "+util.classString(didFulfill);if(arguments.length>1){msg+=", "+util.classString(didReject)}this._warn(msg)}return this._then(didFulfill,didReject,didProgress,undefined,undefined)};Promise.prototype.done=function(didFulfill,didReject,didProgress){var promise=this._then(didFulfill,didReject,didProgress,undefined,undefined);promise._setIsFinal()};Promise.prototype.spread=function(didFulfill,didReject){return this.all()._then(didFulfill,didReject,undefined,APPLY,undefined)};Promise.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()};Promise.prototype.toJSON=function(){var ret={isFulfilled:false,isRejected:false,fulfillmentValue:undefined,rejectionReason:undefined};if(this.isFulfilled()){ret.fulfillmentValue=this.value();ret.isFulfilled=true}else if(this.isRejected()){ret.rejectionReason=this.reason();ret.isRejected=true}return ret};Promise.prototype.all=function(){return new PromiseArray(this).promise()};Promise.prototype.error=function(fn){return this.caught(util.originatesFromRejection,fn)};Promise.is=function(val){return val instanceof Promise};Promise.fromNode=function(fn){var ret=new Promise(INTERNAL);var result=tryCatch(fn)(nodebackForPromise(ret));if(result===errorObj){ret._rejectCallback(result.e,true,true)}return ret};Promise.all=function(promises){return new PromiseArray(promises).promise()};Promise.defer=Promise.pending=function(){var promise=new Promise(INTERNAL);return new PromiseResolver(promise)};Promise.cast=function(obj){var ret=tryConvertToPromise(obj);if(!(ret instanceof Promise)){var val=ret;ret=new Promise(INTERNAL);ret._fulfillUnchecked(val)}return ret};Promise.resolve=Promise.fulfilled=Promise.cast;Promise.reject=Promise.rejected=function(reason){var ret=new Promise(INTERNAL);ret._captureStackTrace();ret._rejectCallback(reason,true);return ret};Promise.setScheduler=function(fn){if(typeof fn!=="function")throw new TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var prev=async._schedule;async._schedule=fn;return prev};Promise.prototype._then=function(didFulfill,didReject,didProgress,receiver,internalData){var haveInternalData=internalData!==undefined;var ret=haveInternalData?internalData:new Promise(INTERNAL);if(!haveInternalData){ret._propagateFrom(this,4|1);ret._captureStackTrace()}var target=this._target();if(target!==this){if(receiver===undefined)receiver=this._boundTo;if(!haveInternalData)ret._setIsMigrated()}var callbackIndex=target._addCallbacks(didFulfill,didReject,didProgress,ret,receiver);if(target._isResolved()&&!target._isSettlePromisesQueued()){async.invoke(target._settlePromiseAtPostResolution,target,callbackIndex)}return ret};Promise.prototype._settlePromiseAtPostResolution=function(index){if(this._isRejectionUnhandled())this._unsetRejectionIsUnhandled();this._settlePromiseAt(index)};Promise.prototype._length=function(){return this._bitField&131071};Promise.prototype._isFollowingOrFulfilledOrRejected=function(){return(this._bitField&939524096)>0};Promise.prototype._isFollowing=function(){return(this._bitField&536870912)===536870912};Promise.prototype._setLength=function(len){this._bitField=this._bitField&-131072|len&131071};Promise.prototype._setFulfilled=function(){this._bitField=this._bitField|268435456};Promise.prototype._setRejected=function(){this._bitField=this._bitField|134217728};Promise.prototype._setFollowing=function(){this._bitField=this._bitField|536870912};Promise.prototype._setIsFinal=function(){this._bitField=this._bitField|33554432};Promise.prototype._isFinal=function(){return(this._bitField&33554432)>0};Promise.prototype._cancellable=function(){return(this._bitField&67108864)>0};Promise.prototype._setCancellable=function(){this._bitField=this._bitField|67108864};Promise.prototype._unsetCancellable=function(){this._bitField=this._bitField&~67108864};Promise.prototype._setIsMigrated=function(){this._bitField=this._bitField|4194304};Promise.prototype._unsetIsMigrated=function(){this._bitField=this._bitField&~4194304};Promise.prototype._isMigrated=function(){return(this._bitField&4194304)>0};Promise.prototype._receiverAt=function(index){var ret=index===0?this._receiver0:this[index*5-5+4];if(ret===undefined&&this._isBound()){return this._boundTo}return ret};Promise.prototype._promiseAt=function(index){return index===0?this._promise0:this[index*5-5+3]};Promise.prototype._fulfillmentHandlerAt=function(index){return index===0?this._fulfillmentHandler0:this[index*5-5+0]};Promise.prototype._rejectionHandlerAt=function(index){return index===0?this._rejectionHandler0:this[index*5-5+1]};Promise.prototype._migrateCallbacks=function(follower,index){var fulfill=follower._fulfillmentHandlerAt(index);var reject=follower._rejectionHandlerAt(index);var progress=follower._progressHandlerAt(index);var promise=follower._promiseAt(index);var receiver=follower._receiverAt(index);if(promise instanceof Promise)promise._setIsMigrated();this._addCallbacks(fulfill,reject,progress,promise,receiver)};Promise.prototype._addCallbacks=function(fulfill,reject,progress,promise,receiver){var index=this._length();if(index>=131071-5){index=0;this._setLength(0)}if(index===0){this._promise0=promise;if(receiver!==undefined)this._receiver0=receiver;if(typeof fulfill==="function"&&!this._isCarryingStackTrace())this._fulfillmentHandler0=fulfill;if(typeof reject==="function")this._rejectionHandler0=reject;if(typeof progress==="function")this._progressHandler0=progress}else{var base=index*5-5;this[base+3]=promise;this[base+4]=receiver;if(typeof fulfill==="function")this[base+0]=fulfill;if(typeof reject==="function")this[base+1]=reject;if(typeof progress==="function")this[base+2]=progress}this._setLength(index+1);return index};Promise.prototype._setProxyHandlers=function(receiver,promiseSlotValue){var index=this._length();if(index>=131071-5){index=0;this._setLength(0)}if(index===0){this._promise0=promiseSlotValue;this._receiver0=receiver}else{var base=index*5-5;this[base+3]=promiseSlotValue;this[base+4]=receiver}this._setLength(index+1)};Promise.prototype._proxyPromiseArray=function(promiseArray,index){this._setProxyHandlers(promiseArray,index)};Promise.prototype._resolveCallback=function(value,shouldBind){if(this._isFollowingOrFulfilledOrRejected())return;if(value===this)return this._rejectCallback(makeSelfResolutionError(),false,true);var maybePromise=tryConvertToPromise(value,this);if(!(maybePromise instanceof Promise))return this._fulfill(value);var propagationFlags=1|(shouldBind?4:0);this._propagateFrom(maybePromise,propagationFlags);var promise=maybePromise._target();if(promise._isPending()){var len=this._length();for(var i=0;i<len;++i){promise._migrateCallbacks(this,i)}this._setFollowing();this._setLength(0);this._setFollowee(promise)}else if(promise._isFulfilled()){this._fulfillUnchecked(promise._value())}else{this._rejectUnchecked(promise._reason(),promise._getCarriedStackTrace())}};Promise.prototype._rejectCallback=function(reason,synchronous,shouldNotMarkOriginatingFromRejection){if(!shouldNotMarkOriginatingFromRejection){util.markAsOriginatingFromRejection(reason)}var trace=util.ensureErrorObject(reason);var hasStack=trace===reason;this._attachExtraTrace(trace,synchronous?hasStack:false);this._reject(reason,hasStack?undefined:trace)};Promise.prototype._resolveFromResolver=function(resolver){var promise=this;this._captureStackTrace();this._pushContext();var synchronous=true;var r=tryCatch(resolver)(function(value){if(promise===null)return;promise._resolveCallback(value);promise=null},function(reason){if(promise===null)return;promise._rejectCallback(reason,synchronous);promise=null});synchronous=false;this._popContext();if(r!==undefined&&r===errorObj&&promise!==null){promise._rejectCallback(r.e,true,true);promise=null}};Promise.prototype._settlePromiseFromHandler=function(handler,receiver,value,promise){if(promise._isRejected())return;promise._pushContext();var x;if(receiver===APPLY&&!this._isRejected()){x=tryCatch(handler).apply(this._boundTo,value)}else{x=tryCatch(handler).call(receiver,value)}promise._popContext();if(x===errorObj||x===promise||x===NEXT_FILTER){var err=x===promise?makeSelfResolutionError():x.e;promise._rejectCallback(err,false,true)}else{promise._resolveCallback(x)}};Promise.prototype._target=function(){var ret=this;while(ret._isFollowing())ret=ret._followee();return ret};Promise.prototype._followee=function(){return this._rejectionHandler0};Promise.prototype._setFollowee=function(promise){this._rejectionHandler0=promise};Promise.prototype._cleanValues=function(){if(this._cancellable()){this._cancellationParent=undefined}};Promise.prototype._propagateFrom=function(parent,flags){if((flags&1)>0&&parent._cancellable()){this._setCancellable();this._cancellationParent=parent}if((flags&4)>0&&parent._isBound()){this._setBoundTo(parent._boundTo)}};Promise.prototype._fulfill=function(value){if(this._isFollowingOrFulfilledOrRejected())return;this._fulfillUnchecked(value)};Promise.prototype._reject=function(reason,carriedStackTrace){if(this._isFollowingOrFulfilledOrRejected())return;this._rejectUnchecked(reason,carriedStackTrace)};Promise.prototype._settlePromiseAt=function(index){var promise=this._promiseAt(index);var isPromise=promise instanceof Promise;if(isPromise&&promise._isMigrated()){promise._unsetIsMigrated();return async.invoke(this._settlePromiseAt,this,index)}var handler=this._isFulfilled()?this._fulfillmentHandlerAt(index):this._rejectionHandlerAt(index);var carriedStackTrace=this._isCarryingStackTrace()?this._getCarriedStackTrace():undefined;var value=this._settledValue;var receiver=this._receiverAt(index);this._clearCallbackDataAtIndex(index);if(typeof handler==="function"){if(!isPromise){handler.call(receiver,value,promise)}else{this._settlePromiseFromHandler(handler,receiver,value,promise)}}else if(receiver instanceof PromiseArray){if(!receiver._isResolved()){if(this._isFulfilled()){receiver._promiseFulfilled(value,promise)}else{receiver._promiseRejected(value,promise)}}}else if(isPromise){if(this._isFulfilled()){promise._fulfill(value)}else{promise._reject(value,carriedStackTrace)}}if(index>=4&&(index&31)===4)async.invokeLater(this._setLength,this,0)};Promise.prototype._clearCallbackDataAtIndex=function(index){if(index===0){if(!this._isCarryingStackTrace()){this._fulfillmentHandler0=undefined}this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=undefined}else{var base=index*5-5;this[base+3]=this[base+4]=this[base+0]=this[base+1]=this[base+2]=undefined}};Promise.prototype._isSettlePromisesQueued=function(){return(this._bitField&-1073741824)===-1073741824};Promise.prototype._setSettlePromisesQueued=function(){this._bitField=this._bitField|-1073741824};Promise.prototype._unsetSettlePromisesQueued=function(){this._bitField=this._bitField&~-1073741824};Promise.prototype._queueSettlePromises=function(){async.settlePromises(this);this._setSettlePromisesQueued()};Promise.prototype._fulfillUnchecked=function(value){if(value===this){var err=makeSelfResolutionError();this._attachExtraTrace(err);return this._rejectUnchecked(err,undefined)}this._setFulfilled();this._settledValue=value;this._cleanValues();if(this._length()>0){this._queueSettlePromises()}};Promise.prototype._rejectUncheckedCheckError=function(reason){var trace=util.ensureErrorObject(reason);this._rejectUnchecked(reason,trace===reason?undefined:trace)};Promise.prototype._rejectUnchecked=function(reason,trace){if(reason===this){var err=makeSelfResolutionError();this._attachExtraTrace(err);return this._rejectUnchecked(err)}this._setRejected();this._settledValue=reason;this._cleanValues();if(this._isFinal()){async.throwLater(function(e){if("stack"in e){async.invokeFirst(CapturedTrace.unhandledRejection,undefined,e)}throw e},trace===undefined?reason:trace);return}if(trace!==undefined&&trace!==reason){this._setCarriedStackTrace(trace)}if(this._length()>0){this._queueSettlePromises()}else{this._ensurePossibleRejectionHandled()}};Promise.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();var len=this._length();for(var i=0;i<len;i++){this._settlePromiseAt(i)}};Promise._makeSelfResolutionError=makeSelfResolutionError;_dereq_("./progress.js")(Promise,PromiseArray);_dereq_("./method.js")(Promise,INTERNAL,tryConvertToPromise,apiRejection);_dereq_("./bind.js")(Promise,INTERNAL,tryConvertToPromise);_dereq_("./finally.js")(Promise,NEXT_FILTER,tryConvertToPromise);_dereq_("./direct_resolve.js")(Promise);_dereq_("./synchronous_inspection.js")(Promise);_dereq_("./join.js")(Promise,PromiseArray,tryConvertToPromise,INTERNAL);Promise.Promise=Promise;_dereq_("./map.js")(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL);_dereq_("./cancel.js")(Promise);_dereq_("./using.js")(Promise,apiRejection,tryConvertToPromise,createContext);_dereq_("./generators.js")(Promise,apiRejection,INTERNAL,tryConvertToPromise);_dereq_("./nodeify.js")(Promise);_dereq_("./call_get.js")(Promise);_dereq_("./props.js")(Promise,PromiseArray,tryConvertToPromise,apiRejection);_dereq_("./race.js")(Promise,INTERNAL,tryConvertToPromise,apiRejection);_dereq_("./reduce.js")(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL);_dereq_("./settle.js")(Promise,PromiseArray);_dereq_("./some.js")(Promise,PromiseArray,apiRejection);_dereq_("./promisify.js")(Promise,INTERNAL);_dereq_("./any.js")(Promise);_dereq_("./each.js")(Promise,INTERNAL);_dereq_("./timers.js")(Promise,INTERNAL);_dereq_("./filter.js")(Promise,INTERNAL);util.toFastProperties(Promise);util.toFastProperties(Promise.prototype);function fillTypes(value){var p=new Promise(INTERNAL);p._fulfillmentHandler0=value;p._rejectionHandler0=value;p._progressHandler0=value;p._promise0=value;p._receiver0=value;p._settledValue=value}fillTypes({a:1});fillTypes({b:2});fillTypes({c:3});fillTypes(1);fillTypes(function(){});fillTypes(undefined);fillTypes(false);fillTypes(new Promise(INTERNAL));CapturedTrace.setBounds(async.firstLineError,util.lastLineError);return Promise}},{"./any.js":1,"./async.js":2,"./bind.js":3,"./call_get.js":5,"./cancel.js":6,"./captured_trace.js":7,"./catch_filter.js":8,"./context.js":9,"./debuggability.js":10,"./direct_resolve.js":11,"./each.js":12,"./errors.js":13,"./filter.js":15,"./finally.js":16,"./generators.js":17,"./join.js":18,"./map.js":19,"./method.js":20,"./nodeify.js":21,"./progress.js":22,"./promise_array.js":24,"./promise_resolver.js":25,"./promisify.js":26,"./props.js":27,"./race.js":29,"./reduce.js":30,"./settle.js":32,"./some.js":33,"./synchronous_inspection.js":34,"./thenables.js":35,"./timers.js":36,"./using.js":37,"./util.js":38}],24:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise,apiRejection){var util=_dereq_("./util.js");var isArray=util.isArray;function toResolutionValue(val){switch(val){case-2:return[];case-3:return{}}}function PromiseArray(values){var promise=this._promise=new Promise(INTERNAL);var parent;if(values instanceof Promise){parent=values;promise._propagateFrom(parent,1|4)}this._values=values;this._length=0;this._totalResolved=0;this._init(undefined,-2)}PromiseArray.prototype.length=function(){return this._length};PromiseArray.prototype.promise=function(){return this._promise};PromiseArray.prototype._init=function init(_,resolveValueIfEmpty){var values=tryConvertToPromise(this._values,this._promise);if(values instanceof Promise){values=values._target();this._values=values;if(values._isFulfilled()){values=values._value();if(!isArray(values)){var err=new Promise.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");this.__hardReject__(err);return}}else if(values._isPending()){values._then(init,this._reject,undefined,this,resolveValueIfEmpty);return}else{this._reject(values._reason());return}}else if(!isArray(values)){this._promise._reject(apiRejection("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());return}if(values.length===0){if(resolveValueIfEmpty===-5){this._resolveEmptyArray()}else{this._resolve(toResolutionValue(resolveValueIfEmpty))}return}var len=this.getActualLength(values.length);this._length=len;this._values=this.shouldCopyValues()?new Array(len):this._values;var promise=this._promise;for(var i=0;i<len;++i){var isResolved=this._isResolved();var maybePromise=tryConvertToPromise(values[i],promise);if(maybePromise instanceof Promise){maybePromise=maybePromise._target();if(isResolved){maybePromise._ignoreRejections()}else if(maybePromise._isPending()){maybePromise._proxyPromiseArray(this,i)}else if(maybePromise._isFulfilled()){this._promiseFulfilled(maybePromise._value(),i)}else{this._promiseRejected(maybePromise._reason(),i)}}else if(!isResolved){this._promiseFulfilled(maybePromise,i)}}};PromiseArray.prototype._isResolved=function(){return this._values===null};PromiseArray.prototype._resolve=function(value){this._values=null;this._promise._fulfill(value)};PromiseArray.prototype.__hardReject__=PromiseArray.prototype._reject=function(reason){this._values=null;this._promise._rejectCallback(reason,false,true)};PromiseArray.prototype._promiseProgressed=function(progressValue,index){this._promise._progress({index:index,value:progressValue})};PromiseArray.prototype._promiseFulfilled=function(value,index){this._values[index]=value;var totalResolved=++this._totalResolved;if(totalResolved>=this._length){this._resolve(this._values)}};PromiseArray.prototype._promiseRejected=function(reason,index){this._totalResolved++;this._reject(reason)};PromiseArray.prototype.shouldCopyValues=function(){return true};PromiseArray.prototype.getActualLength=function(len){return len};return PromiseArray}},{"./util.js":38}],25:[function(_dereq_,module,exports){"use strict";var util=_dereq_("./util.js");var maybeWrapAsError=util.maybeWrapAsError;var errors=_dereq_("./errors.js");var TimeoutError=errors.TimeoutError;var OperationalError=errors.OperationalError;var haveGetters=util.haveGetters;var es5=_dereq_("./es5.js");function isUntypedError(obj){return obj instanceof Error&&es5.getPrototypeOf(obj)===Error.prototype}var rErrorKey=/^(?:name|message|stack|cause)$/;function wrapAsOperationalError(obj){var ret;if(isUntypedError(obj)){ret=new OperationalError(obj);ret.name=obj.name;ret.message=obj.message;ret.stack=obj.stack;var keys=es5.keys(obj);for(var i=0;i<keys.length;++i){var key=keys[i];if(!rErrorKey.test(key)){ret[key]=obj[key]}}return ret}util.markAsOriginatingFromRejection(obj);return obj}function nodebackForPromise(promise){return function(err,value){if(promise===null)return;if(err){var wrapped=wrapAsOperationalError(maybeWrapAsError(err));promise._attachExtraTrace(wrapped);promise._reject(wrapped)}else if(arguments.length>2){var $_len=arguments.length;var args=new Array($_len-1);for(var $_i=1;$_i<$_len;++$_i){args[$_i-1]=arguments[$_i]}promise._fulfill(args)}else{promise._fulfill(value)}promise=null}}var PromiseResolver;if(!haveGetters){PromiseResolver=function(promise){this.promise=promise;this.asCallback=nodebackForPromise(promise);this.callback=this.asCallback}}else{PromiseResolver=function(promise){this.promise=promise}}if(haveGetters){var prop={get:function(){return nodebackForPromise(this.promise)}};es5.defineProperty(PromiseResolver.prototype,"asCallback",prop);es5.defineProperty(PromiseResolver.prototype,"callback",prop)}PromiseResolver._nodebackForPromise=nodebackForPromise;PromiseResolver.prototype.toString=function(){return"[object PromiseResolver]"};PromiseResolver.prototype.resolve=PromiseResolver.prototype.fulfill=function(value){if(!(this instanceof PromiseResolver)){throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n")}this.promise._resolveCallback(value)};PromiseResolver.prototype.reject=function(reason){if(!(this instanceof PromiseResolver)){throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n")}this.promise._rejectCallback(reason)};PromiseResolver.prototype.progress=function(value){if(!(this instanceof PromiseResolver)){throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n")}this.promise._progress(value)};PromiseResolver.prototype.cancel=function(err){this.promise.cancel(err)};PromiseResolver.prototype.timeout=function(){this.reject(new TimeoutError("timeout"))};PromiseResolver.prototype.isResolved=function(){return this.promise.isResolved()};PromiseResolver.prototype.toJSON=function(){return this.promise.toJSON()};module.exports=PromiseResolver},{"./errors.js":13,"./es5.js":14,"./util.js":38}],26:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){var THIS={};var util=_dereq_("./util.js");var nodebackForPromise=_dereq_("./promise_resolver.js")._nodebackForPromise;var withAppended=util.withAppended;var maybeWrapAsError=util.maybeWrapAsError;var canEvaluate=util.canEvaluate;var TypeError=_dereq_("./errors").TypeError;var defaultSuffix="Async";var defaultPromisified={__isPromisified__:true};var noCopyPropsPattern=/^(?:length|name|arguments|caller|callee|prototype|__isPromisified__)$/;var defaultFilter=function(name){return util.isIdentifier(name)&&name.charAt(0)!=="_"&&name!=="constructor"};function propsFilter(key){return!noCopyPropsPattern.test(key)}function isPromisified(fn){try{return fn.__isPromisified__===true}catch(e){return false}}function hasPromisified(obj,key,suffix){var val=util.getDataPropertyOrDefault(obj,key+suffix,defaultPromisified);return val?isPromisified(val):false}function checkValid(ret,suffix,suffixRegexp){for(var i=0;i<ret.length;i+=2){var key=ret[i];if(suffixRegexp.test(key)){var keyWithoutAsyncSuffix=key.replace(suffixRegexp,"");for(var j=0;j<ret.length;j+=2){if(ret[j]===keyWithoutAsyncSuffix){throw new TypeError("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s",suffix))}}}}}function promisifiableMethods(obj,suffix,suffixRegexp,filter){var keys=util.inheritedDataKeys(obj);var ret=[];for(var i=0;i<keys.length;++i){var key=keys[i];var value=obj[key];var passesDefaultFilter=filter===defaultFilter?true:defaultFilter(key,value,obj);if(typeof value==="function"&&!util.isNativeFunctionMethod(value)&&!isPromisified(value)&&!hasPromisified(obj,key,suffix)&&filter(key,value,obj,passesDefaultFilter)){ret.push(key,value)}}checkValid(ret,suffix,suffixRegexp);return ret}var escapeIdentRegex=function(str){return str.replace(/([$])/,"\\$")};var makeNodePromisifiedEval;if(!true){var switchCaseArgumentOrder=function(likelyArgumentCount){var ret=[likelyArgumentCount];var min=Math.max(0,likelyArgumentCount-1-3);for(var i=likelyArgumentCount-1;i>=min;--i){ret.push(i)}for(var i=likelyArgumentCount+1;i<=3;++i){ret.push(i)}return ret};var argumentSequence=function(argumentCount){return util.filledRange(argumentCount,"_arg","")};var parameterDeclaration=function(parameterCount){return util.filledRange(Math.max(parameterCount,3),"_arg","")};var parameterCount=function(fn){if(typeof fn.length==="number"){return Math.max(Math.min(fn.length,1023+1),0)}return 0};makeNodePromisifiedEval=function(callback,receiver,originalName,fn){var newParameterCount=Math.max(0,parameterCount(fn)-1);var argumentOrder=switchCaseArgumentOrder(newParameterCount);var shouldProxyThis=typeof callback==="string"||receiver===THIS;function generateCallForArgumentCount(count){var args=argumentSequence(count).join(", ");var comma=count>0?", ":"";var ret;if(shouldProxyThis){ret="ret = callback.call(this, {{args}}, nodeback); break;\n"}else{ret=receiver===undefined?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n"}return ret.replace("{{args}}",args).replace(", ",comma)}function generateArgumentSwitchCase(){var ret="";for(var i=0;i<argumentOrder.length;++i){ret+="case "+argumentOrder[i]+":"+generateCallForArgumentCount(argumentOrder[i])}ret+="                                                             \n        default:                                                             \n            var args = new Array(len + 1);                                   \n            var i = 0;                                                       \n            for (var i = 0; i < len; ++i) {                                  \n               args[i] = arguments[i];                                       \n            }                                                                \n            args[i] = nodeback;                                              \n            [CodeForCall]                                                    \n            break;                                                           \n        ".replace("[CodeForCall]",shouldProxyThis?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n");
return ret}var getFunctionCode=typeof callback==="string"?"this != null ? this['"+callback+"'] : fn":"fn";return new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL","'use strict';                            \n        var ret = function (Parameters) {                                    \n            'use strict';                                                    \n            var len = arguments.length;                                      \n            var promise = new Promise(INTERNAL);                             \n            promise._captureStackTrace();                                    \n            var nodeback = nodebackForPromise(promise);                      \n            var ret;                                                         \n            var callback = tryCatch([GetFunctionCode]);                      \n            switch(len) {                                                    \n                [CodeForSwitchCase]                                          \n            }                                                                \n            if (ret === errorObj) {                                          \n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n            }                                                                \n            return promise;                                                  \n        };                                                                   \n        notEnumerableProp(ret, '__isPromisified__', true);                   \n        return ret;                                                          \n        ".replace("Parameters",parameterDeclaration(newParameterCount)).replace("[CodeForSwitchCase]",generateArgumentSwitchCase()).replace("[GetFunctionCode]",getFunctionCode))(Promise,fn,receiver,withAppended,maybeWrapAsError,nodebackForPromise,util.tryCatch,util.errorObj,util.notEnumerableProp,INTERNAL)}}function makeNodePromisifiedClosure(callback,receiver,_,fn){var defaultThis=function(){return this}();var method=callback;if(typeof method==="string"){callback=fn}function promisified(){var _receiver=receiver;if(receiver===THIS)_receiver=this;var promise=new Promise(INTERNAL);promise._captureStackTrace();var cb=typeof method==="string"&&this!==defaultThis?this[method]:callback;var fn=nodebackForPromise(promise);try{cb.apply(_receiver,withAppended(arguments,fn))}catch(e){promise._rejectCallback(maybeWrapAsError(e),true,true)}return promise}util.notEnumerableProp(promisified,"__isPromisified__",true);return promisified}var makeNodePromisified=canEvaluate?makeNodePromisifiedEval:makeNodePromisifiedClosure;function promisifyAll(obj,suffix,filter,promisifier){var suffixRegexp=new RegExp(escapeIdentRegex(suffix)+"$");var methods=promisifiableMethods(obj,suffix,suffixRegexp,filter);for(var i=0,len=methods.length;i<len;i+=2){var key=methods[i];var fn=methods[i+1];var promisifiedKey=key+suffix;obj[promisifiedKey]=promisifier===makeNodePromisified?makeNodePromisified(key,THIS,key,fn,suffix):promisifier(fn,function(){return makeNodePromisified(key,THIS,key,fn,suffix)})}util.toFastProperties(obj);return obj}function promisify(callback,receiver){return makeNodePromisified(callback,receiver,undefined,callback)}Promise.promisify=function(fn,receiver){if(typeof fn!=="function"){throw new TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n")}if(isPromisified(fn)){return fn}var ret=promisify(fn,arguments.length<2?THIS:receiver);util.copyDescriptors(fn,ret,propsFilter);return ret};Promise.promisifyAll=function(target,options){if(typeof target!=="function"&&typeof target!=="object"){throw new TypeError("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n")}options=Object(options);var suffix=options.suffix;if(typeof suffix!=="string")suffix=defaultSuffix;var filter=options.filter;if(typeof filter!=="function")filter=defaultFilter;var promisifier=options.promisifier;if(typeof promisifier!=="function")promisifier=makeNodePromisified;if(!util.isIdentifier(suffix)){throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n")}var keys=util.inheritedDataKeys(target);for(var i=0;i<keys.length;++i){var value=target[keys[i]];if(keys[i]!=="constructor"&&util.isClass(value)){promisifyAll(value.prototype,suffix,filter,promisifier);promisifyAll(value,suffix,filter,promisifier)}}return promisifyAll(target,suffix,filter,promisifier)}}},{"./errors":13,"./promise_resolver.js":25,"./util.js":38}],27:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,tryConvertToPromise,apiRejection){var util=_dereq_("./util.js");var isObject=util.isObject;var es5=_dereq_("./es5.js");function PropertiesPromiseArray(obj){var keys=es5.keys(obj);var len=keys.length;var values=new Array(len*2);for(var i=0;i<len;++i){var key=keys[i];values[i]=obj[key];values[i+len]=key}this.constructor$(values)}util.inherits(PropertiesPromiseArray,PromiseArray);PropertiesPromiseArray.prototype._init=function(){this._init$(undefined,-3)};PropertiesPromiseArray.prototype._promiseFulfilled=function(value,index){this._values[index]=value;var totalResolved=++this._totalResolved;if(totalResolved>=this._length){var val={};var keyOffset=this.length();for(var i=0,len=this.length();i<len;++i){val[this._values[i+keyOffset]]=this._values[i]}this._resolve(val)}};PropertiesPromiseArray.prototype._promiseProgressed=function(value,index){this._promise._progress({key:this._values[index+this.length()],value:value})};PropertiesPromiseArray.prototype.shouldCopyValues=function(){return false};PropertiesPromiseArray.prototype.getActualLength=function(len){return len>>1};function props(promises){var ret;var castValue=tryConvertToPromise(promises);if(!isObject(castValue)){return apiRejection("cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n")}else if(castValue instanceof Promise){ret=castValue._then(Promise.props,undefined,undefined,undefined,undefined)}else{ret=new PropertiesPromiseArray(castValue).promise()}if(castValue instanceof Promise){ret._propagateFrom(castValue,4)}return ret}Promise.prototype.props=function(){return props(this)};Promise.props=function(promises){return props(promises)}}},{"./es5.js":14,"./util.js":38}],28:[function(_dereq_,module,exports){"use strict";function arrayMove(src,srcIndex,dst,dstIndex,len){for(var j=0;j<len;++j){dst[j+dstIndex]=src[j+srcIndex];src[j+srcIndex]=void 0}}function Queue(capacity){this._capacity=capacity;this._length=0;this._front=0}Queue.prototype._willBeOverCapacity=function(size){return this._capacity<size};Queue.prototype._pushOne=function(arg){var length=this.length();this._checkCapacity(length+1);var i=this._front+length&this._capacity-1;this[i]=arg;this._length=length+1};Queue.prototype._unshiftOne=function(value){var capacity=this._capacity;this._checkCapacity(this.length()+1);var front=this._front;var i=(front-1&capacity-1^capacity)-capacity;this[i]=value;this._front=i;this._length=this.length()+1};Queue.prototype.unshift=function(fn,receiver,arg){this._unshiftOne(arg);this._unshiftOne(receiver);this._unshiftOne(fn)};Queue.prototype.push=function(fn,receiver,arg){var length=this.length()+3;if(this._willBeOverCapacity(length)){this._pushOne(fn);this._pushOne(receiver);this._pushOne(arg);return}var j=this._front+length-3;this._checkCapacity(length);var wrapMask=this._capacity-1;this[j+0&wrapMask]=fn;this[j+1&wrapMask]=receiver;this[j+2&wrapMask]=arg;this._length=length};Queue.prototype.shift=function(){var front=this._front,ret=this[front];this[front]=undefined;this._front=front+1&this._capacity-1;this._length--;return ret};Queue.prototype.length=function(){return this._length};Queue.prototype._checkCapacity=function(size){if(this._capacity<size){this._resizeTo(this._capacity<<1)}};Queue.prototype._resizeTo=function(capacity){var oldCapacity=this._capacity;this._capacity=capacity;var front=this._front;var length=this._length;var moveItemsCount=front+length&oldCapacity-1;arrayMove(this,0,this,oldCapacity,moveItemsCount)};module.exports=Queue},{}],29:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise,apiRejection){var isArray=_dereq_("./util.js").isArray;var raceLater=function(promise){return promise.then(function(array){return race(array,promise)})};function race(promises,parent){var maybePromise=tryConvertToPromise(promises);if(maybePromise instanceof Promise){return raceLater(maybePromise)}else if(!isArray(promises)){return apiRejection("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")}var ret=new Promise(INTERNAL);if(parent!==undefined){ret._propagateFrom(parent,4|1)}var fulfill=ret._fulfill;var reject=ret._reject;for(var i=0,len=promises.length;i<len;++i){var val=promises[i];if(val===undefined&&!(i in promises)){continue}Promise.cast(val)._then(fulfill,reject,undefined,ret,null)}return ret}Promise.race=function(promises){return race(promises,undefined)};Promise.prototype.race=function(){return race(this,undefined)}}},{"./util.js":38}],30:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL){var async=_dereq_("./async.js");var util=_dereq_("./util.js");var tryCatch=util.tryCatch;var errorObj=util.errorObj;function ReductionPromiseArray(promises,fn,accum,_each){this.constructor$(promises);this._promise._captureStackTrace();this._preservedValues=_each===INTERNAL?[]:null;this._zerothIsAccum=accum===undefined;this._gotAccum=false;this._reducingIndex=this._zerothIsAccum?1:0;this._valuesPhase=undefined;var maybePromise=tryConvertToPromise(accum,this._promise);var rejected=false;var isPromise=maybePromise instanceof Promise;if(isPromise){maybePromise=maybePromise._target();if(maybePromise._isPending()){maybePromise._proxyPromiseArray(this,-1)}else if(maybePromise._isFulfilled()){accum=maybePromise._value();this._gotAccum=true}else{this._reject(maybePromise._reason());rejected=true}}if(!(isPromise||this._zerothIsAccum))this._gotAccum=true;this._callback=fn;this._accum=accum;if(!rejected)async.invoke(init,this,undefined)}function init(){this._init$(undefined,-5)}util.inherits(ReductionPromiseArray,PromiseArray);ReductionPromiseArray.prototype._init=function(){};ReductionPromiseArray.prototype._resolveEmptyArray=function(){if(this._gotAccum||this._zerothIsAccum){this._resolve(this._preservedValues!==null?[]:this._accum)}};ReductionPromiseArray.prototype._promiseFulfilled=function(value,index){var values=this._values;values[index]=value;var length=this.length();var preservedValues=this._preservedValues;var isEach=preservedValues!==null;var gotAccum=this._gotAccum;var valuesPhase=this._valuesPhase;var valuesPhaseIndex;if(!valuesPhase){valuesPhase=this._valuesPhase=new Array(length);for(valuesPhaseIndex=0;valuesPhaseIndex<length;++valuesPhaseIndex){valuesPhase[valuesPhaseIndex]=0}}valuesPhaseIndex=valuesPhase[index];if(index===0&&this._zerothIsAccum){this._accum=value;this._gotAccum=gotAccum=true;valuesPhase[index]=valuesPhaseIndex===0?1:2}else if(index===-1){this._accum=value;this._gotAccum=gotAccum=true}else{if(valuesPhaseIndex===0){valuesPhase[index]=1}else{valuesPhase[index]=2;this._accum=value}}if(!gotAccum)return;var callback=this._callback;var receiver=this._promise._boundTo;var ret;for(var i=this._reducingIndex;i<length;++i){valuesPhaseIndex=valuesPhase[i];if(valuesPhaseIndex===2){this._reducingIndex=i+1;continue}if(valuesPhaseIndex!==1)return;value=values[i];this._promise._pushContext();if(isEach){preservedValues.push(value);ret=tryCatch(callback).call(receiver,value,i,length)}else{ret=tryCatch(callback).call(receiver,this._accum,value,i,length)}this._promise._popContext();if(ret===errorObj)return this._reject(ret.e);var maybePromise=tryConvertToPromise(ret,this._promise);if(maybePromise instanceof Promise){maybePromise=maybePromise._target();if(maybePromise._isPending()){valuesPhase[i]=4;return maybePromise._proxyPromiseArray(this,i)}else if(maybePromise._isFulfilled()){ret=maybePromise._value()}else{return this._reject(maybePromise._reason())}}this._reducingIndex=i+1;this._accum=ret}this._resolve(isEach?preservedValues:this._accum)};function reduce(promises,fn,initialValue,_each){if(typeof fn!=="function")return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var array=new ReductionPromiseArray(promises,fn,initialValue,_each);return array.promise()}Promise.prototype.reduce=function(fn,initialValue){return reduce(this,fn,initialValue,null)};Promise.reduce=function(promises,fn,initialValue,_each){return reduce(promises,fn,initialValue,_each)}}},{"./async.js":2,"./util.js":38}],31:[function(_dereq_,module,exports){"use strict";var schedule;var util=_dereq_("./util");var noAsyncScheduler=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")};if(util.isNode&&typeof MutationObserver==="undefined"){var GlobalSetImmediate=global.setImmediate;var ProcessNextTick=process.nextTick;schedule=util.isRecentNode?function(fn){GlobalSetImmediate.call(global,fn)}:function(fn){ProcessNextTick.call(process,fn)}}else if(typeof MutationObserver!=="undefined"){schedule=function(fn){var div=document.createElement("div");var observer=new MutationObserver(fn);observer.observe(div,{attributes:true});return function(){div.classList.toggle("foo")}};schedule.isStatic=true}else if(typeof setImmediate!=="undefined"){schedule=function(fn){setImmediate(fn)}}else if(typeof setTimeout!=="undefined"){schedule=function(fn){setTimeout(fn,0)}}else{schedule=noAsyncScheduler}module.exports=schedule},{"./util":38}],32:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray){var PromiseInspection=Promise.PromiseInspection;var util=_dereq_("./util.js");function SettledPromiseArray(values){this.constructor$(values)}util.inherits(SettledPromiseArray,PromiseArray);SettledPromiseArray.prototype._promiseResolved=function(index,inspection){this._values[index]=inspection;var totalResolved=++this._totalResolved;if(totalResolved>=this._length){this._resolve(this._values)}};SettledPromiseArray.prototype._promiseFulfilled=function(value,index){var ret=new PromiseInspection;ret._bitField=268435456;ret._settledValue=value;this._promiseResolved(index,ret)};SettledPromiseArray.prototype._promiseRejected=function(reason,index){var ret=new PromiseInspection;ret._bitField=134217728;ret._settledValue=reason;this._promiseResolved(index,ret)};Promise.settle=function(promises){return new SettledPromiseArray(promises).promise()};Promise.prototype.settle=function(){return new SettledPromiseArray(this).promise()}}},{"./util.js":38}],33:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,apiRejection){var util=_dereq_("./util.js");var RangeError=_dereq_("./errors.js").RangeError;var AggregateError=_dereq_("./errors.js").AggregateError;var isArray=util.isArray;function SomePromiseArray(values){this.constructor$(values);this._howMany=0;this._unwrap=false;this._initialized=false}util.inherits(SomePromiseArray,PromiseArray);SomePromiseArray.prototype._init=function(){if(!this._initialized){return}if(this._howMany===0){this._resolve([]);return}this._init$(undefined,-5);var isArrayResolved=isArray(this._values);if(!this._isResolved()&&isArrayResolved&&this._howMany>this._canPossiblyFulfill()){this._reject(this._getRangeError(this.length()))}};SomePromiseArray.prototype.init=function(){this._initialized=true;this._init()};SomePromiseArray.prototype.setUnwrap=function(){this._unwrap=true};SomePromiseArray.prototype.howMany=function(){return this._howMany};SomePromiseArray.prototype.setHowMany=function(count){this._howMany=count};SomePromiseArray.prototype._promiseFulfilled=function(value){this._addFulfilled(value);if(this._fulfilled()===this.howMany()){this._values.length=this.howMany();if(this.howMany()===1&&this._unwrap){this._resolve(this._values[0])}else{this._resolve(this._values)}}};SomePromiseArray.prototype._promiseRejected=function(reason){this._addRejected(reason);if(this.howMany()>this._canPossiblyFulfill()){var e=new AggregateError;for(var i=this.length();i<this._values.length;++i){e.push(this._values[i])}this._reject(e)}};SomePromiseArray.prototype._fulfilled=function(){return this._totalResolved};SomePromiseArray.prototype._rejected=function(){return this._values.length-this.length()};SomePromiseArray.prototype._addRejected=function(reason){this._values.push(reason)};SomePromiseArray.prototype._addFulfilled=function(value){this._values[this._totalResolved++]=value};SomePromiseArray.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()};SomePromiseArray.prototype._getRangeError=function(count){var message="Input array must contain at least "+this._howMany+" items but contains only "+count+" items";return new RangeError(message)};SomePromiseArray.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))};function some(promises,howMany){if((howMany|0)!==howMany||howMany<0){return apiRejection("expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n")}var ret=new SomePromiseArray(promises);var promise=ret.promise();ret.setHowMany(howMany);ret.init();return promise}Promise.some=function(promises,howMany){return some(promises,howMany)};Promise.prototype.some=function(howMany){return some(this,howMany)};Promise._SomePromiseArray=SomePromiseArray}},{"./errors.js":13,"./util.js":38}],34:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){function PromiseInspection(promise){if(promise!==undefined){promise=promise._target();this._bitField=promise._bitField;this._settledValue=promise._settledValue}else{this._bitField=0;this._settledValue=undefined}}PromiseInspection.prototype.value=function(){if(!this.isFulfilled()){throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n")}return this._settledValue};PromiseInspection.prototype.error=PromiseInspection.prototype.reason=function(){if(!this.isRejected()){throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n")}return this._settledValue};PromiseInspection.prototype.isFulfilled=Promise.prototype._isFulfilled=function(){return(this._bitField&268435456)>0};PromiseInspection.prototype.isRejected=Promise.prototype._isRejected=function(){return(this._bitField&134217728)>0};PromiseInspection.prototype.isPending=Promise.prototype._isPending=function(){return(this._bitField&402653184)===0};PromiseInspection.prototype.isResolved=Promise.prototype._isResolved=function(){return(this._bitField&402653184)>0};Promise.prototype.isPending=function(){return this._target()._isPending()};Promise.prototype.isRejected=function(){return this._target()._isRejected()};Promise.prototype.isFulfilled=function(){return this._target()._isFulfilled()};Promise.prototype.isResolved=function(){return this._target()._isResolved()};Promise.prototype._value=function(){return this._settledValue};Promise.prototype._reason=function(){this._unsetRejectionIsUnhandled();return this._settledValue};Promise.prototype.value=function(){var target=this._target();if(!target.isFulfilled()){throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n")}return target._settledValue};Promise.prototype.reason=function(){var target=this._target();if(!target.isRejected()){throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n")}target._unsetRejectionIsUnhandled();return target._settledValue};Promise.PromiseInspection=PromiseInspection}},{}],35:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){var util=_dereq_("./util.js");var errorObj=util.errorObj;var isObject=util.isObject;function tryConvertToPromise(obj,context){if(isObject(obj)){if(obj instanceof Promise){return obj}else if(isAnyBluebirdPromise(obj)){var ret=new Promise(INTERNAL);obj._then(ret._fulfillUnchecked,ret._rejectUncheckedCheckError,ret._progressUnchecked,ret,null);return ret}var then=util.tryCatch(getThen)(obj);if(then===errorObj){if(context)context._pushContext();var ret=Promise.reject(then.e);if(context)context._popContext();return ret}else if(typeof then==="function"){return doThenable(obj,then,context)}}return obj}function getThen(obj){return obj.then}var hasProp={}.hasOwnProperty;function isAnyBluebirdPromise(obj){return hasProp.call(obj,"_promise0")}function doThenable(x,then,context){var promise=new Promise(INTERNAL);var ret=promise;if(context)context._pushContext();promise._captureStackTrace();if(context)context._popContext();var synchronous=true;var result=util.tryCatch(then).call(x,resolveFromThenable,rejectFromThenable,progressFromThenable);synchronous=false;if(promise&&result===errorObj){promise._rejectCallback(result.e,true,true);promise=null}function resolveFromThenable(value){if(!promise)return;if(x===value){promise._rejectCallback(Promise._makeSelfResolutionError(),false,true)}else{promise._resolveCallback(value)}promise=null}function rejectFromThenable(reason){if(!promise)return;promise._rejectCallback(reason,synchronous,true);promise=null}function progressFromThenable(value){if(!promise)return;if(typeof promise._progress==="function"){promise._progress(value)}}return ret}return tryConvertToPromise}},{"./util.js":38}],36:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){var util=_dereq_("./util.js");var TimeoutError=Promise.TimeoutError;var afterTimeout=function(promise,message){if(!promise.isPending())return;if(typeof message!=="string"){message="operation timed out"}var err=new TimeoutError(message);util.markAsOriginatingFromRejection(err);promise._attachExtraTrace(err);promise._cancel(err)};var afterValue=function(value){return delay(+this).thenReturn(value)};var delay=Promise.delay=function(value,ms){if(ms===undefined){ms=value;value=undefined;var ret=new Promise(INTERNAL);setTimeout(function(){ret._fulfill()},ms);return ret}ms=+ms;return Promise.resolve(value)._then(afterValue,null,null,ms,undefined)};Promise.prototype.delay=function(ms){return delay(this,ms)};function successClear(value){var handle=this;if(handle instanceof Number)handle=+handle;clearTimeout(handle);return value}function failureClear(reason){var handle=this;if(handle instanceof Number)handle=+handle;clearTimeout(handle);throw reason}Promise.prototype.timeout=function(ms,message){ms=+ms;var ret=this.then().cancellable();ret._cancellationParent=this;var handle=setTimeout(function timeoutTimeout(){afterTimeout(ret,message)},ms);return ret._then(successClear,failureClear,undefined,handle,undefined)}}},{"./util.js":38}],37:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,apiRejection,tryConvertToPromise,createContext){var TypeError=_dereq_("./errors.js").TypeError;var inherits=_dereq_("./util.js").inherits;var PromiseInspection=Promise.PromiseInspection;function inspectionMapper(inspections){var len=inspections.length;for(var i=0;i<len;++i){var inspection=inspections[i];if(inspection.isRejected()){return Promise.reject(inspection.error())}inspections[i]=inspection._settledValue}return inspections}function thrower(e){setTimeout(function(){throw e},0)}function castPreservingDisposable(thenable){var maybePromise=tryConvertToPromise(thenable);if(maybePromise!==thenable&&typeof thenable._isDisposable==="function"&&typeof thenable._getDisposer==="function"&&thenable._isDisposable()){maybePromise._setDisposable(thenable._getDisposer())}return maybePromise}function dispose(resources,inspection){var i=0;var len=resources.length;var ret=Promise.defer();function iterator(){if(i>=len)return ret.resolve();var maybePromise=castPreservingDisposable(resources[i++]);if(maybePromise instanceof Promise&&maybePromise._isDisposable()){try{maybePromise=tryConvertToPromise(maybePromise._getDisposer().tryDispose(inspection),resources.promise)}catch(e){return thrower(e)}if(maybePromise instanceof Promise){return maybePromise._then(iterator,thrower,null,null,null)}}iterator()}iterator();return ret.promise}function disposerSuccess(value){var inspection=new PromiseInspection;inspection._settledValue=value;inspection._bitField=268435456;return dispose(this,inspection).thenReturn(value)}function disposerFail(reason){var inspection=new PromiseInspection;inspection._settledValue=reason;inspection._bitField=134217728;return dispose(this,inspection).thenThrow(reason)}function Disposer(data,promise,context){this._data=data;this._promise=promise;this._context=context}Disposer.prototype.data=function(){return this._data};Disposer.prototype.promise=function(){return this._promise};Disposer.prototype.resource=function(){if(this.promise().isFulfilled()){return this.promise().value()}return null};Disposer.prototype.tryDispose=function(inspection){var resource=this.resource();var context=this._context;if(context!==undefined)context._pushContext();var ret=resource!==null?this.doDispose(resource,inspection):null;if(context!==undefined)context._popContext();this._promise._unsetDisposable();this._data=null;return ret};Disposer.isDisposer=function(d){return d!=null&&typeof d.resource==="function"&&typeof d.tryDispose==="function"};function FunctionDisposer(fn,promise,context){this.constructor$(fn,promise,context)}inherits(FunctionDisposer,Disposer);FunctionDisposer.prototype.doDispose=function(resource,inspection){var fn=this.data();return fn.call(resource,resource,inspection)};function maybeUnwrapDisposer(value){if(Disposer.isDisposer(value)){this.resources[this.index]._setDisposable(value);return value.promise()}return value}Promise.using=function(){var len=arguments.length;if(len<2)return apiRejection("you must pass at least 2 arguments to Promise.using");var fn=arguments[len-1];if(typeof fn!=="function")return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n");len--;var resources=new Array(len);for(var i=0;i<len;++i){var resource=arguments[i];if(Disposer.isDisposer(resource)){var disposer=resource;resource=resource.promise();resource._setDisposable(disposer)}else{var maybePromise=tryConvertToPromise(resource);if(maybePromise instanceof Promise){resource=maybePromise._then(maybeUnwrapDisposer,null,null,{resources:resources,index:i},undefined)}}resources[i]=resource}var promise=Promise.settle(resources).then(inspectionMapper).then(function(vals){promise._pushContext();var ret;try{ret=fn.apply(undefined,vals)}finally{promise._popContext()}return ret})._then(disposerSuccess,disposerFail,undefined,resources,undefined);resources.promise=promise;return promise};Promise.prototype._setDisposable=function(disposer){this._bitField=this._bitField|262144;this._disposer=disposer};Promise.prototype._isDisposable=function(){return(this._bitField&262144)>0};Promise.prototype._getDisposer=function(){return this._disposer};Promise.prototype._unsetDisposable=function(){this._bitField=this._bitField&~262144;this._disposer=undefined};Promise.prototype.disposer=function(fn){if(typeof fn==="function"){return new FunctionDisposer(fn,this,createContext())}throw new TypeError}}},{"./errors.js":13,"./util.js":38}],38:[function(_dereq_,module,exports){"use strict";var es5=_dereq_("./es5.js");var canEvaluate=typeof navigator=="undefined";var haveGetters=function(){try{var o={};es5.defineProperty(o,"f",{get:function(){return 3}});return o.f===3}catch(e){return false}}();var errorObj={e:{}};var tryCatchTarget;function tryCatcher(){try{return tryCatchTarget.apply(this,arguments)}catch(e){errorObj.e=e;return errorObj}}function tryCatch(fn){tryCatchTarget=fn;return tryCatcher}var inherits=function(Child,Parent){var hasProp={}.hasOwnProperty;function T(){this.constructor=Child;this.constructor$=Parent;for(var propertyName in Parent.prototype){if(hasProp.call(Parent.prototype,propertyName)&&propertyName.charAt(propertyName.length-1)!=="$"){this[propertyName+"$"]=Parent.prototype[propertyName]}}}T.prototype=Parent.prototype;Child.prototype=new T;return Child.prototype};function isPrimitive(val){return val==null||val===true||val===false||typeof val==="string"||typeof val==="number"}function isObject(value){return!isPrimitive(value)}function maybeWrapAsError(maybeError){if(!isPrimitive(maybeError))return maybeError;return new Error(safeToString(maybeError))}function withAppended(target,appendee){var len=target.length;var ret=new Array(len+1);var i;for(i=0;i<len;++i){ret[i]=target[i]}ret[i]=appendee;return ret}function getDataPropertyOrDefault(obj,key,defaultValue){if(es5.isES5){var desc=Object.getOwnPropertyDescriptor(obj,key);if(desc!=null){return desc.get==null&&desc.set==null?desc.value:defaultValue}}else{return{}.hasOwnProperty.call(obj,key)?obj[key]:undefined}}function notEnumerableProp(obj,name,value){if(isPrimitive(obj))return obj;var descriptor={value:value,configurable:true,enumerable:false,writable:true};es5.defineProperty(obj,name,descriptor);return obj}var wrapsPrimitiveReceiver=function(){return this!=="string"}.call("string");function thrower(r){throw r}var inheritedDataKeys=function(){if(es5.isES5){var oProto=Object.prototype;var getKeys=Object.getOwnPropertyNames;return function(obj){var ret=[];var visitedKeys=Object.create(null);while(obj!=null&&obj!==oProto){var keys;try{keys=getKeys(obj)}catch(e){return ret}for(var i=0;i<keys.length;++i){var key=keys[i];if(visitedKeys[key])continue;visitedKeys[key]=true;var desc=Object.getOwnPropertyDescriptor(obj,key);if(desc!=null&&desc.get==null&&desc.set==null){ret.push(key)}}obj=es5.getPrototypeOf(obj)}return ret}}else{return function(obj){var ret=[];for(var key in obj){ret.push(key)}return ret}}}();var thisAssignmentPattern=/this\s*\.\s*\S+\s*=/;function isClass(fn){try{if(typeof fn==="function"){var keys=es5.names(fn.prototype);if(es5.isES5&&keys.length>1||keys.length>0&&!(keys.length===1&&keys[0]==="constructor")||thisAssignmentPattern.test(fn+"")){return true}}return false}catch(e){return false}}function toFastProperties(obj){function f(){}f.prototype=obj;var l=8;while(l--)new f;return obj;eval(obj)}var rident=/^[a-z$_][a-z$_0-9]*$/i;function isIdentifier(str){return rident.test(str)}function filledRange(count,prefix,suffix){var ret=new Array(count);for(var i=0;i<count;++i){ret[i]=prefix+i+suffix}return ret}function safeToString(obj){try{return obj+""}catch(e){return"[no string representation]"}}function markAsOriginatingFromRejection(e){try{notEnumerableProp(e,"isOperational",true)}catch(ignore){}}function originatesFromRejection(e){if(e==null)return false;return e instanceof Error["__BluebirdErrorTypes__"].OperationalError||e["isOperational"]===true}function canAttachTrace(obj){return obj instanceof Error&&es5.propertyIsWritable(obj,"stack")}var ensureErrorObject=function(){if(!("stack"in new Error)){return function(value){if(canAttachTrace(value))return value;try{throw new Error(safeToString(value))}catch(err){return err}}}else{return function(value){if(canAttachTrace(value))return value;return new Error(safeToString(value))}}}();function classString(obj){return{}.toString.call(obj)}function copyDescriptors(from,to,filter){var keys=es5.names(from);for(var i=0;i<keys.length;++i){var key=keys[i];if(filter(key)){es5.defineProperty(to,key,es5.getDescriptor(from,key))}}}function isNativeFunctionMethod(fn){return fn===fn.call||fn===fn.toString||fn===fn.bind||fn===fn.apply}var ret={isClass:isClass,isIdentifier:isIdentifier,inheritedDataKeys:inheritedDataKeys,getDataPropertyOrDefault:getDataPropertyOrDefault,thrower:thrower,isArray:es5.isArray,haveGetters:haveGetters,notEnumerableProp:notEnumerableProp,isPrimitive:isPrimitive,isObject:isObject,canEvaluate:canEvaluate,errorObj:errorObj,tryCatch:tryCatch,inherits:inherits,withAppended:withAppended,maybeWrapAsError:maybeWrapAsError,wrapsPrimitiveReceiver:wrapsPrimitiveReceiver,toFastProperties:toFastProperties,
filledRange:filledRange,toString:safeToString,canAttachTrace:canAttachTrace,ensureErrorObject:ensureErrorObject,originatesFromRejection:originatesFromRejection,markAsOriginatingFromRejection:markAsOriginatingFromRejection,classString:classString,copyDescriptors:copyDescriptors,hasDevTools:typeof chrome!=="undefined"&&chrome&&typeof chrome.loadTimes==="function",isNode:typeof process!=="undefined"&&classString(process).toLowerCase()==="[object process]"&&(!process.type||process.type==="browser"),isNativeFunctionMethod:isNativeFunctionMethod};ret.isRecentNode=ret.isNode&&function(){var version=process.versions.node.split(".").map(Number);return version[0]===0&&version[1]>10||version[0]>0}();try{throw new Error}catch(e){ret.lastLineError=e}module.exports=ret},{"./es5.js":14}],39:[function(_dereq_,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}throw TypeError('Uncaught, unspecified "error" event.')}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];handler.apply(this,args)}}else if(isObject(handler)){len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){var m;if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i=length;i-->0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners)}else{while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.listenerCount=function(emitter,type){var ret;if(!emitter._events||!emitter._events[type])ret=0;else if(isFunction(emitter._events[type]))ret=1;else ret=emitter._events[type].length;return ret};function isFunction(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}]},{},[4])(4)});if(typeof window!=="undefined"&&window!==null){window.P=window.Promise}else if(typeof self!=="undefined"&&self!==null){self.P=self.Promise}
