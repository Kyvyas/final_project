(function(){"use strict";window.TS={session_ms:Date.now(),dom_ready_ms:0,modules:{},boot_data:{},qs_args:{},pri:0,dom_ready:false,rtm_start_times:[],requireds:{view:{clearMessageInput:true,focusMessageInput:true,onMsgsDivClick:true}},logLoad:function(k){if(!window.logLoad){TS.log(88,k);return}window.logLoad(k)},reportLoad:function(i,type){if(!window.load_log||!window.load_log.length)return;if(!TS.model||!TS.model.team||TS.model.team.domain!="tinyspeck")return;if(TS.model.prefs&&!TS.model.prefs.seen_welcome_2)return;TS.dir(88,window.load_log);if(!TS.client||!TS.ims)return;type=type||"short";i=i||window.load_log.length-1;var total=window.load_log[i]["t"];var text="total time: "+total+"s (at index "+i+")";var report;var im;if(type=="complete"){report="TS.reportLoad("+i+", 'snippet')";TS.client.msg_pane.addMaybeClick(report,TS.reportLoad.bind(Object.create(null),i,"snippet"));text+="\n"+JSON.stringify(window.load_log,null,"	");text+="\n<javascript:"+report+")|share this with eric as a snippet>"}else if(type=="short"){report="TS.reportLoad("+i+", 'complete')";TS.client.msg_pane.addMaybeClick(report,TS.reportLoad.bind(Object.create(null),i,"complete"));text+=" <javascript:"+report+"|click for details>"}else if(type=="snippet"){text+="\n"+navigator.userAgent+"\n"+"version_ts: "+TS.boot_data.version_ts+"\n";"version_uid: "+TS.boot_data.version_uid+"\n";if(TS.storage&&TS.storage.storageAvailable){text+="TS.storage.storageAvailable: "+TS.storage.storageAvailable+"\n"+"TS.storage.storageSize(): "+TS.storage.storageSize()+"\n";text+="TS.storage.version: "+TS.storage.version+"\n"+"TS.storage._get('storage_version'): "+TS.storage._get("storage_version")+"\n"+"TS.storage.msgs_version: "+TS.storage.msgs_version+"\n"+"TS.storage._get('storage_msgs_version'): "+TS.storage._get("storage_msgs_version")+"\n";if(TS.model){text+="TS.model.initial_ui_state_str: "+TS.model.initial_ui_state_str+"\n"}}text+=JSON.stringify(window.load_log,null,"	");im=TS.ims.getImByUsername("eric");TS.files.upload({text:text,title:"load times "+TS.utility.date.toDate(TS.utility.date.makeTsStamp()),filetype:"javascript",channels:im?[im.id]:null,initial_comment:""});return}else{alert("type:"+type);return}var msg={type:"message",subtype:"bot_message",username:"loadBot",icons:{emoji:":rocket:"},is_ephemeral:true,ts:TS.utility.date.makeTsStamp(),text:text,no_notifications:true};im=TS.ims.getImByMemberId("USLACKBOT");if(im){TS.ims.addMsg(im.id,msg)}},delayed_module_loads:{},registerModule:function(name,ob,delayed){var may_export_test=typeof window.jasmine!=="undefined"||TS.boot_data.version_ts=="dev"&&TS.qs_args["export_test"];if(ob["test"]&&!may_export_test){delete ob["test"]}else if(typeof ob["test"]==="function"){var test_getter=ob["test"];Object.defineProperty(ob,"test",{get:test_getter})}if(TS.dom_ready){TS.error('module "'+name+'" must be registered on before dom ready');return}if(TS.modules[name]){TS.error('module "'+name+'" already exists');return}var parent_name;var sub_name;if(name.indexOf(".")!=-1){var parts=name.split(".");if(parts.length>2){TS.error('module "'+name+'" cannot be registered, as we only support a depth of one sub module right now');return}parent_name=parts[0];sub_name=parts[1];if(!sub_name){TS.error('module "'+name+'" cannot be registered because of a bad name');return}if(!TS.modules[parent_name]){if(delayed){TS.error('module "'+name+'" cannot be registered after delay; "'+parent_name+'" is not registered')}else{TS.delayed_module_loads[name]=ob}return}if(sub_name in TS.modules[parent_name]){TS.error('module "'+name+'" cannot be registered; "'+sub_name+'" already exists on "'+parent_name+'"');return}}if(TS.requireds[name]){var good=true;for(var k in TS.requireds[name]){if(!(k in ob)){TS.warn('all mudules registering as "'+name+'" must implement "'+k+'"');good=false}}if(!good){TS.error('module "'+name+'" does not implement all requireds');return}}if(parent_name){TS[parent_name][sub_name]=ob}else{TS[name]=ob}ob._name=name;TS.modules[name]=ob},makeLogDate:function(){if(window.TSMakeLogDate)return TSMakeLogDate();return"(TSMakeLogDate not loaded) "},shouldLog:function(pri){var A=String(TS.pri).split(",");if(A.indexOf("all")!=-1)return true;return A.indexOf(String(pri))!=-1},log:function(pri,txt){if(!window.console)return;if(pri){if(!TS.shouldLog(pri))return}if(typeof txt=="object"){console.log(txt)}else{console.log(TS.makeLogDate()+"[** "+pri+" **] "+txt)}},info:function(txt){if(!window.console||!console.info)return;console.info(TS.makeLogDate()+txt)},warn:function(txt){if(!window.console||!console.warn)return;console.warn(TS.makeLogDate()+txt)},dir:function(pri,ob,txt){if(!window.console||!console.dir)return;if(pri){if(!TS.shouldLog(pri))return}txt=txt||"";var dir_json=parseInt(TS.qs_args["dir_json"]);if(dir_json){var limit=dir_json==1?"2000":dir_json;try{var st=JSON.stringify(ob,null,"  ");if(st.length>limit)throw"too long";console.info(TS.makeLogDate()+"[** "+pri+" **] "+txt+" "+st);return}catch(err){if(err!="too long"){console.info(TS.makeLogDate()+"[** "+pri+" **] "+txt+" "+ob);return}}}try{var clone=TS.utility.clone(ob);console.info(TS.makeLogDate()+"[** "+pri+" **] "+txt+" ðŸ‘‡");console.dir(clone)}catch(err){TS.warn("could not dir ob:"+ob+" err:"+err)}},error:function(txt){if(!window.console||!console.error)return;console.error(TS.makeLogDate()+txt)},logError:function(e,desc){if(!window.Bugsnag||!window.Bugsnag.notifyException){if(window.console&&console.error)console.error(TS.makeLogDate()+"no Bugsnag.notifyException trying to log e:"+e+" e.stack:"+e.stack+" desc:"+desc);return}Bugsnag.notifyException(e,desc);if(window.console&&console.error)console.error(TS.makeLogDate()+"logging e:"+e+" e.stack:"+e.stack+" desc:"+desc)},reportLoadTiming:function(loggingKey){window.clearTimeout(_clientLoadWatchdogId);if(window.performance===undefined||window.performance.timing===undefined){return}var now=Date.now();var loadTime=now-window.performance.timing.navigationStart;TS.logDataToServer(loggingKey,loadTime)},logDataToServer:function(key,value){var team="";if(TS&&TS.model&&TS.model.team){team=TS.model.team.id}var xhr=new XMLHttpRequest;var url="/log204?k="+key+"&v="+value+"&t="+team;xhr.open("GET",url,true);xhr.send()},track:function(str){if(window.track){TS.info("tracking: "+str);window.track(str)}else{TS.warn('could not track "'+str+'" because there is no window.track')}},boot:function(boot_data){TS.logLoad("TS.boot");_clientLoadWatchdog();TS.boot_data=boot_data;TS.model.api_url=TS.boot_data.api_url;TS.model.async_api_url=TS.boot_data.async_api_url;TS.model.api_token=TS.boot_data.api_token;TS.model.webhook_url=TS.boot_data.webhook_url;TS.qs_args=TS.getQsArgs(location.search.substring(1));TS.pri=TS.qs_args.pri?TS.qs_args.pri+",0":TS.pri;TS.info("booted! pri:"+TS.pri);if(window.load_start_ms)TS.warn(Date.now()-window.load_start_ms+"ms from first html to TS.boot()");if(TS.boot_data.feature_fast_space_previews&&TS.web&&TS.web.space){TS.web.space.showFastPreview()}$(document).ready(TS.onDOMReady)},getQsArgs:function(qs){var args={};var pairs;pairs=qs.split("&");for(var i=0;i<pairs.length;i++){var p=pairs[i].indexOf("=");if(p!=-1){var name=pairs[i].substring(0,p);var value=pairs[i].substring(p+1);args[name]=unescape(value)}}return args},onDOMReady:function(){TS.dom_ready_ms=(new Date).getTime();TS.info("onDOMReady");TS.setUpCmdsThrottled=TS.utility.throttleFunc(TS.setUpCmds,3e3);if(TS.client&&window.WEB_SOCKET_USING_FLASH_BUT_NO_FLASH){TS.info("WEB_SOCKET_USING_FLASH_BUT_NO_FLASH");$("#loading_animation").addClass("hidden");$("#no_ws_and_bad_flash").css("display","inline");$("#loading_nag").css("display","none");return}if(TS.client){TSSSB.call("didStartLoading",3e4)}else{TS.info("no TS.client on page:"+document.location.href)}TS.logLoad("TS.onDOMReady");soundManager.setup({url:"/img/sm/",debugMode:false,preferFlash:false,onready:function(){}});var templates_load_ms=new Date;var templates_cb=TS.boot_data.version_ts=="dev"?templates_load_ms.getTime():TS.boot_data.version_ts;var templates_url="/templates.php?cb="+templates_cb+TS.appendQSArgsToUrl();var req=new XMLHttpRequest;var attempts=0;function loadTemplates(){return new Promise(function(resolve){attempts++;req.onreadystatechange=function(){if(req.readyState!=4)return;if(req.status!=200){var delay_ms=Math.min(1e3*attempts,1e4);TS.warn("loading "+templates_url+" failed (req.status:"+req.status+" attempts"+attempts+"), trying again in "+delay_ms+"ms");setTimeout(loadTemplates,delay_ms);return}req.onreadystatechange=null;var ms=Date.now()-templates_load_ms;TS.logLoad(templates_url+" is loaded (took "+ms+"ms), doing $('body').append(req.responseText)");$("body").append(req.responseText);TS.onTemplatesLoaded(resolve)};TS.logLoad("loading "+templates_url);req.open("GET",templates_url,1);req.send()})}var promises=[loadTemplates(),TS.setUpCmds(),TS.emoji.setUpEmoji()];if(TS.client||TS.web&&TS.web.space){promises.push(TS.callRTMStartInParallel())}if(TS.web&&TS.web.space&&!TS.boot_data.space_login_data){promises.push(_callDocumentsConnectInParallel())}Promise.all(promises).then(_allParallelCallsComplete)},onTemplatesLoaded:function(parallel_callback){TS.logLoad("onTemplatesLoaded(), calling TS.storage.onStart()");if(window.load_start_ms)TS.warn(new Date-window.load_start_ms+"ms from first html to calling onStarts()");TS.warn(new Date-TS.dom_ready_ms+"ms from dom ready to calling onStarts()");for(var name in TS.delayed_module_loads){TS.registerModule(name,TS.delayed_module_loads[name],true)}TS.storage.onStart(function(){TS.onStorageStart(parallel_callback)})},onStorageStart:function(parallel_callback){TS.logLoad("onStorageStart, calling other onStarts()");if(TS.boot_data.app=="client"){TS.client.onStart();TS.client.onStart=function(){}}else if(TS.boot_data.app=="web"||TS.boot_data.app=="mobile"||TS.boot_data.app=="space"){TS.web.onStart();TS.web.onStart=function(){}}else if(TS.boot_data.app=="test"){return}else{TS.error("WTF app? "+TS.boot_data.app);return}TS.ms.reconnect_requested_sig.add(_reconnectRequestedMS);TS.ds.reconnect_requested_sig.add(_reconnectRequestedDS);TS.ms.connected_sig.add(_socketConnectedMS);TS.ms.disconnected_sig.add(_socketDisconnectedMS);TS.ds.disconnected_sig.add(_socketDisconnectedDS);TS.callModuleMethod("onStart",true);TS.dom_ready=true;parallel_callback()},setUpCmds:function(){return new Promise(function(resolve){if(!TS.boot_data.page_needs_custom_cmds){return resolve()}TS.api.call("commands.list",{},function(ok,data,args){if(!ok||!data.commands){return resolve()}TS.cmd_handlers.mergeInServerCmds(data.commands);resolve()},true)})},setUpCmdsThrottled:$.noop,setUpModel:function(data){var first_time=!TS.model.ms_logged_in_once;TS.model.team=data.team;TS.model.bots_legacy=data.team.bots;TS.model.team.url=data.url;if(!TS.model.last_team_name){TS.model.last_team_name=TS.model.team.name;TS.model.last_team_domain=TS.model.team.domain}TS.model.team.activity=[];if(TS.model.break_token)TS.model.team.url+="f";if(TS.model.break_reconnections)TS.model.team.url=TS.model.team.url.replace("websocket","BUSTED");if(first_time){TS.model.bots=[];TS.model.members=[];TS.model.rooms=[];TS.model.channels=[];TS.model.ims=[];TS.model.groups=[];TS.model.mpims=[];TS.model.user_groups=[]}else{TS.refreshTeams()}TS.prefs.setPrefs(data.self.prefs);delete data.self.prefs;var i;var upsert;var bot;var member;var setModelUser=function(m){TS.model.user=m;TS.model.user.is_self=true};TS.members.suspend_cache_rebuilds=true;if(TS.boot_data.feature_web_cache_users){var users_cache=TS.storage.fetchMembers();for(i=0;i<users_cache.length;i++){member=users_cache[i];if(TS.utility.getObjectWithPropValueFromArray("id",member.id,data.updated_users))continue;member.presence=TS.utility.inArray(data.online_users,member.id)?"active":"away";upsert=TS.members.upsertAndSignal(member);if(upsert.member.id==data.self.id)setModelUser(upsert.member)}for(i=0;i<data.updated_users.length;i++){member=data.updated_users[i];member.presence=TS.utility.inArray(data.online_users,member.id)?"active":"away";upsert=TS.members.upsertAndSignal(member);if(upsert.member.id==data.self.id)setModelUser(upsert.member)}var bots_cache=TS.storage.fetchBots();for(i=0;i<bots_cache.length;i++){bot=bots_cache[i];if(TS.utility.getObjectWithPropValueFromArray("id",bot.id,data.updated_bots))continue;upsert=TS.bots.upsertAndSignal(bot)}for(i=0;i<data.updated_bots.length;i++){bot=data.updated_bots[i];TS.bots.upsertAndSignal(bot)}TS.info("TS.model.supports_user_caching:"+TS.model.supports_user_caching+"\n"+"members from LS:"+users_cache.length+", from updated_users in rtm.start:"+data.updated_users.length+" (slackbot will always be in updated_users)\n"+"bots from LS:"+bots_cache.length+", from updated_bots in rtm.start:"+data.updated_bots.length)}else{for(i=0;i<data.users.length;i++){member=data.users[i];upsert=TS.members.upsertAndSignal(member);if(upsert.member.id==data.self.id)setModelUser(upsert.member)}for(i=0;i<data.bots.length;i++){bot=data.bots[i];TS.bots.upsertAndSignal(bot)}}TS.members.upsertMember(data.self);TS.members.suspend_cache_rebuilds=false;TS.members.invalidateMembersUserCanSeeArrayCaches();TS.members.invalidateActiveMembersArrayCaches();if(TS.model.supports_user_caching){TS.members.maybeStoreMembers();TS.bots.maybeStoreBots();TS.storage.storeLastCacheTS(data.cache_ts)}TS.model.makeYouRegex();if(first_time||true){TS.prefs.setHighlightWords(TS.model.prefs.highlight_words)}if(TS.boot_data.feature_subteams&&data.subteams){data.subteams.all.forEach(function(user_group){TS.user_groups.upsertUserGroup(user_group)});data.subteams.self.forEach(function(user_group){TS.user_groups.upsertSelfUserGroup(user_group)})}var open_cnt=0;data.channels.forEach(function(channel){if(channel.is_member)open_cnt++});data.ims.forEach(function(im){if(im.is_open)open_cnt++});data.groups.forEach(function(group){if((TS.boot_data.feature_private_channels||group.is_open)&&!group.is_archived)open_cnt++});if(TS.boot_data.feature_mpim_client&&data.mpims){data.mpims.forEach(function(mpim){if(mpim.is_open&&!mpim.is_archived)open_cnt++})}if(TS.qs_args["api_count"]){TS.model.initial_msgs_cnt=parseInt(TS.qs_args["api_count"])||TS.model.initial_msgs_cnt}else if(open_cnt<10){TS.model.initial_msgs_cnt=200}else if(open_cnt<20){TS.model.initial_msgs_cnt=180}else if(open_cnt<30){TS.model.initial_msgs_cnt=160}else if(open_cnt<40){TS.model.initial_msgs_cnt=140}else if(open_cnt<50){TS.model.initial_msgs_cnt=120}else if(open_cnt<60){TS.model.initial_msgs_cnt=100}else if(open_cnt<70){TS.model.initial_msgs_cnt=80}else if(open_cnt<80){TS.model.initial_msgs_cnt=60}else if(open_cnt<90){TS.model.initial_msgs_cnt=50}else if(open_cnt<100){TS.model.initial_msgs_cnt=40}else{TS.model.initial_msgs_cnt=30}var max=TS.model.hard_msg_limit;TS.model.subsequent_msgs_cnt=Math.min(max,TS.model.initial_msgs_cnt*2);TS.model.special_initial_msgs_cnt=Math.min(max,TS.model.initial_msgs_cnt*2);TS.info("open channels/groups/ims:"+open_cnt+" initial_msgs_cnt:"+TS.model.initial_msgs_cnt+" subsequent_msgs_cnt:"+TS.model.subsequent_msgs_cnt+" special_initial_msgs_cnt:"+TS.model.special_initial_msgs_cnt);data.channels.forEach(function(channel){channel.all_read_this_session_once=false;TS.channels.upsertChannel(channel)});data.ims.forEach(function(im){im.all_read_this_session_once=false;TS.ims.upsertIm(im)});data.groups.forEach(function(group){group.all_read_this_session_once=false;TS.groups.upsertGroup(group)});if(TS.boot_data.feature_mpim_client&&data.mpims){data.mpims.forEach(function(mpim){mpim.all_read_this_session_once=false;TS.mpims.upsertMpim(mpim)})}},setThemeClasses:function(no_rebuild){$("body").removeClass("dense_theme light_theme");if(TS.model.prefs.theme=="dense"){$("body").addClass("dense_theme")}else if(TS.model.prefs.theme=="light"){$("body").addClass("light_theme")}else{TS.error("no theme?");return}if(TS.model.prefs.avatars){$("body").removeClass("no_avatars")}else{$("body").addClass("no_avatars")}if(TS.client&&!no_rebuild&&!TS.boot_data.feature_new_message_markup){if(TS.shared.getActiveModelOb()){TS.client.msg_pane.rebuildMsgs()}}},callModuleMethod:function(method_name,required){var name;var module;var A=[];for(name in TS.modules){module=TS.modules[name];A.push(module)}for(var i=0;i<A.length;i++){module=A[i];if(!(method_name in module)||typeof module[method_name]!="function"){if(required)TS.error('module:"'+module._name+'" does not have method:"'+method_name+'"');continue}TS.log(4,'calling "'+method_name+'" on "'+module._name);module[method_name]()}},getAllTeams:function(){if(!TS.boot_data)return null;if(!TS.model)return null;if(!TS.model.team)return null;if(!TS.model.user)return null;var A=[{id:TS.model.user.id,name:TS.model.user.name,team_id:TS.model.team.id,team_name:TS.model.team.name.replace(/ +/g," "),team_url:TS.boot_data.team_url}];if(TS.boot_data.other_accounts&&typeof TS.boot_data.other_accounts=="object"&&!TS.boot_data.other_accounts.length){for(var k in TS.boot_data.other_accounts){var team=TS.utility.clone(TS.boot_data.other_accounts[k]);team.id=k;team.team_name=team.team_name.replace(/ +/g," ");A.push(team)}}return A},getOtherAccountsCount:function(){var c=0;if(!TS.boot_data.other_accounts)return c;c=Object.keys(TS.boot_data.other_accounts).length;return c},refreshTeams:function(){if(!TS.boot_data)return;if(!TS.model)return;if(!TS.model.team)return;if(!TS.model.user)return;var url="/account-list-api";var req=new XMLHttpRequest;req.onreadystatechange=function(){if(req.readyState!=4)return;if(req.status!=200)return;req.onreadystatechange=null;if(req.responseText.indexOf("{")!==0)return;var data;try{data=JSON.parse(req.responseText);if(data.ok){TS.boot_data.other_accounts={};var c=0;for(var k in data.accounts){if(k==TS.model.user.id)continue;TS.boot_data.other_accounts[k]=data.accounts[k];c++}if(TSSSB.call("teamsUpdate",TS.getAllTeams())){TS.info("called TSSSB.call('teamsUpdate')")}if(TS.view&&!c){TS.view.updateTitleBarColor()}}else{}}catch(err){if(window.console&&console.warn&&console.error){console.warn("unable to do anything with refreshTeams rsp");console.error(err)}}};req.open("POST",url,1);req.setRequestHeader("Content-Type","application/x-www-form-urlencoded");req.send("token="+encodeURIComponent(TS.model.api_token))},qs_url_args:null,appendQSArgsToUrl:function(no_cache){if(!no_cache&&TS.qs_url_args!==null)return TS.qs_url_args;TS.qs_url_args="";for(var k in TS.qs_args){if(k=="export_test")continue;TS.qs_url_args+="&"+k+"="+TS.qs_args[k]}return TS.qs_url_args},ssbChromeClicked:function(on_button){if(on_button)return;$("html").trigger("mousedown");$(".modal-backdrop").trigger("click")},loginMS:function(){if(TS.model.ms_logged_in_once){var since_last_pong_ms=Date.now()-TS.ms.last_pong_time;if(since_last_pong_ms>1e3*60*5){if(TS.storage.cleanOutMsgStorageIfTooOld()){TS.info("going to call TS.reload() after a TS.storage.cleanOutMsgStorageIfTooOld() because since_last_pong_ms > 1000*60*5");TS.reload(null,"TS.reload() after a TS.storage.cleanOutMsgStorageIfTooOld() because since_last_pong_ms > 1000*60*5")}}}else{TS.storage.cleanOutMsgStorageIfTooOld()}if(TS.client&&TS.boot_data.login_data){var age_of_WS_url=Date.now()-TS.boot_data.start_ms;var limit=25e3;if(age_of_WS_url>limit){TS.info("forcing a call to rtm.start because the WS url is tool old at this point: "+age_of_WS_url+"ms");delete TS.boot_data.login_data;TS.warn(JSON.stringify(window.load_log,null,"	"));TSSSB.call("didStartLoading",3e4)}}var login_args=TS.getMSLoginArgs();if(TS.boot_data.login_data){TS.logLoad("login_with_boot_data");TS.ms.logConnectionFlow("login_with_boot_data");_onLoginMS(true,TS.boot_data.login_data,login_args);delete TS.boot_data.login_data}else if(_parallel_rtm_start_rsp){TS.ms.logConnectionFlow("login_with_parallel_rtm_start_rsp");TS.logLoad("login_with_parallel_rtm_start_rsp");_onLoginMS(_parallel_rtm_start_rsp.ok,_parallel_rtm_start_rsp.login_data,_parallel_rtm_start_rsp.login_args);_parallel_rtm_start_rsp=null}else{TS.callRTMStart(_onLoginMS)}},callRTMStartInParallel:function(){return new Promise(function(resolve){TS.callRTMStart(function(ok,data,args){_parallel_rtm_start_rsp={ok:ok,login_data:data,login_args:args};resolve()})})},callRTMStart:function(handler){TS.ms.logConnectionFlow("login");TS.logLoad("TS.callRTMStart");_ms_last_login_ms=Date.now();var setTimer=function(){clearTimeout(_ms_last_login_tim);_ms_last_login_tim=setTimeout(function(){clearTimeout(_ms_last_login_tim);TS.ms.logConnectionFlow("last_login_timeout");TS.ms.onFailure("15secs passed, no rtm.start preogress")},15e3)};setTimer();TS.model.rtm_start_throttler++;TS.api.callImmediately("rtm.start",TS.getMSLoginArgs(),handler,false,setTimer).then(function(resp){if(resp.data.latest_event_ts){TS.info("rtm.start included latest event timestamp: "+resp.data.latest_event_ts);TS.rtm_start_times.push(resp.data.latest_event_ts)}})},getMSLoginArgs:function(){var login_args={agent:"webapp_"+TS.boot_data.version_uid,login_ms:_ms_last_login_ms,simple_latest:true};if(TS.boot_data.feature_no_unread_counts){login_args.no_unreads=true}if(TS.boot_data.feature_web_cache_users){var cache_ts=TS.storage.fetchMembers().length&&TS.storage.fetchLastCacheTS()||0;login_args.cache_ts=cache_ts}if(TS.web){login_args.no_presence=true}if(TS.boot_data.feature_mpim_client){login_args.mpim_aware=true}if(TS.boot_data.feature_elide_closed_dms){login_args.only_relevant_ims=true}return login_args},reload:function(msg,ts_only_msg){if(msg){TS.info("TS.reload called msg:"+msg);TS.generic_dialog.start({title:"Reloading!",body:msg,show_cancel_button:false,esc_for_ok:true,on_go:function(){TS.reload()}});return}TS.info("TS.reload happening!");if(TS.client&&TSSSB.call("reload")){if(TS.model.mac_ssb_version){setInterval(function(){window.callSlackAPIUnauthed("api.test",{},function(ok,data,args){if(ok){window.location.reload()}})},1e3)}}else{window.location.reload()}},sleepMS:function(){if(TS.model.ms_asleep)return;if(!TS.model.ms_connected)return;TS.model.ms_asleep=true;TS.ms.disconnect()},wakeMS:function(){if(!TS.model.ms_asleep)return;TS.model.ms_asleep=false;TS.ms.startReconnection()},sleepDS:function(){if(TS.model.ds_asleep)return;if(!TS.model.ds_connected)return;TS.model.ds_asleep=true;TS.ds.disconnect()},wakeDS:function(){if(!TS.model.ds_asleep)return;TS.model.ds_asleep=false;TS.ds.startReconnection()}};var _ms_last_login_tim=0;var _ms_last_login_ms=0;var _reconnectRequestedMS=function(){if(TS.model.ms_asleep){TS.error("NOT reconnecting, we are asleep");return}TS.loginMS()};var _onLoginMS=function(ok,data,args){clearTimeout(_ms_last_login_tim);if(_ms_last_login_ms!=args.login_ms){TS.warn("ignoring this rtm.start rsp, it came too late: _ms_last_login_ms ("+_ms_last_login_ms+") != args.login_ms ("+args.login_ms+")");return}if(TS.boot_data.feature_latest_event_ts){if(!TS.model.ms_logged_in_once&&!TS.storage.fetchLastEventTS()&&data.latest_event_ts){TS.ms.connected_sig.addOnce(function(){TS.ms.storeLastEventTS(data.latest_event_ts)})}}if(TS.client){if(TS.model.ms_logged_in_once&&data.min_version_ts){if(TS.boot_data.version_ts=="dev"){}else{if(parseInt(TS.boot_data.version_ts)<parseInt(data.min_version_ts)){TS.info("calling TS.reload() because parseInt(TS.boot_data.version_ts) < parseInt(data.min_version_ts)");TS.reload(null,"calling TS.reload() because parseInt(TS.boot_data.version_ts) < parseInt(data.min_version_ts)");return}}}if(TS.model.ms_logged_in_once&&data.cache_version){if(data.cache_version!=TS.storage.msgs_version){TS.reload(null,"TS.reload() because data.cache_version "+data.cache_version+" != TS.storage.msgs_version "+TS.storage.msgs_version);return}}if(TS.model.ms_logged_in_once&&data.cache_ts_version){if(data.cache_ts_version!=TS.storage.cache_ts_version){TS.reload(null,"TS.reload() because data.cache_ts_version "+data.cache_ts_version+" != TS.storage.cache_ts_version "+TS.storage.cache_ts_version);return}}}if(!ok){if(data&&(data.error=="account_inactive"||data.error=="team_disabled"||data.error=="invalid_auth")){TSSSB.call("invalidateAuth");TS.info("calling TS.reload() because data.error: "+data.error);TS.reload(null,"calling TS.reload() because data.error: "+data.error);return}TS.ms.logConnectionFlow("on_login_failure");TS.ms.onFailure("API rtm.start rsp was no good: "+(data&&data.error?"data.error:"+data.error:"unspecified error"));return}if(!data.self){TS.error("No self?");return}if(!data.team){TS.error("No team?");return}TS.ms.logConnectionFlow("on_login");TS.setUpModel(data);TS.setThemeClasses();if(TS.client){TSSSB.call("setCurrentTeam",TS.model.team.domain);TS.client.updateTeamIcon();if(Object.keys(TS.model.emoji_use).length===0){TS.log(888,"kicking off emoji_use filling because it is empty");TS.utility.callFuncWhenApiQisEmpty(TS.utility.msgs.populateEmojiUsePrefFromExistingMsgs)}}var completeOnLogin=function(){if(!TS.model.ms_logged_in_once){if(TS.client){TS.client.onFirstLoginMS(data)}if(TS.web){TS.web.onFirstLoginMS(data);if(!TS.boot_data.page_has_ms){if(TS.web.space){_loginDS()}}}}if(TS.client)TS.client.onEveryLoginMS(data);if(TS.web)TS.web.onEveryLoginMS(data);if(TS.client||TS.web&&TS.boot_data.page_has_ms){TS.ms.connect()}TS.model.ms_logged_in_once=true};TS.emoji.maybePreloadSheet(completeOnLogin)};var _socketConnectedMS=function(){if(!TS.boot_data.page_has_ms)return;if(!TS.web)return;if(!TS.web.space)return;_reconnectRequestedDS()};var _socketDisconnectedMS=function(){if(!TS.boot_data.page_has_ms)return;if(!TS.web)return;if(!TS.web.space)return;TS.ds.disconnect()};var _ds_last_login_tim=0;var _ds_last_login_ms=0;var _parallel_rtm_start_rsp;var _parallel_documents_connect_rsp;var _allParallelCallsComplete=function(){TS.logLoad("_allParallelCallsComplete(), calling gogogos");if(TS.client){TSSSB.call("didStartLoading",6e4)}if(window.macgap){window.addEventListener("sleep",function(){TS.info("sleep event!");if(TS.client)TS.sleepMS();if(TS.web&&TS.web.space)TS.sleepDS()},false);window.addEventListener("wake",function(){TS.info("wake event!");if(TS.client)TS.wakeMS();if(TS.web)TS.wakeDS()},false)}TS.ui.setUpWindowUnloadHandlers();if(TS.boot_data.app=="client"){TS.client.gogogo()}else if(TS.boot_data.app=="web"||TS.boot_data.app=="mobile"||TS.boot_data.app=="space"){TS.web.gogogo()}if(TS.boot_data.login_data||TS.client||TS.web&&TS.web.space){TS.loginMS()}else{TS.info("running without a user")}};TS.allParallelCallsLoaded=_allParallelCallsComplete;var _reconnectRequestedDS=function(){if(TS.model.ds_asleep){TS.error("NOT reconnecting, we are asleep");return}if(TS.boot_data.page_has_ms){if(TS.model.ms_connected){_loginDS()}}else{_loginDS()}};var _getDSLoginArgs=function(){var login_args={agent:"webapp_"+TS.boot_data.version_uid,login_ms:_ds_last_login_ms};login_args.file=boot_data.file.id;return login_args};var _callDocumentsConnectInParallel=function(){return Promise(function(resolve){_callDocumentsConnect(function(ok,data,args){_parallel_documents_connect_rsp={ok:ok,login_data:data,login_args:args};resolve()})})};var _callDocumentsConnect=function(handler){TS.ds.logConnectionFlow("_loginDS");TS.logLoad("TS._callDocumentsConnect");clearTimeout(_ds_last_login_tim);_ds_last_login_tim=setTimeout(function(){clearTimeout(_ds_last_login_tim);TS.ds.logConnectionFlow("last_login_timeout");TS.ds.onFailure("15secs passed, no files.documents.connect rsp")},15e3);TS.model.rtd_start_throttler++;TS.api.callImmediately("files.documents.connect",_getDSLoginArgs(),handler)};var _loginDS=function(){TS.info("_loginDS");_ds_last_login_ms=Date.now();var login_args=_getDSLoginArgs();if(TS.boot_data.space_login_data){TS.logLoad("ds_login_with_boot_data");TS.ds.logConnectionFlow("login_with_boot_data");_onLoginDS(true,{data:TS.boot_data.space_login_data},login_args);delete TS.boot_data.space_login_data}else if(_parallel_documents_connect_rsp){TS.ms.logConnectionFlow("login_with_parallel_documents_connect_rsp");TS.logLoad("login_with_parallel_documents_connect_rsp");_onLoginDS(_parallel_documents_connect_rsp.ok,_parallel_documents_connect_rsp.login_data,_parallel_documents_connect_rsp.login_args);_parallel_documents_connect_rsp=null}else{_callDocumentsConnect(_onLoginDS)}};var _onLoginDS=function(ok,data,args){clearTimeout(_ds_last_login_tim);if(_ds_last_login_ms!=args.login_ms){TS.warn("ignoring this files.documents.connect rsp, it came too late (_ds_last_login_ms != args.login_ms)");return}if(!ok){if(data&&(data.error=="account_inactive"||data.error=="team_disabled"||data.error=="invalid_auth")){alert("_onLoginDS data.error: "+data.error);return}TS.ds.logConnectionFlow("on_login_failure");TS.ds.onFailure("API files.documents.connect rsp was no good: "+(data&&data.error?"data.error:"+data.error:"unspecified error"));return}if(!data.data){TS.error("No data.data?");return}if(!data.data.ws){TS.error("No ws url?");TS.ds.logConnectionFlow("on_login_missing_ws");TS.ds.onFailure("no ws url in response to a documents.connectUser call, calling api again now.");return}TS.web.space.login_data=data.data;TS.ds.logConnectionFlow("on_login");if(!TS.model.ds_logged_in_once){TS.logLoad("_onLoginDS first time");TS.reportLoad();TS.reportLoadTiming("timing-spaces-perceived-load")}if(!TS.model.ds_logged_in_once){if(window.load_start_ms)TS.warn(new Date-window.load_start_ms+"ms from first html to ds_login_sig.dispatch()");TS.web.ds_login_sig.dispatch()}TS.ds.connect();TS.model.ds_logged_in_once=true};var _socketDisconnectedDS=function(){if(!TS.boot_data.page_has_ms)return;TS.ms.disconnect()};var _clientLoadWatchdogId=null;var _clientLoadWatchdogTimeout=1e4;var _clientLoadWatchdog=function(){if(window.location.pathname.indexOf("/messages")!==0){return}if(_clientLoadWatchdogId!==null){TS.logDataToServer("www-load-watchdog-v2",_clientLoadWatchdogTimeout);_clientLoadWatchdogTimeout*=2}if(_clientLoadWatchdogTimeout<3e5){_clientLoadWatchdogId=window.setTimeout(_clientLoadWatchdog,_clientLoadWatchdogTimeout)}}})();(function(){"use strict";TS.registerModule("timing",{onStart:function(){var noise_ms=Math.floor(Math.random()*_INTERVAL_DURATION_NOISE_MS);setInterval(_beaconDataAndEmptyQueue,_INTERVAL_DURATION_MS+noise_ms);$(window).on("beforeunload",_cleanUp)},mark:function(mark_label){performance.mark(mark_label)},getLatestMark:function(mark_label){var items=performance.getEntriesByName(mark_label);if(items.length===0)return false;return items[items.length-1]},clearMarks:function(mark_label){performance.clearMarks(mark_label)},measure:function(measure_label,start_mark_label,end_mark_label,options){if(start_mark_label==="start_nav"){if(!performance.timing)return;return TS.timing.store(measure_label,(new Date).getTime()-performance.timing.navigationStart,options)}if(!end_mark_label){end_mark_label=start_mark_label+"_end";performance.mark(end_mark_label)}try{performance.measure(measure_label,start_mark_label,end_mark_label)}catch(e){TS.warn("Couldn't complete TS.timing measurement for start mark \""+start_mark_label+'"');return}var measures=performance.getEntriesByName(measure_label);if(measures.length===0)return;var duration=measures[0].duration;duration=TS.timing.store(measure_label,duration,options);performance.clearMeasures(measure_label);return duration},store:function(label,value,options){if(!options)options={};var unit;if(value>0){if(options.in_seconds){value=_convertMillisecondsToSeconds(value);unit=" seconds"}else if(options.is_count){value=Math.round(value);unit=" (count)"}else{value=_roundToThree(value);unit="ms"}if(!options.ephemeral){if(!_measures[label])_measures[label]=[];_measures[label].push(value)}if(_shouldLog(label))TS.info("[TIMING] "+label+": "+value+unit)}return value},flush:function(){_beaconDataAndEmptyQueue()},test:function(){return{createBeaconURL:_createBeaconURL,getMeasures:function(){return _measures},reset:function(){performance.clearMarks();performance.clearMeasures();_measures={}}}}});var _INTERVAL_DURATION_MS=25*1e3;var _INTERVAL_DURATION_NOISE_MS=10*1e3;var _measures={};var _cleanUp=function(e){if(TS.client&&TS.timing.getLatestMark("start_load"))TS.timing.measure("session_lifespan","start_load",null,{in_seconds:true});_beaconDataAndEmptyQueue()};var _beaconDataAndEmptyQueue=function(){
if(Object.keys(_measures).length===0)return;if(performance.memory&&performance.memory.usedJSHeapSize)_measures["used_js_heap_size"]=[_convertBytesToMegabytes(performance.memory.usedJSHeapSize)];var beacon_url=_createBeaconURL(_measures);var beacon=new Image;beacon.src=beacon_url;performance.clearMeasures();_measures={}};var _createBeaconURL=function(measures){var label;var beacon_data={team_id:TS.model.team.id,team_size:TS.model.members.length,ver:TS.boot_data.version_ts,session_age:0,data:[]};var beacon_url;if(TS.client&&TS.timing.getLatestMark("start_load")){beacon_data.session_age=TS.timing.measure("session_age","start_load",null,{ephemeral:true,in_seconds:true})}for(label in measures){if(!measures.hasOwnProperty(label))continue;beacon_data.data.push(label+":"+measures[label].join(","))}if(beacon_data.data.length===0)return"";beacon_data.data=beacon_data.data.join(";");beacon_url=TS.boot_data.beacon_timing_url+"?"+_serialize(beacon_data);return beacon_url};var _shouldLog=function(label){return TS.qs_args.log_timings||TS.timing.log===true||TS.timing.log===label||TS.timing.log instanceof Array&&TS.timing.log.indexOf(label)!==-1};var _serialize=function(obj){var str=[];for(var p in obj){if(obj.hasOwnProperty(p))str.push(encodeURIComponent(p)+"="+encodeURIComponent(obj[p]))}return str.join("&")};var _roundToThree=function(num){return+(Math.round(num+"e+3")+"e-3")};var _convertBytesToMegabytes=function(bytes){return _roundToThree(bytes/1024/1024)};var _convertMillisecondsToSeconds=function(ms){return Math.round(ms/1e3)}})();(function(){"use strict";TS.registerModule("model",{api_url:"",api_token:"",async_api_url:"",webhook_url:"",user:null,team:null,ims:null,channels:null,groups:null,mpims:null,members:null,rooms:null,bots:null,user_groups:null,files:[],requested_im_opens:{},requested_group_opens:{},requested_mpim_opens:{},requested_channel_joins:{},created_channels:{},created_groups:{},archives_and_recreated_groups:{},last_team_name:"",last_team_domain:"",unsent_msgs:{},display_unsent_msgs:{},inline_img_byte_limit:2097152,inline_img_pixel_limit:7360*4912,code_wrap_long_lines:true,last_reads_set_by_client:{},ms_asleep:false,ms_connected:false,ms_connecting:false,ms_logged_in_once:false,ds_asleep:false,ds_connected:false,ds_connecting:false,ds_logged_in_once:false,window_unloading:false,active_cid:null,last_active_cid:null,active_group_id:null,active_channel_id:null,active_im_id:null,active_mpim_id:null,active_history:[],all_custom_emoji:[],user_hiddens:[],user_colors:null,at_channel_suppressed_channels:null,push_at_channel_suppressed_channels:null,loud_channels:null,never_channels:null,loud_channels_set:null,push_loud_channels:null,push_mention_channels:null,push_loud_channels_set:null,muted_channels:null,highlight_words:null,highlight_words_regex:null,everyone_regex:/<!everyone\b/,channel_regex:/<!channel\b/,group_regex:/<!group\b/,here_regex:/<!here\b/,you_regex:null,your_user_group_regex:{},inline_attachments:{},inline_imgs:{},inline_img_exclude_filetypes:["gdoc","gsheet","gpres","gdraw"],inline_videos:{},inline_others:{},inline_audios:{},expandable_state:{},break_token:false,break_reconnections:false,ms_reconnect_ms:0,ms_reconnect_time:0,rtm_start_throttler:0,ds_reconnect_ms:0,ds_reconnect_time:0,rtd_start_throttler:0,initial_msgs_cnt:50,subsequent_msgs_cnt:100,special_initial_msgs_cnt:100,hard_msg_limit:500,input_maxlength:4e3,all_unread_cnt:0,all_unread_highlights_cnt:0,c_name_in_url:"",flex_name_in_url:"",flex_extra_in_url:"",flex_names:["activity","files","team","search","stars","mentions","details"],default_flex_name:"files",prefs:null,ui_state:null,input_history:null,input_history_index:-1,last_net_send:0,previewed_file_id:null,last_previewed_file_id:null,previewed_member_name:null,previewed_member_id:null,last_previewed_member_id:null,previewed_user_group_id:null,last_previewed_user_group_id:null,channel_name_max_length:21,channel_purpose_max_length:250,channel_topic_max_length:250,upload_file_size_limit_bytes:1073741824,msg_activity_interval:5,msg_preview_showing:false,dialog_is_showing:false,archive_view_is_showing:false,menu_is_showing:false,overlay_is_showing:false,seen_onboarding_this_session:false,seen_welcome_2:false,showing_welcome_2:false,cancelled_welcome_2_this_session:false,show_inline_img_size_pref_reminder:false,shown_inline_img_size_pref_reminder_once:false,collapse_trigger_w:30,last_key_down_e:null,is_retina:false,group_prefix:"",allow_invite_to_group_from_person:false,ms_conn_log:[],ds_conn_log:[],is_iOS:navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?true:false,is_FF:navigator.userAgent.match(/(Firefox)/g)?true:false,is_chrome:navigator.userAgent.match(/(Chrome)/g)?true:false,is_safari_desktop:navigator.userAgent.match(/(Safari)/g)&&!navigator.userAgent.match(/(Chrome)/g)&&navigator.userAgent.match(/(OS X)/g)&&!navigator.userAgent.match(/(iPhone)/g)&&!navigator.userAgent.match(/(iPad)/g)?true:false,is_apple_webkit:false,is_mac:navigator.userAgent.match(/(OS X)/g)?true:false,is_mac_10_6:navigator.userAgent.match(/(OS X 10_6)/g)?true:false,is_win:navigator.appVersion.indexOf("Windows")!==-1,is_win_7_plus:function(ua){var matches=ua.match(/Windows NT ([0-9]+\.[0-9]+);/);if(!matches||matches.length<2)return false;return parseInt(matches[1])>=6}(navigator.userAgent),is_lin:navigator.appVersion.indexOf("Linux")!==-1,is_our_app:navigator.userAgent.match(/(Slack)/g)?true:false,mac_ssb_version:TSSSB.env.mac_ssb_version,mac_ssb_version_minor:TSSSB.env.mac_ssb_version_minor,win_ssb_version:TSSSB.env.win_ssb_version,win_ssb_version_minor:TSSSB.env.win_ssb_version_minor,lin_ssb_version:TSSSB.env.lin_ssb_version,lin_ssb_version_minor:TSSSB.env.lin_ssb_version_minor,supports_downloads:false,supports_spaces_in_windows:false,supports_sticky_position:false,supports_growl_subtitle:false,supports_line_clamp:false,supports_voice_calls:false,supports_user_caching:false,active_file_list_filter:"all",active_file_list_member_filter:"all",file_list_types:null,shift_key_pressed:false,insert_key_pressed:false,alt_key_pressed:false,join_leave_subtypes:["channel_leave","channel_join","group_leave","group_join"],file_list_type_map:{all:"All File Types",posts:"Posts",spaces:"Posts",snippets:"Snippets",emails:"Emails",images:"Images",pdfs:"PDF Files",gdocs:"Google Docs"},marked_reasons:{viewed:"viewed",left:"left",esc:"esc",esc_all:"esc_all",closed:"closed",muted:"muted",back:"back",sent:"sent",clicked:"clicked",deleted:"deleted",none_qualify:"none_qualify"},default_rxns:["simple_smile","thumbsup","white_check_mark","heart","eyes"],welcome_model_ob:{},change_channels_when_offline:true,ampersands_are_inconsistent_in_from_urls:true,ui:{cached_file_preview_scroller_rect:null,cached_msgs_scroller_rect:null,cached_msgs_scroll_result:null,cached_search_scroller_rect:null,cached_channels_scroller_rect:null,cached_archives_scroller_rect:null,cached_archive_scroll_result:null,is_window_focused:document.hasFocus&&document.hasFocus()&&window.macgap_is_in_active_space?true:false,msgs_are_auto_scrolling:false,is_mouse_down:false,last_flex_extra:null,active_tab_id:null,active_tab_ts:null,is_collapsible:false,is_collapsed:false,was_just_collapsed:false,collapse_moves_whole:true,debug_channel_lists:true,collapsible_ms:100,last_top_msg:null},client:{reads:[],last_user_active_timestamp:new Date},data_urls:{app_icon_32px_green:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2lJREFUeNqMVk1vGkEMndmu4MLmkOWQoCqkh0APqAdUVNpKiXLux/+tFKlSDlEitcm15RI4BBBiucCFjdDUs571eL1L1EEC450d28/P9ujvH7+qbBljFFtaa9SgAN9ij9Xnb/LNdBrKIUn0rNKGKi1vvkpPQqi0syYiIBvlN7lt2kM7C6ErE2gr6BfcpCXO4mg4AURlCg6ZHCIrGuk1Kckp/q20P13u1NknW4E7VMkAreE8ONTLEA0Lpep0jDvgSReZIGRQbkSNuBnT0+ggOowP0X3uB0cC1qvu6453Te8lT3/Qv7i8SLfpbDrDN4efh4MPg91ut1gsMBprqYSEY1EledA1fNo+bcN3kiS0HzVgz7pMwGrJhRBs5glS+EuVQbkDZKIoAmHyOEEP2m/s6WmaJsnKRZ5XoijJkIrAWtKG8sP5dNw6ds46Puhmswni+HFsmclKnZe9M0BmiXD4uFavdbod3ERC713PRZDhA2GhJlkmmBuOj0vkt+EXbhl5BnY6bzvDT0P1f+v25nb0Z8SZ6rikMwO51gcGf8G7xkEDNtRqtfPLc1Be/7zebreYkv77PghXP65g5ypZWT3RP3ufjIWeOb6A7LPNZrNerymfIE/GE4wSKgAZNX2aenIrhwF5jzZCOpg3Ly4jf1bIlozsWF+zpxmxQ+liN81UWBaBMrIjOhpoZwkpBGl0hW0U1vNmvXGFooycHMbHFJY7OO4jwqAB6BOkieMYM9GrW818Oge4CuzUDCIqcW4GDsU00iKm0jrrnqFw/+t+uVxyHhZA9jRlZuAvOg5wgyXI8N3NHb55cnoCxgCxh98P6A1gBR/uIkc7LGQ4xx0WFA4lAEAAwuA76Ph85jR82ogJmje7whD37RBfOGodYYaJ4GgSMKFZW25BHiiVzwMaOx47KLF6DfPpupAxkFioO99Eiye6GhYRFEZYcdi2Wi0sMYCYJwYCek6fOdC+GRt5zQmlC8wSdGNgiG3RxlX46O8ITfojlBHDkuLwzU7cscr1LLqhd5y3hfK8Iogq7lLZ8jZK9zU+9co3KK4P+LnCca9nG8T9RedLXBL8tUUMIGwvojXtc99dthiqLnoWViADNHvvAGL2uROVFtcykZjwhZdFcAJc6TjbwTEM3QAq3lP40VSThRxU3U0rgf0nwADpJQebhAz3/AAAAABJRU5ErkJggg==",app_icon_32px_green_unreads:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4JJREFUeNqMVj1MFEEUntlsx1FzQgmXnI13JGA0XIWJmvgTEzAxBhXbw0Rjg4VWamFLIjWGUkwgFoIFNkAhJN5VHGEpMVBz1OPbfW/evJldyc1d9t7Nzrzf7/3o+9fvqmwZY5RYWmvcQQKewZl0396Uh5kb0jFT/K5QhsotJ75on4lYaZIWWMAy8jelbD7DJz3TlYl0SugL1OQV8JLeIAJIZTyFjHVRSppQa95kpeRTacc9PKmzT7YiYqpCA1PB1jjcD000wpQi7mh3JIMeRII9k8eYp4oyUg/pCVix5zJdAFAg+kp98x/f1Mbr3bPu45uPkN3aznd4tndb716+ZT+z7nw3QhTltaMLGa+JGw3gjuzw/JWxGp7s6y+lKiM7Gwp2XWoByLQBUvjLmcEXRqojyK4FArIzvNPea1G8tZZ3WemYzUklaWejxFNtrE7sMgvg05hskMjfLSVSXaY9CQhcJiMGXAYGB4AoD5VxZ2KygRYPWwtGqpVKtQI735ZXgiyhQN67dkdKplAbNf3k4dPmM9XbSjrJ6+evJFIJSzrLA7trI5N5CXXvcW1vbiltPSrSIs0VsCBwnKEkpUjMzb+49eA2EIufPq+v/oBjUzPTaNyXxSXwDOqbL7pUTW0KK1m8JM3uTg4SxG5tnDB6+veUqoBWQT5hqOAZKRNWRFIkMxlSjBGZ7B8i2J3IziGKDDsHwT79G+crOPG9XIG/jnsnwVwr9Zfgi5vloUvwPeokkOEeOrVIWOhoaIvMZ+D1fuFDjxHm+uFSSjg5MlzDtSvUAO3eIXRyfBIEkksnJZos8Sh8ZfkrhBSI2eYsehwAc3RwBMTUzBT6CvDT3mvDmfOzrqxCxu+Asd/EDQOitftHxnNjdb3bPYdLzfk5wv6vrWQ/8Qq1bNS2vsZeERWRAHq4OsxOAEdjhMuDZQuqpKCRcA5bvMZeC/ObbX181CuZWtevjrqq52tNrHMZF8ms81ouVIuhAcYoZjjXD6jbdIUbgHEhlO06LmxhqALwPTleAv9AqcFXP9c20Hs7m9uyqJFOHGqR2Ronu8KZR3g21bZwCAumIzEREPqjoDbJHHH7/3EjR5hfSYy4RPPGN+VyJGh+8qScnaQRqB/PWPA3Cg00xTOAlOFxVDoYyyRS0yBfcDkwzjk3531vBDZezYjxV1nMkY2y//DMI2NQNJsWOvafAAMAxE3MJSrFyPAAAAAASUVORK5CYII=",app_icon_32px_green_mentions:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABExJREFUeNqkVktsG0UYnpl9OF6/4JDYaWirNrFIgTbvNEilByS4FHogQeJQoCcOidQjiF6LBGcEnIs4cABBKZeUQw+IQkUicFDVJo0TJ0gtSW2paWLHr90d/t2ZnZ11TBubie3Mzu7+3//9b3z2xdeQuyilKLhMy6yb8KmVq+VLPT0j0RhqfakgF2MMO/YrlnfOYa098PsFQJjLamBA3SVQdyyrPQCCHdWbMJCx4PtPrdYmA64+osgjIJA4MMKEkFy10iYDLgv5QoWtYA+i4Qc+i+Xy/wJgPBo9QZ0PcWHyprVU3m3LyZJXGQ0B46huExAfiUSmzk2VCg/R3VzrDHCTDGBsYKMQomAyOjH63InnN48e3ia4nSjypLJ48fHYLeDR198XiUY6nk5cteotA/iJxv48T7gWc6yvEGVodCgWi8UT8av37y+36AlVeJgpDtEqwvTUy6e6urtM0zx45NDWw61EIv7C8MB3j7YvVMwwwi07WbiXZcTU22++M/0uXAFAtVI1IkY8kXjjrcnNjc3fF7On/7qD6b4BuPpSPgNG8kCSPQEm0jTNMAxAqtfr8M2nj96s1k4urZJ9FCj8+sQZBiAsQxHnz4w2/f7MK2dfrdVqn3/y2eyPs6ZVP/nSxND4sLq6NvLHrfiTbEXEA9Rb2NszQn3H0uBqILGeW9cUVVXUkfGRzmQnerbv43plfmf7SSZyFRYkRBF1vI0wRCfEKJwAxtrdHPyqSD0+fBxMpev631vbF/P5gXD4vVR3Omw8LorkngPSHbnH0nAJ0tlJdjE7MDYIJx1GONWdKpV29ZD+zKGDncmulbX1mdzqoGGMRaKnE08ldT3gA+hoTFk5n0HWpU8/aqza7rJtm8VVpVIpl3aLpVLhQeHihQ/h3LJNeKBH06KKciQUUjGGa5XLxTzT2GW6P90kHljxUBSnymKiqqquaaFwR2Gz0KGHbGpblgYK5Kn9wLRzZpnFixpoyJ4zvv3qm+xSFjbnp8/3ulb68ovLK0srsJk8N3lidABr+MrX3y/ML0DfLj7a0VTNIUdseMB2Mwl7MtVAlrm2YpeZuT9BASYd1rUrs8ViCV6a/mCGUbn582/Lt5eZQhBaTEvgwaIGds4tTIOZLHkC9r39vWy/cW+juFOETTQWTR1IcbffyTIkpylRN/wwJRD3DIBwk6h+FdozXgyODbHNwnyGnQ+OeydzGT/tRfOgvPo6ogi/RURoikcFiWQPrxYQo8xjon5k5jKiqPDXpXxiZvZ94LewIBuQu3HvMtjnxvVf2K2ffrjGrPfr9RtckNxCvNEBS/UDs8lOToK9eIiPYLTpfNYwi3gFjY8pBAXflPu+f/4fZhSjgrjV0A0DHU0gixdkiXIUyPpSRGUSckfhg08jQdp8BpAxAhIRlj0n93Ze7B7zcgM537h7rO8mqTxp+jZU2X/kxZxcsQPAXq/2WneAVmDUDBr2XwEGADZFpKJDFtSPAAAAAElFTkSuQmCC",app_icon_32px_yellow:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA6VJREFUeNp8Vr1PVEEQn3m+Ais+TOQ4TCCeARMxRyESC6EwkUIDpf530kqnJVZqZayMFBI5wpGAYMEdDZzR3Dqzszs7b+9gL7k3b97sfP5mdnH9yUvwyzkHZiGicISg/0yG+XGnFVZtQpdK6behNmBgJfPD+EqUgMFaFoHaGNxpbauMSlZCB1cgE3iNm7oyXTYbgSASXMUhF1PEpMu9VqY6Zf8Bk/ZcEv3PryIohTxANhyDE34eojOhDNMucRe26FklNDNCj4/CdC3pnxjD+mRw3/phM0HrxvydueQaXgmetVX3eqPf60GrLRtxY63/4pn7+w8Oj1CiYUsDmQgoGgoecU2+Lswz/+gEVN5zcL/tXdbEYo6FkmzGAoE8tTO0dpSZ8TEmdnaDgwvz/HrZg6NT3ib67F51ukiNJr9YCV+usO7OsHTrAAMeEKdrrHfnB2uCak9k+SjVrAJO7N0cgaVmwPXjZqjP02XnI+5LxibGiMM5o9S12i7rkliDgdkgSh/eh+erfUi5w8asa8yC0ML3HH59t42ttnE0ZpuI0uAXbXl/HsCbLepzDuXVOou/fV9cXPKueo1AxbY3tyjD8Os3Xlya5mKkpimZIsDUQPytew6drov1xE6XKyw+3hpn/vEJ7h3ITielCc0EaVzQW6mKhxaKaI8f59ESwD51m01STsIkT3Mg6vEsaYtCuzzlR3CFYf89zjtSGQO0XOjns25sFHD5yRFgH1OUTXCRW1kmMU50w2N0YhQJQiJWr3EE9RqujPAm6u3jU9M9Jt2cIm1xa6YxQxBysSK8lhbB5NZzmoIx2P5YUHzqfna6lGn2IqiZ/UPc3GL21CRPoU6XgSguPphzS4sM/A+fCu8NnJ1DVkjbz2WlwjHvtChwHwqDYq/NgJE9j5reg8ixp012gsqnonqIm1ntaSnA8Yk0ecien3pOz1oFSLDHuEpIKSqdbCpBNLVYnQGDFIG4RPi5yYXloa2TMY0A6eEsgsGjVZ3yAKUCQOc88L37VADs/al4nVS7VG3Ba5m7YEpE05gQ8n03jnGAr99YA5lMZQSXHZZqLA277I6lNqiMYRjET+T45y8QnDNDLUQfzw/b2eXgzUejSSAZuK/ZsTh4g7L8wurNBlHiG4Hs/hLPJMwuCenaUmnxeOBko+kq98Nlq4oOPVGEU+QBuivvANnZFzQCZtcywMpMKa/ZnAWXJTd33EjYHJbyhOo9xarWu2WlBsPupkMT+1+AAQCmPwV2bobFnwAAAABJRU5ErkJggg==",app_icon_32px_yellow_unreads:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1hJREFUeNqMVr1PFUEQn9lcIc+ORylHB9gBNpLY+dEISKWhNHYWdhb+FRaa+CeYWJnYKVoJdAiVQMc7Oh90go1vnX2zOzs7dxj2JXfz9mbne36zuLa8AuPlvQe1EJF3mKCn4Qn76aRmFmlMV0LJt04d0FpZfde+EBVg1GY8EB3tk1q38Ahn4Tp4h4HA/5gpy8jS0YgEkeALg3wKUSC9tVo2xSj9BMzSLSeOf+PlolCwDgbFyTnety565UqXdPbb6aSbTEhk2jVWmAJe26EjQasqQoYdBUrExDX/7Kmfnx2dX8DLV47FvX39l54HR/jmHUqcxXY5G6uos3jYNPq6tEjSA8/BITL/3Gzk7PUCH4g3aGuhohMpQcBv6QzJ3fR0FHd4FHnqaZ92MOYbUZ8Vo11uNP6lTIwjFhebLx7QztJiVPnzIJtv+oNXZUKmM3ZrwU9Ohs2pfuReXGDOUX0jSqlrmKmDNV++2i5JOWgVBoflwT14tDIyuVlf9QCFgetjnsEJkoJsaIo2EU7Vb9TMldDvdyDHZWv3B3Do2Expi9Arq7cfarwELgpV+xtP/J3lQLz/4L5vh2P373p27uMnMhzZ3jboxipKLQydiSJaCqY5ifg1l3J+dparw/QTFyc9XXZHyp8NGbtMLSb5PB5E/BKVx01UaSdHLPvwt2ojeJRbh78ia9AgN9f1nu9NRGOpuqb6vmmQOlwHWRwKGaWJxr7o+iVZL56PrphhwQ+pIh1k5wXDMQP1TH31CoLhEE0iBTpzHwjEs/LPmxQT0g3razEHVDDNSThAJcSNTfVDSEc8FxcZVPQEtY2m4XAMk+GYZHhrG8//BJzbeJxqfx8HA3HaFqjgqys6WWWC6Dph3PA0BJpOU3qnUgOSdCNRAL/woBhh5bCdn4PkTdy/OV+CqAZOhodWxznddcXIhWxs08QOZ+wLIHqYZ0YeZJinZpGD9ghjEwYN/Bri6Sns7kUM396hkI6I3tsvQC3aJKlWkaraNx8J6NaOS+5Hnt/nfvObM1OvfYPS+85gk+6RvH9JGKXe5ZOuETvRRLMcMMNPc+q7k0ZGPVF4x1kH/aV3ADP7ZHiYa1meNiYH7cPGORNca7ji0DGs+A3lPaWYP3Ln0Tnoupt2BvafAAMA603M1k3efM4AAAAASUVORK5CYII=",app_icon_32px_yellow_mentions:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABBhJREFUeNqkVk1vG0UYfudj/bExbWo3kJLaKRWO3aaooIoKOMCBDwlBI06F/oEeQOIHcIU7N34CEieQekMIkBDtBaEgDk1aRIgdRGiSpqSpN1nvzPDOzuzurO2SxozX69lZz/vM836ThRffhngopSA/IhH1I7zCYD/4eGbmQuUxOPzgKJcQgjNzT0eybmHFEPyjAgCxsgYYqHikqPeFGA+AEn30EQxcLPz+FYZjMrDHBwUJgRTJAgOhlK7s743JwMqCTGiqK5yjaLzhtRQE/wvA8Bi0hNIXjWE2IrEc9MYHsFaN1ZTC6KPjl1K/RBbepJv1u2MBkBERYNjghFHKCD13lj59mv4xtf0PhON4USLV+EuGZ14hh0ad+WVWrNAvg/VDA2SBZj6JJTRMrH1G2ZkWmZjglQq/dmfn9iEtwVon54adx0wuPAfzZ+WpWTh/DqRUeG3dVUti5yI95hF6aIBMdHx74zW4clm256DVNHrT+ntyWvnV/hrsNnePZbo90Ivs8RMMs7NWs4QoBY+TcolVfH7kiDc5Wdid3vt2alXAI2UncumFtwxAqhllOVhrv/eueumi7Efy8y/ghxtRJPrPzIft5r7/d/GVtVNHqXewm7rZTSMlc0Noto4kCOd0fZ16jHPG59terVoIZ8JPdn/76f7OQdk0PnBKIk2iqHNcLpdU46TGYpSs/YlOhRt4q6n6EXge6T4QH213zpfLV6dPNMv+QwAcx09PreU29GOjblZgtUNacwhPSyU1VeO9PVLw6InHRXWS3V7vf7Dy+7O+//xE5eWjk08UCjkbYEUzh3XjuTUHH74vB7N2/F5IJSIVhnI/FMGe7AXR9rb49DN0YilkhEJmPK/C2FPFIicEn7mVS2ykmcfZxih/0ElF64pwncEZJx6XxQK9d0+VCjpOhPCUkhtK3onkShQYf+G5gpwY4+tvoNPFIId3FrQN8M1X10h3TfvD668qjAw0+3ffw81lJoR80FOIhLsk1aRlnDRJIpO7Cc7oyjwu3dIHMNJx/HidoN5x05XLlsrir3R1Fd1B64AzaU6JPIzX4EwLJIrnlOBYAuf1up1vbkEvZuyX4XjNmr3TsZGvi5KK3Y8oin5vAKhVCU+z0HB70W5Bwsaun2lbyOVb2T+z4qFs9tWiqH1FU9dM/5qSOJ5ki27XRni1alduLidbkhrlxpNRc2aDrITl2XS6sLFJtrbg50Wbw6/fwNwlcb74SyLILSFJ6+DmQWI6OzcIhvHAtmBqZH82kOSThGbbFAr5nW5hyNYfosa0VUhfDVTDXEVLkdMNrkTXC9zzKlAuCZvNwGl8Bgmq0T2Ai5GTCMS1nFvbbbL7j80D5DLlDmk/DlK308x0yM0vJD7nZuwcMKicDfK0cq1mXrH/CjAAfjaCPa5V5tYAAAAASUVORK5CYII=",app_icon_32px_red:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2pJREFUeNp8Vr13EzEMly5uQl+nlKnpRrtRNsp7DO1Ilz5W/gZW/iG6MrLCyMhIN9JsKVvDlH7dRdiWLcu6K27fxaeTrY/fT7Lx/dtziIOIQA1EZAlP/NPoBHleqZVlN547mcm3QRvQG8X8kFwmDjBZMxGIjf5KbVt0RLMKHajBMMH/uCnD7KWzkSZ+ClQ5RDlFYUrWaxGKU/oJWHa3mhj/4mjSpmADDIZzcCy3IZIKZWh3jrvRoBskJDM8nzawPyr7745w1iT3tR86E3401XZAg+Txr2fP4NMOHbmy8t2EPu7Aybj4J1mWHPiRWDRIHnaNv/LWyw2IPksWm6AHkli0XHA+Xxkg4F+pDMFu38E0hnr5mDw42grPW4JlF5bxfnqtOO2kCIIlJMFH8+lFzPVVK3zACAYFewFV1NVa/GMDJYNUIbaNcDxOlt6Mk7bPOGtyfnYbOJkE7WXnzZOpklzJvd7AaXm1FWDUXw9c+AdVSlESXr/e4VUEVZiatDAayFLU8P5u6fM6ZMOH8mE7qH+5xXV0ajbCs2j7Yh3w+7PB9UYVV2BqYWOJAEsBhW9/CVatnxLjudrAZcsJx+cR8OsO5i1DRQxNKiYVo39zsrFuXno+jQgHgub+tRcNeMyFHYB1N42iACf4QiPbERMNMK0/jNW7bHNhU6rnm00uFCB7ciTa5xSZDs56p5MUx4EQJnNpFg3MHJ5yKB36dFXsRJUidoGtiRm/qaHQ8dh28uOtpPDtHpctifvmdHGl9yKImUWHF+sg3hvR2SQg7InIfrx05I154n+/T3y7iRQyXUiy7SqEc9798IHHUAIp5h3Ocx29jqEsskTaWGmU9Qno6kOchBC84GAUntctpQLzJhnzjuSs7begkiigpqpkhQSXGOM575JLnj/bmDgqnbG0ACLL19BN9RFWH7aHMT8egFWmMrcKD8Bd7AZV4+QCI3vNcdYFZcl3Y8+QX4+pnfvHz4egsiKVE31GCU2wxsDcscSGh3HeVn3wDvHHAx+uoJtaCiKfH7qyXf/mI9EUOvfua7ot9m9QWt7ofU0jKnKlYO4vmIe5JJRrizmAuL2Y1vSU++mypTqjPlFY0tgA6ck7gDn70o6A5loGul9rDPqLTXAmudZxpaFz6PgX6nuK3lpqssJg6G46mNh/AgwA1LYLPz5hMyUAAAAASUVORK5CYII=",app_icon_32px_red_unreads:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAzFJREFUeNqMVr1zUzEMlxyHtincsdDOyUo6Aytz6Qoz3HVk5y/gr6ATQ2dgBWZYKWvDDAsDaZvmJUZ+smVZ77UXp5e4sqyPn76MR08OoV0hBFALEZnCG/o2PJGeb2pmkcZ7Lzs569UBnVXU99Fl4wGTNuOB6Oje1LqFRzgr1yE4jBu8xUxZRpZGI21oC6EyKGSI4jZYq4UoRulvwCLdcmL7aZdLQsE6GBVn55huXQzKlT7p7LfTQTeREGS6OVaZAkHboZGg5SvIsCdBaTOC8PoeTH2YBzj+mwx/fz8enS3h7RwEZ7Fd7qYs6k0eNo1OH90h6cDimH86TJy7LvKBeIM2FzzpzAEC/pXKkNiNs59nTeIZDxSF442o74rRrhQaf3IkWsTSmoqC1gOikE+KUtWEwcMbyHTEHg/hgYvEvZQKQHLZY/FgPMDJIHr18SqYKskx6CQGw3K0jc93bGxe7ABAqCnx39mKFChDM9q0cSp/k2bOBLZ9w/XtOkHHZkpZxEou5pcCimcnl/DuIjK+GsHTrUg/ucDPi2jjsy1g504vo+FsrzRdVD62dYC2l5lGNvZpTzhwsj/MVv1ZR2mqL5R64lDRtyvuSPpzXrUuj1Q8z5sUIMna81WqLzs5UtrHf323g7Pcia+yhczn4trF+Mdr3+G+oyOc6+pRcEfEaKKxLzp/Sdabu5tGWPqHZJEG2QXp4Vga9WSAm6fQ7zWYQErrLHUgLZ6Vf7gK5DhppsRnlChhfq3ihcPtwIVN+fOziTzzdWkqeoLaQtPtkNaPpo1nBurLAubtpZejnPtLmDWCe9WCClCQ54GMnZKggBJhAoGAptsUXmkbswaMRGn4lQfVCKuH7cEwFU1qmYgHQzCUaoKGquL4yOlpXo1c6haDUBmr+gc1UZkZZZBhmZpVDLojjE0guaeriA+1Gj76ep1K9/sSdFNLNkmoFVK++/IRQElcdj/x/FuHTws0U6/7gtJ0p+WaRlToN8Ao+S5HOkfsRBPNcsEMP82p3066M+qJwhRnHQw3vgHM7JPhYZ5lgNVM8rdcNs4ZcK3hikNj6PkX6neKFl3ePDoGfW/TXmD/CzAAcryyBfjeu1oAAAAASUVORK5CYII=",app_icon_32px_red_mentions:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA+pJREFUeNqkVktvHEUQ7q7unp19xAkHJ6BFAhshgeI8pAgpuSAO3OLkCJw5cOEXwBX4F/yAiBMCxA1yyQWUG4kEIsoGoyiWDYg4jsc7091F9XRPT8/YkeNlPLvunUd99X1V1VX8+pV1Vh+IyLqHNrrSdJbFvPhsOr00OcGOf0iyyzmnlf+OR3M9wJoD8M8LwHiw1WOA9RFRnxizGABw5/ohDFIs+jwqywUZBPcZsoZARArAjAPAbL6/IINgi7VGo1a0JtP0ReevRfG/ADyPfiTQnVDDbGvzW7G3OECIai1ThHGu0wdgzPl7Y3i8+89CAPyQCvBsaCEABIeLA/FGJh7uPd6pykWyqLHq86XF87eIw0oGIyEHnH+9vXlsgLbQ/F8TCQdTqy9AnM/ERIolJb/9d+f3Y0YCYoR9CFK5Liu2PsCrOZ9KGAt5Qqo3c/HVo43iOEUne9LHUF/P+ftDx0IjKw1JJJakvDZWW/Py1ubs3elrrbZHMgjuN/Xs31yGQEWQFwBDQSrJk0q9oFSh57c2N55zd+LXLl/1ALGAkQXfvFwfjtg7GVbWfrmLPxSVNtUlVq6xciAHV868siTV0Wma7m4OqVl7QqvS1RqReIighJRCns+z5UFmTPnFg3u3n+wcFYPa4UgibqIUCbo8Yrgi3COE8YdllFSSybNDXmmmOGzMq0//3LgwHH704kuvD0fPDHLMnOg12V2VDoOs+wqZGbaWETzkyE4rXnCeAbyci2Wp71XVx7P7F0ejt8aTt0+eOpNlnRhQR/POpgm6ptgnk0N2bTotokYsjd23hvJ1z5i/KvP5jrHWGkt3cKrURIiVwUByykCUwS4PleZ/roqmrFNffFLVyeDKD7gCyEH8zU2eWYvWGIVot9FuaTvThfdJdhpyE4xv9nFmnEQfDJlX6UbBHhgHsZ7jWemS+fsC71ag0ewaUJKIoQXLaoq1JMGm7FRZrZX/+Yt2BbfSCPXjnD2tHaGs9U/c1vy+pnSQ9JwU1ntJPHzW0MoZ5Nit5CQStH5VhPWWZU/dEsecnYYm7Dq0PNeUsE4/jkB57wEgSCLj7n9wvDinQiTu6EDxnGK9K23ugXPYL5wpCLcgpmZ8NJJYbhjMdMiiuH/cqZpXmh6V1pMXsY1B28K6bMjuDeP0+akMt26WjhPZ+bliwVDaQprRId0HZTqtpDDeXJNd4Zldi9/NOzNHHEb6c1tzHVK7vamivf4MGeOoEG/1umGno0Xk+EJqMc2C1F9kmI45aUcJg0+fIB4+A6QYHYuMp5FLe3s/Bgdf7pHridt3vDNpthpK/581EUt37A4ww04MurQ6o2ZX2P8EGAAu1YEi4TmT9gAAAABJRU5ErkJggg=="},emoji_groups:[],emoji_names:[],emoji_complex_customs:null,emoji_menu_columns:9,emoji_names_to_canonical_names:{},files_url:null,archives_url:null,bots_url:null,onStart:function(){TS.model.files_url=TS.utility.normalizeDevHost("https://"+document.location.hostname+"/files");TS.model.archives_url=TS.utility.normalizeDevHost("https://"+document.location.hostname+"/archives");TS.model.bots_url=TS.utility.normalizeDevHost("https://"+document.location.hostname+"/services");TS.model.is_retina=TS.utility.isRetina();if(TS.model.is_safari_desktop){TS.model.supports_sticky_position=true;$("html").addClass("is_safari_desktop")}if(TS.boot_data.feature_reactions){TS.model.supports_sticky_position=TS.model.is_safari_desktop||TS.model.is_FF||TS.model.mac_ssb_version;if(TS.model.supports_sticky_position){$("html").addClass("supports_sticky_position")}}if(TS.boot_data.feature_files_list){TS.model.supports_line_clamp=TS.utility.cssPropertySupported("line-clamp");if(TS.model.supports_line_clamp)$("html").addClass("supports_line_clamp")}if(TS.model.mac_ssb_version||TS.model.is_safari_desktop){TS.model.is_apple_webkit=true;$("html").addClass("is_apple_webkit")}var OSX_version=function(){if(!TS.model.mac_ssb_version)return 0;var matches=navigator.userAgent.match(/(?:Mac OS X )([0-9][0-9]_[0-9])(_[0-9])/);if(!matches)return 0;if(matches.length<2)return 0;var v=parseFloat(matches[1].replace("_","."))||0;return v}();TS.model.supports_growl_subtitle=TS.model.mac_ssb_version&&TS.model.mac_ssb_version>=.61&&OSX_version>10.7;if(TS.boot_data.feature_screenhero){if(window.winssb){TS.model.supports_voice_calls=!!winssb.screenhero}else if(window.macgap){TS.model.supports_voice_calls=!!macgap.screenhero}else if(TS.model.is_chrome){TS.model.supports_voice_calls=true}}if(TS.boot_data.feature_web_cache_users&&(TS.model.is_our_app||TS.model.is_chrome)){TS.model.supports_user_caching=true}if(!TS.model.supports_user_caching||!TS.storage.fetchLastCacheTS()){TS.storage.cleanOutCacheTsStorage()}if(window.macgap&&macgap.downloads||window.winssb&&winssb.downloads){TS.model.supports_downloads=true;TS.model.flex_names.push("downloads")}if(TS.boot_data.feature_spaces){if(window.macgap&&macgap.window&&macgap.window.list){if(window.WebKitMutationObserver||window.MutationObserver){TS.model.supports_spaces_in_windows=true}}else if(window.winssb&&winssb.window&&winssb.window.list){TS.model.supports_spaces_in_windows=true}}var k;if(TS.boot_data.special_flex_panes){for(k in TS.boot_data.special_flex_panes){var special=TS.boot_data.special_flex_panes[k];TS.model.flex_names.push(special.flex_name)}}TS.model.expandable_state=TS.storage.fetchExpandableState();var inline_img_state=TS.storage.fetchInlineImgState();var inline_video_state=TS.storage.fetchInlineVideoState();var inline_attachment_state=TS.storage.fetchInlineAttachmentState();for(k in inline_img_state){if(!TS.model.expandable_state["img_"+k]){TS.model.expandable_state["img_"+k]=inline_img_state[k]}}for(k in inline_video_state){if(!TS.model.expandable_state["vid_"+k]){TS.model.expandable_state["vid_"+k]=inline_video_state[k]}}for(k in inline_attachment_state){if(!TS.model.expandable_state["attach_"+k]){TS.model.expandable_state["attach_"+k]=inline_attachment_state[k]}}TS.storage.storeInlineImgState({});TS.storage.storeInlineVideoState({});TS.storage.storeInlineAttachmentState({})},makeYouRegex:function(){var self=TS.model.user;if(self){TS.model.you_regex=new RegExp("<@("+self.id+"|"+self.name+")\\b")}},addProfilingKeyTime:function(name,ms){if(!ms||!name){return}if(!TS.model.profiling_key_times){TS.model.profiling_key_times=[]}TS.model.profiling_key_times.push({name:name,ms:ms})}})})();(function(){"use strict";TS.registerModule("emoji",{onStart:function(){},isValidName:function(name){if(!name)return false;name=TS.emoji.stripWrappingColons(name).toLowerCase();if(TS.model.emoji_names.indexOf(name)==-1)return false;return name},stripWrappingColons:function(str){str=String(str);if(!str)return str;return str.replace(/^:|:$/g,"")},nameToCanonicalName:function(name){name=TS.emoji.stripWrappingColons(name);name=String(name).toLowerCase();if(!name)return name;return TS.model.emoji_names_to_canonical_names[name]||name},ingestCustoms:function(customs){var include_aliases_in_all_customs=false;var allow_overwrites=false;TS.model.all_custom_emoji.length=0;TS.model.emoji_complex_customs={};var alias_key;var datum;var custom;var idx;function isEmojiNameOK(name){var names;for(var idx in _emoji.data){names=_emoji.data[idx][3];for(var i=0;i<names.length;i++){if(name==names[i]){if(allow_overwrites){delete _emoji.data[idx]}return false}}}return true}for(idx in customs){custom=customs[idx];if(typeof custom=="object"){TS.model.emoji_complex_customs[idx]=custom;_emoji.data[idx]=[[],null,null,[idx],null,null,null,custom["apple"]];_emoji.map.colons[idx]=idx;TS.model.all_custom_emoji.push(idx);if(idx=="simple_smile"){_emoji.emoticons_data[":)"]="simple_smile";_emoji.emoticons_data["(:"]="simple_smile";_emoji.emoticons_data[":-)"]="simple_smile"}}else{if(custom.indexOf("alias:")===0)continue;if(!isEmojiNameOK(idx)){if(allow_overwrites){TS.error("allowing custom emoji :"+idx+": to overwrite")}else{TS.error("can't ingest custom emoji :"+idx+": because that already exists");continue}}_emoji.data[idx]=[[],null,null,[idx],null,null,null,custom];_emoji.map.colons[idx]=idx;TS.model.all_custom_emoji.push(idx)}}for(idx in customs){custom=customs[idx];if(typeof custom=="object"||custom.indexOf("alias:")!==0)continue;if(!isEmojiNameOK(idx)){if(allow_overwrites){TS.error("allowing custom emoji :"+idx+": to overwrite")}else{TS.error("can't ingest custom emoji :"+idx+": because that already exists");continue}}alias_key=custom.replace("alias:","");datum=_emoji.data.hasOwnProperty(alias_key)&&_emoji.data[alias_key];if(datum){datum[3].push(idx);_emoji.map.colons[idx]=alias_key;if(include_aliases_in_all_customs)TS.model.all_custom_emoji.push(idx);continue}alias_key=_emoji.map.colons.hasOwnProperty(alias_key)&&_emoji.map.colons[alias_key];datum=_emoji.data.hasOwnProperty(alias_key)&&_emoji.data[alias_key];if(datum){datum[3].push(idx);_emoji.map.colons[idx]=alias_key;if(include_aliases_in_all_customs)TS.model.all_custom_emoji.push(idx);continue}TS.warn('alias for "'+idx+'":"'+custom+'" not recognized')}TS.model.all_custom_emoji=TS.model.all_custom_emoji.sort();if(_emoji&&_emoji.inits){delete _emoji.inits.emoticons;_emoji.init_emoticons()}},setUpEmoji:function(){return new Promise(function(resolve){if(!_emoji)return resolve();_emoji.include_text=true;if(_emoji.unaltered_data){_emoji.data=TS.utility.clone(_emoji.unaltered_data);_emoji.inits={}}_emoji.init_colons();if(TS.boot_data.emoji_customs){TS.emoji.ingestCustoms(TS.boot_data.emoji_customs);TS.boot_data.emoji_customs=null;return resolve()}if(!TS.boot_data.page_needs_custom_emoji){return resolve()}TS.api.call("emoji.list",{include_complex_values:1},function(ok,data,args){if(!ok||!data.emoji){return resolve()}TS.emoji.ingestCustoms(data.emoji);resolve()})})},resetUpEmoji:function(){TS.emoji.setUpEmoji().then(function(){TS.emoji.setEmojiMode();TS.emoji.makeEmoticonList();if(TS.client)TS.client.ui.rebuildAll()})},makeEmoticonList:function(){var was_emoji_groups=TS.model.emoji_groups||[];TS.model.emoji_groups=[];TS.model.emoji_names=[];var groupings=TS.utility.clone(_getGroupings());if(TS.model.all_custom_emoji&&TS.model.all_custom_emoji.length){groupings.push({display_name:"Custom",tab_icon_html:'<span class="emoji-sizer"><i class="ts_icon ts_icon_slack"></i></span>',name:"slack",emoji_names:TS.model.all_custom_emoji})}if(TS.boot_data.feature_reactions){var used=TS.model.emoji_use_for_menu||[];var extras=["simple_smile","heart","+1","100","bug"];while(used.length<5){used.push(extras.shift())}groupings.unshift({name:"mine",display_name:"Frequently Used",tab_icon_html:'<span class="emoji-sizer"><i class="ts_icon ts_icon_clock_o"></i></span>',emoji_names:used})}var i,m;var name;var defaults=[];for(i=0;i<groupings.length;i++){defaults=defaults.concat(groupings[i].emoji_names)}var cat_map={};for(var idx in _emoji.data){var names=_emoji.data[idx][3];for(i=0;i<names.length;i++){name=names[i];TS.model.emoji_names.push(name);cat_map[name]={html:TS.emoji.graphicReplace(":"+name+":"),name:":"+name+":",names:":"+names.join(": :")+":"};_emoji.skin_tones.forEach(function(skin_idx){if(!_emoji.variations_data[idx+"-"+skin_idx])return;var skin_datum=_emoji.data[skin_idx];var skin_name=skin_datum[3][0];var name_with_skin=name+"::"+skin_name;TS.model.emoji_names.push(name_with_skin);var colon_name_with_skin=":"+name_with_skin+":";cat_map[name_with_skin]={is_skin:true,html:TS.emoji.graphicReplace(colon_name_with_skin),name:colon_name_with_skin,names:colon_name_with_skin}})}}for(i=0;i<defaults.length;i++){name=defaults[i];if(!cat_map[name]){TS.info(name+" not in cat_map?")}}var preloadEmojiGroup=function(grouping){var i,j;var image_count;var images_loaded=0;var images_requested=0;var images=[];var image_urls=[];var buffer_size;var datum;var emoji_id;var url;var max_simultaneous_requests=4;function getImageObject(){var i,j,image;for(i=0,j=images.length;i<j;i++){if(!images[i].src||images[i].complete){return images[i]}}image=new Image;images.push(image);return image}function imageLoaded(){this.onload=null;images_loaded++;if(images_loaded<image_count){if(images_requested<image_urls.length){loadImage(this)}}else{images=null}}function loadImage(img){img=img||getImageObject();img.onload=imageLoaded;img.src=image_urls[images_requested];images_requested++}for(i=0,j=grouping.emoji_names.length;i<j;i++){emoji_id=_emoji.map.colons[grouping.emoji_names[i]];datum=_emoji.data[emoji_id];if(!datum||!datum.length){TS.error(grouping.emoji_names[i]+" does not have a member in in _emoji.data");continue}url=datum[7]||TS.emoji.getCurrentImagePath()+emoji_id+".png";image_urls.push(url)}image_count=image_urls.length;buffer_size=Math.min(max_simultaneous_requests,image_count);for(i=0;i<buffer_size;i++){loadImage()}};var grouping;var cat_map_items;var cat_map_item;var tab_html;for(i=0;i<groupings.length;i++){grouping=groupings[i];cat_map_items=[];cat_map_item=null;tab_html="";if(grouping.tab_icon_html&&TS.boot_data.feature_reactions){tab_html=grouping.tab_icon_html}for(m=0;m<grouping.emoji_names.length;m++){cat_map_item=cat_map[grouping.emoji_names[m]];cat_map_items.push(cat_map_item);if(tab_html)continue;if(grouping.emoji_names[m]==grouping.name){tab_html=cat_map_item.html}}cat_map_item=cat_map_items[0];TS.model.emoji_groups.push({name:grouping.name,display_name:grouping.display_name,tab_html:tab_html||cat_map_item.html,items:cat_map_items});if(grouping.name=="slack"){(function(g_grouping){window.setTimeout(function(){preloadEmojiGroup(g_grouping)},5e3)})(grouping)}if(!TS.model.prefs.ss_emojis){if(grouping.name==TS.emoji_menu.default_emoji_group){preloadEmojiGroup(grouping)}}}var sheet_url=TS.emoji.getCurrentSheetUrl();if(TS.model.prefs.ss_emojis&&sheet_url){var img=new Image;img.onload=function(){img.onload=null;img.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";img=null};img.src=sheet_url}var names_to_canonical_names={};var item;for(name in _emoji.data){item=_emoji.data[name];names_to_canonical_names[item[3][0]]=null;item[3].forEach(function(n){if(names_to_canonical_names.hasOwnProperty(n))return;names_to_canonical_names[n]=item[3][0]})}TS.model.emoji_names_to_canonical_names=names_to_canonical_names;TS.model.emoji_names.sort();if(TS.boot_data.feature_reactions&&!TS.emoji_menu.is_dirty){TS.emoji_menu.is_dirty=!TS.utility.areSimpleObjectsEqual(was_emoji_groups,TS.model.emoji_groups,"emoji_menu.is_dirty")}var thumbsdown_index=TS.model.emoji_names.indexOf("thumbsdown");var thumbsup_index=TS.model.emoji_names.indexOf("thumbsup");var thought_balloon_index=TS.model.emoji_names.indexOf("thought_balloon");var three_index=TS.model.emoji_names.indexOf("three");TS.model.emoji_names[thought_balloon_index]="thumbsup";
TS.model.emoji_names[three_index]="thumbsdown";TS.model.emoji_names[thumbsdown_index]="thought_balloon";TS.model.emoji_names[thumbsup_index]="three";var ok_index=TS.model.emoji_names.indexOf("ok");var ok_hand_index=TS.model.emoji_names.indexOf("ok_hand");TS.model.emoji_names[ok_index]="ok_hand";TS.model.emoji_names[ok_hand_index]="ok"},maybePreloadSheet:function(callback){var sheet_url=TS.emoji.getCurrentSheetUrl();if(TS.client&&!TS.model.ms_logged_in_once&&TS.model.prefs.ss_emojis&&sheet_url){TS.logLoad("TS.client preloading "+sheet_url);var load_start_ms=Date.now();$("body").append('<img style="position:absolute; width:100px; left:-200px; top:-200%; z-index:100" id="emoji_ss_preloader" src="'+sheet_url+'">');$("#emoji_ss_preloader").bind("load",function(){$("#emoji_ss_preloader").remove();TS.logLoad("TS.client preloaded "+sheet_url+" (took "+(Date.now()-load_start_ms)+"ms)");callback()});$("#emoji_ss_preloader").bind("abort error",function(){TS.error("emoji sheet preload failed!");callback()})}else{callback()}},graphicReplace:function(str,disallow_native,include_title,exclude_text){if(!str)return"";_emoji.init_env();var was_text_mode=_emoji.text_mode;var was_include_title=_emoji.include_title;var was_include_text=_emoji.include_text;var was_allow_native=_emoji.allow_native;_emoji.text_mode=false;_emoji.include_title=!!include_title;_emoji.include_text=!exclude_text;_emoji.allow_native=false;var html=TS.emoji.replace(str);_emoji.text_mode=was_text_mode;_emoji.include_title=was_include_title;_emoji.include_text=was_include_text;_emoji.allow_native=was_allow_native;return html},replace:function(str,token_map,as_img){if(!str)return"";var ret;_emoji.init_env();var was_supports_css=_emoji.supports_css;if(as_img)_emoji.supports_css=false;if(token_map){ret=_emoji.replace_colons(str,function(str){return TS.format.tokenizeStr(token_map,str)})}else{ret=_emoji.replace_colons(str)}_emoji.supports_css=was_supports_css;return ret},replaceColons:function(str){return _emoji.replace_colons(str)},maybeUnifiedReplace:function(new_text){if(_emoji.replace_mode!="unified")return new_text;return _emoji.replace_colons_with_unified(new_text)},replaceEmoticons:function(str){return _emoji.replace_emoticons_with_colons(str)},setEmojiMode:function(){_emoji.text_mode=TS.model.prefs.emoji_mode=="as_text";_emoji.do_emoticons=!!TS.model.prefs.graphic_emoticons;_emoji.allow_native=false;_emoji.use_sheet=function(){if(!TS.model.prefs.ss_emojis)return false;if(TS.boot_data.feature_reactions){return!!TS.boot_data.page_needs_custom_emoji}return!!TS.client}();if(TS.model.prefs.emoji_mode=="google"||TS.model.prefs.emoji_mode=="emojione"||TS.model.prefs.emoji_mode=="twitter"){_emoji.img_set=TS.model.prefs.emoji_mode}else{_emoji.img_set="apple"}if(!TS.model.emoji_complex_customs)return;for(var idx in TS.model.emoji_complex_customs){if(!_emoji.data[idx])continue;_emoji.data[idx][7]=TS.model.emoji_complex_customs[idx][TS.model.prefs.emoji_mode]||TS.model.emoji_complex_customs[idx]["apple"]}},getColonsRx:function(){return _emoji.rx_colons},getEmojiForSpaces:function(){var ob={emoticonEmojiNames:_emoji.emoticons_data,emoji:{},sheetSize:_emoji.sheet_size,sheetPath:TS.emoji.getCurrentSheetUrl()};for(var idx in _emoji.data){var datum=_emoji.data[idx];var names=datum[3];var px=datum[4];var py=datum[5];var url=datum[7];var value;if(px!==null&&py!==null){value=[px,py]}else if(url){value=url}else{TS.error('WTF, _emoji "'+idx+'" is missing coords or and a url, or something!');continue}names.forEach(function(it){ob.emoji[it]=value})}return ob},getCurrentSheetUrl:function(){return _emoji.img_sets[_emoji.img_set].sheet},getCurrentImagePath:function(){return _emoji.img_sets[_emoji.img_set].path},test:function(){return{emoji:_emoji}}});var _emoji=window._private_emoji;delete window._private_emoji;var _getGroupings=function(){if((TS.boot_data||window.boot_data||{}).feature_reactions){return __groupings_new}else{return __groupings_old}};var __groupings_old=[{name:"grinning",emoji_names:["grinning","grin","joy","smiley","smile","sweat_smile","satisfied","innocent","smiling_imp","wink","blush","yum","relieved","heart_eyes","sunglasses","smirk","neutral_face","expressionless","unamused","sweat","pensive","confused","confounded","kissing","kissing_heart","kissing_smiling_eyes","kissing_closed_eyes","stuck_out_tongue","stuck_out_tongue_winking_eye","stuck_out_tongue_closed_eyes","disappointed","worried","angry","rage","cry","persevere","triumph","disappointed_relieved","frowning","anguished","fearful","weary","sleepy","tired_face","grimacing","sob","open_mouth","hushed","cold_sweat","scream","astonished","flushed","sleeping","dizzy_face","no_mouth","relaxed","mask","smile_cat","joy_cat","smiley_cat","heart_eyes_cat","smirk_cat","kissing_cat","pouting_cat","crying_cat_face","scream_cat","no_good","ok_woman","bow","see_no_evil","hear_no_evil","speak_no_evil","raising_hand","raised_hands","person_frowning","person_with_pouting_face","bust_in_silhouette","busts_in_silhouette","boy","girl","man","woman","family","couple","two_men_holding_hands","two_women_holding_hands","cop","dancers","bride_with_veil","person_with_blond_hair","man_with_gua_pi_mao","man_with_turban","older_man","older_woman","baby","construction_worker","princess","japanese_ogre","japanese_goblin","ghost","angel","alien","space_invader","imp","skull","information_desk_person","guardsman"]},{name:"rat",emoji_names:["rat","mouse2","ox","water_buffalo","cow2","tiger2","leopard","rabbit2","cat2","dragon","crocodile","whale2","snail","snake","racehorse","ram","goat","sheep","monkey","rooster","chicken","dog2","pig2","boar","elephant","octopus","shell","bug","ant","honeybee","beetle","fish","tropical_fish","blowfish","turtle","hatching_chick","baby_chick","hatched_chick","bird","penguin","koala","poodle","dromedary_camel","camel","flipper","mouse","cow","tiger","rabbit","cat","dragon_face","whale","horse","monkey_face","dog","pig","frog","hamster","wolf","bear","panda_face","pig_nose","paw_prints","eyes","ear","nose","lips","tongue","point_up","fist","raised_hand","v","point_up_2","point_down","point_left","point_right","punch","wave","ok_hand","thumbsup","thumbsdown","clap","open_hands"]},{name:"hamburger",emoji_names:["hamburger","coffee","pizza","meat_on_bone","poultry_leg","rice_cracker","rice_ball","rice","curry","ramen","spaghetti","bread","fries","sweet_potato","dango","oden","sushi","fried_shrimp","fish_cake","icecream","shaved_ice","ice_cream","doughnut","cookie","chocolate_bar","candy","lollipop","custard","honey_pot","cake","bento","stew","egg","fork_and_knife","tea","sake","wine_glass","cocktail","tropical_drink","beer","beers","baby_bottle","mushroom","tomato","eggplant","grapes","melon","watermelon","tangerine","lemon","banana","pineapple","apple","green_apple","pear","peach","cherries","strawberry","chestnut","seedling","evergreen_tree","deciduous_tree","palm_tree","cactus","tulip","cherry_blossom","rose","hibiscus","sunflower","blossom","corn","ear_of_rice","herb","four_leaf_clover","maple_leaf","fallen_leaf","leaves"]},{name:"sunny",emoji_names:["sunny","cloud","telephone","umbrella","spades","clubs","hearts","diamonds","recycle","wheelchair","warning","copyright","registered","tm","zap","soccer","baseball","snowman","partly_sunny","no_entry","golf","sailboat","fuelpump","scissors","ballot_box_with_check","white_check_mark","airplane","envelope","pencil2","black_nib","heavy_check_mark","heavy_multiplication_x","sparkles","snowflake","x","negative_squared_cross_mark","question","heavy_exclamation_mark","bangbang","interrobang","heart","heavy_plus_sign","heavy_minus_sign","heavy_division_sign","star","o","black_joker","cyclone","foggy","closed_umbrella","sunrise","ocean","earth_africa","earth_americas","earth_asia","globe_with_meridians","waxing_crescent_moon","waning_gibbous_moon","last_quarter_moon","waning_crescent_moon","crescent_moon","new_moon_with_face","first_quarter_moon_with_face","last_quarter_moon_with_face","full_moon_with_face","sun_with_face","star2","ribbon","gift","birthday","jack_o_lantern","christmas_tree","santa","fireworks","sparkler","balloon","tada","confetti_ball","tanabata_tree","crossed_flags","bamboo","dolls","flags","wind_chime","rice_scene","school_satchel","mortar_board","microphone","movie_camera","cinema","headphones","art","tophat","circus_tent","ticket","clapper","performing_arts","video_game","dart","slot_machine","8ball","game_die","bowling","flower_playing_cards","musical_note","notes","saxophone","guitar","musical_keyboard","trumpet","violin","musical_score","tennis","ski","basketball","checkered_flag","snowboarder","running","surfer","trophy","horse_racing","football","rugby_football","swimmer","dancer","lipstick","nail_care","massage","haircut","barber","syringe","pill"]},{name:"kiss",emoji_names:["kiss","love_letter","ring","gem","couplekiss","bouquet","couple_with_heart","wedding","heartbeat","broken_heart","two_hearts","sparkling_heart","heartpulse","cupid","blue_heart","green_heart","yellow_heart","purple_heart","gift_heart","revolving_hearts","heart_decoration","diamond_shape_with_a_dot_inside","bulb","anger","bomb","zzz","collision","sweat_drops","droplet","dash","shit","muscle","dizzy","speech_balloon","thought_balloon","heavy_dollar_sign","credit_card","yen","dollar","euro","pound","money_with_wings","seat","computer","briefcase","minidisc","floppy_disk","cd","dvd","file_folder","open_file_folder","page_with_curl","page_facing_up","date","card_index","chart_with_upwards_trend","chart_with_downwards_trend","bar_chart","pushpin","round_pushpin","paperclip","notebook","open_book","books","pencil","telephone_receiver","pager","fax","satellite","loudspeaker","mega","outbox_tray","inbox_tray","package","mailbox_closed","mailbox","mailbox_with_mail","mailbox_with_no_mail","postbox","postal_horn","newspaper","iphone","no_mobile_phones","camera","video_camera","tv","radio","vhs","low_brightness","high_brightness","mute","sound","speaker","battery","electric_plug","mag","mag_right","lock_with_ink_pen","closed_lock_with_key","key","lock","unlock","bell","no_bell","bookmark","link","radio_button","underage","fire","flashlight","wrench","hammer","nut_and_bolt","hocho","gun","microscope","telescope","crystal_ball","clock3","pray"]},{name:"rocket",emoji_names:["rocket","helicopter","steam_locomotive","train","bullettrain_side","bullettrain_front","train2","light_rail","station","tram","bus","oncoming_bus","trolleybus","busstop","minibus","ambulance","fire_engine","police_car","oncoming_police_car","taxi","oncoming_taxi","red_car","oncoming_automobile","blue_car","truck","articulated_lorry","tractor","monorail","mountain_railway","suspension_railway","mountain_cableway","aerial_tramway","ship","rowboat","speedboat","traffic_light","vertical_traffic_light","construction","rotating_light","triangular_flag_on_post","door","house","house_with_garden","european_post_office","convenience_store","school","no_entry_sign","smoking","no_smoking","put_litter_in_its_place","bike","no_bicycles","bicyclist","mountain_bicyclist","walking","no_pedestrians","mens","womens","toilet","shower","bath","bathtub","cn","de","es","fr","uk","it","jp","kr","ru","us"]}];var __groupings_new=[{name:"people",display_name:"People",tab_icon_html:'<span class="emoji-sizer"><i class="ts_icon ts_icon_happy_smile"></i></span>',emoji_names:["grinning","grin","joy","smiley","smile","sweat_smile","satisfied","innocent","smiling_imp","imp","wink","blush","relaxed","yum","relieved","heart_eyes","sunglasses","smirk","neutral_face","expressionless","unamused","sweat","pensive","confused","confounded","kissing","kissing_heart","kissing_smiling_eyes","kissing_closed_eyes","stuck_out_tongue","stuck_out_tongue_winking_eye","stuck_out_tongue_closed_eyes","disappointed","worried","angry","rage","cry","persevere","triumph","disappointed_relieved","frowning","anguished","fearful","weary","sleepy","tired_face","grimacing","sob","open_mouth","hushed","cold_sweat","scream","astonished","flushed","sleeping","dizzy_face","no_mouth","mask","smile_cat","joy_cat","smiley_cat","heart_eyes_cat","smirk_cat","kissing_cat","pouting_cat","crying_cat_face","scream_cat","footprints","bust_in_silhouette","busts_in_silhouette","baby","boy","girl","man","woman","family","couple","two_men_holding_hands","two_women_holding_hands","dancers","bride_with_veil","person_with_blond_hair","man_with_gua_pi_mao","man_with_turban","older_man","older_woman","cop","construction_worker","princess","guardsman","angel","santa","ghost","japanese_ogre","japanese_goblin","shit","skull","alien","space_invader","bow","information_desk_person","no_good","ok_woman","raising_hand","person_with_pouting_face","person_frowning","massage","haircut","couple_with_heart","couplekiss","raised_hands","clap","ear","eyes","nose","lips","kiss","tongue","nail_care","wave","thumbsup","thumbsdown","point_up","point_up_2","point_down","point_left","point_right","ok_hand","v","punch","fist","raised_hand","muscle","open_hands","pray"]},{name:"nature",display_name:"Nature",tab_icon_html:'<span class="emoji-sizer"><i class="ts_icon ts_icon_emoji_nature"></i></span>',emoji_names:["seedling","evergreen_tree","deciduous_tree","palm_tree","cactus","tulip","cherry_blossom","rose","hibiscus","sunflower","blossom","bouquet","ear_of_rice","herb","four_leaf_clover","maple_leaf","fallen_leaf","leaves","mushroom","chestnut","rat","mouse2","mouse","hamster","ox","water_buffalo","cow2","cow","tiger2","leopard","tiger","rabbit2","rabbit","cat2","cat","racehorse","horse","ram","sheep","goat","rooster","chicken","baby_chick","hatching_chick","hatched_chick","bird","penguin","elephant","dromedary_camel","camel","boar","pig2","pig","pig_nose","dog2","poodle","dog","wolf","bear","koala","panda_face","monkey_face","see_no_evil","hear_no_evil","speak_no_evil","monkey","dragon","dragon_face","crocodile","snake","turtle","frog","whale2","whale","flipper","octopus","fish","tropical_fish","blowfish","shell","snail","bug","ant","honeybee","beetle","paw_prints","zap","fire","crescent_moon","sunny","partly_sunny","cloud","droplet","sweat_drops","umbrella","dash","snowflake","star2","star","stars","sunrise_over_mountains","sunrise","rainbow","ocean","volcano","milky_way","mount_fuji","japan","globe_with_meridians","earth_africa","earth_americas","earth_asia","new_moon","waxing_crescent_moon","first_quarter_moon","waxing_gibbous_moon","full_moon","waning_gibbous_moon","last_quarter_moon","waning_crescent_moon","new_moon_with_face","full_moon_with_face","first_quarter_moon_with_face","last_quarter_moon_with_face","sun_with_face"]},{name:"food_and_drink",display_name:"Food & Drink",tab_icon_html:'<span class="emoji-sizer"><i class="ts_icon ts_icon_emoji_food"></i></span>',emoji_names:["tomato","eggplant","corn","sweet_potato","grapes","melon","watermelon","tangerine","lemon","banana","pineapple","apple","green_apple","pear","peach","cherries","strawberry","hamburger","pizza","meat_on_bone","poultry_leg","rice_cracker","rice_ball","rice","curry","ramen","spaghetti","bread","fries","dango","oden","sushi","fried_shrimp","fish_cake","icecream","shaved_ice","ice_cream","doughnut","cookie","chocolate_bar","candy","lollipop","custard","honey_pot","cake","bento","stew","egg","fork_and_knife","tea","coffee","sake","wine_glass","cocktail","tropical_drink","beer","beers","baby_bottle"]},{name:"celebration",display_name:"Celebration",tab_icon_html:'<span class="emoji-sizer"><i class="ts_icon ts_icon_emoji_celebration"></i></span>',emoji_names:["ribbon","gift","birthday","jack_o_lantern","christmas_tree","tanabata_tree","bamboo","rice_scene","fireworks","sparkler","tada","confetti_ball","balloon","dizzy","sparkles","collision","mortar_board","crown","dolls","flags","wind_chime","crossed_flags","lantern","ring","heart","broken_heart","love_letter","two_hearts","revolving_hearts","heartbeat","heartpulse","sparkling_heart","cupid","gift_heart","heart_decoration","purple_heart","yellow_heart","green_heart","blue_heart"]},{name:"activity",display_name:"Activity",tab_icon_html:'<span class="emoji-sizer"><i class="ts_icon ts_icon_emoji_activities"></i></span>',emoji_names:["running","walking","dancer","rowboat","swimmer","surfer","bath","snowboarder","ski","snowman","bicyclist","mountain_bicyclist","horse_racing","tent","fishing_pole_and_fish","soccer","basketball","football","baseball","tennis","rugby_football","golf","trophy","running_shirt_with_sash","checkered_flag","musical_keyboard","guitar","violin","saxophone","trumpet","musical_note","notes","musical_score","headphones","microphone","performing_arts","ticket","tophat","circus_tent","clapper","art","dart","8ball","bowling","slot_machine","game_die","video_game","flower_playing_cards","black_joker","mahjong","carousel_horse","ferris_wheel","roller_coaster"]},{name:"travel_and_places",display_name:"Travel & Places",tab_icon_html:'<span class="emoji-sizer"><i class="ts_icon ts_icon_emoji_travel"></i></span>',emoji_names:["train","mountain_railway","steam_locomotive","monorail","bullettrain_side","bullettrain_front","train2","metro","light_rail","station","tram","bus","oncoming_bus","trolleybus","minibus","ambulance","fire_engine","police_car","oncoming_police_car","rotating_light","taxi","oncoming_taxi","red_car","oncoming_automobile","blue_car","truck","articulated_lorry","tractor","bike","busstop","fuelpump","construction","vertical_traffic_light","traffic_light","rocket","helicopter","airplane","seat","anchor","ship","speedboat","sailboat","aerial_tramway","mountain_cableway","suspension_railway","passport_control","customs","baggage_claim","left_luggage","yen","euro","pound","dollar","statue_of_liberty","moyai","foggy","tokyo_tower","fountain","european_castle","japanese_castle","city_sunrise","city_sunset","night_with_stars","bridge_at_night","house","house_with_garden","office","department_store","factory","post_office","european_post_office","hospital","bank","hotel","love_hotel","wedding","church","convenience_store","school","cn","de","es","fr","uk","it","jp","kr","ru","us"]},{name:"OBJECTS_AND_SYMBOLS",display_name:"Objects & Symbols",tab_icon_html:'<span class="emoji-sizer"><i class="ts_icon ts_icon_emoji_objects"></i></span>',emoji_names:["watch","iphone","calling","computer","alarm_clock","hourglass_flowing_sand","hourglass","camera","video_camera","movie_camera","tv","radio","pager","telephone_receiver","telephone","fax","minidisc","floppy_disk","cd","dvd","vhs","battery","electric_plug","bulb","flashlight","satellite","credit_card","money_with_wings","moneybag","gem","closed_umbrella","pouch","purse","handbag","briefcase","school_satchel","lipstick","eyeglasses","womans_hat","sandal","high_heel","boot","shoe","athletic_shoe","bikini","dress","kimono","womans_clothes","tshirt","necktie","jeans","door","shower","bathtub","toilet","barber","syringe","pill","microscope","telescope","crystal_ball","wrench","hocho","nut_and_bolt","hammer","bomb","smoking","gun","bookmark","newspaper","key","envelope","envelope_with_arrow","incoming_envelope","e-mail","inbox_tray","outbox_tray","package","postal_horn","postbox","mailbox_closed","mailbox","mailbox_with_mail","mailbox_with_no_mail","page_facing_up","page_with_curl","bookmark_tabs","chart_with_upwards_trend","chart_with_downwards_trend","bar_chart","date","calendar","low_brightness","high_brightness","scroll","clipboard","open_book","notebook","notebook_with_decorative_cover","ledger","closed_book","green_book","blue_book","orange_book","books","card_index","link","paperclip","pushpin","scissors","triangular_ruler","round_pushpin","straight_ruler","triangular_flag_on_post","file_folder","open_file_folder","black_nib","pencil2","pencil","lock_with_ink_pen","closed_lock_with_key","lock","unlock","mega","loudspeaker","sound","speaker","mute","zzz","bell","no_bell","thought_balloon","speech_balloon","children_crossing","mag","mag_right","no_entry_sign","no_entry","name_badge","no_pedestrians","do_not_litter","no_bicycles","non-potable_water","no_mobile_phones","underage","accept","ideograph_advantage","white_flower","secret","congratulations","u5408","u6e80","u7981","u6709","u7121","u7533","u55b6","u6708","u5272","u7a7a","sa","koko","u6307","chart","sparkle","eight_spoked_asterisk","negative_squared_cross_mark","white_check_mark","eight_pointed_black_star","vibration_mode","mobile_phone_off","vs","a","b","ab","cl","o2","sos","id","parking","wc","cool","free","new","ng","ok","up","atm","aries","taurus","gemini","cancer","leo","virgo","libra","scorpius","sagittarius","capricorn","aquarius","pisces","restroom","mens","womens","baby_symbol","wheelchair","potable_water","no_smoking","put_litter_in_its_place","arrow_forward","arrow_backward","arrow_up_small","arrow_down_small","fast_forward","rewind","arrow_double_up","arrow_double_down","arrow_right","arrow_left","arrow_up","arrow_down","arrow_upper_right","arrow_lower_right","arrow_lower_left","arrow_upper_left","arrow_up_down","left_right_arrow","arrows_counterclockwise","arrow_right_hook","leftwards_arrow_with_hook","arrow_heading_up","arrow_heading_down","twisted_rightwards_arrows","repeat","repeat_one","zero","one","two","three","four","five","six","seven","eight","nine","keycap_ten","1234","abc","abcd","capital_abcd","information_source","signal_strength","cinema","symbols","heavy_plus_sign","heavy_minus_sign","wavy_dash","heavy_division_sign","heavy_multiplication_x","heavy_check_mark","arrows_clockwise","tm","copyright","registered","currency_exchange","heavy_dollar_sign","curly_loop","loop","part_alternation_mark","heavy_exclamation_mark","question","grey_exclamation","grey_question","interrobang","x","o","100","end","back","on","top","soon","cyclone","m","ophiuchus","six_pointed_star","beginner","trident","warning","hotsprings","recycle","anger","diamond_shape_with_a_dot_inside","spades","clubs","hearts","diamonds","ballot_box_with_check","white_circle","black_circle","radio_button","red_circle","large_blue_circle","small_red_triangle","small_red_triangle_down","small_orange_diamond","small_blue_diamond","large_orange_diamond","large_blue_diamond","black_small_square","white_small_square","black_large_square","white_large_square","black_medium_square","white_medium_square","black_medium_small_square","white_medium_small_square","black_square_button","white_square_button","clock1","clock2","clock3","clock4","clock5","clock6","clock7","clock8","clock9","clock10","clock11","clock12","clock130","clock230","clock330","clock430","clock530","clock630","clock730","clock830","clock930","clock1030","clock1130","clock1230"]}];__groupings_new.forEach(function(grouping){var added=0;grouping.emoji_names.concat().forEach(function(emoji_name,emoji_name_i){var idx=_emoji.map.colons[emoji_name];var datum=_emoji.data.hasOwnProperty(idx)&&_emoji.data[idx];if(!datum)return;_emoji.skin_tones.forEach(function(skin_idx){if(!_emoji.variations_data[idx+"-"+skin_idx])return;var skin_datum=_emoji.data[skin_idx];var skin_name=skin_datum[3][0];var name_with_skin=emoji_name+"::"+skin_name;var splice_i=++added+emoji_name_i;grouping.emoji_names.splice(splice_i,0,name_with_skin)})})})})();(function(){"use strict";TS.registerModule("ssb",{teams_did_load_sig:new signals.Signal,onStart:function(){TS.files.team_file_deleted_sig.add(_teamFileDeleted)},openNewFileWindow:function(file,url,qs){TS.log(438,"TS.ssb.openNewFileWindow url: "+url);if(TS.client){return TS.client.windows.openFileWindow(file.id,qs)}else if(window.is_in_ssb){TS.ssb.upsertFileInSSBParentWin(file);if(document.ssb_main){if(document.ssb_main.TS){return document.ssb_main.TS.client.windows.openFileWindow(file.id,url)}else{return true}}else if(window.winssb&&window.opener&&window.opener.executeJavaScript){TS.log(438,"calling _executeInAtomSSBParentWin for TS.client.windows.openFileWindow");_executeInAtomSSBParentWin("TS.client.windows.openFileWindow("+_prepStringForEval(file.id)+", "+_prepStringForEval(url)+");");return true}}return false},closeWindow:function(){if(!window.is_in_ssb)return false;window.close();return true},setUpAtomSSBWin:function(win){_executeInAtomSSBWin(win,"window.is_in_ssb = true;");if(TS.shouldLog(438)&&!win._has_console){win._has_console=1}},upsertFileInSSBParentWin:function(file){if(!TS.web)return;if(document.ssb_main){if(document.ssb_main.TS)document.ssb_main.TS.files.upsertAndSignal(file)}else if(window.winssb&&window.opener&&window.opener.executeJavaScript){TS.log(438,"calling _executeInAtomSSBParentWin for TS.files.upsertAndSignal");_executeInAtomSSBParentWin("TS.files.upsertAndSignal("+_prepObjectForEval(file)+");")}},updateAtomSSBWin:function(win,callback){TS.log(438,"updateAtomSSBWin token: "+win.token);var func=function(){return{x:window.screenX,y:window.screenY,width:window.innerWidth,height:window.innerHeight+22,title:window.document&&window.document.title}};_executeInAtomSSBWin(win,_prepFunctionForEval(func),function(err,data){if(err){TS.error("updateAtomSSBWin got err: "+err);return}if(!data.width){TS.error("updateAtomSSBWin got bad values:");TS.dir(0,data);return}TS.log(438,"updateAtomSSBWin SETTING VALUES token: "+win.token);win.x=data.x;win.y=data.y;win.width=data.width;win.height=data.height;if(data.title)win.title=data.title;callback()})},toggleMuteInWin:function(token,video,handler){TS.log(438,"toggleMuteInWin called with token: "+token);if(!TS.client)return;var win=TS.client.windows.getWinByToken(token);if(!win){TS.error("toggleMuteInWin called with bad token: "+token);return}if(window.macgap){var ret;var error;try{ret=win.window.toggleMute(video)}catch(err){TS.error("error calling macgap win.window.toggleMute");TS.error(err);error=err}if(handler)setTimeout(handler,0,error,ret)}else{_executeInAtomSSBWin(win,"window.toggleMute("+_prepBoolForEval(video)+");",handler)}},teamsDidLoad:function(){TS.ssb.teams_did_load_sig.dispatch()},distributeMsgToWin:function(token,imsg){TS.log(438,"distributeMsgToWin called with token: "+token);if(!TS.client)return;var win=TS.client.windows.getWinByToken(token);if(!win){TS.error("distributeMsgToWin called with bad token: "+token);return}if(window.macgap){try{if(win&&win.window&&win.window.TS&&win.window.TS.ms&&win.window.TS.ms.msg_handlers){win.window.TS.ms.msg_handlers.msgReceivedFromParentWindow(imsg)}else{TS.warn("distributeMsgToWin win.window not ready! token: "+token)}}catch(err){TS.error("error calling macgap win.window.TS.ms.msg_handlers.msgReceivedFromParentWindow");TS.error(err)}}else{_executeInAtomSSBWin(win,"TS.ms.msg_handlers.msgReceivedFromParentWindow("+_prepObjectForEval(imsg)+");")}}});var _prepBoolForEval=function(bool){return(!!bool).toString()};var _prepFunctionForEval=function(func){return"("+func.toString()+")()"};var _prepObjectForEval=function(ob){return"JSON.parse('"+JSON.stringify(ob||null)+"')"};var _prepStringForEval=function(str){str=String(str);str=str.replace(/"/g,'\\"');return'"'+str+'"'};var _teamFileDeleted=function(file){if(!file)return;if(!TS.client)return;var win=TS.client.windows.getWinByProp("file_id",file.id);if(!win)return;setTimeout(function(){if(window.macgap){try{win.window.TS.files.team_file_deleted_sig.dispatch(file)}catch(err){}}else{_executeInAtomSSBWin(win,"window.TS.files.team_file_deleted_sig.dispatch(TS.files.getFileById("+_prepStringForEval(file.id)+"));")}},1e3)};var _execute_parent_win_Q=[];var _executeInAtomSSBParentWin=function(code,handler){_execute_parent_win_Q.push(arguments);if(_execute_parent_win_Q.length==1)_executeInAtomSSBParentWinWorker(code,handler)};var _executeInAtomSSBParentWinWorker=function(code,handler){TS.log(438,'CALLING _executeInAtomSSBParentWin\n\n"'+code+'"');var callNext=function(){_execute_parent_win_Q.shift();if(_execute_parent_win_Q.length)_executeInAtomSSBParentWinWorker.apply(null,_execute_parent_win_Q[0])};var allowance_ms=2e3;var attempts=1;var attempts_max=2;var call=function(){var allowance_timer=setTimeout(function(){attempts++;if(attempts>attempts_max){TS.error('_executeInAtomSSBParentWin\n\n"'+code+'"\n\ndid not get a callback in '+allowance_ms+"ms, bailing");callNext()}else{TS.error('_executeInAtomSSBParentWin\n\n"'+code+'"\n\ndid not get a callback in '+allowance_ms+"ms, trying again");call()}},allowance_ms);var ret=TSSSB.call("executeJavaScriptInParentWindow",{code:code,callback:function(err,data){clearTimeout(allowance_timer);if(err){TS.error('_executeInAtomSSBParentWin\n\n"'+code+'"\n\nreturned err: '+err)}else{var data_log=typeof data=="object"?JSON.stringify(data,null,2):data;var pri=attempts==1?438:0;TS.log(pri,'_executeInAtomSSBParentWin\n\n"'+code+'"\n\nreturned data: '+data_log)}if(handler)handler(err,data);setTimeout(callNext,0)}});TS.log(438,'CALLED _executeInAtomSSBParentWin\n\n"'+code+'"\n\n ret: '+ret);return ret};var ret=call();return!!ret};var _execute_win_Q=[];var _executeInAtomSSBWin=function(win,code,handler){_execute_win_Q.push(arguments);TS.log(438,"_executeInAtomSSBWin _execute_win_Q: "+_execute_win_Q.length);if(_execute_win_Q.length==1)_executeInAtomSSBWinWorker(win,code,handler)};var _executeInAtomSSBWinWorker=function(win,code,handler){TS.log(438,"CALLING _executeInAtomSSBWin token: "+win.token+'\n\n"'+code+'"');var callNext=function(){_execute_win_Q.shift();if(_execute_win_Q.length)_executeInAtomSSBWinWorker.apply(null,_execute_win_Q[0])};var allowance_ms=2e3;var attempts=1;var attempts_max=2;var call=function(){var allowance_timer=setTimeout(function(){attempts++;if(attempts>attempts_max){TS.error("_executeInAtomSSBWin token: "+win.token+'\n\n"'+code+'"\n\ndid not get a callback in '+allowance_ms+"ms, bailing");callNext()}else{TS.error("_executeInAtomSSBWin token: "+win.token+'\n\n"'+code+'"\n\ndid not get a callback in '+allowance_ms+"ms, trying again");call()}},allowance_ms);var ret=TSSSB.call("executeJavaScriptInWindow",{window_token:win.token,code:code,callback:function(err,data){clearTimeout(allowance_timer);if(err){TS.error("_executeInAtomSSBWin token: "+win.token+'\n\n"'+code+'"\n\nreturned err: '+err)}else{var data_log=typeof data=="object"?JSON.stringify(data,null,2):data;var pri=attempts==1?438:0;TS.log(pri,"_executeInAtomSSBWin token: "+win.token+'\n\n"'+code+'"\n\nreturned data: '+data_log)}if(handler)handler(err,data);setTimeout(callNext,0)}});TS.log(438,"CALLED _executeInAtomSSBWin token: "+win.token+'\n\n"'+code+'"\n\n ret: '+ret);return ret};var ret=call();return!!ret}})();(function(){"use strict";TS.registerModule("ui",{window_focus_changed_sig:new signals.Signal,window_unloaded_sig:new signals.Signal,retina_changed_sig:new signals.Signal,onStart:function(){$(window).bind("focus",TS.ui.onWindowFocus);$(window).bind("blur",TS.ui.onWindowBlur);$("html").bind("mousedown",function(e){TS.ui.onWindowFocus({target:window})});var has_focus_now=document.hasFocus&&document.hasFocus()&&window.macgap_is_in_active_space?true:false;if(has_focus_now){TS.ui.onWindowFocus({target:window})}else{TS.ui.onWindowBlur({target:window})}if(!!window.matchMedia){var qry="screen and (-webkit-min-device-pixel-ratio: 1.5), screen and (min--moz-device-pixel-ratio: 1.5), screen and (min-device-pixel-ratio: 1.5)";window.matchMedia(qry).addListener(function(){var was=TS.model.is_retina;TS.model.is_retina=TS.utility.isRetina();if(TS.model.is_retina===was)return;TS.info("TS.model.is_retina changed from "+was+" to "+TS.model.is_retina);TS.ui.retina_changed_sig.dispatch(TS.model.is_retina)})}if(TS.model.win_ssb_version)$("body").addClass("winssb")},setUpWindowUnloadHandlers:function(){if(window.macgap){window.onbeforeunload=TS.ui.onWindowUnload}else if(typeof window.addEventListener!="undefined"){window.addEventListener("beforeunload",TS.ui.onWindowUnload,false)}else if(typeof document.addEventListener!="undefined"){document.addEventListener("beforeunload",TS.ui.onWindowUnload,false)}else if(typeof window.attachEvent!="undefined"){window.attachEvent("onbeforeunload",TS.ui.onWindowUnload)}else{if(typeof window.onbeforeunload=="function"){window.onbeforeunload=function(){TS.ui.onWindowUnload();return false}}else{window.onbeforeunload=TS.ui.onWindowUnload;
}}},onWindowUnload:function(){if(TS.client)TS.client.markLastReadsWithAPI();TS.model.window_unloading=true;TS.ui.window_unloaded_sig.dispatch();return},maybeTickleMS:function(){if(!TS.client)return;TS.client.ui.maybeTickleMS()},handleDraghoverstartFromWinSSB:function(){$(window).trigger("draghoverstart",[null,true])},handleDraghoverendFromWinSSB:function(){$(window).trigger("draghoverend")},handleDropFromWinSSB:function(files){TS.info("handleDropFromWinSSB called files:"+files);$("body").removeClass("drop-target");if(TS.client.ui.checkForEditing()){return}if(!files||!files.length){TS.warn("handleDropFromWinSSB called with no files");return}TS.client.ui.validateFiles(files,TS.model.shift_key_pressed)},onMacSpaceChanged:function(active){if(!active){TS.ui.onWindowBlur({target:window})}else if(document.hasFocus()){TS.ui.onWindowFocus({target:window})}},onWindowFocus:function(e){if(e.target!==window)return;if(TS.model.ui.is_window_focused)return;TS.model.shift_key_pressed=false;TS.model.insert_key_pressed=false;TS.model.ui.is_window_focused=true;if(TS.view)TS.view.updateTitleBarColor();TS.ui.window_focus_changed_sig.dispatch(true)},onWindowBlur:function(e){if(e.target!==window)return;if(!TS.model.ui.is_window_focused)return;TS.model.shift_key_pressed=false;TS.model.insert_key_pressed=false;TS.model.ui.is_window_focused=false;TS.ui.window_focus_changed_sig.dispatch(false)},getFileShareSelectOptions:function(for_template){var i,j;var archives_channel_id=TS.model.archive_view_is_showing&&TS.client.archives.current_model_ob?TS.client.archives.current_model_ob.id:null;var channels=[];var channel;var can_post_in_general=TS.members.canUserPostInGeneral();for(i=0;i<TS.model.channels.length;i++){channel=TS.model.channels[i];if((channel.is_member||archives_channel_id==channel.id)&&(!channel.is_general||can_post_in_general)&&!channel.is_archived){channels.push({model_ob:channel,preselected:channel.id===TS.model.active_channel_id})}}var groups=[];var group;for(i=0;i<TS.model.groups.length;i++){group=TS.model.groups[i];if(!group.is_archived){groups.push({model_ob:group,preselected:group.id===TS.model.active_group_id})}}var members=[];var member;var member_name_map={};var members_for_user=TS.members.getMembersForUser();var im;var im_id;for(i=0;i<members_for_user.length;i++){member=members_for_user[i];if(!member||member.deleted||member.is_self)continue;im=TS.ims.getImByMemberId(member.id);im_id=im?im.id:null;members.push({model_ob:member,preselected:im&&im_id===TS.model.active_im_id});member_name_map[member.id]=TS.members.getMemberDisplayNameLowerCase(member)}var mpims=[];var mpim;var mpim_name_map={};var visible_mpims;if(TS.boot_data.feature_mpim_client){visible_mpims=TS.mpims.getVisibleMpims();for(i=0;i<visible_mpims.length;i++){mpim=visible_mpims[i];mpims.push({model_ob:mpim,preselected:mpim.id===TS.model.active_mpim_id});mpim_name_map[mpim.id]=TS.mpims.getDisplayName(mpim).toLowerCase()}}if(!TS.model.active_channel_id&&!TS.model.active_group_id&&!TS.model.active_im_id&&!TS.model.active_mpim_id){if(channels.length){channels[0].preselected=true}else if(groups.length){groups[0].preselected=true}}channels.sort(function(a,b){return a.model_ob._name_lc>b.model_ob._name_lc?1:b.model_ob._name_lc>a.model_ob._name_lc?-1:0});groups.sort(function(a,b){return a.model_ob._name_lc>b.model_ob._name_lc?1:b.model_ob._name_lc>a.model_ob._name_lc?-1:0});members.sort(function(a,b){return member_name_map[a.model_ob.id]>member_name_map[b.model_ob.id]?1:member_name_map[b.model_ob.id]>member_name_map[a.model_ob.id]?-1:0});mpims.sort(function(a,b){return mpim_name_map[a.model_ob.id]>mpim_name_map[b.model_ob.id]?1:mpim_name_map[b.model_ob.id]>mpim_name_map[a.model_ob.id]?-1:0});for(i=0,j=members.length;i<j;i++){if(members[i].model_ob.is_slackbot){members.push(members[i]);members.splice(i,1);break}}if(for_template){return{channels:channels.map(function(i){return i.model_ob}),groups:groups.map(function(i){return i.model_ob}),members:members.map(function(i){return i.model_ob})}}return[{fsl_group:true,label:"Channels",children:channels.concat(groups)},{fsl_group:true,label:"Direct Messages",children:members.concat(mpims)}]},bindFileShareDropdowns:function(){var $select_share_channels=$("#select_share_channels");var chosen_width="60%";if(TS.web&&TS.web.space)chosen_width="100%";if($select_share_channels.length!=1){alert("error: "+$select_share_channels.length+" $('#select_share_channels')s");return}if(!TS.boot_data.feature_private_channels){$select_share_channels.find('optgroup[label="People"] option').each(function(){var user_id=$(this).val();if(user_id){var member=TS.members.getMemberById(user_id);var additionalSearchText=_getAdditionalSearchText(member);if(additionalSearchText){$(this).attr("data-additional-search-field",additionalSearchText)}}})}if(!TS.boot_data.feature_private_channels){$select_share_channels.on("change",_fileShareOnChange).each(function(){$(this).addClass("hidden")})}if(TS.boot_data.feature_filter_select_component){if(TS.boot_data.feature_private_channels){var prev_query;var prefix_regexes;var suffix_regexes;var prefix_regex;var suffix_regex;var match_names_only=true;$select_share_channels.filterSelect({append:true,single:true,data:TS.ui.getFileShareSelectOptions(),template:function(item){return new Handlebars.SafeString(TS.templates.file_sharing_channel_row({item:item.model_ob}))},filter:function(item,query){if(prev_query!==query){prefix_regexes=[];suffix_regexes=[];var queries=query.split(/[,| ]/).filter(function(i){return!!i});for(var i=0;i<queries.length;i++){prefix_regexes.push(new RegExp("^"+TS.utility.regexpEscape(queries[i]),"i"));suffix_regexes.push(new RegExp("(-|_|\\+|\\s|\\.|@)"+TS.utility.regexpEscape(queries[i]),"i"))}prefix_regex=new RegExp("^"+TS.utility.regexpEscape(query),"i");suffix_regex=new RegExp("(-|_|\\+|\\s|\\.|@)"+TS.utility.regexpEscape(query),"i");prev_query=query}var model_ob=item.model_ob;if(TS.boot_data.feature_mpim_client&&model_ob.is_mpim){return TS.mpims.checkMpimMatch(model_ob,prefix_regexes,suffix_regexes)}else if(model_ob.is_group||model_ob.is_channel){return model_ob.name.match(prefix_regex)}else{return TS.members.checkMemberMatch(model_ob,prefix_regex,match_names_only)||TS.members.checkMemberMatch(model_ob,suffix_regex,match_names_only)}},onItemAdded:_fileShareOnChange});$select_share_channels.css({width:chosen_width})}else{$select_share_channels.filterSelect();$select_share_channels.filterSelect("getInstance").$container.css({width:chosen_width,display:"inline-block",vertical_align:"middle"})}}else{$select_share_channels.chosen({search_contains:true,width:chosen_width})}$select_share_channels.one("remove",function(){if(TS.boot_data.feature_filter_select_component){$(this).filterSelect("destroy")}else{$(this).chosen("destroy")}});$("#file_sharing_div").on("keydown",function(e){e.stopPropagation()})},bindFileShareShareToggle:function(){$("#share_cb").bind("click.toggle_select_list",function(){if($(this).prop("checked")){$(".file_share_select").prop("disabled",false)}else{$(".file_share_select").prop("disabled",true)}TS.ui.updateAtChannelWarningNote();TS.ui.updateAtChannelBlockedNote()})},bindFileShareCommentField:function(){$("#file_comment_textarea").bind("keyup",function(){TS.ui.updateAtChannelWarningNote();TS.ui.updateAtChannelBlockedNote()})},needToShowAtChannelWarning:function(c_id,text){var model_ob;var clean_text=TS.format.cleanMsg(text);var is_at_everyone=TS.model.everyone_regex.test(clean_text);var is_at_channel=TS.model.channel_regex.test(clean_text);var is_at_group=TS.model.group_regex.test(clean_text);var user_has_seen_it=!!TS.model.prefs.last_seen_at_channel_warning;var user_has_seen_it_today=user_has_seen_it&&TS.utility.date.sameDay(new Date(TS.model.prefs.last_seen_at_channel_warning),new Date);if(!is_at_everyone&&!is_at_channel&&!is_at_group)return false;model_ob=TS.shared.getModelObById(c_id);if(!model_ob||model_ob.is_im)return false;if((is_at_channel||is_at_group)&&!TS.members.canUserAtChannelOrAtGroup())return false;if(model_ob.is_general&&is_at_everyone&&!TS.members.canUserAtEveryone())return false;if(TS.model.team.prefs.warn_before_at_channel==="never")return false;if(TS.model.team.prefs.warn_before_at_channel==="once"&&user_has_seen_it)return false;if(TS.model.team.prefs.warn_before_at_channel==="daily"&&user_has_seen_it_today)return false;return true},updateAtChannelWarningNote:function(){var text=$("#file_comment_textarea").val();var c_id;if(TS.boot_data.feature_private_channels){var selected=$("#select_share_channels").filterSelect("value")[0];if(selected){c_id=selected.model_ob.id||""}}else{c_id=$("#select_share_channels").val()}var $note=$("#select_share_at_channel_note");if(TS.ui.needToShowAtChannelWarning(c_id,text)){var clean_text=TS.format.cleanMsg(text);var keyword="";var show=true;if(TS.model.everyone_regex.test(clean_text)){keyword="everyone"}else if(TS.model.channel_regex.test(clean_text)){keyword="channel"}else if(TS.model.group_regex.test(clean_text)){keyword="group"}var model_ob=TS.shared.getModelObById(c_id);if(!model_ob||model_ob.is_im)show=false;var members=model_ob.members.filter(function(member_id){var member=TS.members.getMemberById(member_id);var is_human=member&&!member.deleted&&!member.is_bot&&!member.is_slackbot;return is_human&&!member.is_self}).sort(TS.members.memberSorterByName);if(members.length<1)show=false;if(show){var html=TS.templates.at_channel_warning_note({keyword:keyword,member_count:members.length});$note.html(html);$note.removeClass("hidden");return}}$note.addClass("hidden")},updateAtChannelBlockedNote:function(){var text=$("#file_comment_textarea").val();var c_id;if(TS.boot_data.feature_private_channels){var selected=$("#select_share_channels").filterSelect("value")[0];if(selected){c_id=$("#share_cb").is(":checked")&&selected.model_ob.id}}else{c_id=$("#share_cb").is(":checked")&&$("#select_share_channels").val()}var $note=$("#select_share_at_channel_blocked_note");var $go_btn=$(".modal .btn.dialog_go");var keyword=TS.ui.needToBlockAtChannelKeyword(text,null,c_id);if(keyword){$note.html(TS.templates.at_channel_blocked_note({keyword:keyword}));$note.removeClass("hidden");$go_btn.addClass("disabled")}else{$note.addClass("hidden");$go_btn.removeClass("disabled")}},needToBlockAtChannelKeyword:function(text_unclean,file,share_channel_id){var comment_text=TS.format.cleanMsg(text_unclean);var share_channel=share_channel_id&&TS.shared.getModelObById(share_channel_id);var is_shared=share_channel&&!share_channel.is_im&&!(TS.boot_data.feature_mpim_client&&share_channel.is_mpim)||file&&(file.channels.length||file.groups.length);if(!is_shared)return false;var has_at_everyone=TS.model.everyone_regex.test(comment_text);var has_at_here=TS.model.here_regex.test(comment_text);var has_at_channel=TS.model.channel_regex.test(comment_text);var has_at_group=TS.model.group_regex.test(comment_text);var only_general=false;if(share_channel){only_general=!!share_channel.is_general}else if(file&&file.groups.length===0&&file.channels.length===1){var channel=TS.channels.getChannelById(file.channels[0]);only_general=!!channel.is_general}if(only_general&&has_at_everyone&&(!has_at_here&&!has_at_channel&&!has_at_group)){if(TS.members.canUserAtEveryone())return false}if(!TS.members.canUserAtChannelOrAtGroup()){if(has_at_here)return"@here";if(has_at_channel)return"@channel";if(has_at_group)return"@group";if(has_at_everyone)return"@everyone"}var is_general=share_channel&&share_channel.is_general;if(!is_general&&file&&file.channels){file.channels.forEach(function(c_id){var channel=TS.channels.getChannelById(c_id);if(channel.is_general)is_general=true})}if(is_general&&!TS.members.canUserAtEveryone()){if(has_at_everyone||has_at_here||has_at_group||has_at_channel)return"@everyone"}return false},shouldBlockUploadDialogSubmission:function(){var text=$("#file_comment_textarea").val();var c_id;if(TS.boot_data.feature_private_channels){var selected=$("#select_share_channels").filterSelect("value")[0];if(selected){c_id=$("#share_cb").is(":checked")&&selected.model_ob.id}}else{c_id=$("#share_cb").is(":checked")&&$("#select_share_channels").val()}var keyword=TS.ui.needToBlockAtChannelKeyword(text,null,c_id);if(keyword){TS.info("Can't submit dialog because comment contains "+keyword);return true}return false},fileShowPublicUrlDialog:function(file){if(!file||!file.public_url_shared)return;var html=$('<input type="text" id="public_url" class="full_width small">').attr("value",file.permalink_public)[0].outerHTML;TS.generic_dialog.start({title:"Public link to this file",body:html,show_cancel_button:false,show_close_button:true,show_secondary_go_button:true,secondary_go_button_class:"btn_outline",secondary_go_button_text:"Revoke",show_go_button:true,go_button_text:"Done",esc_for_ok:true,on_secondary_go:function(){TS.ui.fileRevokePublicLink(file.id)},on_go:function(){TS.generic_dialog.cancel()},on_show:function(){TS.generic_dialog.div.on("shown",function shown(){TS.generic_dialog.div.off("shown",shown);$("#public_url").select().focus().on("keydown",function(e){if(e.which==TS.utility.keymap.esc)TS.generic_dialog.cancel()})})}})},fileRevokePublicLink:function(id){var file=TS.files.getFileById(id);if(!file)return false;TS.generic_dialog.start({title:"Revoke public file link",body:'<p class="no_bottom_margin">This will disable the Public Link for this file. This will cause any previously shared links to stop working.<br /><br />Are you sure you want to revoke this public link?</p>',go_button_text:"Revoke it",go_button_class:"btn_warning",on_go:function(){TS.files.upsertAndSignal({id:file.id,public_url_shared:false});TS.api.callImmediately("files.revokePublicURL",{file:file.id})}})},startButtonSpinner:function(btn){TS.ui.resetButtonSpinner(btn);var l=_getLadda(btn);if(!l.isLoading()){l.start()}},stopButtonSpinner:function(btn,success){var l=_getLadda(btn);if(l.isLoading()){l.stop();if(success){var original_text=$(btn).find(".ladda-label").text();$(btn).data("original_text",original_text);$(btn).removeClass("").addClass("btn_success").find(".ladda-label").html('<i class="ts_icon ts_icon_check_circle_o small_right_margin"></i>Saved')}}},resetButtonSpinner:function(btn){var l=_getLadda(btn);if(l.isLoading()){return}var original_text=$(btn).data("original_text");if(original_text){$(btn).find(".ladda-label").text(original_text);$(btn).removeData("original_text");$(btn).removeClass("btn_success").addClass("")}},showVersionInfo:function(e){var VERSION_INFO_DIALOG_NAME="version_info";TS.generic_dialog.start({title:"Version Info",unique:VERSION_INFO_DIALOG_NAME,body:"<p>This version: "+TS.boot_data.version_ts+'</p><p class="latest_version checking">Checking for updates...</p>',show_cancel_button:false,go_button_class:"btn_outline",go_button_text:"Close",show_secondary_go_button:false,on_secondary_go:function(){window.location.reload()}});TS.api.callImmediately("test.versionInfo").then(function(resp){if(!TS.generic_dialog.is_showing||TS.generic_dialog.current_setting.unique!=VERSION_INFO_DIALOG_NAME){return}var $latest_version=TS.generic_dialog.div.find(".latest_version");$latest_version.removeClass("checking");var is_up_to_date=resp.data.version_ts.toString()==TS.boot_data.version_ts.toString();if(is_up_to_date){$latest_version.html("Your copy of Slack is up-to-date! "+TS.emoji.replace(":tada:"))}else{TS.generic_dialog.div.find(".btn.dialog_secondary_go").removeClass("hidden").text("Update");var requires_update=resp.data.min_version_ts>TS.boot_data.version_ts;if(requires_update){$latest_version.html("An important new version of Slack is available. "+TS.emoji.replace(":sparkles:"))}else{$latest_version.html("A newer version of Slack is available. "+TS.emoji.replace(":sparkles:"))}}}).catch($.noop)},test:function(){return{getAdditionalSearchText:_getAdditionalSearchText}}});var _getLadda=function(btn){var l=$(btn).data("ladda");if(!l){l=Ladda.create(btn);$(btn).data("ladda",l)}return l};function _fileShareOnChange(item){var selected_val,type_prefix;var $select_share_channels=$("#select_share_channels");if(TS.boot_data.feature_private_channels){selected_val=item.model_ob.id}else{selected_val=$select_share_channels.val()}if(!TS.boot_data.feature_private_channels&&(selected_val=="ts_null_value"||selected_val===null)){$select_share_channels[0].selectedIndex=0;$select_share_channels.trigger("chosen:updated.chosen");return}else if(!selected_val){return}else{$("#share_model_ob_id").val(selected_val)}$("#select_share_groups_note, #select_share_channels_note, #select_share_ims_note, #select_share_mpims_note, #select_share_channels_join_note").addClass("hidden");type_prefix=selected_val.substring(0,1);if(type_prefix==="C"){$("#select_share_channels_note").removeClass("hidden");$("#share_context_label").text("in");var channel=TS.shared.getModelObById(selected_val);if(channel&&!channel.is_member){$("#select_share_channels_join_note").removeClass("hidden")}}else if(type_prefix==="U"||type_prefix==="D"){$("#select_share_ims_note").removeClass("hidden");$("#share_context_label").text("with")}else if(TS.boot_data.feature_mpim_client&&item&&item.model_ob&&item.model_ob.is_mpim){$("#select_share_mpims_note").removeClass("hidden");$("#share_context_label").text("with")}else{$("#select_share_groups_note").removeClass("hidden");$("#share_context_label").text("in")}TS.ui.updateAtChannelWarningNote();TS.ui.updateAtChannelBlockedNote()}function _getAdditionalSearchText(member){var override=TS.model.prefs.display_real_names_override;var display_real_names=TS.model.team.prefs.display_real_names&&override!=-1||override==1;if(!member.is_slackbot&&!member.is_bot){if(member.real_name&&member.name){if(display_real_names){return"(@"+member.name+")"}else{return"("+TS.utility.htmlEntities(member.real_name)+")"}}}return""}})();
